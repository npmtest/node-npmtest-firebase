{"/home/travis/build/npmtest/node-npmtest-firebase/test.js":"/* istanbul instrument in package npmtest_firebase */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        switch (local.modeJs) {\n        // re-init local from window.local\n        case 'browser':\n            local = local.global.utility2.objectSetDefault(\n                local.global.utility2_rollup || local.global.local,\n                local.global.utility2\n            );\n            break;\n        // re-init local from example.js\n        case 'node':\n            local = (local.global.utility2_rollup || require('utility2'))\n                .requireExampleJsFromReadme();\n            break;\n        }\n        // export local\n        local.global.local = local;\n    }());\n\n\n\n    // run shared js-env code - function\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - function\n    case 'browser':\n        break;\n\n\n\n    // run node js-env code - function\n    case 'node':\n        break;\n    }\n\n\n\n    // run shared js-env code - post-init\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - post-init\n    case 'browser':\n        // run tests\n        local.nop(local.modeTest &&\n            document.querySelector('#testRunButton1') &&\n            document.querySelector('#testRunButton1').click());\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApidoc's default handling-behavior-behavior\n         */\n            options = { modulePathList: module.paths };\n            local.buildApidoc(options, onError);\n        };\n\n        local.testCase_buildApp_default = local.testCase_buildApp_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApp's default handling-behavior-behavior\n         */\n            local.testCase_buildReadme_default(options, local.onErrorThrow);\n            local.testCase_buildLib_default(options, local.onErrorThrow);\n            local.testCase_buildTest_default(options, local.onErrorThrow);\n            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);\n            options = [];\n            local.buildApp(options, onError);\n        };\n\n        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||\n            function (options, onError) {\n            /*\n             * this function will test buildCustomOrg's default handling-behavior\n             */\n                options = {};\n                local.buildCustomOrg(options, onError);\n            };\n\n        local.testCase_buildLib_default = local.testCase_buildLib_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildLib's default handling-behavior\n         */\n            options = {};\n            local.buildLib(options, onError);\n        };\n\n        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildReadme's default handling-behavior-behavior\n         */\n            options = {};\n            local.buildReadme(options, onError);\n        };\n\n        local.testCase_buildTest_default = local.testCase_buildTest_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildTest's default handling-behavior\n         */\n            options = {};\n            local.buildTest(options, onError);\n        };\n\n        local.testCase_webpage_default = local.testCase_webpage_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test webpage's default handling-behavior\n         */\n            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };\n            local.browserTest(options, onError);\n        };\n\n        // run test-server\n        local.testRunServer(local);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-firebase/lib.npmtest_firebase.js":"/* istanbul instrument in package npmtest_firebase */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || local;\n        // init lib\n        local.local = local.npmtest_firebase = local;\n        // init exports\n        if (local.modeJs === 'browser') {\n            local.global.utility2_npmtest_firebase = local;\n        } else {\n            module.exports = local;\n            module.exports.__dirname = __dirname;\n            module.exports.module = module;\n        }\n    }());\n}());\n","/home/travis/build/npmtest/node-npmtest-firebase/example.js":"/*\nexample.js\n\nquickstart example\n\ninstruction\n    1. save this script as example.js\n    2. run the shell command:\n        $ npm install npmtest-firebase && PORT=8081 node example.js\n    3. play with the browser-demo on http://127.0.0.1:8081\n*/\n\n\n\n/* istanbul instrument in package npmtest_firebase */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || (local.modeJs === 'browser'\n            ? local.global.utility2_npmtest_firebase\n            : global.utility2_moduleExports);\n        // export local\n        local.global.local = local;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // post-init\n    // run browser js-env code - post-init\n    /* istanbul ignore next */\n    case 'browser':\n        local.testRunBrowser = function (event) {\n            if (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('onreset'))) {\n                // reset output\n                Array.from(\n                    document.querySelectorAll('body > .resettable')\n                ).forEach(function (element) {\n                    switch (element.tagName) {\n                    case 'INPUT':\n                    case 'TEXTAREA':\n                        element.value = '';\n                        break;\n                    default:\n                        element.textContent = '';\n                    }\n                });\n            }\n            switch (event && event.currentTarget && event.currentTarget.id) {\n            case 'testRunButton1':\n                // show tests\n                if (document.querySelector('#testReportDiv1').style.display === 'none') {\n                    document.querySelector('#testReportDiv1').style.display = 'block';\n                    document.querySelector('#testRunButton1').textContent =\n                        'hide internal test';\n                    local.modeTest = true;\n                    local.testRunDefault(local);\n                // hide tests\n                } else {\n                    document.querySelector('#testReportDiv1').style.display = 'none';\n                    document.querySelector('#testRunButton1').textContent = 'run internal test';\n                }\n                break;\n            // custom-case\n            default:\n                break;\n            }\n            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('oneval')))) {\n                // try to eval input-code\n                try {\n                    /*jslint evil: true*/\n                    eval(document.querySelector('#inputTextareaEval1').value);\n                } catch (errorCaught) {\n                    console.error(errorCaught);\n                }\n            }\n        };\n        // log stderr and stdout to #outputTextareaStdout1\n        ['error', 'log'].forEach(function (key) {\n            console[key + '_original'] = console[key];\n            console[key] = function () {\n                var element;\n                console[key + '_original'].apply(console, arguments);\n                element = document.querySelector('#outputTextareaStdout1');\n                if (!element) {\n                    return;\n                }\n                // append text to #outputTextareaStdout1\n                element.value += Array.from(arguments).map(function (arg) {\n                    return typeof arg === 'string'\n                        ? arg\n                        : JSON.stringify(arg, null, 4);\n                }).join(' ') + '\\n';\n                // scroll textarea to bottom\n                element.scrollTop = element.scrollHeight;\n            };\n        });\n        // init event-handling\n        ['change', 'click', 'keyup'].forEach(function (event) {\n            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {\n                element.addEventListener(event, local.testRunBrowser);\n            });\n        });\n        // run tests\n        local.testRunBrowser();\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        // export local\n        module.exports = local;\n        // require modules\n        local.fs = require('fs');\n        local.http = require('http');\n        local.url = require('url');\n        // init assets\n        local.assetsDict = local.assetsDict || {};\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.index.template.html'] = '\\\n<!doctype html>\\n\\\n<html lang=\"en\">\\n\\\n<head>\\n\\\n<meta charset=\"UTF-8\">\\n\\\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\\n<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n    box-sizing: false,\\n\\\n    universal-selector: false\\n\\\n*/\\n\\\n* {\\n\\\n    box-sizing: border-box;\\n\\\n}\\n\\\nbody {\\n\\\n    background: #dde;\\n\\\n    font-family: Arial, Helvetica, sans-serif;\\n\\\n    margin: 2rem;\\n\\\n}\\n\\\nbody > * {\\n\\\n    margin-bottom: 1rem;\\n\\\n}\\n\\\n.utility2FooterDiv {\\n\\\n    margin-top: 20px;\\n\\\n    text-align: center;\\n\\\n}\\n\\\n</style>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n*/\\n\\\ntextarea {\\n\\\n    font-family: monospace;\\n\\\n    height: 10rem;\\n\\\n    width: 100%;\\n\\\n}\\n\\\ntextarea[readonly] {\\n\\\n    background: #ddd;\\n\\\n}\\n\\\n</style>\\n\\\n</head>\\n\\\n<body>\\n\\\n<!-- utility2-comment\\n\\\n<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\\nutility2-comment -->\\n\\\n<h1>\\n\\\n<!-- utility2-comment\\n\\\n    <a\\n\\\n        {{#if env.npm_package_homepage}}\\n\\\n        href=\"{{env.npm_package_homepage}}\"\\n\\\n        {{/if env.npm_package_homepage}}\\n\\\n        target=\"_blank\"\\n\\\n    >\\n\\\nutility2-comment -->\\n\\\n        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\\n<!-- utility2-comment\\n\\\n    </a>\\n\\\nutility2-comment -->\\n\\\n</h1>\\n\\\n<h3>{{env.npm_package_description}}</h3>\\n\\\n<!-- utility2-comment\\n\\\n<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\\n<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\\n<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\\nutility2-comment -->\\n\\\n\\n\\\n\\n\\\n\\n\\\n<label>stderr and stdout</label>\\n\\\n<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\\n<!-- utility2-comment\\n\\\n{{#if isRollup}}\\n\\\n<script src=\"assets.app.js\"></script>\\n\\\n{{#unless isRollup}}\\n\\\nutility2-comment -->\\n\\\n<script src=\"assets.utility2.rollup.js\"></script>\\n\\\n<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\\n<script src=\"assets.npmtest_firebase.rollup.js\"></script>\\n\\\n<script src=\"assets.example.js\"></script>\\n\\\n<script src=\"assets.test.js\"></script>\\n\\\n<!-- utility2-comment\\n\\\n{{/if isRollup}}\\n\\\nutility2-comment -->\\n\\\n<div class=\"utility2FooterDiv\">\\n\\\n    [ this app was created with\\n\\\n    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\\n    ]\\n\\\n</div>\\n\\\n</body>\\n\\\n</html>\\n\\\n';\n        /* jslint-ignore-end */\n        if (local.templateRender) {\n            local.assetsDict['/'] = local.templateRender(\n                local.assetsDict['/assets.index.template.html'],\n                {\n                    env: local.objectSetDefault(local.env, {\n                        npm_package_description: 'the greatest app in the world!',\n                        npm_package_name: 'my-app',\n                        npm_package_nameAlias: 'my_app',\n                        npm_package_version: '0.0.1'\n                    })\n                }\n            );\n        } else {\n            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']\n                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {\n                    // jslint-hack\n                    String(match0);\n                    switch (match1) {\n                    case 'npm_package_description':\n                        return 'the greatest app in the world!';\n                    case 'npm_package_name':\n                        return 'my-app';\n                    case 'npm_package_nameAlias':\n                        return 'my_app';\n                    case 'npm_package_version':\n                        return '0.0.1';\n                    }\n                });\n        }\n        // run the cli\n        if (local.global.utility2_rollup || module !== require.main) {\n            break;\n        }\n        local.assetsDict['/assets.example.js'] =\n            local.assetsDict['/assets.example.js'] ||\n            local.fs.readFileSync(__filename, 'utf8');\n        local.assetsDict['/assets.npmtest_firebase.rollup.js'] =\n            local.assetsDict['/assets.npmtest_firebase.rollup.js'] ||\n            local.fs.readFileSync(\n                // buildCustomOrg-hack\n                local.npmtest_firebase.__dirname +\n                    '/lib.npmtest_firebase.js',\n                'utf8'\n            ).replace((/^#!/), '//');\n        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';\n        // if $npm_config_timeout_exit exists,\n        // then exit this process after $npm_config_timeout_exit ms\n        if (Number(process.env.npm_config_timeout_exit)) {\n            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));\n        }\n        // start server\n        if (local.global.utility2_serverHttp1) {\n            break;\n        }\n        process.env.PORT = process.env.PORT || '8081';\n        console.error('server starting on port ' + process.env.PORT);\n        local.http.createServer(function (request, response) {\n            request.urlParsed = local.url.parse(request.url);\n            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {\n                response.end(local.assetsDict[request.urlParsed.pathname]);\n                return;\n            }\n            response.statusCode = 404;\n            response.end();\n        }).listen(process.env.PORT);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/firebase-node.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar firebase = require('./app-node');\nrequire('./auth-node');\n\nrequire('./server-auth-node');\nrequire('./database-node');\nvar Storage = require('dom-storage');\nvar XMLHttpRequest = require(\"xmlhttprequest\").XMLHttpRequest;\nfirebase.INTERNAL.extendNamespace({\n    'INTERNAL': {\n        'node': {\n            'localStorage': new Storage(null, { strict: true }),\n            'sessionStorage': new Storage(null, { strict: true }),\n            'XMLHttpRequest': XMLHttpRequest\n        }\n    }\n});\nvar AsyncStorage;\n\nexports.default = firebase;\nmodule.exports = exports['default'];\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app-node.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _firebase_app = require('./app/firebase_app');\n\nvar firebase = (0, _firebase_app.createFirebaseNamespace)(); \nexports.default = firebase;\nmodule.exports = exports['default'];\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app/firebase_app.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.createFirebaseNamespace = createFirebaseNamespace;\n\nvar _deep_copy = require('./deep_copy');\n\nvar _subscribe = require('./subscribe');\n\nvar _errors = require('./errors');\n\nvar _shared_promise = require('./shared_promise');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LocalPromise = _shared_promise.local.Promise;\nvar DEFAULT_ENTRY_NAME = '[DEFAULT]';\n\nvar FirebaseAppImpl = function () {\n    function FirebaseAppImpl(options, name, firebase_) {\n        var _this = this;\n\n        _classCallCheck(this, FirebaseAppImpl);\n\n        this.firebase_ = firebase_;\n        this.isDeleted_ = false;\n        this.services_ = {};\n        this.name_ = name;\n        this.options_ = (0, _deep_copy.deepCopy)(options);\n        var hasCredential = 'credential' in this.options_;\n        var hasServiceAccount = 'serviceAccount' in this.options_;\n        if (hasCredential || hasServiceAccount) {\n            var deprecatedKey = hasServiceAccount ? 'serviceAccount' : 'credential';\n            if (typeof console !== 'undefined') {\n                console.log('The \\'' + deprecatedKey + '\\' property specified in the first argument ' + 'to initializeApp() is deprecated and will be removed in the next ' + 'major version. You should instead use the \\'firebase-admin\\' ' + 'package. See https://firebase.google.com/docs/admin/setup for ' + 'details on how to get started.');\n            }\n        }\n        Object.keys(firebase_.INTERNAL.factories).forEach(function (serviceName) {\n            var factoryName = firebase_.INTERNAL.useAsService(_this, serviceName);\n            if (factoryName === null) {\n                return;\n            }\n            var getService = _this.getService.bind(_this, factoryName);\n            (0, _deep_copy.patchProperty)(_this, serviceName, getService);\n        });\n    }\n\n    _createClass(FirebaseAppImpl, [{\n        key: 'delete',\n        value: function _delete() {\n            var _this2 = this;\n\n            return new LocalPromise(function (resolve) {\n                _this2.checkDestroyed_();\n                resolve();\n            }).then(function () {\n                _this2.firebase_.INTERNAL.removeApp(_this2.name_);\n                var services = [];\n                Object.keys(_this2.services_).forEach(function (serviceKey) {\n                    Object.keys(_this2.services_[serviceKey]).forEach(function (instanceKey) {\n                        services.push(_this2.services_[serviceKey][instanceKey]);\n                    });\n                });\n                return LocalPromise.all(services.map(function (service) {\n                    return service.INTERNAL.delete();\n                }));\n            }).then(function () {\n                _this2.isDeleted_ = true;\n                _this2.services_ = {};\n            });\n        }\n\n    }, {\n        key: 'getService',\n        value: function getService(name, instanceString) {\n            this.checkDestroyed_();\n            if (typeof this.services_[name] === 'undefined') {\n                this.services_[name] = {};\n            }\n            var instanceSpecifier = instanceString || DEFAULT_ENTRY_NAME;\n            if (typeof this.services_[name][instanceSpecifier] === 'undefined') {\n                var firebaseService = this.firebase_.INTERNAL.factories[name](this, this.extendApp.bind(this), instanceString);\n                this.services_[name][instanceSpecifier] = firebaseService;\n                return firebaseService;\n            } else {\n                return this.services_[name][instanceSpecifier];\n            }\n        }\n\n    }, {\n        key: 'extendApp',\n        value: function extendApp(props) {\n            (0, _deep_copy.deepExtend)(this, props);\n        }\n\n    }, {\n        key: 'checkDestroyed_',\n        value: function checkDestroyed_() {\n            if (this.isDeleted_) {\n                error('app-deleted', { 'name': this.name_ });\n            }\n        }\n    }, {\n        key: 'name',\n        get: function get() {\n            this.checkDestroyed_();\n            return this.name_;\n        }\n    }, {\n        key: 'options',\n        get: function get() {\n            this.checkDestroyed_();\n            return this.options_;\n        }\n    }]);\n\n    return FirebaseAppImpl;\n}();\n\nFirebaseAppImpl.prototype.name && FirebaseAppImpl.prototype.options || FirebaseAppImpl.prototype.delete || console.log(\"dc\");\nfunction createFirebaseNamespace() {\n    var apps_ = {};\n    var factories = {};\n    var appHooks = {};\n    var namespace = {\n        '__esModule': true,\n        'initializeApp':\n        function (options, name) {\n            if (name === undefined) {\n                name = DEFAULT_ENTRY_NAME;\n            } else {\n                if (typeof name !== 'string' || name === '') {\n                    error('bad-app-name', { 'name': name + '' });\n                }\n            }\n            if (apps_[name] !== undefined) {\n                error('duplicate-app', { 'name': name });\n            }\n            var app = new FirebaseAppImpl(options, name, namespace);\n            apps_[name] = app;\n            callAppHooks(app, 'create');\n            if (app.INTERNAL == undefined || app.INTERNAL.getToken == undefined) {\n                (0, _deep_copy.deepExtend)(app, {\n                    INTERNAL: {\n                        'getUid': function getUid() {\n                            return null;\n                        },\n                        'getToken': function getToken() {\n                            return LocalPromise.resolve(null);\n                        },\n                        'addAuthTokenListener': function addAuthTokenListener() {},\n                        'removeAuthTokenListener': function removeAuthTokenListener() {}\n                    }\n                });\n            }\n            return app;\n        }\n        ,\n        'app': app,\n        'apps': null,\n        'Promise': LocalPromise,\n        'SDK_VERSION': '3.7.8',\n        'INTERNAL': {\n            'registerService':\n            function (name, createService, serviceProperties, appHook, allowMultipleInstances) {\n                if (factories[name]) {\n                    error('duplicate-service', { 'name': name });\n                }\n                if (!!allowMultipleInstances) {\n                    factories[name] = createService;\n                } else {\n                    factories[name] = function (app, extendApp) {\n                        return createService(app, extendApp, DEFAULT_ENTRY_NAME);\n                    };\n                }\n                if (appHook) {\n                    appHooks[name] = appHook;\n                }\n                var serviceNamespace = void 0;\n                serviceNamespace = function (appArg) {\n                    if (appArg === undefined) {\n                        appArg = app();\n                    }\n                    if (typeof appArg[name] !== 'function') {\n                        error('invalid-app-argument', { 'name': name });\n                    }\n                    return appArg[name]();\n                };\n                if (serviceProperties !== undefined) {\n                    (0, _deep_copy.deepExtend)(serviceNamespace, serviceProperties);\n                }\n                namespace[name] = serviceNamespace;\n                return serviceNamespace;\n            }\n            ,\n            'createFirebaseNamespace': createFirebaseNamespace,\n            'extendNamespace': function (props) {\n                (0, _deep_copy.deepExtend)(namespace, props);\n            },\n            'createSubscribe': _subscribe.createSubscribe,\n            'ErrorFactory': _errors.ErrorFactory,\n            'removeApp':\n            function (name) {\n                var app = apps_[name];\n                callAppHooks(app, 'delete');\n                delete apps_[name];\n            }\n            ,\n            'factories': factories,\n            'useAsService': useAsService,\n            'Promise': _shared_promise.local.GoogPromise,\n            'deepExtend': _deep_copy.deepExtend\n        }\n    };\n    (0, _deep_copy.patchProperty)(namespace, 'default', namespace);\n    Object.defineProperty(namespace, 'apps', {\n        get: function () {\n            return Object.keys(apps_).map(function (name) {\n                return apps_[name];\n            });\n        }\n    });function app(name) {\n        name = name || DEFAULT_ENTRY_NAME;\n        var result = apps_[name];\n        if (result === undefined) {\n            error('no-app', { 'name': name });\n        }\n        return result;\n    }\n    (0, _deep_copy.patchProperty)(app, 'App', FirebaseAppImpl);\n    function callAppHooks(app, eventName) {\n        Object.keys(factories).forEach(function (serviceName) {\n            var factoryName = useAsService(app, serviceName);\n            if (factoryName === null) {\n                return;\n            }\n            if (appHooks[factoryName]) {\n                appHooks[factoryName](eventName, app);\n            }\n        });\n    }\n    function useAsService(app, name) {\n        if (name === 'serverAuth') {\n            return null;\n        }\n        var useService = name;\n        var options = app.options;\n        if (name === 'auth' && (options['serviceAccount'] || options['credential'])) {\n            useService = 'serverAuth';\n            if (!('serverAuth' in factories)) {\n                error('sa-not-supported');\n            }\n        }\n        return useService;\n    }\n    return namespace;\n}\nfunction error(code, args) {\n    throw appErrors.create(code, args);\n}\nvar errors = {\n    'no-app': 'No Firebase App \\'{$name}\\' has been created - ' + 'call Firebase App.initializeApp()',\n    'bad-app-name': 'Illegal App name: \\'{$name}',\n    'duplicate-app': 'Firebase App named \\'{$name}\\' already exists',\n    'app-deleted': 'Firebase App named \\'{$name}\\' already deleted',\n    'duplicate-service': 'Firebase service named \\'{$name}\\' already registered',\n    'sa-not-supported': 'Initializing the Firebase SDK with a service ' + 'account is only allowed in a Node.js environment. On client ' + 'devices, you should instead initialize the SDK with an api key and ' + 'auth domain',\n    'invalid-app-argument': 'firebase.{$name}() takes either no argument or a ' + 'Firebase App instance.'\n};\nvar appErrors = new _errors.ErrorFactory('app', 'Firebase', errors);\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app/deep_copy.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.deepCopy = deepCopy;\nexports.deepExtend = deepExtend;\nexports.patchProperty = patchProperty;\nfunction deepCopy(value) {\n    return deepExtend(undefined, value);\n}\nfunction deepExtend(target, source) {\n    if (!(source instanceof Object)) {\n        return source;\n    }\n    switch (source.constructor) {\n        case Date:\n            return new Date(source.getTime());\n\n        case Object:\n            if (target === undefined) {\n                target = {};\n            }\n            break;\n        case Array:\n            target = [];\n            break;\n        default:\n            return source;\n    }\n    for (var prop in source) {\n        if (!source.hasOwnProperty(prop)) {\n            continue;\n        }\n        target[prop] = deepExtend(target[prop], source[prop]);\n    }\n    return target;\n}\nfunction patchProperty(obj, prop, value) {\n    obj[prop] = value;\n}\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app/subscribe.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.createSubscribe = createSubscribe;\nexports.async = async;\n\nvar _shared_promise = require('./shared_promise');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LocalPromise = _shared_promise.local.Promise;\nfunction createSubscribe(executor, onNoObservers) {\n    var proxy = new ObserverProxy(executor, onNoObservers);\n    return proxy.subscribe.bind(proxy);\n}\n\nvar ObserverProxy = function () {\n    function ObserverProxy(executor, onNoObservers) {\n        var _this = this;\n\n        _classCallCheck(this, ObserverProxy);\n\n        this.observers = [];\n        this.unsubscribes = [];\n        this.observerCount = 0;\n        this.task = LocalPromise.resolve();\n        this.finalized = false;\n        this.onNoObservers = onNoObservers;\n        this.task.then(function () {\n            executor(_this);\n        }).catch(function (e) {\n            _this.error(e);\n        });\n    }\n\n    _createClass(ObserverProxy, [{\n        key: 'next',\n        value: function next(value) {\n            this.forEachObserver(function (observer) {\n                observer.next(value);\n            });\n        }\n    }, {\n        key: 'error',\n        value: function error(_error) {\n            this.forEachObserver(function (observer) {\n                observer.error(_error);\n            });\n            this.close(_error);\n        }\n    }, {\n        key: 'complete',\n        value: function complete() {\n            this.forEachObserver(function (observer) {\n                observer.complete();\n            });\n            this.close();\n        }\n\n    }, {\n        key: 'subscribe',\n        value: function subscribe(nextOrObserver, error, complete) {\n            var _this2 = this;\n\n            var observer = void 0;\n            if (nextOrObserver === undefined && error === undefined && complete === undefined) {\n                throw new Error(\"Missing Observer.\");\n            }\n            if (implementsAnyMethods(nextOrObserver, ['next', 'error', 'complete'])) {\n                observer = nextOrObserver;\n            } else {\n                observer = {\n                    next: nextOrObserver,\n                    error: error,\n                    complete: complete\n                };\n            }\n            if (observer.next === undefined) {\n                observer.next = noop;\n            }\n            if (observer.error === undefined) {\n                observer.error = noop;\n            }\n            if (observer.complete === undefined) {\n                observer.complete = noop;\n            }\n            var unsub = this.unsubscribeOne.bind(this, this.observers.length);\n            if (this.finalized) {\n                this.task.then(function () {\n                    try {\n                        if (_this2.finalError) {\n                            observer.error(_this2.finalError);\n                        } else {\n                            observer.complete();\n                        }\n                    } catch (e) {\n                    }\n                });\n            }\n            this.observers.push(observer);\n            return unsub;\n        }\n\n    }, {\n        key: 'unsubscribeOne',\n        value: function unsubscribeOne(i) {\n            if (this.observers === undefined || this.observers[i] === undefined) {\n                return;\n            }\n            delete this.observers[i];\n            this.observerCount -= 1;\n            if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n                this.onNoObservers(this);\n            }\n        }\n    }, {\n        key: 'forEachObserver',\n        value: function forEachObserver(fn) {\n            if (this.finalized) {\n                return;\n            }\n            for (var i = 0; i < this.observers.length; i++) {\n                this.sendOne(i, fn);\n            }\n        }\n\n    }, {\n        key: 'sendOne',\n        value: function sendOne(i, fn) {\n            var _this3 = this;\n\n            this.task.then(function () {\n                if (_this3.observers !== undefined && _this3.observers[i] !== undefined) {\n                    try {\n                        fn(_this3.observers[i]);\n                    } catch (e) {\n                        if (typeof console !== \"undefined\" && console.error) {\n                            console.error(e);\n                        }\n                    }\n                }\n            });\n        }\n    }, {\n        key: 'close',\n        value: function close(err) {\n            var _this4 = this;\n\n            if (this.finalized) {\n                return;\n            }\n            this.finalized = true;\n            if (err !== undefined) {\n                this.finalError = err;\n            }\n            this.task.then(function () {\n                _this4.observers = undefined;\n                _this4.onNoObservers = undefined;\n            });\n        }\n    }]);\n\n    return ObserverProxy;\n}();\n\n\nfunction async(fn, onError) {\n    return function () {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        LocalPromise.resolve(true).then(function () {\n            fn.apply(undefined, args);\n        }).catch(function (error) {\n            if (onError) {\n                onError(error);\n            }\n        });\n    };\n}\nfunction implementsAnyMethods(obj, methods) {\n    if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object' || obj === null) {\n        return false;\n    }\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = methods[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var method = _step.value;\n\n            if (method in obj && typeof obj[method] === 'function') {\n                return true;\n            }\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    return false;\n}\nfunction noop() {\n}\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app/shared_promise.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar scope = void 0;\nif (typeof global !== 'undefined') {\n    scope = global;\n} else if (typeof self !== 'undefined') {\n    scope = self;\n} else {\n    try {\n        scope = Function('return this')();\n    } catch (e) {\n        throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n}\nvar PromiseImpl = scope.Promise || require('promise-polyfill');\nvar local = exports.local = {\n    Promise: PromiseImpl,\n    GoogPromise: PromiseImpl\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/app/errors.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.patchCapture = patchCapture;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ERROR_NAME = 'FirebaseError';\nvar captureStackTrace = Error.captureStackTrace;\nfunction patchCapture(captureFake) {\n    var result = captureStackTrace;\n    captureStackTrace = captureFake;\n    return result;\n}\n\nvar FirebaseError = function FirebaseError(code, message) {\n    _classCallCheck(this, FirebaseError);\n\n    this.code = code;\n    this.message = message;\n\n    if (captureStackTrace) {\n        captureStackTrace(this, ErrorFactory.prototype.create);\n    } else {\n        var err = Error.apply(this, arguments);\n        this.name = ERROR_NAME;\n        Object.defineProperty(this, 'stack', {\n            get: function get() {\n                return err.stack;\n            }\n        });\n    }\n};\n\n\nFirebaseError.prototype = Object.create(Error.prototype);\nFirebaseError.prototype.constructor = FirebaseError;\nFirebaseError.prototype.name = ERROR_NAME;\n\nvar ErrorFactory = exports.ErrorFactory = function () {\n    function ErrorFactory(service, serviceName, errors) {\n        _classCallCheck(this, ErrorFactory);\n\n        this.service = service;\n        this.serviceName = serviceName;\n        this.errors = errors;\n        this.pattern = /\\{\\$([^}]+)}/g;\n    }\n\n    _createClass(ErrorFactory, [{\n        key: 'create',\n        value: function create(code, data) {\n            if (data === undefined) {\n                data = {};\n            }\n            var template = this.errors[code];\n            var fullCode = this.service + '/' + code;\n            var message = void 0;\n            if (template === undefined) {\n                message = \"Error\";\n            } else {\n                message = template.replace(this.pattern, function (match, key) {\n                    var value = data[key];\n                    return value !== undefined ? value.toString() : '<' + key + '?>';\n                });\n            }\n            message = this.serviceName + ': ' + message + ' (' + fullCode + ').';\n            var err = new FirebaseError(fullCode, message);\n            for (var prop in data) {\n                if (!data.hasOwnProperty(prop) || prop.slice(-1) === '_') {\n                    continue;\n                }\n                err[prop] = data[prop];\n            }\n            return err;\n        }\n    }]);\n\n    return ErrorFactory;\n}();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/auth-node.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\nvar firebase = require('./app-node');\n(function(){\n(function(){var h,aa=aa||{},l=this,ba=function(){},ca=function(a){var b=typeof a;if(\"object\"==b)if(a){if(a instanceof Array)return\"array\";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(\"[object Window]\"==c)return\"object\";if(\"[object Array]\"==c||\"number\"==typeof a.length&&\"undefined\"!=typeof a.splice&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==c||\"undefined\"!=typeof a.call&&\"undefined\"!=typeof a.propertyIsEnumerable&&\n!a.propertyIsEnumerable(\"call\"))return\"function\"}else return\"null\";else if(\"function\"==b&&\"undefined\"==typeof a.call)return\"object\";return b},da=function(a){return null===a},ea=function(a){return\"array\"==ca(a)},fa=function(a){var b=ca(a);return\"array\"==b||\"object\"==b&&\"number\"==typeof a.length},m=function(a){return\"string\"==typeof a},ga=function(a){return\"number\"==typeof a},p=function(a){return\"function\"==ca(a)},ha=function(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b},ia=function(a,\nb,c){return a.call.apply(a.bind,arguments)},ja=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?ia:ja;return q.apply(null,arguments)},ka=function(a,b){var c=Array.prototype.slice.call(arguments,\n1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},la=Date.now||function(){return+new Date},r=function(a,b){function c(){}c.prototype=b.prototype;a.qd=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.If=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};var t=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};r(t,Error);t.prototype.name=\"CustomError\";var ma=function(a,b){for(var c in a)b.call(void 0,a[c],c,a)},na=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b},oa=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b},pa=function(a){for(var b in a)return!1;return!0},qa=function(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0},ra=function(a){var b={},c;for(c in a)b[c]=a[c];return b},sa=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \"),\nta=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<sa.length;f++)c=sa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var ua=function(a){ua[\" \"](a);return a};ua[\" \"]=ba;var wa=function(a,b){var c=va;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)};var xa=function(a,b){for(var c=a.split(\"%s\"),d=\"\",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join(\"%s\")},ya=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g,\"\")},za=/&/g,Aa=/</g,Ba=/>/g,Ca=/\"/g,Da=/'/g,Ea=/\\x00/g,Fa=/[\\x00&<>\"']/,u=function(a,b){return-1!=a.indexOf(b)},Ga=function(a,b){return a<b?-1:a>b?1:0};var Ha=function(a,b){b.unshift(a);t.call(this,xa.apply(null,b));b.shift()};r(Ha,t);Ha.prototype.name=\"AssertionError\";\nvar Ia=function(a,b,c,d){var e=\"Assertion failed\";if(c)var e=e+(\": \"+c),f=d;else a&&(e+=\": \"+a,f=b);throw new Ha(\"\"+e,f||[]);},v=function(a,b,c){a||Ia(\"\",null,b,Array.prototype.slice.call(arguments,2))},Ja=function(a,b){throw new Ha(\"Failure\"+(a?\": \"+a:\"\"),Array.prototype.slice.call(arguments,1));},Ka=function(a,b,c){ga(a)||Ia(\"Expected number but got %s: %s.\",[ca(a),a],b,Array.prototype.slice.call(arguments,2));return a},La=function(a,b,c){m(a)||Ia(\"Expected string but got %s: %s.\",[ca(a),a],b,Array.prototype.slice.call(arguments,\n2))},Ma=function(a,b,c){p(a)||Ia(\"Expected function but got %s: %s.\",[ca(a),a],b,Array.prototype.slice.call(arguments,2))};var Na;a:{var Oa=l.navigator;if(Oa){var Pa=Oa.userAgent;if(Pa){Na=Pa;break a}}Na=\"\"}var w=function(a){return u(Na,a)};var Qa=Array.prototype.indexOf?function(a,b,c){v(null!=a.length);return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},x=Array.prototype.forEach?function(a,b,c){v(null!=a.length);Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ra=function(a,b){for(var c=m(a)?\na.split(\"\"):a,d=a.length-1;0<=d;--d)d in c&&b.call(void 0,c[d],d,a)},Sa=Array.prototype.map?function(a,b,c){v(null!=a.length);return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=m(a)?a.split(\"\"):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ta=Array.prototype.some?function(a,b,c){v(null!=a.length);return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(\"\"):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},\nVa=function(a){var b;a:{b=Ua;for(var c=a.length,d=m(a)?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:m(a)?a.charAt(b):a[b]},Wa=function(a,b){return 0<=Qa(a,b)},Ya=function(a,b){b=Qa(a,b);var c;(c=0<=b)&&Xa(a,b);return c},Xa=function(a,b){v(null!=a.length);return 1==Array.prototype.splice.call(a,b,1).length},Za=function(a,b){var c=0;Ra(a,function(d,e){b.call(void 0,d,e,a)&&Xa(a,e)&&c++})},$a=function(a){return Array.prototype.concat.apply([],arguments)},\nab=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};var cb=function(a){return Sa(a,function(a){a=a.toString(16);return 1<a.length?a:\"0\"+a}).join(\"\")};var db=w(\"Opera\"),y=w(\"Trident\")||w(\"MSIE\"),eb=w(\"Edge\"),fb=eb||y,gb=w(\"Gecko\")&&!(u(Na.toLowerCase(),\"webkit\")&&!w(\"Edge\"))&&!(w(\"Trident\")||w(\"MSIE\"))&&!w(\"Edge\"),hb=u(Na.toLowerCase(),\"webkit\")&&!w(\"Edge\"),ib=function(){var a=l.document;return a?a.documentMode:void 0},jb;\na:{var kb=\"\",lb=function(){var a=Na;if(gb)return/rv\\:([^\\);]+)(\\)|;)/.exec(a);if(eb)return/Edge\\/([\\d\\.]+)/.exec(a);if(y)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(hb)return/WebKit\\/(\\S+)/.exec(a);if(db)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();lb&&(kb=lb?lb[1]:\"\");if(y){var mb=ib();if(null!=mb&&mb>parseFloat(kb)){jb=String(mb);break a}}jb=kb}\nvar nb=jb,va={},z=function(a){return wa(a,function(){for(var b=0,c=ya(String(nb)).split(\".\"),d=ya(String(a)).split(\".\"),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||\"\",k=d[f]||\"\";do{g=/(\\d*)(\\D*)(.*)/.exec(g)||[\"\",\"\",\"\",\"\"];k=/(\\d*)(\\D*)(.*)/.exec(k)||[\"\",\"\",\"\",\"\"];if(0==g[0].length&&0==k[0].length)break;b=Ga(0==g[1].length?0:parseInt(g[1],10),0==k[1].length?0:parseInt(k[1],10))||Ga(0==g[2].length,0==k[2].length)||Ga(g[2],k[2]);g=g[3];k=k[3]}while(0==b)}return 0<=b})},ob;var pb=l.document;\nob=pb&&y?ib()||(\"CSS1Compat\"==pb.compatMode?parseInt(nb,10):5):void 0;var qb=null,rb=null,tb=function(a){var b=\"\";sb(a,function(a){b+=String.fromCharCode(a)});return b},sb=function(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=rb[c];if(null!=e)return e;if(!/^[\\s\\xa0]*$/.test(c))throw Error(\"Unknown base64 encoding at char: \"+c);}return b}ub();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=k&&b(g<<6&192|k))}},ub=function(){if(!qb){qb={};rb={};for(var a=0;65>a;a++)qb[a]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".charAt(a),\nrb[qb[a]]=a,62<=a&&(rb[\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.\".charAt(a)]=a)}};var vb=function(){this.Ba=-1};var yb=function(a,b){this.Ba=64;this.Yb=l.Uint8Array?new Uint8Array(this.Ba):Array(this.Ba);this.Bc=this.cb=0;this.h=[];this.$e=a;this.Nd=b;this.Bf=l.Int32Array?new Int32Array(64):Array(64);void 0!==wb||(wb=l.Int32Array?new Int32Array(xb):xb);this.reset()},wb;r(yb,vb);for(var zb=[],Ab=0;63>Ab;Ab++)zb[Ab]=0;var Bb=$a(128,zb);yb.prototype.reset=function(){this.Bc=this.cb=0;this.h=l.Int32Array?new Int32Array(this.Nd):ab(this.Nd)};\nvar Cb=function(a){var b=a.Yb;v(b.length==a.Ba);for(var c=a.Bf,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){var e=c[b-15]|0,d=c[b-2]|0,f=(c[b-16]|0)+((e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(c[b-7]|0)+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}for(var d=a.h[0]|0,e=a.h[1]|0,k=a.h[2]|0,n=a.h[3]|0,B=a.h[4]|0,bb=a.h[5]|0,Lb=a.h[6]|0,f=a.h[7]|0,b=0;64>b;b++)var sh=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&k^e&k)|0,g=B&bb^~B&Lb,f=f+((B>>>6|\nB<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))|0,g=g+(wb[b]|0)|0,g=f+(g+(c[b]|0)|0)|0,f=Lb,Lb=bb,bb=B,B=n+g|0,n=k,k=e,e=d,d=g+sh|0;a.h[0]=a.h[0]+d|0;a.h[1]=a.h[1]+e|0;a.h[2]=a.h[2]+k|0;a.h[3]=a.h[3]+n|0;a.h[4]=a.h[4]+B|0;a.h[5]=a.h[5]+bb|0;a.h[6]=a.h[6]+Lb|0;a.h[7]=a.h[7]+f|0};\nyb.prototype.update=function(a,b){void 0===b&&(b=a.length);var c=0,d=this.cb;if(m(a))for(;c<b;)this.Yb[d++]=a.charCodeAt(c++),d==this.Ba&&(Cb(this),d=0);else if(fa(a))for(;c<b;){var e=a[c++];if(!(\"number\"==typeof e&&0<=e&&255>=e&&e==(e|0)))throw Error(\"message must be a byte array\");this.Yb[d++]=e;d==this.Ba&&(Cb(this),d=0)}else throw Error(\"message must be string or array\");this.cb=d;this.Bc+=b};\nyb.prototype.digest=function(){var a=[],b=8*this.Bc;56>this.cb?this.update(Bb,56-this.cb):this.update(Bb,this.Ba-(this.cb-56));for(var c=63;56<=c;c--)this.Yb[c]=b&255,b/=256;Cb(this);for(c=b=0;c<this.$e;c++)for(var d=24;0<=d;d-=8)a[b++]=this.h[c]>>d&255;return a};\nvar xb=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,\n4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var Eb=function(){yb.call(this,8,Db)};r(Eb,yb);var Db=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];var Fb=function(){this.Da=this.Da;this.pc=this.pc};Fb.prototype.Da=!1;Fb.prototype.isDisposed=function(){return this.Da};Fb.prototype.Za=function(){if(this.pc)for(;this.pc.length;)this.pc.shift()()};var Gb=\"closure_listenable_\"+(1E6*Math.random()|0),Hb=0;var Ib=function(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.jb=!1;this.Yd=!0};Ib.prototype.preventDefault=function(){this.defaultPrevented=!0;this.Yd=!1};var Jb=function(a,b,c,d,e){this.listener=a;this.tc=null;this.src=b;this.type=c;this.capture=!!d;this.fc=e;this.key=++Hb;this.nb=this.Xb=!1},Kb=function(a){a.nb=!0;a.listener=null;a.tc=null;a.src=null;a.fc=null};var Mb=function(a){this.src=a;this.F={};this.Tb=0};Mb.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.F[f];a||(a=this.F[f]=[],this.Tb++);var g=Nb(a,b,d,e);-1<g?(b=a[g],c||(b.Xb=!1)):(b=new Jb(b,this.src,f,!!d,e),b.Xb=c,a.push(b));return b};Mb.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.F))return!1;var e=this.F[a];b=Nb(e,b,c,d);return-1<b?(Kb(e[b]),Xa(e,b),0==e.length&&(delete this.F[a],this.Tb--),!0):!1};\nvar Ob=function(a,b){var c=b.type;c in a.F&&Ya(a.F[c],b)&&(Kb(b),0==a.F[c].length&&(delete a.F[c],a.Tb--))};Mb.prototype.Pc=function(a,b,c,d){a=this.F[a.toString()];var e=-1;a&&(e=Nb(a,b,c,d));return-1<e?a[e]:null};var Nb=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.nb&&f.listener==b&&f.capture==!!c&&f.fc==d)return e}return-1};var Pb=!y||9<=Number(ob),Qb=y&&!z(\"9\");!hb||z(\"528\");gb&&z(\"1.9b\")||y&&z(\"8\")||db&&z(\"9.5\")||hb&&z(\"528\");gb&&!z(\"8\")||y&&z(\"9\");var Rb=function(a,b){Ib.call(this,a?a.type:\"\");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key=\"\";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.$a=this.state=null;a&&this.init(a,b)};r(Rb,Ib);\nRb.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(gb){var e;a:{try{ua(b.nodeName);e=!0;break a}catch(f){}e=!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.offsetX=hb||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=hb||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:\na.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||\"\";this.charCode=a.charCode||(\"keypress\"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.$a=\na;a.defaultPrevented&&this.preventDefault()};Rb.prototype.preventDefault=function(){Rb.qd.preventDefault.call(this);var a=this.$a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Qb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};Rb.prototype.Fe=function(){return this.$a};var Sb=\"closure_lm_\"+(1E6*Math.random()|0),Tb={},Ub=0,Vb=function(a,b,c,d,e){if(ea(b))for(var f=0;f<b.length;f++)Vb(a,b[f],c,d,e);else c=Wb(c),a&&a[Gb]?a.listen(b,c,d,e):Xb(a,b,c,!1,d,e)},Xb=function(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var g=!!e,k=Yb(a);k||(a[Sb]=k=new Mb(a));c=k.add(b,c,d,e,f);if(!c.tc){d=Zb();c.tc=d;d.src=a;d.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),d,g);else if(a.attachEvent)a.attachEvent($b(b.toString()),d);else throw Error(\"addEventListener and attachEvent are unavailable.\");\nUb++}},Zb=function(){var a=ac,b=Pb?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},bc=function(a,b,c,d,e){if(ea(b))for(var f=0;f<b.length;f++)bc(a,b[f],c,d,e);else c=Wb(c),a&&a[Gb]?cc(a,b,c,d,e):Xb(a,b,c,!0,d,e)},dc=function(a,b,c,d,e){if(ea(b))for(var f=0;f<b.length;f++)dc(a,b[f],c,d,e);else c=Wb(c),a&&a[Gb]?a.da.remove(String(b),c,d,e):a&&(a=Yb(a))&&(b=a.Pc(b,c,!!d,e))&&ec(b)},ec=function(a){if(!ga(a)&&a&&!a.nb){var b=a.src;if(b&&\nb[Gb])Ob(b.da,a);else{var c=a.type,d=a.tc;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent($b(c),d);Ub--;(c=Yb(b))?(Ob(c,a),0==c.Tb&&(c.src=null,b[Sb]=null)):Kb(a)}}},$b=function(a){return a in Tb?Tb[a]:Tb[a]=\"on\"+a},gc=function(a,b,c,d){var e=!0;if(a=Yb(a))if(b=a.F[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.nb&&(f=fc(f,d),e=e&&!1!==f)}return e},fc=function(a,b){var c=a.listener,d=a.fc||a.src;a.Xb&&ec(a);return c.call(d,\nb)},ac=function(a,b){if(a.nb)return!0;if(!Pb){if(!b)a:{b=[\"window\",\"event\"];for(var c=l,d;d=b.shift();)if(null!=c[d])c=c[d];else{b=null;break a}b=c}d=b;b=new Rb(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.jb&&0<=e;e--){b.currentTarget=d[e];var f=gc(d[e],a,!0,b),c=c&&f}for(e=0;!b.jb&&e<d.length;e++)b.currentTarget=\nd[e],f=gc(d[e],a,!1,b),c=c&&f}return c}return fc(a,new Rb(b,this))},Yb=function(a){a=a[Sb];return a instanceof Mb?a:null},hc=\"__closure_events_fn_\"+(1E9*Math.random()>>>0),Wb=function(a){v(a,\"Listener can not be null.\");if(p(a))return a;v(a.handleEvent,\"An object listener must have handleEvent method.\");a[hc]||(a[hc]=function(b){return a.handleEvent(b)});return a[hc]};var ic=/^[+a-zA-Z0-9_.!#$%&'*\\/=?^`{|}~-]+@([a-zA-Z0-9-]+\\.)+[a-zA-Z0-9]{2,63}$/;var kc=function(){this.yc=\"\";this.oe=jc};kc.prototype.jc=!0;kc.prototype.dc=function(){return this.yc};kc.prototype.toString=function(){return\"Const{\"+this.yc+\"}\"};var lc=function(a){if(a instanceof kc&&a.constructor===kc&&a.oe===jc)return a.yc;Ja(\"expected object of type Const, got '\"+a+\"'\");return\"type_error:Const\"},jc={},mc=function(a){var b=new kc;b.yc=a;return b};mc(\"\");var oc=function(){this.sc=\"\";this.pe=nc};oc.prototype.jc=!0;oc.prototype.dc=function(){return this.sc};oc.prototype.toString=function(){return\"TrustedResourceUrl{\"+this.sc+\"}\"};var nc={};var qc=function(){this.na=\"\";this.ne=pc};qc.prototype.jc=!0;qc.prototype.dc=function(){return this.na};qc.prototype.toString=function(){return\"SafeUrl{\"+this.na+\"}\"};\nvar rc=function(a){if(a instanceof qc&&a.constructor===qc&&a.ne===pc)return a.na;Ja(\"expected object of type SafeUrl, got '\"+a+\"' of type \"+ca(a));return\"type_error:SafeUrl\"},sc=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/i,uc=function(a){if(a instanceof qc)return a;a=a.jc?a.dc():String(a);sc.test(a)||(a=\"about:invalid#zClosurez\");return tc(a)},pc={},tc=function(a){var b=new qc;b.na=a;return b};tc(\"about:blank\");var xc=function(a){var b=[];vc(new wc,a,b);return b.join(\"\")},wc=function(){this.uc=void 0},vc=function(a,b,c){if(null==b)c.push(\"null\");else{if(\"object\"==typeof b){if(ea(b)){var d=b;b=d.length;c.push(\"[\");for(var e=\"\",f=0;f<b;f++)c.push(e),e=d[f],vc(a,a.uc?a.uc.call(d,String(f),e):e,c),e=\",\";c.push(\"]\");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push(\"{\");f=\"\";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(e=b[d],\"function\"!=typeof e&&(c.push(f),\nyc(d,c),c.push(\":\"),vc(a,a.uc?a.uc.call(b,d,e):e,c),f=\",\"));c.push(\"}\");return}}switch(typeof b){case \"string\":yc(b,c);break;case \"number\":c.push(isFinite(b)&&!isNaN(b)?String(b):\"null\");break;case \"boolean\":c.push(String(b));break;case \"function\":c.push(\"null\");break;default:throw Error(\"Unknown type: \"+typeof b);}}},zc={'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\",\"/\":\"\\\\/\",\"\\b\":\"\\\\b\",\"\\f\":\"\\\\f\",\"\\n\":\"\\\\n\",\"\\r\":\"\\\\r\",\"\\t\":\"\\\\t\",\"\\x0B\":\"\\\\u000b\"},Ac=/\\uffff/.test(\"\\uffff\")?/[\\\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g:/[\\\\\\\"\\x00-\\x1f\\x7f-\\xff]/g,\nyc=function(a,b){b.push('\"',a.replace(Ac,function(a){var b=zc[a];b||(b=\"\\\\u\"+(a.charCodeAt(0)|65536).toString(16).substr(1),zc[a]=b);return b}),'\"')};var Bc=function(){};Bc.prototype.ud=null;var Cc=function(a){return a.ud||(a.ud=a.Vc())};var Dc,Ec=function(){};r(Ec,Bc);Ec.prototype.Zb=function(){var a=Fc(this);return a?new ActiveXObject(a):new XMLHttpRequest};Ec.prototype.Vc=function(){var a={};Fc(this)&&(a[0]=!0,a[1]=!0);return a};\nvar Fc=function(a){if(!a.Md&&\"undefined\"==typeof XMLHttpRequest&&\"undefined\"!=typeof ActiveXObject){for(var b=[\"MSXML2.XMLHTTP.6.0\",\"MSXML2.XMLHTTP.3.0\",\"MSXML2.XMLHTTP\",\"Microsoft.XMLHTTP\"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.Md=d}catch(e){}}throw Error(\"Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed\");}return a.Md};Dc=new Ec;var Gc=function(){};r(Gc,Bc);Gc.prototype.Zb=function(){var a=new XMLHttpRequest;if(\"withCredentials\"in a)return a;if(\"undefined\"!=typeof XDomainRequest)return new Hc;throw Error(\"Unsupported browser\");};Gc.prototype.Vc=function(){return{}};\nvar Hc=function(){this.sa=new XDomainRequest;this.readyState=0;this.onreadystatechange=null;this.responseText=\"\";this.status=-1;this.statusText=this.responseXML=null;this.sa.onload=q(this.He,this);this.sa.onerror=q(this.Jd,this);this.sa.onprogress=q(this.Ie,this);this.sa.ontimeout=q(this.Je,this)};h=Hc.prototype;h.open=function(a,b,c){if(null!=c&&!c)throw Error(\"Only async requests are supported.\");this.sa.open(a,b)};\nh.send=function(a){if(a)if(\"string\"==typeof a)this.sa.send(a);else throw Error(\"Only string data is supported\");else this.sa.send()};h.abort=function(){this.sa.abort()};h.setRequestHeader=function(){};h.He=function(){this.status=200;this.responseText=this.sa.responseText;Ic(this,4)};h.Jd=function(){this.status=500;this.responseText=\"\";Ic(this,4)};h.Je=function(){this.Jd()};h.Ie=function(){this.status=200;Ic(this,1)};var Ic=function(a,b){a.readyState=b;if(a.onreadystatechange)a.onreadystatechange()};var Jc=function(a,b,c){this.Ue=c;this.we=a;this.kf=b;this.oc=0;this.gc=null};Jc.prototype.get=function(){var a;0<this.oc?(this.oc--,a=this.gc,this.gc=a.next,a.next=null):a=this.we();return a};Jc.prototype.put=function(a){this.kf(a);this.oc<this.Ue&&(this.oc++,a.next=this.gc,this.gc=a)};var Kc=function(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0},Lc=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var Mc=function(){this.Ec=this.Ua=null},Oc=new Jc(function(){return new Nc},function(a){a.reset()},100);Mc.prototype.add=function(a,b){var c=Oc.get();c.set(a,b);this.Ec?this.Ec.next=c:(v(!this.Ua),this.Ua=c);this.Ec=c};Mc.prototype.remove=function(){var a=null;this.Ua&&(a=this.Ua,this.Ua=this.Ua.next,this.Ua||(this.Ec=null),a.next=null);return a};var Nc=function(){this.next=this.scope=this.Oc=null};Nc.prototype.set=function(a,b){this.Oc=a;this.scope=b;this.next=null};\nNc.prototype.reset=function(){this.next=this.scope=this.Oc=null};var Pc=function(a){l.setTimeout(function(){throw a;},0)},Qc,Rc=function(){var a=l.MessageChannel;\"undefined\"===typeof a&&\"undefined\"!==typeof window&&window.postMessage&&window.addEventListener&&!w(\"Presto\")&&(a=function(){var a=document.createElement(\"IFRAME\");a.style.display=\"none\";a.src=\"\";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write(\"\");a.close();var c=\"callImmediate\"+Math.random(),d=\"file:\"==b.location.protocol?\"*\":b.location.protocol+\"//\"+b.location.host,\na=q(function(a){if((\"*\"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener(\"message\",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if(\"undefined\"!==typeof a&&!w(\"Trident\")&&!w(\"MSIE\")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.xd;c.xd=null;a()}};return function(a){d.next={xd:a};d=d.next;b.port2.postMessage(0)}}return\"undefined\"!==typeof document&&\"onreadystatechange\"in document.createElement(\"SCRIPT\")?\nfunction(a){var b=document.createElement(\"SCRIPT\");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){l.setTimeout(a,0)}};var Wc=function(a,b){Sc||Tc();Uc||(Sc(),Uc=!0);Vc.add(a,b)},Sc,Tc=function(){if(-1!=String(l.Promise).indexOf(\"[native code]\")){var a=l.Promise.resolve(void 0);Sc=function(){a.then(Xc)}}else Sc=function(){var a=Xc;!p(l.setImmediate)||l.Window&&l.Window.prototype&&!w(\"Edge\")&&l.Window.prototype.setImmediate==l.setImmediate?(Qc||(Qc=Rc()),Qc(a)):l.setImmediate(a)}},Uc=!1,Vc=new Mc,Xc=function(){for(var a;a=Vc.remove();){try{a.Oc.call(a.scope)}catch(b){Pc(b)}Oc.put(a)}Uc=!1};!gb&&!y||y&&9<=Number(ob)||gb&&z(\"1.9.1\");y&&z(\"9\");var Zc=function(){this.na=\"\";this.me=Yc};Zc.prototype.jc=!0;Zc.prototype.dc=function(){return this.na};Zc.prototype.toString=function(){return\"SafeHtml{\"+this.na+\"}\"};var $c=function(a){if(a instanceof Zc&&a.constructor===Zc&&a.me===Yc)return a.na;Ja(\"expected object of type SafeHtml, got '\"+a+\"' of type \"+ca(a));return\"type_error:SafeHtml\"},Yc={};Zc.prototype.Qe=function(a){this.na=a;return this};var A=function(a,b){this.M=0;this.pa=void 0;this.Xa=this.la=this.s=null;this.ec=this.Nc=!1;if(a!=ba)try{var c=this;a.call(b,function(a){ad(c,2,a)},function(a){if(!(a instanceof bd))try{if(a instanceof Error)throw a;throw Error(\"Promise rejected.\");}catch(e){}ad(c,3,a)})}catch(d){ad(this,3,d)}},cd=function(){this.next=this.context=this.fb=this.La=this.child=null;this.ub=!1};cd.prototype.reset=function(){this.context=this.fb=this.La=this.child=null;this.ub=!1};\nvar dd=new Jc(function(){return new cd},function(a){a.reset()},100),ed=function(a,b,c){var d=dd.get();d.La=a;d.fb=b;d.context=c;return d},C=function(a){if(a instanceof A)return a;var b=new A(ba);ad(b,2,a);return b},D=function(a){return new A(function(b,c){c(a)})},gd=function(a,b,c){fd(a,b,c,null)||Wc(ka(b,a))},hd=function(a){return new A(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{De:!0,value:f}:{De:!1,reason:f};0==c&&b(d)},f=0,g;f<a.length;f++)g=a[f],gd(g,ka(e,f,!0),\nka(e,f,!1));else b(d)})};A.prototype.then=function(a,b,c){null!=a&&Ma(a,\"opt_onFulfilled should be a function.\");null!=b&&Ma(b,\"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?\");return id(this,p(a)?a:null,p(b)?b:null,c)};Kc(A);var kd=function(a,b){b=ed(b,b,void 0);b.ub=!0;jd(a,b);return a};A.prototype.f=function(a,b){return id(this,null,a,b)};A.prototype.cancel=function(a){0==this.M&&Wc(function(){var b=new bd(a);ld(this,b)},this)};\nvar ld=function(a,b){if(0==a.M)if(a.s){var c=a.s;if(c.la){for(var d=0,e=null,f=null,g=c.la;g&&(g.ub||(d++,g.child==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.M&&1==d?ld(c,b):(f?(d=f,v(c.la),v(null!=d),d.next==c.Xa&&(c.Xa=d),d.next=d.next.next):md(c),nd(c,e,3,b)))}a.s=null}else ad(a,3,b)},jd=function(a,b){a.la||2!=a.M&&3!=a.M||od(a);v(null!=b.La);a.Xa?a.Xa.next=b:a.la=b;a.Xa=b},id=function(a,b,c,d){var e=ed(null,null,null);e.child=new A(function(a,g){e.La=b?function(c){try{var e=b.call(d,c);a(e)}catch(B){g(B)}}:\na;e.fb=c?function(b){try{var e=c.call(d,b);void 0===e&&b instanceof bd?g(b):a(e)}catch(B){g(B)}}:g});e.child.s=a;jd(a,e);return e.child};A.prototype.yf=function(a){v(1==this.M);this.M=0;ad(this,2,a)};A.prototype.zf=function(a){v(1==this.M);this.M=0;ad(this,3,a)};\nvar ad=function(a,b,c){0==a.M&&(a===c&&(b=3,c=new TypeError(\"Promise cannot resolve to itself\")),a.M=1,fd(c,a.yf,a.zf,a)||(a.pa=c,a.M=b,a.s=null,od(a),3!=b||c instanceof bd||pd(a,c)))},fd=function(a,b,c,d){if(a instanceof A)return null!=b&&Ma(b,\"opt_onFulfilled should be a function.\"),null!=c&&Ma(c,\"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?\"),jd(a,ed(b||ba,c||null,d)),!0;if(Lc(a))return a.then(b,c,d),!0;if(ha(a))try{var e=a.then;if(p(e))return qd(a,\ne,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},qd=function(a,b,c,d,e){var f=!1,g=function(a){f||(f=!0,c.call(e,a))},k=function(a){f||(f=!0,d.call(e,a))};try{b.call(a,g,k)}catch(n){k(n)}},od=function(a){a.Nc||(a.Nc=!0,Wc(a.ze,a))},md=function(a){var b=null;a.la&&(b=a.la,a.la=b.next,b.next=null);a.la||(a.Xa=null);null!=b&&v(null!=b.La);return b};A.prototype.ze=function(){for(var a;a=md(this);)nd(this,a,this.M,this.pa);this.Nc=!1};\nvar nd=function(a,b,c,d){if(3==c&&b.fb&&!b.ub)for(;a&&a.ec;a=a.s)a.ec=!1;if(b.child)b.child.s=null,rd(b,c,d);else try{b.ub?b.La.call(b.context):rd(b,c,d)}catch(e){sd.call(null,e)}dd.put(b)},rd=function(a,b,c){2==b?a.La.call(a.context,c):a.fb&&a.fb.call(a.context,c)},pd=function(a,b){a.ec=!0;Wc(function(){a.ec&&sd.call(null,b)})},sd=Pc,bd=function(a){t.call(this,a)};r(bd,t);bd.prototype.name=\"cancel\";var ud=function(a,b){ma(b,function(b,d){\"style\"==d?a.style.cssText=b:\"class\"==d?a.className=b:\"for\"==d?a.htmlFor=b:td.hasOwnProperty(d)?a.setAttribute(td[d],b):0==d.lastIndexOf(\"aria-\",0)||0==d.lastIndexOf(\"data-\",0)?a.setAttribute(d,b):a[d]=b})},td={cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\",colspan:\"colSpan\",frameborder:\"frameBorder\",height:\"height\",maxlength:\"maxLength\",nonce:\"nonce\",role:\"role\",rowspan:\"rowSpan\",type:\"type\",usemap:\"useMap\",valign:\"vAlign\",width:\"width\"};\nvar vd=function(a,b){this.vc=[];this.Td=a;this.Ad=b||null;this.xb=this.ab=!1;this.pa=void 0;this.nd=this.td=this.Ic=!1;this.Cc=0;this.s=null;this.Jc=0};vd.prototype.cancel=function(a){if(this.ab)this.pa instanceof vd&&this.pa.cancel();else{if(this.s){var b=this.s;delete this.s;a?b.cancel(a):(b.Jc--,0>=b.Jc&&b.cancel())}this.Td?this.Td.call(this.Ad,this):this.nd=!0;this.ab||wd(this,new xd)}};vd.prototype.yd=function(a,b){this.Ic=!1;yd(this,a,b)};\nvar yd=function(a,b,c){a.ab=!0;a.pa=c;a.xb=!b;zd(a)},Bd=function(a){if(a.ab){if(!a.nd)throw new Ad;a.nd=!1}};vd.prototype.callback=function(a){Bd(this);Cd(a);yd(this,!0,a)};\nvar wd=function(a,b){Bd(a);Cd(b);yd(a,!1,b)},Cd=function(a){v(!(a instanceof vd),\"An execution sequence may not be initiated with a blocking Deferred.\")},Gd=function(a){var b=Dd(\"https://apis.google.com/js/client.js?onload=\"+Ed);Fd(b,null,a,void 0)},Fd=function(a,b,c,d){v(!a.td,\"Blocking Deferreds can not be re-used\");a.vc.push([b,c,d]);a.ab&&zd(a)};vd.prototype.then=function(a,b,c){var d,e,f=new A(function(a,b){d=a;e=b});Fd(this,d,function(a){a instanceof xd?f.cancel():e(a)});return f.then(a,b,c)};\nKc(vd);\nvar Hd=function(a){return Ta(a.vc,function(a){return p(a[1])})},zd=function(a){if(a.Cc&&a.ab&&Hd(a)){var b=a.Cc,c=Id[b];c&&(l.clearTimeout(c.yb),delete Id[b]);a.Cc=0}a.s&&(a.s.Jc--,delete a.s);for(var b=a.pa,d=c=!1;a.vc.length&&!a.Ic;){var e=a.vc.shift(),f=e[0],g=e[1],e=e[2];if(f=a.xb?g:f)try{var k=f.call(e||a.Ad,b);void 0!==k&&(a.xb=a.xb&&(k==b||k instanceof Error),a.pa=b=k);if(Lc(b)||\"function\"===typeof l.Promise&&b instanceof l.Promise)d=!0,a.Ic=!0}catch(n){b=n,a.xb=!0,Hd(a)||(c=!0)}}a.pa=b;d&&\n(k=q(a.yd,a,!0),d=q(a.yd,a,!1),b instanceof vd?(Fd(b,k,d),b.td=!0):b.then(k,d));c&&(b=new Jd(b),Id[b.yb]=b,a.Cc=b.yb)},Ad=function(){t.call(this)};r(Ad,t);Ad.prototype.message=\"Deferred has already fired\";Ad.prototype.name=\"AlreadyCalledError\";var xd=function(){t.call(this)};r(xd,t);xd.prototype.message=\"Deferred was canceled\";xd.prototype.name=\"CanceledError\";var Jd=function(a){this.yb=l.setTimeout(q(this.xf,this),0);this.O=a};\nJd.prototype.xf=function(){v(Id[this.yb],\"Cannot throw an error that is not scheduled.\");delete Id[this.yb];throw this.O;};var Id={};var Dd=function(a){var b=new oc;b.sc=a;return Kd(b)},Kd=function(a){var b={},c=b.document||document,d;a instanceof oc&&a.constructor===oc&&a.pe===nc?d=a.sc:(Ja(\"expected object of type TrustedResourceUrl, got '\"+a+\"' of type \"+ca(a)),d=\"type_error:TrustedResourceUrl\");var e=document.createElement(\"SCRIPT\");a={Zd:e,Sb:void 0};var f=new vd(Ld,a),g=null,k=null!=b.timeout?b.timeout:5E3;0<k&&(g=window.setTimeout(function(){Md(e,!0);wd(f,new Nd(1,\"Timeout reached for loading script \"+d))},k),a.Sb=g);e.onload=\ne.onreadystatechange=function(){e.readyState&&\"loaded\"!=e.readyState&&\"complete\"!=e.readyState||(Md(e,b.Jf||!1,g),f.callback(null))};e.onerror=function(){Md(e,!0,g);wd(f,new Nd(0,\"Error while loading script \"+d))};a=b.attributes||{};ta(a,{type:\"text/javascript\",charset:\"UTF-8\",src:d});ud(e,a);Od(c).appendChild(e);return f},Od=function(a){var b;return(b=(a||document).getElementsByTagName(\"HEAD\"))&&0!=b.length?b[0]:a.documentElement},Ld=function(){if(this&&this.Zd){var a=this.Zd;a&&\"SCRIPT\"==a.tagName&&\nMd(a,!0,this.Sb)}},Md=function(a,b,c){null!=c&&l.clearTimeout(c);a.onload=ba;a.onerror=ba;a.onreadystatechange=ba;b&&window.setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},0)},Nd=function(a,b){var c=\"Jsloader error (code #\"+a+\")\";b&&(c+=\": \"+b);t.call(this,c);this.code=a};r(Nd,t);var Pd=function(a,b,c,d,e){this.reset(a,b,c,d,e)};Pd.prototype.Dd=null;var Qd=0;Pd.prototype.reset=function(a,b,c,d,e){\"number\"==typeof e||Qd++;d||la();this.Cb=a;this.Xe=b;delete this.Dd};Pd.prototype.be=function(a){this.Cb=a};var Rd=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/,Sd=function(a,b){if(a){a=a.split(\"&\");for(var c=0;c<a.length;c++){var d=a[c].indexOf(\"=\"),e,f=null;0<=d?(e=a[c].substring(0,d),f=a[c].substring(d+1)):e=a[c];b(e,f?decodeURIComponent(f.replace(/\\+/g,\" \")):\"\")}}};var Td=function(a){if(a.X&&\"function\"==typeof a.X)return a.X();if(m(a))return a.split(\"\");if(fa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return na(a)},Ud=function(a){if(a.ma&&\"function\"==typeof a.ma)return a.ma();if(!a.X||\"function\"!=typeof a.X){if(fa(a)||m(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return oa(a)}},Vd=function(a,b){if(a.forEach&&\"function\"==typeof a.forEach)a.forEach(b,void 0);else if(fa(a)||m(a))x(a,b,void 0);else for(var c=Ud(a),d=Td(a),e=\nd.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)};var Wd=\"StopIteration\"in l?l.StopIteration:{message:\"StopIteration\",stack:\"\"},Xd=function(){};Xd.prototype.next=function(){throw Wd;};Xd.prototype.qe=function(){return this};var Yd=function(a,b){this.ea={};this.w=[];this.tb=this.o=0;var c=arguments.length;if(1<c){if(c%2)throw Error(\"Uneven number of arguments\");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)};Yd.prototype.X=function(){Zd(this);for(var a=[],b=0;b<this.w.length;b++)a.push(this.ea[this.w[b]]);return a};Yd.prototype.ma=function(){Zd(this);return this.w.concat()};Yd.prototype.vb=function(a){return $d(this.ea,a)};\nYd.prototype.remove=function(a){return $d(this.ea,a)?(delete this.ea[a],this.o--,this.tb++,this.w.length>2*this.o&&Zd(this),!0):!1};var Zd=function(a){if(a.o!=a.w.length){for(var b=0,c=0;b<a.w.length;){var d=a.w[b];$d(a.ea,d)&&(a.w[c++]=d);b++}a.w.length=c}if(a.o!=a.w.length){for(var e={},c=b=0;b<a.w.length;)d=a.w[b],$d(e,d)||(a.w[c++]=d,e[d]=1),b++;a.w.length=c}};h=Yd.prototype;h.get=function(a,b){return $d(this.ea,a)?this.ea[a]:b};\nh.set=function(a,b){$d(this.ea,a)||(this.o++,this.w.push(a),this.tb++);this.ea[a]=b};h.addAll=function(a){var b;a instanceof Yd?(b=a.ma(),a=a.X()):(b=oa(a),a=na(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};h.forEach=function(a,b){for(var c=this.ma(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};h.clone=function(){return new Yd(this)};\nh.qe=function(a){Zd(this);var b=0,c=this.tb,d=this,e=new Xd;e.next=function(){if(c!=d.tb)throw Error(\"The map has changed since the iterator was created\");if(b>=d.w.length)throw Wd;var e=d.w[b++];return a?e:d.ea[e]};return e};var $d=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var ae=function(a){this.Ye=a;this.Kd=this.Kc=this.Cb=this.s=null},be=function(a,b){this.name=a;this.value=b};be.prototype.toString=function(){return this.name};var ce=new be(\"SEVERE\",1E3),de=new be(\"CONFIG\",700),ee=new be(\"FINE\",500);ae.prototype.getParent=function(){return this.s};ae.prototype.be=function(a){this.Cb=a};var fe=function(a){if(a.Cb)return a.Cb;if(a.s)return fe(a.s);Ja(\"Root logger has no level set.\");return null};\nae.prototype.log=function(a,b,c){if(a.value>=fe(this).value)for(p(b)&&(b=b()),a=new Pd(a,String(b),this.Ye),c&&(a.Dd=c),c=\"log:\"+a.Xe,l.console&&(l.console.timeStamp?l.console.timeStamp(c):l.console.markTimeline&&l.console.markTimeline(c)),l.msWriteProfilerMark&&l.msWriteProfilerMark(c),c=this;c;){var d=c,e=a;if(d.Kd)for(var f=0;b=d.Kd[f];f++)b(e);c=c.getParent()}};\nvar ge={},he=null,ie=function(a){he||(he=new ae(\"\"),ge[\"\"]=he,he.be(de));var b;if(!(b=ge[a])){b=new ae(a);var c=a.lastIndexOf(\".\"),d=a.substr(c+1),c=ie(a.substr(0,c));c.Kc||(c.Kc={});c.Kc[d]=b;b.s=c;ge[a]=b}return b};var je=function(){Fb.call(this);this.da=new Mb(this);this.re=this;this.ad=null};r(je,Fb);je.prototype[Gb]=!0;h=je.prototype;h.addEventListener=function(a,b,c,d){Vb(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){dc(this,a,b,c,d)};\nh.dispatchEvent=function(a){ke(this);var b,c=this.ad;if(c){b=[];for(var d=1;c;c=c.ad)b.push(c),v(1E3>++d,\"infinite loop\")}c=this.re;d=a.type||a;if(m(a))a=new Ib(a,c);else if(a instanceof Ib)a.target=a.target||c;else{var e=a;a=new Ib(d,c);ta(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.jb&&0<=g;g--)f=a.currentTarget=b[g],e=le(f,d,!0,a)&&e;a.jb||(f=a.currentTarget=c,e=le(f,d,!0,a)&&e,a.jb||(e=le(f,d,!1,a)&&e));if(b)for(g=0;!a.jb&&g<b.length;g++)f=a.currentTarget=b[g],e=le(f,d,!1,a)&&e;return e};\nh.Za=function(){je.qd.Za.call(this);if(this.da){var a=this.da,b=0,c;for(c in a.F){for(var d=a.F[c],e=0;e<d.length;e++)++b,Kb(d[e]);delete a.F[c];a.Tb--}}this.ad=null};h.listen=function(a,b,c,d){ke(this);return this.da.add(String(a),b,!1,c,d)};\nvar cc=function(a,b,c,d,e){a.da.add(String(b),c,!0,d,e)},le=function(a,b,c,d){b=a.da.F[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.nb&&g.capture==c){var k=g.listener,n=g.fc||g.src;g.Xb&&Ob(a.da,g);e=!1!==k.call(n,d)&&e}}return e&&0!=d.Yd};je.prototype.Pc=function(a,b,c,d){return this.da.Pc(String(a),b,c,d)};var ke=function(a){v(a.da,\"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?\")};var E=function(a,b){a&&a.log(ee,b,void 0)};var me=function(a,b,c){if(p(a))c&&(a=q(a,c));else if(a&&\"function\"==typeof a.handleEvent)a=q(a.handleEvent,a);else throw Error(\"Invalid listener argument\");return 2147483647<Number(b)?-1:l.setTimeout(a,b||0)},ne=function(a){var b=null;return(new A(function(c,d){b=me(function(){c(void 0)},a);-1==b&&d(Error(\"Failed to schedule timer.\"))})).f(function(a){l.clearTimeout(b);throw a;})};var F=function(a){je.call(this);this.headers=new Yd;this.Gc=a||null;this.ta=!1;this.Fc=this.b=null;this.Bb=this.Qd=this.mc=\"\";this.Ha=this.Tc=this.kc=this.Mc=!1;this.qb=0;this.Ac=null;this.Xd=\"\";this.Dc=this.ff=this.le=!1};r(F,je);var oe=F.prototype,pe=ie(\"goog.net.XhrIo\");oe.T=pe;var qe=/^https?$/i,re=[\"POST\",\"PUT\"];\nF.prototype.send=function(a,b,c,d){if(this.b)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.mc+\"; newUri=\"+a);b=b?b.toUpperCase():\"GET\";this.mc=a;this.Bb=\"\";this.Qd=b;this.Mc=!1;this.ta=!0;this.b=this.Gc?this.Gc.Zb():Dc.Zb();this.Fc=this.Gc?Cc(this.Gc):Cc(Dc);this.b.onreadystatechange=q(this.Vd,this);this.ff&&\"onprogress\"in this.b&&(this.b.onprogress=q(function(a){this.Ud(a,!0)},this),this.b.upload&&(this.b.upload.onprogress=q(this.Ud,this)));try{E(this.T,se(this,\"Opening Xhr\")),\nthis.Tc=!0,this.b.open(b,String(a),!0),this.Tc=!1}catch(f){E(this.T,se(this,\"Error opening Xhr: \"+f.message));this.O(5,f);return}a=c||\"\";var e=this.headers.clone();d&&Vd(d,function(a,b){e.set(b,a)});d=Va(e.ma());c=l.FormData&&a instanceof l.FormData;!Wa(re,b)||d||c||e.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\");e.forEach(function(a,b){this.b.setRequestHeader(b,a)},this);this.Xd&&(this.b.responseType=this.Xd);\"withCredentials\"in this.b&&this.b.withCredentials!==this.le&&(this.b.withCredentials=\nthis.le);try{te(this),0<this.qb&&(this.Dc=ue(this.b),E(this.T,se(this,\"Will abort after \"+this.qb+\"ms if incomplete, xhr2 \"+this.Dc)),this.Dc?(this.b.timeout=this.qb,this.b.ontimeout=q(this.Sb,this)):this.Ac=me(this.Sb,this.qb,this)),E(this.T,se(this,\"Sending request\")),this.kc=!0,this.b.send(a),this.kc=!1}catch(f){E(this.T,se(this,\"Send error: \"+f.message)),this.O(5,f)}};var ue=function(a){return y&&z(9)&&ga(a.timeout)&&void 0!==a.ontimeout},Ua=function(a){return\"content-type\"==a.toLowerCase()};\nF.prototype.Sb=function(){\"undefined\"!=typeof aa&&this.b&&(this.Bb=\"Timed out after \"+this.qb+\"ms, aborting\",E(this.T,se(this,this.Bb)),this.dispatchEvent(\"timeout\"),this.abort(8))};F.prototype.O=function(a,b){this.ta=!1;this.b&&(this.Ha=!0,this.b.abort(),this.Ha=!1);this.Bb=b;ve(this);we(this)};var ve=function(a){a.Mc||(a.Mc=!0,a.dispatchEvent(\"complete\"),a.dispatchEvent(\"error\"))};\nF.prototype.abort=function(){this.b&&this.ta&&(E(this.T,se(this,\"Aborting\")),this.ta=!1,this.Ha=!0,this.b.abort(),this.Ha=!1,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),we(this))};F.prototype.Za=function(){this.b&&(this.ta&&(this.ta=!1,this.Ha=!0,this.b.abort(),this.Ha=!1),we(this,!0));F.qd.Za.call(this)};F.prototype.Vd=function(){this.isDisposed()||(this.Tc||this.kc||this.Ha?xe(this):this.bf())};F.prototype.bf=function(){xe(this)};\nvar xe=function(a){if(a.ta&&\"undefined\"!=typeof aa)if(a.Fc[1]&&4==ye(a)&&2==ze(a))E(a.T,se(a,\"Local request error detected and ignored\"));else if(a.kc&&4==ye(a))me(a.Vd,0,a);else if(a.dispatchEvent(\"readystatechange\"),4==ye(a)){E(a.T,se(a,\"Request complete\"));a.ta=!1;try{var b=ze(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=String(a.mc).match(Rd)[1]||null;if(!f&&l.self&&l.self.location)var g=l.self.location.protocol,\nf=g.substr(0,g.length-1);e=!qe.test(f?f.toLowerCase():\"\")}d=e}if(d)a.dispatchEvent(\"complete\"),a.dispatchEvent(\"success\");else{var k;try{k=2<ye(a)?a.b.statusText:\"\"}catch(n){E(a.T,\"Can not get status: \"+n.message),k=\"\"}a.Bb=k+\" [\"+ze(a)+\"]\";ve(a)}}finally{we(a)}}};F.prototype.Ud=function(a,b){v(\"progress\"===a.type,\"goog.net.EventType.PROGRESS is of the same type as raw XHR progress.\");this.dispatchEvent(Ae(a,\"progress\"));this.dispatchEvent(Ae(a,b?\"downloadprogress\":\"uploadprogress\"))};\nvar Ae=function(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}},we=function(a,b){if(a.b){te(a);var c=a.b,d=a.Fc[0]?ba:null;a.b=null;a.Fc=null;b||a.dispatchEvent(\"ready\");try{c.onreadystatechange=d}catch(e){(a=a.T)&&a.log(ce,\"Problem encountered resetting onreadystatechange: \"+e.message,void 0)}}},te=function(a){a.b&&a.Dc&&(a.b.ontimeout=null);ga(a.Ac)&&(l.clearTimeout(a.Ac),a.Ac=null)},ye=function(a){return a.b?a.b.readyState:0},ze=function(a){try{return 2<ye(a)?\na.b.status:-1}catch(b){return-1}},Be=function(a){try{return a.b?a.b.responseText:\"\"}catch(b){return E(a.T,\"Can not get responseText: \"+b.message),\"\"}},se=function(a,b){return b+\" [\"+a.Qd+\" \"+a.mc+\" \"+ze(a)+\"]\"};var Ce=function(a,b){this.ca=this.Sa=this.fa=\"\";this.hb=null;this.Ga=this.va=\"\";this.R=this.Te=!1;var c;a instanceof Ce?(this.R=void 0!==b?b:a.R,De(this,a.fa),c=a.Sa,G(this),this.Sa=c,Ee(this,a.ca),Fe(this,a.hb),Ge(this,a.va),He(this,a.V.clone()),a=a.Ga,G(this),this.Ga=a):a&&(c=String(a).match(Rd))?(this.R=!!b,De(this,c[1]||\"\",!0),a=c[2]||\"\",G(this),this.Sa=Ie(a),Ee(this,c[3]||\"\",!0),Fe(this,c[4]),Ge(this,c[5]||\"\",!0),He(this,c[6]||\"\",!0),a=c[7]||\"\",G(this),this.Ga=Ie(a)):(this.R=!!b,this.V=new H(null,\n0,this.R))};Ce.prototype.toString=function(){var a=[],b=this.fa;b&&a.push(Je(b,Ke,!0),\":\");var c=this.ca;if(c||\"file\"==b)a.push(\"//\"),(b=this.Sa)&&a.push(Je(b,Ke,!0),\"@\"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),c=this.hb,null!=c&&a.push(\":\",String(c));if(c=this.va)this.ca&&\"/\"!=c.charAt(0)&&a.push(\"/\"),a.push(Je(c,\"/\"==c.charAt(0)?Le:Me,!0));(c=this.V.toString())&&a.push(\"?\",c);(c=this.Ga)&&a.push(\"#\",Je(c,Ne));return a.join(\"\")};\nCe.prototype.resolve=function(a){var b=this.clone(),c=!!a.fa;c?De(b,a.fa):c=!!a.Sa;if(c){var d=a.Sa;G(b);b.Sa=d}else c=!!a.ca;c?Ee(b,a.ca):c=null!=a.hb;d=a.va;if(c)Fe(b,a.hb);else if(c=!!a.va){if(\"/\"!=d.charAt(0))if(this.ca&&!this.va)d=\"/\"+d;else{var e=b.va.lastIndexOf(\"/\");-1!=e&&(d=b.va.substr(0,e+1)+d)}e=d;if(\"..\"==e||\".\"==e)d=\"\";else if(u(e,\"./\")||u(e,\"/.\")){for(var d=0==e.lastIndexOf(\"/\",0),e=e.split(\"/\"),f=[],g=0;g<e.length;){var k=e[g++];\".\"==k?d&&g==e.length&&f.push(\"\"):\"..\"==k?((1<f.length||\n1==f.length&&\"\"!=f[0])&&f.pop(),d&&g==e.length&&f.push(\"\")):(f.push(k),d=!0)}d=f.join(\"/\")}else d=e}c?Ge(b,d):c=\"\"!==a.V.toString();c?He(b,a.V.clone()):c=!!a.Ga;c&&(a=a.Ga,G(b),b.Ga=a);return b};Ce.prototype.clone=function(){return new Ce(this)};\nvar De=function(a,b,c){G(a);a.fa=c?Ie(b,!0):b;a.fa&&(a.fa=a.fa.replace(/:$/,\"\"))},Ee=function(a,b,c){G(a);a.ca=c?Ie(b,!0):b},Fe=function(a,b){G(a);if(b){b=Number(b);if(isNaN(b)||0>b)throw Error(\"Bad port number \"+b);a.hb=b}else a.hb=null},Ge=function(a,b,c){G(a);a.va=c?Ie(b,!0):b},He=function(a,b,c){G(a);b instanceof H?(a.V=b,a.V.md(a.R)):(c||(b=Je(b,Oe)),a.V=new H(b,0,a.R))},I=function(a,b,c){G(a);a.V.set(b,c)},Pe=function(a,b){return a.V.get(b)},Qe=function(a,b){G(a);a.V.remove(b)},G=function(a){if(a.Te)throw Error(\"Tried to modify a read-only Uri\");\n};Ce.prototype.md=function(a){this.R=a;this.V&&this.V.md(a);return this};\nvar Re=function(a){return a instanceof Ce?a.clone():new Ce(a,void 0)},Se=function(a,b){var c=new Ce(null,void 0);De(c,\"https\");a&&Ee(c,a);b&&Ge(c,b);return c},Ie=function(a,b){return a?b?decodeURI(a.replace(/%25/g,\"%2525\")):decodeURIComponent(a):\"\"},Je=function(a,b,c){return m(a)?(a=encodeURI(a).replace(b,Te),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),a):null},Te=function(a){a=a.charCodeAt(0);return\"%\"+(a>>4&15).toString(16)+(a&15).toString(16)},Ke=/[#\\/\\?@]/g,Me=/[\\#\\?:]/g,Le=/[\\#\\?]/g,Oe=/[\\#\\?@]/g,\nNe=/#/g,H=function(a,b,c){this.o=this.l=null;this.N=a||null;this.R=!!c},Ue=function(a){a.l||(a.l=new Yd,a.o=0,a.N&&Sd(a.N,function(b,c){a.add(decodeURIComponent(b.replace(/\\+/g,\" \")),c)}))},We=function(a){var b=Ud(a);if(\"undefined\"==typeof b)throw Error(\"Keys are undefined\");var c=new H(null,0,void 0);a=Td(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];ea(f)?Ve(c,e,f):c.add(e,f)}return c};h=H.prototype;\nh.add=function(a,b){Ue(this);this.N=null;a=this.P(a);var c=this.l.get(a);c||this.l.set(a,c=[]);c.push(b);this.o=Ka(this.o)+1;return this};h.remove=function(a){Ue(this);a=this.P(a);return this.l.vb(a)?(this.N=null,this.o=Ka(this.o)-this.l.get(a).length,this.l.remove(a)):!1};h.vb=function(a){Ue(this);a=this.P(a);return this.l.vb(a)};h.ma=function(){Ue(this);for(var a=this.l.X(),b=this.l.ma(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};\nh.X=function(a){Ue(this);var b=[];if(m(a))this.vb(a)&&(b=$a(b,this.l.get(this.P(a))));else{a=this.l.X();for(var c=0;c<a.length;c++)b=$a(b,a[c])}return b};h.set=function(a,b){Ue(this);this.N=null;a=this.P(a);this.vb(a)&&(this.o=Ka(this.o)-this.l.get(a).length);this.l.set(a,[b]);this.o=Ka(this.o)+1;return this};h.get=function(a,b){a=a?this.X(a):[];return 0<a.length?String(a[0]):b};var Ve=function(a,b,c){a.remove(b);0<c.length&&(a.N=null,a.l.set(a.P(b),ab(c)),a.o=Ka(a.o)+c.length)};\nH.prototype.toString=function(){if(this.N)return this.N;if(!this.l)return\"\";for(var a=[],b=this.l.ma(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.X(d),f=0;f<d.length;f++){var g=e;\"\"!==d[f]&&(g+=\"=\"+encodeURIComponent(String(d[f])));a.push(g)}return this.N=a.join(\"&\")};H.prototype.clone=function(){var a=new H;a.N=this.N;this.l&&(a.l=this.l.clone(),a.o=this.o);return a};H.prototype.P=function(a){a=String(a);this.R&&(a=a.toLowerCase());return a};\nH.prototype.md=function(a){a&&!this.R&&(Ue(this),this.N=null,this.l.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),Ve(this,b,a))},this));this.R=a};var Xe=function(){var a=J();return y&&!!ob&&11==ob||/Edge\\/\\d+/.test(a)},Ye=function(){return l.window&&l.window.location.href||\"\"},Ze=function(a,b){b=b||l.window;var c=\"about:blank\";a&&(c=rc(uc(a)));b.location.href=c},$e=function(a,b){var c=[],d;for(d in a)d in b?typeof a[d]!=typeof b[d]?c.push(d):ea(a[d])?qa(a[d],b[d])||c.push(d):\"object\"==typeof a[d]&&null!=a[d]&&null!=b[d]?0<$e(a[d],b[d]).length&&c.push(d):a[d]!==b[d]&&c.push(d):c.push(d);for(d in b)d in a||c.push(d);return c},bf=function(){var a;\na=J();a=\"Chrome\"!=af(a)?null:(a=a.match(/\\sChrome\\/(\\d+)/i))&&2==a.length?parseInt(a[1],10):null;return a&&30>a?!1:!y||!ob||9<ob},cf=function(a){a=(a||J()).toLowerCase();return a.match(/android/)||a.match(/webos/)||a.match(/iphone|ipad|ipod/)||a.match(/blackberry/)||a.match(/windows phone/)||a.match(/iemobile/)?!0:!1},df=function(a){a=a||l.window;try{a.close()}catch(b){}},ef=function(a,b,c){var d=Math.floor(1E9*Math.random()).toString();b=b||500;c=c||600;var e=(window.screen.availHeight-c)/2,f=(window.screen.availWidth-\nb)/2;b={width:b,height:c,top:0<e?e:0,left:0<f?f:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1};c=J().toLowerCase();d&&(b.target=d,u(c,\"crios/\")&&(b.target=\"_blank\"));\"Firefox\"==af(J())&&(a=a||\"http://localhost\",b.scrollbars=!0);var g;c=a||\"about:blank\";(d=b)||(d={});a=window;b=c instanceof qc?c:uc(\"undefined\"!=typeof c.href?c.href:String(c));c=d.target||c.target;e=[];for(g in d)switch(g){case \"width\":case \"height\":case \"top\":case \"left\":e.push(g+\"=\"+d[g]);break;case \"target\":case \"noreferrer\":break;\ndefault:e.push(g+\"=\"+(d[g]?1:0))}g=e.join(\",\");(w(\"iPhone\")&&!w(\"iPod\")&&!w(\"iPad\")||w(\"iPad\")||w(\"iPod\"))&&a.navigator&&a.navigator.standalone&&c&&\"_self\"!=c?(g=a.document.createElement(\"A\"),\"undefined\"!=typeof HTMLAnchorElement&&\"undefined\"!=typeof Location&&\"undefined\"!=typeof Element&&(e=g&&(g instanceof HTMLAnchorElement||!(g instanceof Location||g instanceof Element)),f=ha(g)?g.constructor.displayName||g.constructor.name||Object.prototype.toString.call(g):void 0===g?\"undefined\":null===g?\"null\":\ntypeof g,v(e,\"Argument is not a HTMLAnchorElement (or a non-Element mock); got: %s\",f)),b=b instanceof qc?b:uc(b),g.href=rc(b),g.setAttribute(\"target\",c),d.noreferrer&&g.setAttribute(\"rel\",\"noreferrer\"),d=document.createEvent(\"MouseEvent\"),d.initMouseEvent(\"click\",!0,!0,a,1),g.dispatchEvent(d),g={}):d.noreferrer?(g=a.open(\"\",c,g),d=rc(b),g&&(fb&&u(d,\";\")&&(d=\"'\"+d.replace(/'/g,\"%27\")+\"'\"),g.opener=null,a=mc(\"b/12014412, meta tag with sanitized URL\"),Fa.test(d)&&(-1!=d.indexOf(\"&\")&&(d=d.replace(za,\n\"&amp;\")),-1!=d.indexOf(\"<\")&&(d=d.replace(Aa,\"&lt;\")),-1!=d.indexOf(\">\")&&(d=d.replace(Ba,\"&gt;\")),-1!=d.indexOf('\"')&&(d=d.replace(Ca,\"&quot;\")),-1!=d.indexOf(\"'\")&&(d=d.replace(Da,\"&#39;\")),-1!=d.indexOf(\"\\x00\")&&(d=d.replace(Ea,\"&#0;\"))),d='<META HTTP-EQUIV=\"refresh\" content=\"0; url='+d+'\">',La(lc(a),\"must provide justification\"),v(!/^[\\s\\xa0]*$/.test(lc(a)),\"must provide non-empty justification\"),g.document.write($c((new Zc).Qe(d))),g.document.close())):g=a.open(rc(b),c,g);if(g)try{g.focus()}catch(k){}return g},\nff=function(a){return new A(function(b){var c=function(){ne(2E3).then(function(){if(!a||a.closed)b();else return c()})};return c()})},gf=/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/,hf=function(){var a=null;return(new A(function(b){\"complete\"==l.document.readyState?b():(a=function(){b()},bc(window,\"load\",a))})).f(function(b){dc(window,\"load\",a);throw b;})},kf=function(){return jf(void 0)?hf().then(function(){return new A(function(a,b){var c=l.document,d=setTimeout(function(){b(Error(\"Cordova framework is not ready.\"))},\n1E3);c.addEventListener(\"deviceready\",function(){clearTimeout(d);a()},!1)})}):D(Error(\"Cordova must run in an Android or iOS file scheme.\"))},jf=function(a){a=a||J();return!(\"file:\"!==lf()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))},mf=function(){var a=l.window;try{return!(!a||a==a.top)}catch(b){return!1}},K=function(){return firebase.INTERNAL.hasOwnProperty(\"reactNative\")?\"ReactNative\":firebase.INTERNAL.hasOwnProperty(\"node\")?\"Node\":\"Browser\"},nf=function(){var a=K();return\"ReactNative\"===\na||\"Node\"===a},af=function(a){var b=a.toLowerCase();if(u(b,\"opera/\")||u(b,\"opr/\")||u(b,\"opios/\"))return\"Opera\";if(u(b,\"iemobile\"))return\"IEMobile\";if(u(b,\"msie\")||u(b,\"trident/\"))return\"IE\";if(u(b,\"edge/\"))return\"Edge\";if(u(b,\"firefox/\"))return\"Firefox\";if(u(b,\"silk/\"))return\"Silk\";if(u(b,\"blackberry\"))return\"Blackberry\";if(u(b,\"webos\"))return\"Webos\";if(!u(b,\"safari/\")||u(b,\"chrome/\")||u(b,\"crios/\")||u(b,\"android\"))if(!u(b,\"chrome/\")&&!u(b,\"crios/\")||u(b,\"edge/\")){if(u(b,\"android\"))return\"Android\";\nif((a=a.match(/([a-zA-Z\\d\\.]+)\\/[a-zA-Z\\d\\.]*$/))&&2==a.length)return a[1]}else return\"Chrome\";else return\"Safari\";return\"Other\"},of=function(a){var b=K();return(\"Browser\"===b?af(J()):b)+\"/JsCore/\"+a},J=function(){return l.navigator&&l.navigator.userAgent||\"\"},L=function(a,b){a=a.split(\".\");b=b||l;for(var c=0;c<a.length&&\"object\"==typeof b&&null!=b;c++)b=b[a[c]];c!=a.length&&(b=void 0);return b},rf=function(){var a;if(a=(pf()||\"chrome-extension:\"===lf()||jf()&&!1)&&!nf())a:{try{var b=l.localStorage,\nc=qf();if(b){b.setItem(c,\"1\");b.removeItem(c);a=Xe()?!!l.indexedDB:!0;break a}}catch(d){}a=!1}return a},pf=function(){return\"http:\"===lf()||\"https:\"===lf()},lf=function(){return l.location&&l.location.protocol||null},sf=function(a){a=a||J();return cf(a)||\"Firefox\"==af(a)?!1:!0},tf=function(a){return\"undefined\"===typeof a?null:xc(a)},uf=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]&&(b[c]=a[c]);return b},vf=function(a){if(null!==a)return JSON.parse(a)},qf=function(a){return a?\na:\"\"+Math.floor(1E9*Math.random()).toString()},wf=function(a){a=a||J();return\"Safari\"==af(a)||a.toLowerCase().match(/iphone|ipad|ipod/)?!1:!0},xf=function(){var a=l.___jsl;if(a&&a.H)for(var b in a.H)if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=a.H[b].L.concat(),a.CP)for(var c=0;c<a.CP.length;c++)a.CP[c]=null},yf=function(){return l.navigator&&\"boolean\"===typeof l.navigator.onLine?l.navigator.onLine:!0},zf=function(a,b,c,d){if(a>b)throw Error(\"Short delay should be less than long delay!\");\nthis.uf=a;this.We=b;a=c||J();d=d||K();this.Se=cf(a)||\"ReactNative\"===d};zf.prototype.get=function(){return this.Se?this.We:this.uf};\nvar Af=function(){var a=l.document;return a&&\"undefined\"!==typeof a.visibilityState?\"visible\"==a.visibilityState:!0},Bf=function(){var a=l.document,b=null;return Af()||!a?C():(new A(function(c){b=function(){Af()&&(a.removeEventListener(\"visibilitychange\",b,!1),c())};a.addEventListener(\"visibilitychange\",b,!1)})).f(function(c){a.removeEventListener(\"visibilitychange\",b,!1);throw c;})};var Cf={};var Df;try{var Ef={};Object.defineProperty(Ef,\"abcd\",{configurable:!0,enumerable:!0,value:1});Object.defineProperty(Ef,\"abcd\",{configurable:!0,enumerable:!0,value:2});Df=2==Ef.abcd}catch(a){Df=!1}\nvar M=function(a,b,c){Df?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c}):a[b]=c},Ff=function(a){Df?Object.defineProperty(a,\"provider\",{configurable:!0,enumerable:!0,get:function(){Cf[\"firebase.auth.AuthCredential.provider is deprecated. Please use the providerId field instead.\"]||(Cf[\"firebase.auth.AuthCredential.provider is deprecated. Please use the providerId field instead.\"]=!0,\"undefined\"!==typeof console&&\"function\"===typeof console.warn&&console.warn(\"firebase.auth.AuthCredential.provider is deprecated. Please use the providerId field instead.\"));\nreturn\"password\"}}):a.provider=\"password\"},Gf=function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&M(a,c,b[c])},Hf=function(a){var b={};Gf(b,a);return b},If=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},Jf=function(a,b){if(!b||!b.length)return!0;if(!a)return!1;for(var c=0;c<b.length;c++){var d=a[b[c]];if(void 0===d||null===d||\"\"===d)return!1}return!0},Kf=function(a){var b=a;if(\"object\"==typeof a&&null!=a){var b=\"length\"in a?[]:{},c;for(c in a)M(b,c,Kf(a[c]))}return b};var Lf=\"oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version\".split(\" \"),Mf=[\"client_id\",\"response_type\",\"scope\",\"redirect_uri\",\"state\"],Nf={Ef:{Gb:500,Fb:600,providerId:\"facebook.com\",jd:Mf},Ff:{Gb:500,Fb:620,providerId:\"github.com\",jd:Mf},Gf:{Gb:515,Fb:680,providerId:\"google.com\",jd:Mf},Hf:{Gb:485,Fb:705,providerId:\"twitter.com\",jd:Lf}},Of=function(a){for(var b in Nf)if(Nf[b].providerId==a)return Nf[b];return null};var N=function(a,b){this.code=\"auth/\"+a;this.message=b||Pf[a]||\"\"};r(N,Error);N.prototype.D=function(){return{code:this.code,message:this.message}};N.prototype.toJSON=function(){return this.D()};\nvar Qf=function(a){var b=a&&a.code;return b?new N(b.substring(5),a.message):null},Pf={\"argument-error\":\"\",\"app-not-authorized\":\"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.\",\"app-not-installed\":\"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.\",\"captcha-check-failed\":\"\",\n\"code-expired\":\"\",\"cordova-not-ready\":\"Cordova framework is not ready.\",\"cors-unsupported\":\"This browser is not supported.\",\"credential-already-in-use\":\"This credential is already associated with a different user account.\",\"custom-token-mismatch\":\"The custom token corresponds to a different audience.\",\"requires-recent-login\":\"This operation is sensitive and requires recent authentication. Log in again before retrying this request.\",\"dynamic-link-not-activated\":\"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.\",\n\"email-already-in-use\":\"The email address is already in use by another account.\",\"expired-action-code\":\"The action code has expired. \",\"cancelled-popup-request\":\"This operation has been cancelled due to another conflicting popup being opened.\",\"internal-error\":\"An internal error has occurred.\",\"invalid-app-credential\":\"\",\"invalid-app-id\":\"The mobile app identifier is not registed for the current project.\",\"invalid-user-token\":\"The user's credential is no longer valid. The user must sign in again.\",\n\"invalid-auth-event\":\"An internal error has occurred.\",\"invalid-verification-code\":\"\",\"invalid-cordova-configuration\":\"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.\",\"invalid-custom-token\":\"The custom token format is incorrect. Please check the documentation.\",\"invalid-email\":\"The email address is badly formatted.\",\"invalid-api-key\":\"Your API key is invalid, please check you have copied it correctly.\",\n\"invalid-credential\":\"The supplied auth credential is malformed or has expired.\",\"invalid-message-payload\":\"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-oauth-provider\":\"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.\",\"unauthorized-domain\":\"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.\",\n\"invalid-action-code\":\"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.\",\"wrong-password\":\"The password is invalid or the user does not have a password.\",\"invalid-identifier-number\":\"\",\"invalid-recipient-email\":\"The email corresponding to this action failed to send as the provided recipient email address is invalid.\",\"invalid-sender\":\"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.\",\n\"invalid-verification-id\":\"\",\"missing-iframe-start\":\"An internal error has occurred.\",\"auth-domain-config-required\":\"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.\",\"missing-app-credential\":\"\",\"missing-verification-code\":\"\",\"missing-identifier-number\":\"\",\"missing-verification-id\":\"\",\"app-deleted\":\"This instance of FirebaseApp has been deleted.\",\"account-exists-with-different-credential\":\"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.\",\n\"network-request-failed\":\"A network error (such as timeout, interrupted connection or unreachable host) has occurred.\",\"no-auth-event\":\"An internal error has occurred.\",\"no-such-provider\":\"User was not linked to an account with the given provider.\",\"operation-not-allowed\":\"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.\",\"operation-not-supported-in-this-environment\":'This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.',\n\"popup-blocked\":\"Unable to establish a connection with the popup. It may have been blocked by the browser.\",\"popup-closed-by-user\":\"The popup has been closed by the user before finalizing the operation.\",\"provider-already-linked\":\"User can only be linked to one identity for the given provider.\",\"quota-exceeded\":\"\",\"redirect-cancelled-by-user\":\"The redirect operation has been cancelled by the user before finalizing.\",\"redirect-operation-pending\":\"A redirect sign-in operation is already pending.\",timeout:\"The operation has timed out.\",\n\"user-token-expired\":\"The user's credential is no longer valid. The user must sign in again.\",\"too-many-requests\":\"We have blocked all requests from this device due to unusual activity. Try again later.\",\"user-cancelled\":\"User did not grant your application the permissions it requested.\",\"user-not-found\":\"There is no user record corresponding to this identifier. The user may have been deleted.\",\"user-disabled\":\"The user account has been disabled by an administrator.\",\"user-mismatch\":\"The supplied credentials do not correspond to the previously signed in user.\",\n\"user-signed-out\":\"\",\"weak-password\":\"The password must be 6 characters long or more.\",\"web-storage-unsupported\":\"This browser is not supported or 3rd party cookies and data may be disabled.\"};var O=function(a,b,c,d,e){this.ba=a;this.I=b||null;this.rb=c||null;this.ld=d||null;this.O=e||null;if(this.rb||this.O){if(this.rb&&this.O)throw new N(\"invalid-auth-event\");if(this.rb&&!this.ld)throw new N(\"invalid-auth-event\");}else throw new N(\"invalid-auth-event\");};O.prototype.cc=function(){return this.ld};O.prototype.getError=function(){return this.O};O.prototype.D=function(){return{type:this.ba,eventId:this.I,urlResponse:this.rb,sessionId:this.ld,error:this.O&&this.O.D()}};\nvar Rf=function(a){a=a||{};return a.type?new O(a.type,a.eventId,a.urlResponse,a.sessionId,a.error&&Qf(a.error)):null};var Sf=function(a){var b=\"unauthorized-domain\",c=void 0,d=Re(a);a=d.ca;d=d.fa;\"chrome-extension\"==d?c=xa(\"This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):\"http\"==d||\"https\"==d?c=xa(\"This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):b=\n\"operation-not-supported-in-this-environment\";N.call(this,b,c)};r(Sf,N);var Tf=function(a){this.Ve=a.sub;la();this.$b=a.email||null};var Uf=function(a,b){return a.then(function(a){if(a.idToken){var c;a:{var e=a.idToken.split(\".\");if(3==e.length){for(var e=e[1],f=(4-e.length%4)%4,g=0;g<f;g++)e+=\".\";try{var k=JSON.parse(tb(e));if(k.sub&&k.iss&&k.aud&&k.exp){c=new Tf(k);break a}}catch(n){}}c=null}if(!c||b!=c.Ve)throw new N(\"user-mismatch\");return a}throw new N(\"user-mismatch\");}).f(function(a){throw a&&a.code&&\"auth/user-not-found\"==a.code?new N(\"user-mismatch\"):a;})},Vf=function(a,b){if(b.idToken||b.accessToken)b.idToken&&M(this,\n\"idToken\",b.idToken),b.accessToken&&M(this,\"accessToken\",b.accessToken);else if(b.oauthToken&&b.oauthTokenSecret)M(this,\"accessToken\",b.oauthToken),M(this,\"secret\",b.oauthTokenSecret);else throw new N(\"internal-error\",\"failed to construct a credential\");M(this,\"provider\",a);M(this,\"providerId\",a)};Vf.prototype.bc=function(a){return Wf(a,Xf(this))};Vf.prototype.Rd=function(a,b){var c=Xf(this);c.idToken=b;return Yf(a,c)};Vf.prototype.Sd=function(a,b){var c=Xf(this);return Uf(Zf(a,c),b)};\nvar Xf=function(a){var b={};a.idToken&&(b.id_token=a.idToken);a.accessToken&&(b.access_token=a.accessToken);a.secret&&(b.oauth_token_secret=a.secret);b.providerId=a.providerId;return{postBody:We(b).toString(),requestUri:\"http://localhost\"}};Vf.prototype.D=function(){var a={providerId:this.providerId};this.idToken&&(a.oauthIdToken=this.idToken);this.accessToken&&(a.oauthAccessToken=this.accessToken);this.secret&&(a.oauthTokenSecret=this.secret);return a};\nvar $f=function(a,b){this.jf=b||[];Gf(this,{providerId:a,isOAuthProvider:!0});this.zd={}};$f.prototype.setCustomParameters=function(a){this.zd=ra(a);return this};var P=function(a){$f.call(this,a,Mf);this.kd=[]};r(P,$f);P.prototype.addScope=function(a){Wa(this.kd,a)||this.kd.push(a);return this};P.prototype.Id=function(){return ab(this.kd)};\nP.prototype.credential=function(a,b){if(!a&&!b)throw new N(\"argument-error\",\"credential failed: must provide the ID token and/or the access token.\");return new Vf(this.providerId,{idToken:a||null,accessToken:b||null})};var ag=function(){P.call(this,\"facebook.com\")};r(ag,P);M(ag,\"PROVIDER_ID\",\"facebook.com\");\nvar bg=function(a){if(!a)throw new N(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;ha(a)&&(b=a.accessToken);return(new ag).credential(null,b)},cg=function(){P.call(this,\"github.com\")};r(cg,P);M(cg,\"PROVIDER_ID\",\"github.com\");\nvar dg=function(a){if(!a)throw new N(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;ha(a)&&(b=a.accessToken);return(new cg).credential(null,b)},eg=function(){P.call(this,\"google.com\");this.addScope(\"profile\")};r(eg,P);M(eg,\"PROVIDER_ID\",\"google.com\");var fg=function(a,b){var c=a;ha(a)&&(c=a.idToken,b=a.accessToken);return(new eg).credential(c,b)},gg=function(){$f.call(this,\"twitter.com\",Lf)};r(gg,$f);M(gg,\"PROVIDER_ID\",\"twitter.com\");\nvar hg=function(a,b){var c=a;ha(c)||(c={oauthToken:a,oauthTokenSecret:b});if(!c.oauthToken||!c.oauthTokenSecret)throw new N(\"argument-error\",\"credential failed: expected 2 arguments (the OAuth access token and secret).\");return new Vf(\"twitter.com\",c)},ig=function(a,b){this.$b=a;this.bd=b;Ff(this);M(this,\"providerId\",\"password\")};ig.prototype.bc=function(a){return Q(a,jg,{email:this.$b,password:this.bd})};ig.prototype.Rd=function(a,b){return Q(a,kg,{idToken:b,email:this.$b,password:this.bd})};\nig.prototype.Sd=function(a,b){return Uf(this.bc(a),b)};ig.prototype.D=function(){return{email:this.$b,password:this.bd}};var lg=function(){Gf(this,{providerId:\"password\",isOAuthProvider:!1})};Gf(lg,{PROVIDER_ID:\"password\"});\nGf(function(a){try{a||firebase.auth()}catch(b){throw new N(\"argument-error\",\"Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.identifierAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().\");}Gf(this,{providerId:\"identifier\",isOAuthProvider:!1})},{PROVIDER_ID:\"identifier\"});\nvar mg=function(a){var b=a&&a.providerId;if(!b||\"password\"===b||\"identifier\"===b)return null;var c=a&&a.oauthAccessToken,d=a&&a.oauthTokenSecret;a=a&&a.oauthIdToken;try{switch(b){case \"google.com\":return fg(a,c);case \"facebook.com\":return bg(c);case \"github.com\":return dg(c);case \"twitter.com\":return hg(c,d);default:return(new P(b)).credential(a,c)}}catch(e){return null}},ng=function(a){if(!a.isOAuthProvider)throw new N(\"invalid-oauth-provider\");};var og=function(a,b,c,d){N.call(this,a,d);M(this,\"email\",b);M(this,\"credential\",c)};r(og,N);og.prototype.D=function(){var a={code:this.code,message:this.message,email:this.email},b=this.credential&&this.credential.D();b&&ta(a,b);return a};og.prototype.toJSON=function(){return this.D()};var pg=function(a){if(a.code){var b=a.code||\"\";0==b.indexOf(\"auth/\")&&(b=b.substring(5));return a.email?new og(b,a.email,mg(a),a.message):new N(b,a.message||void 0)}return null};var qg=function(a){this.Df=a};r(qg,Bc);qg.prototype.Zb=function(){return new this.Df};qg.prototype.Vc=function(){return{}};\nvar R=function(a,b,c){var d;d=\"Node\"==K();d=l.XMLHttpRequest||d&&firebase.INTERNAL.node&&firebase.INTERNAL.node.XMLHttpRequest;if(!d)throw new N(\"internal-error\",\"The XMLHttpRequest compatibility library was not found.\");this.j=a;a=b||{};this.qf=a.secureTokenEndpoint||\"https://securetoken.googleapis.com/v1/token\";this.rf=a.secureTokenTimeout||rg;this.$d=ra(a.secureTokenHeaders||sg);this.Be=a.firebaseEndpoint||\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\";this.Ce=a.firebaseTimeout||\ntg;this.Gd=ra(a.firebaseHeaders||ug);c&&(this.Gd[\"X-Client-Version\"]=c,this.$d[\"X-Client-Version\"]=c);this.ve=new Gc;this.Cf=new qg(d)},vg,rg=new zf(3E4,6E4),sg={\"Content-Type\":\"application/x-www-form-urlencoded\"},tg=new zf(3E4,6E4),ug={\"Content-Type\":\"application/json\"},xg=function(a,b,c,d,e,f,g){yf()?(bf()?a=q(a.tf,a):(vg||(vg=new A(function(a,b){wg(a,b)})),a=q(a.sf,a)),a(b,c,d,e,f,g)):c&&c(null)};\nR.prototype.tf=function(a,b,c,d,e,f){var g=\"Node\"==K(),k=nf()?g?new F(this.Cf):new F:new F(this.ve),n;f&&(k.qb=Math.max(0,f),n=setTimeout(function(){k.dispatchEvent(\"timeout\")},f));k.listen(\"complete\",function(){n&&clearTimeout(n);var a=null;try{a=JSON.parse(Be(this))||null}catch(bb){a=null}b&&b(a)});cc(k,\"ready\",function(){n&&clearTimeout(n);this.Da||(this.Da=!0,this.Za())});cc(k,\"timeout\",function(){n&&clearTimeout(n);this.Da||(this.Da=!0,this.Za());b&&b(null)});k.send(a,c,d,e)};\nvar Ed=\"__fcb\"+Math.floor(1E6*Math.random()).toString(),wg=function(a,b){((window.gapi||{}).client||{}).request?a():(l[Ed]=function(){((window.gapi||{}).client||{}).request?a():b(Error(\"CORS_UNSUPPORTED\"))},Gd(function(){b(Error(\"CORS_UNSUPPORTED\"))}))};\nR.prototype.sf=function(a,b,c,d,e){var f=this;vg.then(function(){window.gapi.client.setApiKey(f.j);var g=window.gapi.auth.getToken();window.gapi.auth.setToken(null);window.gapi.client.request({path:a,method:c,body:d,headers:e,authType:\"none\",callback:function(a){window.gapi.auth.setToken(g);b&&b(a)}})}).f(function(a){b&&b({error:{message:a&&a.message||\"CORS_UNSUPPORTED\"}})})};\nvar zg=function(a,b){return new A(function(c,d){\"refresh_token\"==b.grant_type&&b.refresh_token||\"authorization_code\"==b.grant_type&&b.code?xg(a,a.qf+\"?key=\"+encodeURIComponent(a.j),function(a){a?a.error?d(yg(a)):a.access_token&&a.refresh_token?c(a):d(new N(\"internal-error\")):d(new N(\"network-request-failed\"))},\"POST\",We(b).toString(),a.$d,a.rf.get()):d(new N(\"internal-error\"))})},Ag=function(a,b,c,d,e){var f=Re(a.Be+b);I(f,\"key\",a.j);e&&I(f,\"cb\",la().toString());var g=\"GET\"==c;if(g)for(var k in d)d.hasOwnProperty(k)&&\nI(f,k,d[k]);return new A(function(b,e){xg(a,f.toString(),function(a){a?a.error?e(yg(a)):b(a):e(new N(\"network-request-failed\"))},c,g?void 0:xc(uf(d)),a.Gd,a.Ce.get())})},Bg=function(a){if(!ic.test(a.email))throw new N(\"invalid-email\");},Cg=function(a){\"email\"in a&&Bg(a)},Eg=function(a,b){return Q(a,Dg,{identifier:b,continueUri:pf()?Ye():\"http://localhost\"}).then(function(a){return a.allProviders||[]})},Gg=function(a){return Q(a,Fg,{}).then(function(a){return a.authorizedDomains||[]})},Hg=function(a){if(!a.idToken)throw new N(\"internal-error\");\n};R.prototype.signInAnonymously=function(){return Q(this,Ig,{})};R.prototype.updateEmail=function(a,b){return Q(this,Jg,{idToken:a,email:b})};R.prototype.updatePassword=function(a,b){return Q(this,kg,{idToken:a,password:b})};var Kg={displayName:\"DISPLAY_NAME\",photoUrl:\"PHOTO_URL\"};R.prototype.updateProfile=function(a,b){var c={idToken:a},d=[];ma(Kg,function(a,f){var e=b[f];null===e?d.push(a):f in b&&(c[f]=e)});d.length&&(c.deleteAttribute=d);return Q(this,Jg,c)};\nR.prototype.sendPasswordResetEmail=function(a){return Q(this,Lg,{requestType:\"PASSWORD_RESET\",email:a})};R.prototype.sendEmailVerification=function(a){return Q(this,Mg,{requestType:\"VERIFY_EMAIL\",idToken:a})};\nvar Og=function(a,b,c){return Q(a,Ng,{idToken:b,deleteProvider:c})},Pg=function(a){if(!a.requestUri||!a.sessionId&&!a.postBody)throw new N(\"internal-error\");},Qg=function(a){var b=null;a.needConfirmation?(a.code=\"account-exists-with-different-credential\",b=pg(a)):\"FEDERATED_USER_ID_ALREADY_LINKED\"==a.errorMessage?(a.code=\"credential-already-in-use\",b=pg(a)):\"EMAIL_EXISTS\"==a.errorMessage&&(a.code=\"email-already-in-use\",b=pg(a));if(b)throw b;if(!a.idToken)throw new N(\"internal-error\");},Wf=function(a,\nb){b.returnIdpCredential=!0;return Q(a,Rg,b)},Yf=function(a,b){b.returnIdpCredential=!0;return Q(a,Sg,b)},Zf=function(a,b){b.returnIdpCredential=!0;b.autoCreate=!1;return Q(a,Tg,b)},Ug=function(a){if(!a.oobCode)throw new N(\"invalid-action-code\");};R.prototype.confirmPasswordReset=function(a,b){return Q(this,Vg,{oobCode:a,newPassword:b})};R.prototype.checkActionCode=function(a){return Q(this,Wg,{oobCode:a})};R.prototype.applyActionCode=function(a){return Q(this,Xg,{oobCode:a})};\nvar Xg={endpoint:\"setAccountInfo\",G:Ug,pb:\"email\"},Wg={endpoint:\"resetPassword\",G:Ug,oa:function(a){if(!a.email||!a.requestType)throw new N(\"internal-error\");}},Yg={endpoint:\"signupNewUser\",G:function(a){Bg(a);if(!a.password)throw new N(\"weak-password\");},oa:Hg,qa:!0},Dg={endpoint:\"createAuthUri\"},Zg={endpoint:\"deleteAccount\",ob:[\"idToken\"]},Ng={endpoint:\"setAccountInfo\",ob:[\"idToken\",\"deleteProvider\"],G:function(a){if(!ea(a.deleteProvider))throw new N(\"internal-error\");}},$g={endpoint:\"getAccountInfo\"},\nMg={endpoint:\"getOobConfirmationCode\",ob:[\"idToken\",\"requestType\"],G:function(a){if(\"VERIFY_EMAIL\"!=a.requestType)throw new N(\"internal-error\");},pb:\"email\"},Lg={endpoint:\"getOobConfirmationCode\",ob:[\"requestType\"],G:function(a){if(\"PASSWORD_RESET\"!=a.requestType)throw new N(\"internal-error\");Bg(a)},pb:\"email\"},Fg={ue:!0,endpoint:\"getProjectConfig\",Me:\"GET\"},Vg={endpoint:\"resetPassword\",G:Ug,pb:\"email\"},Jg={endpoint:\"setAccountInfo\",ob:[\"idToken\"],G:Cg,qa:!0},kg={endpoint:\"setAccountInfo\",ob:[\"idToken\"],\nG:function(a){Cg(a);if(!a.password)throw new N(\"weak-password\");},oa:Hg,qa:!0},Ig={endpoint:\"signupNewUser\",oa:Hg,qa:!0},Rg={endpoint:\"verifyAssertion\",G:Pg,oa:Qg,qa:!0},Tg={endpoint:\"verifyAssertion\",G:Pg,oa:function(a){if(a.errorMessage&&\"USER_NOT_FOUND\"==a.errorMessage)throw new N(\"user-not-found\");if(!a.idToken)throw new N(\"internal-error\");},qa:!0},Sg={endpoint:\"verifyAssertion\",G:function(a){Pg(a);if(!a.idToken)throw new N(\"internal-error\");},oa:Qg,qa:!0},ah={endpoint:\"verifyCustomToken\",G:function(a){if(!a.token)throw new N(\"invalid-custom-token\");\n},oa:Hg,qa:!0},jg={endpoint:\"verifyPassword\",G:function(a){Bg(a);if(!a.password)throw new N(\"wrong-password\");},oa:Hg,qa:!0},Q=function(a,b,c){if(!Jf(c,b.ob))return D(new N(\"internal-error\"));var d=b.Me||\"POST\",e;return C(c).then(b.G).then(function(){b.qa&&(c.returnSecureToken=!0);return Ag(a,b.endpoint,d,c,b.ue||!1)}).then(function(a){return e=a}).then(b.oa).then(function(){if(!b.pb)return e;if(!(b.pb in e))throw new N(\"internal-error\");return e[b.pb]})},yg=function(a){var b,c;c=(a.error&&a.error.errors&&\na.error.errors[0]||{}).reason||\"\";var d={keyInvalid:\"invalid-api-key\",ipRefererBlocked:\"app-not-authorized\"};if(c=d[c]?new N(d[c]):null)return c;c=a.error&&a.error.message||\"\";d={INVALID_CUSTOM_TOKEN:\"invalid-custom-token\",CREDENTIAL_MISMATCH:\"custom-token-mismatch\",MISSING_CUSTOM_TOKEN:\"internal-error\",INVALID_IDENTIFIER:\"invalid-email\",MISSING_CONTINUE_URI:\"internal-error\",INVALID_EMAIL:\"invalid-email\",INVALID_PASSWORD:\"wrong-password\",USER_DISABLED:\"user-disabled\",MISSING_PASSWORD:\"internal-error\",\nEMAIL_EXISTS:\"email-already-in-use\",PASSWORD_LOGIN_DISABLED:\"operation-not-allowed\",INVALID_IDP_RESPONSE:\"invalid-credential\",FEDERATED_USER_ID_ALREADY_LINKED:\"credential-already-in-use\",INVALID_MESSAGE_PAYLOAD:\"invalid-message-payload\",INVALID_RECIPIENT_EMAIL:\"invalid-recipient-email\",INVALID_SENDER:\"invalid-sender\",EMAIL_NOT_FOUND:\"user-not-found\",EXPIRED_OOB_CODE:\"expired-action-code\",INVALID_OOB_CODE:\"invalid-action-code\",MISSING_OOB_CODE:\"internal-error\",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:\"requires-recent-login\",\nINVALID_ID_TOKEN:\"invalid-user-token\",TOKEN_EXPIRED:\"user-token-expired\",USER_NOT_FOUND:\"user-token-expired\",CORS_UNSUPPORTED:\"cors-unsupported\",DYNAMIC_LINK_NOT_ACTIVATED:\"dynamic-link-not-activated\",INVALID_APP_ID:\"invalid-app-id\",TOO_MANY_ATTEMPTS_TRY_LATER:\"too-many-requests\",WEAK_PASSWORD:\"weak-password\",OPERATION_NOT_ALLOWED:\"operation-not-allowed\",USER_CANCELLED:\"user-cancelled\",CAPTCHA_CHECK_FAILED:\"captcha-check-failed\",INVALID_APP_CREDENTIAL:\"invalid-app-credential\",INVALID_CODE:\"invalid-verification-code\",\nINVALID_identifier_NUMBER:\"invalid-identifier-number\",INVALID_SESSION_INFO:\"invalid-verification-id\",INVALID_TEMPORARY_PROOF:\"invalid-credential\",MISSING_APP_CREDENTIAL:\"missing-app-credential\",MISSING_CODE:\"missing-verification-code\",MISSING_identifier_NUMBER:\"missing-identifier-number\",MISSING_SESSION_INFO:\"missing-verification-id\",QUOTA_EXCEEDED:\"quota-exceeded\",SESSION_EXPIRED:\"code-expired\"};b=(b=c.match(/^[^\\s]+\\s*:\\s*(.*)$/))&&1<b.length?b[1]:void 0;for(var e in d)if(0===c.indexOf(e))return new N(d[e],b);!b&&\na&&(b=tf(a));return new N(\"internal-error\",b)};var bh=function(a){this.U=a};bh.prototype.value=function(){return this.U};bh.prototype.ce=function(a){this.U.style=a;return this};var ch=function(a){this.U=a||{}};ch.prototype.value=function(){return this.U};ch.prototype.ce=function(a){this.U.style=a;return this};var eh=function(a){this.Af=a;this.ic=null;this.$c=dh(this)},fh=function(a){var b=new ch;b.U.where=document.body;b.U.url=a.Af;b.U.messageHandlersFilter=L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\");b.U.attributes=b.U.attributes||{};(new bh(b.U.attributes)).ce({position:\"absolute\",top:\"-100px\",width:\"1px\",height:\"1px\"});b.U.dontclear=!0;return b},dh=function(a){return gh().then(function(){return new A(function(b,c){L(\"gapi.iframes.getContext\")().open(fh(a).value(),function(d){a.ic=d;a.ic.restyle({setHideOnLeave:!1});\nvar e=setTimeout(function(){c(Error(\"Network Error\"))},hh.get()),f=function(){clearTimeout(e);b()};d.ping(f).then(f,function(){c(Error(\"Network Error\"))})})})})};eh.prototype.sendMessage=function(a){var b=this;return this.$c.then(function(){return new A(function(c){b.ic.send(a.type,a,c,L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})})};\nvar ih=function(a,b){a.$c.then(function(){a.ic.register(\"authEvent\",b,L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})},jh=new zf(3E4,6E4),hh=new zf(5E3,15E3),gh=function(){return new A(function(a,b){if(yf()){var c=function(){xf();L(\"gapi.load\")(\"gapi.iframes\",{callback:a,ontimeout:function(){xf();b(Error(\"Network Error\"))},timeout:jh.get()})};if(L(\"gapi.iframes.Iframe\"))a();else if(L(\"gapi.load\"))c();else{var d=\"__iframefcb\"+Math.floor(1E6*Math.random()).toString();l[d]=function(){L(\"gapi.load\")?\nc():b(Error(\"Network Error\"))};C(Dd(\"https://apis.google.com/js/api.js?onload=\"+d)).f(function(){b(Error(\"Network Error\"))})}}else b(Error(\"Network Error\"))})};var kh=function(a,b,c){this.v=a;this.j=b;this.B=c;this.Ta=null;this.Ub=Se(this.v,\"/__/auth/iframe\");I(this.Ub,\"apiKey\",this.j);I(this.Ub,\"appName\",this.B)};kh.prototype.setVersion=function(a){this.Ta=a;return this};kh.prototype.toString=function(){this.Ta?I(this.Ub,\"v\",this.Ta):Qe(this.Ub,\"v\");return this.Ub.toString()};var lh=function(a,b,c,d,e){this.v=a;this.j=b;this.B=c;this.te=d;this.Ta=this.I=this.hd=null;this.Jb=e};lh.prototype.setVersion=function(a){this.Ta=a;return this};\nlh.prototype.toString=function(){var a=Se(this.v,\"/__/auth/handler\");I(a,\"apiKey\",this.j);I(a,\"appName\",this.B);I(a,\"authType\",this.te);if(this.Jb.isOAuthProvider){I(a,\"providerId\",this.Jb.providerId);var b=this.Jb,c=uf(b.zd),d;for(d in c)c[d]=c[d].toString();b=b.jf;c=ra(c);for(d=0;d<b.length;d++){var e=b[d];e in c&&delete c[e]}pa(c)||I(a,\"customParameters\",tf(c))}\"function\"===typeof this.Jb.Id&&(b=this.Jb.Id(),b.length&&I(a,\"scopes\",b.join(\",\")));this.hd?I(a,\"redirectUrl\",this.hd):Qe(a,\"redirectUrl\");\nthis.I?I(a,\"eventId\",this.I):Qe(a,\"eventId\");this.Ta?I(a,\"v\",this.Ta):Qe(a,\"v\");if(this.Vb)for(var f in this.Vb)this.Vb.hasOwnProperty(f)&&!Pe(a,f)&&I(a,f,this.Vb[f]);return a.toString()};\nvar mh=function(a,b,c,d){this.v=a;this.j=b;this.B=c;this.Ee=(this.Ca=d||null)?of(this.Ca):null;d=this.Ca;this.Ne=(new kh(a,b,c)).setVersion(d).toString();this.ka=[];this.g=new R(b,null,this.Ee);this.lc=this.ua=null},nh=function(a){var b=Ye();return Gg(a).then(function(a){a:{for(var c=Re(b),e=c.fa,c=c.ca,f=0;f<a.length;f++){var g;var k=a[f];g=c;var n=e;0==k.indexOf(\"chrome-extension://\")?g=Re(k).ca==g&&\"chrome-extension\"==n:\"http\"!=n&&\"https\"!=n?g=!1:gf.test(k)?g=g==k:(k=k.split(\".\").join(\"\\\\.\"),g=\n(new RegExp(\"^(.+\\\\.\"+k+\"|\"+k+\")$\",\"i\")).test(g));if(g){a=!0;break a}}a=!1}if(!a)throw new Sf(Ye());})};h=mh.prototype;h.Ab=function(){if(this.lc)return this.lc;var a=this;return this.lc=hf().then(function(){a.hc=new eh(a.Ne);oh(a)})};h.Pb=function(a,b,c){var d=new N(\"popup-closed-by-user\"),e=new N(\"web-storage-unsupported\"),f=this,g=!1;return this.Ia().then(function(){ph(f).then(function(c){c||(a&&df(a),b(e),g=!0)})}).f(function(){}).then(function(){if(!g)return ff(a)}).then(function(){if(!g)return ne(c).then(function(){b(d)})})};\nh.de=function(){var a=J();return!sf(a)&&!wf(a)};h.Ld=function(){return!1};h.Hb=function(a,b,c,d,e,f,g){if(!a)return D(new N(\"popup-blocked\"));if(g&&!sf())return this.Ia().f(function(b){df(a);e(b)}),d(),C();this.ua||(this.ua=nh(this.g));var k=this;return this.ua.then(function(){var b=k.Ia().f(function(b){df(a);e(b);throw b;});d();return b}).then(function(){ng(c);if(!g){var d=qh(k.v,k.j,k.B,b,c,null,f,k.Ca);Ze(d,a)}}).f(function(a){\"auth/network-request-failed\"==a.code&&(k.ua=null);throw a;})};\nh.Ib=function(a,b,c){this.ua||(this.ua=nh(this.g));var d=this;return this.ua.then(function(){ng(b);var e=qh(d.v,d.j,d.B,a,b,Ye(),c,d.Ca);Ze(e)})};h.Ia=function(){var a=this;return this.Ab().then(function(){return a.hc.$c}).f(function(){a.ua=null;throw new N(\"network-request-failed\");})};h.ge=function(){return!0};\nvar qh=function(a,b,c,d,e,f,g,k,n){a=new lh(a,b,c,d,e);a.hd=f;a.I=g;f=a.setVersion(k);f.Vb=ra(n||null);return f.toString()},oh=function(a){if(!a.hc)throw Error(\"IfcHandler must be initialized!\");ih(a.hc,function(b){var c={};if(b&&b.authEvent){var d=!1;b=Rf(b.authEvent);for(c=0;c<a.ka.length;c++)d=a.ka[c](b)||d;c={};c.status=d?\"ACK\":\"ERROR\";return C(c)}c.status=\"ERROR\";return C(c)})},ph=function(a){var b={type:\"webStorageSupport\"};return a.Ab().then(function(){return a.hc.sendMessage(b)}).then(function(a){if(a&&\na.length&&\"undefined\"!==typeof a[0].webStorageSupport)return a[0].webStorageSupport;throw Error();})};mh.prototype.Va=function(a){this.ka.push(a)};mh.prototype.Nb=function(a){Za(this.ka,function(b){return b==a})};var rh=function(a){this.A=a||firebase.INTERNAL.reactNative&&firebase.INTERNAL.reactNative.AsyncStorage;if(!this.A)throw new N(\"internal-error\",\"The React Native compatibility library was not found.\");};h=rh.prototype;h.get=function(a){return C(this.A.getItem(a)).then(function(a){return a&&vf(a)})};h.set=function(a,b){return C(this.A.setItem(a,tf(b)))};h.remove=function(a){return C(this.A.removeItem(a))};h.Wa=function(){};h.Qa=function(){};var th=function(){this.A={}};h=th.prototype;h.get=function(a){return C(this.A[a])};h.set=function(a,b){this.A[a]=b;return C()};h.remove=function(a){delete this.A[a];return C()};h.Wa=function(){};h.Qa=function(){};var vh=function(){if(!uh()){if(\"Node\"==K())throw new N(\"internal-error\",\"The LocalStorage compatibility library was not found.\");throw new N(\"web-storage-unsupported\");}this.A=l.localStorage||firebase.INTERNAL.node.localStorage},uh=function(){var a=\"Node\"==K(),a=l.localStorage||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.localStorage;if(!a)return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}};h=vh.prototype;\nh.get=function(a){var b=this;return C().then(function(){var c=b.A.getItem(a);return vf(c)})};h.set=function(a,b){var c=this;return C().then(function(){var d=tf(b);null===d?c.remove(a):c.A.setItem(a,d)})};h.remove=function(a){var b=this;return C().then(function(){b.A.removeItem(a)})};h.Wa=function(a){l.window&&Vb(l.window,\"storage\",a)};h.Qa=function(a){l.window&&dc(l.window,\"storage\",a)};var wh=function(){this.A={}};h=wh.prototype;h.get=function(){return C(null)};h.set=function(){return C()};h.remove=function(){return C()};h.Wa=function(){};h.Qa=function(){};var yh=function(){if(!xh()){if(\"Node\"==K())throw new N(\"internal-error\",\"The SessionStorage compatibility library was not found.\");throw new N(\"web-storage-unsupported\");}this.A=l.sessionStorage||firebase.INTERNAL.node.sessionStorage},xh=function(){var a=\"Node\"==K(),a=l.sessionStorage||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.sessionStorage;if(!a)return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}};h=yh.prototype;\nh.get=function(a){var b=this;return C().then(function(){var c=b.A.getItem(a);return vf(c)})};h.set=function(a,b){var c=this;return C().then(function(){var d=tf(b);null===d?c.remove(a):c.A.setItem(a,d)})};h.remove=function(a){var b=this;return C().then(function(){b.A.removeItem(a)})};h.Wa=function(){};h.Qa=function(){};var zh=function(a,b,c,d,e,f){if(!window.indexedDB)throw new N(\"web-storage-unsupported\");this.xe=a;this.Zc=b;this.Lc=c;this.ke=d;this.tb=e;this.Y={};this.Qb=[];this.Db=0;this.Oe=f||l.indexedDB},Ah,Bh=function(a){return new A(function(b,c){var d=a.Oe.open(a.xe,a.tb);d.onerror=function(a){c(Error(a.target.errorCode))};d.onupgradeneeded=function(b){b=b.target.result;try{b.createObjectStore(a.Zc,{keyPath:a.Lc})}catch(f){c(f)}};d.onsuccess=function(a){b(a.target.result)}})},Ch=function(a){a.Od||(a.Od=\nBh(a));return a.Od},Dh=function(a,b){return b.objectStore(a.Zc)},Eh=function(a,b,c){return b.transaction([a.Zc],c?\"readwrite\":\"readonly\")},Fh=function(a){return new A(function(b,c){a.onsuccess=function(a){a&&a.target?b(a.target.result):b()};a.onerror=function(a){c(Error(a.target.errorCode))}})};h=zh.prototype;\nh.set=function(a,b){var c=!1,d,e=this;return kd(Ch(this).then(function(b){d=b;b=Dh(e,Eh(e,d,!0));return Fh(b.get(a))}).then(function(f){var g=Dh(e,Eh(e,d,!0));if(f)return f.value=b,Fh(g.put(f));e.Db++;c=!0;f={};f[e.Lc]=a;f[e.ke]=b;return Fh(g.add(f))}).then(function(){e.Y[a]=b}),function(){c&&e.Db--})};h.get=function(a){var b=this;return Ch(this).then(function(c){return Fh(Dh(b,Eh(b,c,!1)).get(a))}).then(function(a){return a&&a.value})};\nh.remove=function(a){var b=!1,c=this;return kd(Ch(this).then(function(d){b=!0;c.Db++;return Fh(Dh(c,Eh(c,d,!0))[\"delete\"](a))}).then(function(){delete c.Y[a]}),function(){b&&c.Db--})};\nh.wf=function(){var a=this;return Ch(this).then(function(b){var c=Dh(a,Eh(a,b,!1));return c.getAll?Fh(c.getAll()):new A(function(a,b){var d=[],e=c.openCursor();e.onsuccess=function(b){(b=b.target.result)?(d.push(b.value),b[\"continue\"]()):a(d)};e.onerror=function(a){b(Error(a.target.errorCode))}})}).then(function(b){var c={},d=[];if(0==a.Db){for(d=0;d<b.length;d++)c[b[d][a.Lc]]=b[d][a.ke];d=$e(a.Y,c);a.Y=c}return d})};h.Wa=function(a){0==this.Qb.length&&this.od();this.Qb.push(a)};\nh.Qa=function(a){Za(this.Qb,function(b){return b==a});0==this.Qb.length&&this.xc()};h.od=function(){var a=this;this.xc();var b=function(){a.cd=ne(800).then(q(a.wf,a)).then(function(b){0<b.length&&x(a.Qb,function(a){a(b)})}).then(b).f(function(a){\"STOP_EVENT\"!=a.message&&b()});return a.cd};b()};h.xc=function(){this.cd&&this.cd.cancel(\"STOP_EVENT\")};var Jh=function(){this.Cd={Browser:Gh,Node:Hh,ReactNative:Ih}[K()]},Kh,Gh={K:vh,rd:yh},Hh={K:vh,rd:yh},Ih={K:rh,rd:wh};var Lh=function(a){var b={},c=a.email,d=a.newEmail;a=a.requestType;if(!c||!a)throw Error(\"Invalid provider user info!\");b.fromEmail=d||null;b.email=c;M(this,\"operation\",a);M(this,\"data\",Kf(b))};var Mh=function(a,b,c,d,e,f){this.cf=a;this.lf=b;this.Ge=c;this.nc=d;this.sd=e;this.mf=!!f;this.gb=null;this.Ja=this.nc;if(this.sd<this.nc)throw Error(\"Proactive refresh lower bound greater than upper bound!\");};Mh.prototype.start=function(){this.Ja=this.nc;Nh(this,!0)};\nvar Oh=function(a,b){if(b)return a.Ja=a.nc,a.Ge();b=a.Ja;a.Ja*=2;a.Ja>a.sd&&(a.Ja=a.sd);return b},Nh=function(a,b){a.stop();a.gb=ne(Oh(a,b)).then(function(){return a.mf?C():Bf()}).then(function(){return a.cf()}).then(function(){Nh(a,!0)}).f(function(b){a.lf(b)&&Nh(a,!1)})};Mh.prototype.stop=function(){this.gb&&(this.gb.cancel(),this.gb=null)};var Uh=function(a){var b={};b[\"facebook.com\"]=Ph;b[\"google.com\"]=Qh;b[\"github.com\"]=Rh;b[\"twitter.com\"]=Sh;var c=a&&a.providerId;return c?b[c]?new b[c](a):new Th(a):null},Th=function(a){var b=vf(a.rawUserInfo||\"{}\");a=a.providerId;if(!a)throw Error(\"Invalid additional user info!\");M(this,\"profile\",Kf(b||{}));M(this,\"providerId\",a)},Ph=function(a){Th.call(this,a);if(\"facebook.com\"!=this.providerId)throw Error(\"Invalid provider id!\");};r(Ph,Th);\nvar Rh=function(a){Th.call(this,a);if(\"github.com\"!=this.providerId)throw Error(\"Invalid provider id!\");M(this,\"username\",this.profile&&this.profile.login||null)};r(Rh,Th);var Qh=function(a){Th.call(this,a);if(\"google.com\"!=this.providerId)throw Error(\"Invalid provider id!\");};r(Qh,Th);var Sh=function(a){Th.call(this,a);if(\"twitter.com\"!=this.providerId)throw Error(\"Invalid provider id!\");M(this,\"username\",a.screenName||null)};r(Sh,Th);var Vh=function(a,b,c,d){this.Ze=a;this.ae=b;this.nf=c;this.Ob=d;this.S={};Kh||(Kh=new Jh);a=Kh;try{var e;Xe()?(Ah||(Ah=new zh(\"firebaseLocalStorageDb\",\"firebaseLocalStorage\",\"fbase_key\",\"value\",1)),e=Ah):e=new a.Cd.K;this.Na=e}catch(f){this.Na=new th,this.Ob=!0}try{this.zc=new a.Cd.rd}catch(f){this.zc=new th}this.pd=q(this.ee,this);this.Y={}},Wh,Xh=function(){Wh||(Wh=new Vh(\"firebase\",\":\",!wf(J())&&mf()?!0:!1,sf()));return Wh};h=Vh.prototype;\nh.P=function(a,b){return this.Ze+this.ae+a.name+(b?this.ae+b:\"\")};h.get=function(a,b){return(a.K?this.Na:this.zc).get(this.P(a,b))};h.remove=function(a,b){b=this.P(a,b);a.K&&!this.Ob&&(this.Y[b]=null);return(a.K?this.Na:this.zc).remove(b)};h.set=function(a,b,c){var d=this.P(a,c),e=this,f=a.K?this.Na:this.zc;return f.set(d,b).then(function(){return f.get(d)}).then(function(b){a.K&&!this.Ob&&(e.Y[d]=b)})};\nh.addListener=function(a,b,c){a=this.P(a,b);this.Ob||(this.Y[a]=l.localStorage.getItem(a));pa(this.S)&&this.od();this.S[a]||(this.S[a]=[]);this.S[a].push(c)};h.removeListener=function(a,b,c){a=this.P(a,b);this.S[a]&&(Za(this.S[a],function(a){return a==c}),0==this.S[a].length&&delete this.S[a]);pa(this.S)&&this.xc()};h.od=function(){this.Na.Wa(this.pd);this.Ob||Xe()||Yh(this)};\nvar Yh=function(a){Zh(a);a.Yc=setInterval(function(){for(var b in a.S){var c=l.localStorage.getItem(b),d=a.Y[b];c!=d&&(a.Y[b]=c,c=new Rb({type:\"storage\",key:b,target:window,oldValue:d,newValue:c,ef:!0}),a.ee(c))}},1E3)},Zh=function(a){a.Yc&&(clearInterval(a.Yc),a.Yc=null)};Vh.prototype.xc=function(){this.Na.Qa(this.pd);Zh(this)};\nVh.prototype.ee=function(a){if(a&&a.Fe){var b=a.$a.key;\"undefined\"!==typeof a.$a.ef?this.Na.Qa(this.pd):Zh(this);if(this.nf){var c=l.localStorage.getItem(b);a=a.$a.newValue;a!=c&&(a?l.localStorage.setItem(b,a):a||l.localStorage.removeItem(b))}this.Y[b]=l.localStorage.getItem(b);this.vd(b)}else x(a,q(this.vd,this))};Vh.prototype.vd=function(a){this.S[a]&&x(this.S[a],function(a){a()})};var $h=function(a,b){this.u=a;this.i=b||Xh()},ai={name:\"authEvent\",K:!0},bi=function(a){return a.i.get(ai,a.u).then(function(a){return Rf(a)})};$h.prototype.Va=function(a){this.i.addListener(ai,this.u,a)};$h.prototype.Nb=function(a){this.i.removeListener(ai,this.u,a)};var ci=function(a){this.i=a||Xh()},di={name:\"sessionId\",K:!1};ci.prototype.cc=function(a){return this.i.get(di,a)};var ei=function(a,b,c,d,e,f){this.v=a;this.j=b;this.B=c;this.Ca=d||null;this.fe=b+\":\"+c;this.pf=new ci;this.Hd=new $h(this.fe);this.Uc=null;this.ka=[];this.Re=e||500;this.gf=f||2E3;this.zb=this.qc=null},fi=function(a){return new N(\"invalid-cordova-configuration\",a)};\nei.prototype.Ia=function(){return this.Wc?this.Wc:this.Wc=kf().then(function(){if(\"function\"!==typeof L(\"universalLinks.subscribe\",l))throw fi(\"cordova-universal-links-plugin is not installed\");if(\"undefined\"===typeof L(\"BuildInfo.packageName\",l))throw fi(\"cordova-plugin-buildinfo is not installed\");if(\"function\"!==typeof L(\"cordova.plugins.browsertab.openUrl\",l))throw fi(\"cordova-plugin-browsertab is not installed\");if(\"function\"!==typeof L(\"cordova.InAppBrowser.open\",l))throw fi(\"cordova-plugin-inappbrowser is not installed\");\n},function(){throw new N(\"cordova-not-ready\");})};var gi=function(){for(var a=20,b=[];0<a;)b.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),a--;return b.join(\"\")},hi=function(a){var b=new Eb;b.update(a);return cb(b.digest())};h=ei.prototype;h.Pb=function(a,b){b(new N(\"operation-not-supported-in-this-environment\"));return C()};h.Hb=function(){return D(new N(\"operation-not-supported-in-this-environment\"))};h.ge=function(){return!1};h.de=function(){return!0};\nh.Ld=function(){return!0};\nh.Ib=function(a,b,c){if(this.qc)return D(new N(\"redirect-operation-pending\"));var d=this,e=l.document,f=null,g=null,k=null,n=null;return this.qc=kd(C().then(function(){ng(b);return ii(d)}).then(function(){return ji(d,a,b,c)}).then(function(){return(new A(function(a,b){g=function(){var b=L(\"cordova.plugins.browsertab.close\",l);a();\"function\"===typeof b&&b();d.zb&&\"function\"===typeof d.zb.close&&(d.zb.close(),d.zb=null);return!1};d.Va(g);k=function(){f||(f=ne(d.gf).then(function(){b(new N(\"redirect-cancelled-by-user\"))}))};n=\nfunction(){Af()&&k()};e.addEventListener(\"resume\",k,!1);J().toLowerCase().match(/android/)||e.addEventListener(\"visibilitychange\",n,!1)})).f(function(a){return ki(d).then(function(){throw a;})})}),function(){k&&e.removeEventListener(\"resume\",k,!1);n&&e.removeEventListener(\"visibilitychange\",n,!1);f&&f.cancel();g&&d.Nb(g);d.qc=null})};\nvar ji=function(a,b,c,d){var e=gi(),f=new O(b,d,null,e,new N(\"no-auth-event\")),g=L(\"BuildInfo.packageName\",l);if(\"string\"!==typeof g)throw new N(\"invalid-cordova-configuration\");var k=L(\"BuildInfo.displayName\",l),n={};if(J().toLowerCase().match(/iphone|ipad|ipod/))n.ibi=g;else if(J().toLowerCase().match(/android/))n.apn=g;else return D(new N(\"operation-not-supported-in-this-environment\"));k&&(n.appDisplayName=k);e=hi(e);n.sessionId=e;var B=qh(a.v,a.j,a.B,b,c,null,d,a.Ca,n);return a.Ia().then(function(){var b=\na.fe;return a.pf.i.set(ai,f.D(),b)}).then(function(){var b=L(\"cordova.plugins.browsertab.isAvailable\",l);if(\"function\"!==typeof b)throw new N(\"invalid-cordova-configuration\");var c=null;b(function(b){if(b){c=L(\"cordova.plugins.browsertab.openUrl\",l);if(\"function\"!==typeof c)throw new N(\"invalid-cordova-configuration\");c(B)}else{c=L(\"cordova.InAppBrowser.open\",l);if(\"function\"!==typeof c)throw new N(\"invalid-cordova-configuration\");b=c;var d;d=J();d=!(!d.match(/(iPad|iPhone|iPod).*OS 7_\\d/i)&&!d.match(/(iPad|iPhone|iPod).*OS 8_\\d/i));\na.zb=b(B,d?\"_blank\":\"_system\",\"location=yes\")}})})},li=function(a,b){for(var c=0;c<a.ka.length;c++)try{a.ka[c](b)}catch(d){}},ii=function(a){a.Uc||(a.Uc=a.Ia().then(function(){return new A(function(b){var c=function(d){b(d);a.Nb(c);return!1};a.Va(c);mi(a)})}));return a.Uc},ki=function(a){var b=null;return bi(a.Hd).then(function(c){b=c;c=a.Hd;return c.i.remove(ai,c.u)}).then(function(){return b})},mi=function(a){var b=L(\"universalLinks.subscribe\",l);if(\"function\"!==typeof b)throw new N(\"invalid-cordova-configuration\");\nvar c=new O(\"unknown\",null,null,null,new N(\"no-auth-event\")),d=!1,e=ne(a.Re).then(function(){return ki(a).then(function(){d||li(a,c)})}),f=function(b){d=!0;e&&e.cancel();ki(a).then(function(d){var e=c;if(d&&b&&b.url){var e=null,f;f=b.url;var g=Re(f),k=Pe(g,\"link\"),n=Pe(Re(k),\"link\"),g=Pe(g,\"deep_link_id\");f=Pe(Re(g),\"link\")||g||n||k||f;-1!=f.indexOf(\"/__/auth/callback\")&&(e=Re(f),e=vf(Pe(e,\"firebaseError\")||null),e=(e=\"object\"===typeof e?Qf(e):null)?new O(d.ba,d.I,null,null,e):new O(d.ba,d.I,f,d.cc()));\ne=e||c}li(a,e)})},g=l.handleOpenURL;l.handleOpenURL=function(a){0==a.indexOf(L(\"BuildInfo.packageName\",l)+\"://\")&&f({url:a});if(\"function\"===typeof g)try{g(a)}catch(n){console.error(n)}};b(null,f)};ei.prototype.Va=function(a){this.ka.push(a);ii(this).f(function(){})};ei.prototype.Nb=function(a){Za(this.ka,function(b){return b==a})};var ni=function(a){this.u=a;this.i=Xh()},oi={name:\"pendingRedirect\",K:!1},pi=function(a){return a.i.set(oi,\"pending\",a.u)},qi=function(a){return a.i.remove(oi,a.u)},ri=function(a){return a.i.get(oi,a.u).then(function(a){return\"pending\"==a})};var S=function(a,b,c){this.v=a;this.j=b;this.B=c;this.Rb=[];this.eb=!1;this.Hc=q(this.Rc,this);this.Oa=new si(this);this.dd=new ti(this);this.Eb=new ni(this.j+\":\"+this.B);this.ya={};this.ya.unknown=this.Oa;this.ya.signInViaRedirect=this.Oa;this.ya.linkViaRedirect=this.Oa;this.ya.reauthViaRedirect=this.Oa;this.ya.signInViaPopup=this.dd;this.ya.linkViaPopup=this.dd;this.ya.reauthViaPopup=this.dd;this.J=ui(this.v,this.j,this.B)},ui=function(a,b,c){var d=firebase.SDK_VERSION||null;return jf()?new ei(a,\nb,c,d):new mh(a,b,c,d)};S.prototype.reset=function(){this.eb=!1;this.J.Nb(this.Hc);this.J=ui(this.v,this.j,this.B)};S.prototype.Ab=function(){var a=this;this.eb||(this.eb=!0,this.J.Va(this.Hc));var b=this.J;return this.J.Ia().f(function(c){a.J==b&&a.reset();throw c;})};var xi=function(a){a.J.de()&&a.Ab().f(function(b){var c=new O(\"unknown\",null,null,null,new N(\"operation-not-supported-in-this-environment\"));vi(b)&&a.Rc(c)});a.J.Ld()||wi(a.Oa)};\nS.prototype.subscribe=function(a){Wa(this.Rb,a)||this.Rb.push(a);if(!this.eb){var b=this;ri(this.Eb).then(function(a){a?qi(b.Eb).then(function(){b.Ab().f(function(a){var c=new O(\"unknown\",null,null,null,new N(\"operation-not-supported-in-this-environment\"));vi(a)&&b.Rc(c)})}):xi(b)}).f(function(){xi(b)})}};S.prototype.unsubscribe=function(a){Za(this.Rb,function(b){return b==a})};\nS.prototype.Rc=function(a){if(!a)throw new N(\"invalid-auth-event\");for(var b=!1,c=0;c<this.Rb.length;c++){var d=this.Rb[c];if(d.wd(a.ba,a.I)){(b=this.ya[a.ba])&&b.Wd(a,d);b=!0;break}}wi(this.Oa);return b};var yi=new zf(2E3,1E4),zi=new zf(3E4,6E4);S.prototype.getRedirectResult=function(){return this.Oa.getRedirectResult()};S.prototype.Hb=function(a,b,c,d,e){var f=this;return this.J.Hb(a,b,c,function(){f.eb||(f.eb=!0,f.J.Va(f.Hc))},function(){f.reset()},d,e)};\nvar vi=function(a){return a&&\"auth/cordova-not-ready\"==a.code?!0:!1};S.prototype.Ib=function(a,b,c){var d=this,e;return pi(this.Eb).then(function(){return d.J.Ib(a,b,c).f(function(a){if(vi(a))throw new N(\"operation-not-supported-in-this-environment\");e=a;return qi(d.Eb).then(function(){throw e;})}).then(function(){return d.J.ge()?new A(function(){}):qi(d.Eb).then(function(){return d.getRedirectResult()}).then(function(){}).f(function(){})})})};\nS.prototype.Pb=function(a,b,c,d){return this.J.Pb(c,function(c){a.Ra(b,null,c,d)},yi.get())};var Ai={},Bi=function(a,b,c){var d=b+\":\"+c;Ai[d]||(Ai[d]=new S(a,b,c));return Ai[d]},si=function(a){this.i=a;this.mb=null;this.Lb=[];this.Kb=[];this.kb=null;this.gd=!1};si.prototype.reset=function(){this.mb=null;this.kb&&(this.kb.cancel(),this.kb=null)};\nsi.prototype.Wd=function(a,b){if(!a)return D(new N(\"invalid-auth-event\"));this.reset();this.gd=!0;var c=a.ba,d=a.I,e=a.getError()&&\"auth/web-storage-unsupported\"==a.getError().code,f=a.getError()&&\"auth/operation-not-supported-in-this-environment\"==a.getError().code;\"unknown\"!=c||e||f?a=a.O?this.ed(a,b):b.wb(c,d)?this.fd(a,b):D(new N(\"invalid-auth-event\")):(Ci(this,!1,null,null),a=C());return a};var wi=function(a){a.gd||(a.gd=!0,Ci(a,!1,null,null))};\nsi.prototype.ed=function(a){Ci(this,!0,null,a.getError());return C()};si.prototype.fd=function(a,b){var c=this;b=b.wb(a.ba,a.I);var d=a.rb,e=a.cc(),f=!!a.ba.match(/Redirect$/);return b(d,e).then(function(a){Ci(c,f,a,null)}).f(function(a){Ci(c,f,null,a)})};\nvar Di=function(a,b){a.mb=function(){return D(b)};if(a.Kb.length)for(var c=0;c<a.Kb.length;c++)a.Kb[c](b)},Ei=function(a,b){a.mb=function(){return C(b)};if(a.Lb.length)for(var c=0;c<a.Lb.length;c++)a.Lb[c](b)},Ci=function(a,b,c,d){b?d?Di(a,d):Ei(a,c):Ei(a,{user:null});a.Lb=[];a.Kb=[]};si.prototype.getRedirectResult=function(){var a=this;return new A(function(b,c){a.mb?a.mb().then(b,c):(a.Lb.push(b),a.Kb.push(c),Fi(a))})};\nvar Fi=function(a){var b=new N(\"timeout\");a.kb&&a.kb.cancel();a.kb=ne(zi.get()).then(function(){a.mb||Ci(a,!0,null,b)})},ti=function(a){this.i=a};ti.prototype.Wd=function(a,b){if(!a)return D(new N(\"invalid-auth-event\"));var c=a.ba,d=a.I;return a.O?this.ed(a,b):b.wb(c,d)?this.fd(a,b):D(new N(\"invalid-auth-event\"))};ti.prototype.ed=function(a,b){b.Ra(a.ba,null,a.getError(),a.I);return C()};\nti.prototype.fd=function(a,b){var c=a.I,d=a.ba,e=b.wb(d,c),f=a.rb;a=a.cc();return e(f,a).then(function(a){b.Ra(d,a,null,c)}).f(function(a){b.Ra(d,null,a,c)})};var Gi=function(a){this.g=a;this.za=this.W=null;this.Ea=0};Gi.prototype.D=function(){return{apiKey:this.g.j,refreshToken:this.W,accessToken:this.za,expirationTime:this.Ea}};\nvar Ii=function(a,b){var c=b.idToken,d=b.refreshToken;b=Hi(b.expiresIn);a.za=c;a.Ea=b;a.W=d},Hi=function(a){return la()+1E3*parseInt(a,10)},Ji=function(a,b){return zg(a.g,b).then(function(b){a.za=b.access_token;a.Ea=Hi(b.expires_in);a.W=b.refresh_token;return{accessToken:a.za,expirationTime:a.Ea,refreshToken:a.W}}).f(function(b){\"auth/user-token-expired\"==b.code&&(a.W=null);throw b;})};\nGi.prototype.getToken=function(a){a=!!a;return this.za&&!this.W?D(new N(\"user-token-expired\")):a||!this.za||la()>this.Ea-3E4?this.W?Ji(this,{grant_type:\"refresh_token\",refresh_token:this.W}):C(null):C({accessToken:this.za,expirationTime:this.Ea,refreshToken:this.W})};var Ki=function(a,b,c,d,e){Gf(this,{uid:a,displayName:d||null,photoURL:e||null,email:c||null,providerId:b})},Li=function(a,b){Ib.call(this,a);for(var c in b)this[c]=b[c]};r(Li,Ib);\nvar T=function(a,b,c){this.$=[];this.j=a.apiKey;this.B=a.appName;this.v=a.authDomain||null;a=firebase.SDK_VERSION?of(firebase.SDK_VERSION):null;this.g=new R(this.j,null,a);this.ga=new Gi(this.g);Mi(this,b.idToken);Ii(this.ga,b);M(this,\"refreshToken\",this.ga.W);Ni(this,c||{});je.call(this);this.rc=!1;this.v&&rf()&&(this.m=Bi(this.v,this.j,this.B));this.wc=[];this.ia=null;this.ib=Oi(this);this.sb=q(this.Sc,this)};r(T,je);T.prototype.Sc=function(){this.ib.gb&&(this.ib.stop(),this.ib.start())};\nvar Oi=function(a){return new Mh(function(){return a.getToken(!0)},function(a){return a&&\"auth/network-request-failed\"==a.code?!0:!1},function(){var b=a.ga.Ea-la()-3E5;return 0<b?b:0},3E4,96E4,!1)},Pi=function(a){a.Bd||a.ib.gb||(a.ib.start(),dc(a,\"tokenChanged\",a.sb),Vb(a,\"tokenChanged\",a.sb))},Qi=function(a){dc(a,\"tokenChanged\",a.sb);a.ib.stop()},Mi=function(a,b){a.Pd=b;M(a,\"_lat\",b)},Ri=function(a,b){Za(a.wc,function(a){return a==b})},Si=function(a){for(var b=[],c=0;c<a.wc.length;c++)b.push(a.wc[c](a));\nreturn hd(b).then(function(){return a})},Ti=function(a){a.m&&!a.rc&&(a.rc=!0,a.m.subscribe(a))},Ni=function(a,b){Gf(a,{uid:b.uid,displayName:b.displayName||null,photoURL:b.photoURL||null,email:b.email||null,emailVerified:b.emailVerified||!1,identifierNumber:b.identifierNumber||null,isAnonymous:b.isAnonymous||!1,providerData:[]})};M(T.prototype,\"providerId\",\"firebase\");\nvar Ui=function(){},Vi=function(a){return C().then(function(){if(a.Bd)throw new N(\"app-deleted\");})},Wi=function(a){return Sa(a.providerData,function(a){return a.providerId})},Yi=function(a,b){b&&(Xi(a,b.providerId),a.providerData.push(b))},Xi=function(a,b){Za(a.providerData,function(a){return a.providerId==b})},Zi=function(a,b,c){(\"uid\"!=b||c)&&a.hasOwnProperty(b)&&M(a,b,c)};\nT.prototype.copy=function(a){var b=this;b!=a&&(Gf(this,{uid:a.uid,displayName:a.displayName,photoURL:a.photoURL,email:a.email,emailVerified:a.emailVerified,identifierNumber:a.identifierNumber,isAnonymous:a.isAnonymous,providerData:[]}),x(a.providerData,function(a){Yi(b,a)}),this.ga=a.ga,M(this,\"refreshToken\",this.ga.W))};T.prototype.reload=function(){var a=this;return this.c(Vi(this).then(function(){return $i(a).then(function(){return Si(a)}).then(Ui)}))};\nvar $i=function(a){return a.getToken().then(function(b){var c=a.isAnonymous;return aj(a,b).then(function(){c||Zi(a,\"isAnonymous\",!1);return b})})};T.prototype.getToken=function(a){var b=this;return this.c(Vi(this).then(function(){return b.ga.getToken(a)}).then(function(a){if(!a)throw new N(\"internal-error\");a.accessToken!=b.Pd&&(Mi(b,a.accessToken),b.Ka());Zi(b,\"refreshToken\",a.refreshToken);return a.accessToken}))};\nvar bj=function(a,b){b.idToken&&a.Pd!=b.idToken&&(Ii(a.ga,b),a.Ka(),Mi(a,b.idToken),Zi(a,\"refreshToken\",a.ga.W))};T.prototype.Ka=function(){this.dispatchEvent(new Li(\"tokenChanged\"))};var aj=function(a,b){return Q(a.g,$g,{idToken:b}).then(q(a.df,a))};\nT.prototype.df=function(a){a=a.users;if(!a||!a.length)throw new N(\"internal-error\");a=a[0];Ni(this,{uid:a.localId,displayName:a.displayName,photoURL:a.photoUrl,email:a.email,emailVerified:!!a.emailVerified,identifierNumber:a.identifierNumber});for(var b=cj(a),c=0;c<b.length;c++)Yi(this,b[c]);Zi(this,\"isAnonymous\",!(this.email&&a.passwordHash)&&!(this.providerData&&this.providerData.length))};\nvar cj=function(a){return(a=a.providerUserInfo)&&a.length?Sa(a,function(a){return new Ki(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl)}):[]},ej=function(a,b){var c=null;return a.c(b.Sd(a.g,a.uid).then(function(b){bj(a,b);c=dj(a,b,\"reauthenticate\");a.ia=null;return a.reload()}).then(function(){return c}),!0)};T.prototype.reauthenticate=function(a){return fj(this,a)};\nvar fj=function(a,b){return ej(a,b).then(function(){})},gj=function(a,b){return $i(a).then(function(){if(Wa(Wi(a),b))return Si(a).then(function(){throw new N(\"provider-already-linked\");})})},ij=function(a,b){var c=null;return a.c(gj(a,b.providerId).then(function(){return a.getToken()}).then(function(c){return b.Rd(a.g,c)}).then(function(b){c=dj(a,b,\"link\");return hj(a,b)}).then(function(){return c}))};T.prototype.link=function(a){return jj(this,a)};\nvar jj=function(a,b){return ij(a,b).then(function(a){return a.user})},dj=function(a,b,c){var d=mg(b);b=Uh(b);return Hf({user:a,credential:d,additionalUserInfo:b,operationType:c})},hj=function(a,b){bj(a,b);return a.reload().then(function(){return a})};h=T.prototype;h.updateEmail=function(a){var b=this;return this.c(this.getToken().then(function(c){return b.g.updateEmail(c,a)}).then(function(a){bj(b,a);return b.reload()}))};\nh.updatePassword=function(a){var b=this;return this.c(this.getToken().then(function(c){return b.g.updatePassword(c,a)}).then(function(a){bj(b,a);return b.reload()}))};h.updateProfile=function(a){if(void 0===a.displayName&&void 0===a.photoURL)return Vi(this);var b=this;return this.c(this.getToken().then(function(c){return b.g.updateProfile(c,{displayName:a.displayName,photoUrl:a.photoURL})}).then(function(a){bj(b,a);Zi(b,\"displayName\",a.displayName||null);Zi(b,\"photoURL\",a.photoUrl||null);return Si(b)}).then(Ui))};\nh.unlink=function(a){var b=this;return this.c($i(this).then(function(c){return Wa(Wi(b),a)?Og(b.g,c,[a]).then(function(a){var c={};x(a.providerUserInfo||[],function(a){c[a.providerId]=!0});x(Wi(b),function(a){c[a]||Xi(b,a)});return Si(b)}):Si(b).then(function(){throw new N(\"no-such-provider\");})}))};\nh[\"delete\"]=function(){var a=this;return this.c(this.getToken().then(function(b){return Q(a.g,Zg,{idToken:b})}).then(function(){a.dispatchEvent(new Li(\"userDeleted\"))})).then(function(){for(var b=0;b<a.$.length;b++)a.$[b].cancel(\"app-deleted\");a.$=[];a.Bd=!0;Qi(a);M(a,\"refreshToken\",null);a.m&&a.m.unsubscribe(a)})};\nh.wd=function(a,b){return\"linkViaPopup\"==a&&(this.aa||null)==b&&this.Z||\"reauthViaPopup\"==a&&(this.aa||null)==b&&this.Z||\"linkViaRedirect\"==a&&(this.wa||null)==b||\"reauthViaRedirect\"==a&&(this.wa||null)==b?!0:!1};h.Ra=function(a,b,c,d){\"linkViaPopup\"!=a&&\"reauthViaPopup\"!=a||d!=(this.aa||null)||(c&&this.Ma?this.Ma(c):b&&!c&&this.Z&&this.Z(b),this.C&&(this.C.cancel(),this.C=null),delete this.Z,delete this.Ma)};\nh.wb=function(a,b){return\"linkViaPopup\"==a&&b==(this.aa||null)?q(this.Ed,this):\"reauthViaPopup\"==a&&b==(this.aa||null)?q(this.Fd,this):\"linkViaRedirect\"==a&&(this.wa||null)==b?q(this.Ed,this):\"reauthViaRedirect\"==a&&(this.wa||null)==b?q(this.Fd,this):null};h.ac=function(){return qf(this.uid+\":::\")};var lj=function(a,b){return kj(a,b,function(){return gj(a,b.providerId).then(function(){return Si(a)})})};\nT.prototype.linkWithPopup=function(a){return lj(this,a).then(function(a){return a?Hf({user:a.user,credential:a.credential}):a})};\nvar kj=function(a,b,c){if(!rf())return D(new N(\"operation-not-supported-in-this-environment\"));if(a.ia)return D(a.ia);var d=Of(b.providerId),e=a.ac(),f=null;(!sf()||mf())&&a.v&&b.isOAuthProvider&&(f=qh(a.v,a.j,a.B,\"linkViaPopup\",b,null,e,firebase.SDK_VERSION||null));var g=ef(f,d&&d.Gb,d&&d.Fb);c=c().then(function(){mj(a);return a.getToken().then(function(){})}).then(function(){return a.m.Hb(g,\"linkViaPopup\",b,e,!!f)}).then(function(){return new A(function(b,c){a.Ra(\"linkViaPopup\",null,new N(\"cancelled-popup-request\"),\na.aa||null);a.Z=b;a.Ma=c;a.aa=e;a.C=a.m.Pb(a,\"linkViaPopup\",g,e)})}).then(function(a){g&&df(g);return a}).f(function(a){g&&df(g);throw a;});return a.c(c,!1)};T.prototype.linkWithRedirect=function(a){var b=this;return nj(this,a,function(){return gj(b,a.providerId)})};\nvar nj=function(a,b,c){if(!rf())return D(new N(\"operation-not-supported-in-this-environment\"));if(a.ia)return D(a.ia);var d=null,e=a.ac();c=c().then(function(){mj(a);return a.getToken().then(function(){})}).then(function(){a.wa=e;return Si(a)}).then(function(b){a.Pa&&(b=a.Pa,b=b.i.set(oj,a.D(),b.u));return b}).then(function(){return a.m.Ib(\"linkViaRedirect\",b,e)}).f(function(b){d=b;if(a.Pa)return pj(a.Pa);throw d;}).then(function(){if(d)throw d;});return a.c(c,!1)},mj=function(a){if(!a.m||!a.rc){if(a.m&&\n!a.rc)throw new N(\"internal-error\");throw new N(\"auth-domain-config-required\");}};T.prototype.Ed=function(a,b){var c=this;this.C&&(this.C.cancel(),this.C=null);var d=null,e=this.getToken().then(function(d){return Yf(c.g,{requestUri:a,sessionId:b,idToken:d})}).then(function(a){d=dj(c,a,\"link\");return hj(c,a)}).then(function(){return d});return this.c(e)};\nT.prototype.Fd=function(a,b){var c=this;this.C&&(this.C.cancel(),this.C=null);var d=null,e=C().then(function(){return Uf(Zf(c.g,{requestUri:a,sessionId:b}),c.uid)}).then(function(a){d=dj(c,a,\"reauthenticate\");bj(c,a);c.ia=null;return c.reload()}).then(function(){return d});return this.c(e,!0)};T.prototype.sendEmailVerification=function(){var a=this;return this.c(this.getToken().then(function(b){return a.g.sendEmailVerification(b)}).then(function(b){if(a.email!=b)return a.reload()}).then(function(){}))};\nT.prototype.c=function(a,b){var c=this,d=qj(this,a,b);this.$.push(d);kd(d,function(){Ya(c.$,d)});return d};var qj=function(a,b,c){return a.ia&&!c?(b.cancel(),D(a.ia)):b.f(function(b){!b||\"auth/user-disabled\"!=b.code&&\"auth/user-token-expired\"!=b.code||(a.ia||a.dispatchEvent(new Li(\"userInvalidated\")),a.ia=b);throw b;})};T.prototype.toJSON=function(){return this.D()};\nT.prototype.D=function(){var a={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,identifierNumber:this.identifierNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.j,appName:this.B,authDomain:this.v,stsTokenManager:this.ga.D(),redirectEventId:this.wa||null};x(this.providerData,function(b){a.providerData.push(If(b))});return a};\nvar rj=function(a){if(!a.apiKey)return null;var b={apiKey:a.apiKey,authDomain:a.authDomain,appName:a.appName},c={};if(a.stsTokenManager&&a.stsTokenManager.accessToken&&a.stsTokenManager.expirationTime)c.idToken=a.stsTokenManager.accessToken,c.refreshToken=a.stsTokenManager.refreshToken||null,c.expiresIn=(a.stsTokenManager.expirationTime-la())/1E3;else return null;var d=new T(b,c,a);a.providerData&&x(a.providerData,function(a){a&&Yi(d,Hf(a))});a.redirectEventId&&(d.wa=a.redirectEventId);return d},\nsj=function(a,b,c){var d=new T(a,b);c&&(d.Pa=c);return d.reload().then(function(){return d})};var tj=function(a){this.u=a;this.i=Xh()},oj={name:\"redirectUser\",K:!1},pj=function(a){return a.i.remove(oj,a.u)},uj=function(a,b){return a.i.get(oj,a.u).then(function(a){a&&b&&(a.authDomain=b);return rj(a||{})})};var vj=function(a){this.u=a;this.i=Xh()},wj={name:\"authUser\",K:!0},xj=function(a,b){return a.i.set(wj,b.D(),a.u)},yj=function(a){return a.i.remove(wj,a.u)},zj=function(a,b){return a.i.get(wj,a.u).then(function(a){a&&b&&(a.authDomain=b);return rj(a||{})})};var V=function(a){this.Ya=!1;M(this,\"app\",a);if(U(this).options&&U(this).options.apiKey)a=firebase.SDK_VERSION?of(firebase.SDK_VERSION):null,this.g=new R(U(this).options&&U(this).options.apiKey,null,a);else throw new N(\"invalid-api-key\");this.$=[];this.Aa=[];this.af=firebase.INTERNAL.createSubscribe(q(this.Pe,this));Aj(this,null);this.ra=new vj(U(this).options.apiKey+\":\"+U(this).name);this.lb=new tj(U(this).options.apiKey+\":\"+U(this).name);this.Wb=this.c(Bj(this));this.xa=this.c(Cj(this));this.Xc=\n!1;this.Qc=q(this.vf,this);this.je=q(this.bb,this);this.sb=q(this.Sc,this);this.he=q(this.Ke,this);this.ie=q(this.Le,this);Dj(this);this.INTERNAL={};this.INTERNAL[\"delete\"]=q(this[\"delete\"],this);this.Fa=0};V.prototype.toJSON=function(){return{apiKey:U(this).options.apiKey,authDomain:U(this).options.authDomain,appName:U(this).name,currentUser:W(this)&&W(this).D()}};\nvar Ej=function(a){return a.ye||D(new N(\"auth-domain-config-required\"))},Dj=function(a){var b=U(a).options.authDomain,c=U(a).options.apiKey;b&&rf()&&(a.ye=a.Wb.then(function(){if(!a.Ya)return a.m=Bi(b,c,U(a).name),a.m.subscribe(a),W(a)&&Ti(W(a)),a.Mb&&(Ti(a.Mb),a.Mb=null),a.m}))};h=V.prototype;h.wd=function(a,b){switch(a){case \"unknown\":case \"signInViaRedirect\":return!0;case \"signInViaPopup\":return this.aa==b&&!!this.Z;default:return!1}};\nh.Ra=function(a,b,c,d){\"signInViaPopup\"==a&&this.aa==d&&(c&&this.Ma?this.Ma(c):b&&!c&&this.Z&&this.Z(b),this.C&&(this.C.cancel(),this.C=null),delete this.Z,delete this.Ma)};h.wb=function(a,b){return\"signInViaRedirect\"==a||\"signInViaPopup\"==a&&this.aa==b&&this.Z?q(this.Ae,this):null};\nh.Ae=function(a,b){var c=this;a={requestUri:a,sessionId:b};this.C&&(this.C.cancel(),this.C=null);var d=null,e=null,f=Wf(c.g,a).then(function(a){d=mg(a);e=Uh(a);return a});a=c.Wb.then(function(){return f}).then(function(a){return Fj(c,a)}).then(function(){return Hf({user:W(c),credential:d,additionalUserInfo:e,operationType:\"signIn\"})});return this.c(a)};h.ac=function(){return qf()};\nvar Gj=function(a,b){if(!rf())return D(new N(\"operation-not-supported-in-this-environment\"));var c=Of(b.providerId),d=a.ac(),e=null;(!sf()||mf())&&U(a).options.authDomain&&b.isOAuthProvider&&(e=qh(U(a).options.authDomain,U(a).options.apiKey,U(a).name,\"signInViaPopup\",b,null,d,firebase.SDK_VERSION||null));var f=ef(e,c&&c.Gb,c&&c.Fb),c=Ej(a).then(function(a){return a.Hb(f,\"signInViaPopup\",b,d,!!e)}).then(function(){return new A(function(b,c){a.Ra(\"signInViaPopup\",null,new N(\"cancelled-popup-request\"),\na.aa);a.Z=b;a.Ma=c;a.aa=d;a.C=a.m.Pb(a,\"signInViaPopup\",f,d)})}).then(function(a){f&&df(f);return a}).f(function(a){f&&df(f);throw a;});return a.c(c)};V.prototype.signInWithPopup=function(a){return Gj(this,a).then(function(a){return a?Hf({user:a.user,credential:a.credential}):a})};V.prototype.getRedirectResult=function(){return Hj(this).then(function(a){return a?Hf({user:a.user,credential:a.credential}):a})};\nV.prototype.signInWithRedirect=function(a){if(!rf())return D(new N(\"operation-not-supported-in-this-environment\"));var b=this,c=Ej(this).then(function(){return b.m.Ib(\"signInViaRedirect\",a)});return this.c(c)};\nvar Hj=function(a){if(!rf())return D(new N(\"operation-not-supported-in-this-environment\"));var b=Ej(a).then(function(){return a.m.getRedirectResult()});return a.c(b)},Fj=function(a,b){var c={};c.apiKey=U(a).options.apiKey;c.authDomain=U(a).options.authDomain;c.appName=U(a).name;return a.Wb.then(function(){return sj(c,b,a.lb)}).then(function(b){if(W(a)&&b.uid==W(a).uid)return W(a).copy(b),a.bb(b);Aj(a,b);Ti(b);return a.bb(b)}).then(function(){a.Ka()})},Aj=function(a,b){W(a)&&(Ri(W(a),a.je),dc(W(a),\n\"tokenChanged\",a.sb),dc(W(a),\"userDeleted\",a.he),dc(W(a),\"userInvalidated\",a.ie),Qi(W(a)));b&&(b.wc.push(a.je),Vb(b,\"tokenChanged\",a.sb),Vb(b,\"userDeleted\",a.he),Vb(b,\"userInvalidated\",a.ie),0<a.Fa&&Pi(b));M(a,\"currentUser\",b)};V.prototype.signOut=function(){var a=this,b=this.xa.then(function(){if(!W(a))return C();Aj(a,null);return yj(a.ra).then(function(){a.Ka()})});return this.c(b)};\nvar Ij=function(a){var b=uj(a.lb,U(a).options.authDomain).then(function(b){if(a.Mb=b)b.Pa=a.lb;return pj(a.lb)});return a.c(b)},Bj=function(a){var b=U(a).options.authDomain,c=Ij(a).then(function(){return zj(a.ra,b)}).then(function(b){return b?(b.Pa=a.lb,a.Mb&&(a.Mb.wa||null)==(b.wa||null)?b:b.reload().then(function(){return xj(a.ra,b).then(function(){return b})}).f(function(c){return\"auth/network-request-failed\"==c.code?b:yj(a.ra)})):null}).then(function(b){Aj(a,b||null)});return a.c(c)},Cj=function(a){return a.Wb.then(function(){return a.getRedirectResult()}).f(function(){}).then(function(){if(!a.Ya)return a.Qc()}).f(function(){}).then(function(){if(!a.Ya){a.Xc=\n!0;var b=a.ra;b.i.addListener(wj,b.u,a.Qc)}})};h=V.prototype;h.vf=function(){var a=this;return zj(this.ra,U(this).options.authDomain).then(function(b){if(!a.Ya){var c;if(c=W(a)&&b){c=W(a).uid;var d=b.uid;c=void 0===c||null===c||\"\"===c||void 0===d||null===d||\"\"===d?!1:c==d}if(c)return W(a).copy(b),W(a).getToken();if(W(a)||b)Aj(a,b),b&&(Ti(b),b.Pa=a.lb),a.m&&a.m.subscribe(a),a.Ka()}})};h.bb=function(a){return xj(this.ra,a)};h.Sc=function(){this.Ka();this.bb(W(this))};h.Ke=function(){this.signOut()};\nh.Le=function(){this.signOut()};var Jj=function(a,b){var c=null,d=null;return a.c(b.then(function(b){c=mg(b);d=Uh(b);return Fj(a,b)}).then(function(){return Hf({user:W(a),credential:c,additionalUserInfo:d,operationType:\"signIn\"})}))};h=V.prototype;h.Pe=function(a){var b=this;this.addAuthTokenListener(function(){a.next(W(b))})};h.onAuthStateChanged=function(a,b,c){var d=this;this.Xc&&firebase.Promise.resolve().then(function(){p(a)?a(W(d)):p(a.next)&&a.next(W(d))});return this.af(a,b,c)};\nh.getToken=function(a){var b=this,c=this.xa.then(function(){return W(b)?W(b).getToken(a).then(function(a){return{accessToken:a}}):null});return this.c(c)};h.signInWithCustomToken=function(a){var b=this;return this.xa.then(function(){return Jj(b,Q(b.g,ah,{token:a}))}).then(function(a){a=a.user;Zi(a,\"isAnonymous\",!1);return b.bb(a)}).then(function(){return W(b)})};h.signInWithEmailAndPassword=function(a,b){var c=this;return this.xa.then(function(){return Jj(c,Q(c.g,jg,{email:a,password:b}))}).then(function(a){return a.user})};\nh.createUserWithEmailAndPassword=function(a,b){var c=this;return this.xa.then(function(){return Jj(c,Q(c.g,Yg,{email:a,password:b}))}).then(function(a){return a.user})};h.signInWithCredential=function(a){return Kj(this,a).then(function(a){return a.user})};var Kj=function(a,b){return a.xa.then(function(){return Jj(a,b.bc(a.g))})};\nV.prototype.signInAnonymously=function(){var a=W(this),b=this;return a&&a.isAnonymous?C(a):this.xa.then(function(){return Jj(b,b.g.signInAnonymously())}).then(function(a){a=a.user;Zi(a,\"isAnonymous\",!0);return b.bb(a)}).then(function(){return W(b)})};var U=function(a){return a.app},W=function(a){return a.currentUser};h=V.prototype;h.getUid=function(){return W(this)&&W(this).uid||null};h.Ka=function(){if(this.Xc)for(var a=0;a<this.Aa.length;a++)if(this.Aa[a])this.Aa[a](W(this)&&W(this)._lat||null)};\nh.se=function(a){this.addAuthTokenListener(a);this.Fa++;0<this.Fa&&W(this)&&Pi(W(this))};h.hf=function(a){var b=this;x(this.Aa,function(c){c==a&&b.Fa--});0>this.Fa&&(this.Fa=0);0==this.Fa&&W(this)&&Qi(W(this));this.removeAuthTokenListener(a)};h.addAuthTokenListener=function(a){var b=this;this.Aa.push(a);this.c(this.xa.then(function(){b.Ya||Wa(b.Aa,a)&&a(W(b)&&W(b)._lat||null)}))};h.removeAuthTokenListener=function(a){Za(this.Aa,function(b){return b==a})};\nh[\"delete\"]=function(){this.Ya=!0;for(var a=0;a<this.$.length;a++)this.$[a].cancel(\"app-deleted\");this.$=[];this.ra&&(a=this.ra,a.i.removeListener(wj,a.u,this.Qc));this.m&&this.m.unsubscribe(this);return firebase.Promise.resolve()};h.c=function(a){var b=this;this.$.push(a);kd(a,function(){Ya(b.$,a)});return a};h.fetchProvidersForEmail=function(a){return this.c(Eg(this.g,a))};h.verifyPasswordResetCode=function(a){return this.checkActionCode(a).then(function(a){return a.data.email})};\nh.confirmPasswordReset=function(a,b){return this.c(this.g.confirmPasswordReset(a,b).then(function(){}))};h.checkActionCode=function(a){return this.c(this.g.checkActionCode(a).then(function(a){return new Lh(a)}))};h.applyActionCode=function(a){return this.c(this.g.applyActionCode(a).then(function(){}))};h.sendPasswordResetEmail=function(a){return this.c(this.g.sendPasswordResetEmail(a).then(function(){}))};var Lj=\"First Second Third Fourth Fifth Sixth Seventh Eighth Ninth\".split(\" \"),X=function(a,b){return{name:a||\"\",ha:\"a valid string\",optional:!!b,ja:m}},Y=function(a){return{name:a||\"\",ha:\"a valid object\",optional:!1,ja:ha}},Mj=function(a,b){return{name:a||\"\",ha:\"a function\",optional:!!b,ja:p}},Nj=function(){return{name:\"\",ha:\"null\",optional:!1,ja:da}},Oj=function(){return{name:\"credential\",ha:\"a valid credential\",optional:!1,ja:function(a){return a?!!a.bc:!1}}},Pj=function(){return{name:\"authProvider\",\nha:\"a valid Auth provider\",optional:!1,ja:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}},Qj=function(a,b,c,d){return{name:c||\"\",ha:a.ha+\" or \"+b.ha,optional:!!d,ja:function(c){return a.ja(c)||b.ja(c)}}};var Z=function(a,b){for(var c in b){var d=b[c].name;a[d]=Rj(d,a[c],b[c].a)}},Sj=function(a,b,c,d){a[b]=Rj(b,c,d)},Rj=function(a,b,c){if(!c)return b;var d=Tj(a);a=function(){var a=Array.prototype.slice.call(arguments),e;a:{e=Array.prototype.slice.call(a);var k;k=0;for(var n=!1,B=0;B<c.length;B++)if(c[B].optional)n=!0;else{if(n)throw new N(\"internal-error\",\"Argument validator encountered a required argument after an optional argument.\");k++}n=c.length;if(e.length<k||n<e.length)e=\"Expected \"+(k==n?1==\nk?\"1 argument\":k+\" arguments\":k+\"-\"+n+\" arguments\")+\" but got \"+e.length+\".\";else{for(k=0;k<e.length;k++)if(n=c[k].optional&&void 0===e[k],!c[k].ja(e[k])&&!n){e=c[k];if(0>k||k>=Lj.length)throw new N(\"internal-error\",\"Argument validator received an unsupported number of arguments.\");e=Lj[k]+\" argument \"+(e.name?'\"'+e.name+'\" ':\"\")+\"must be \"+e.ha+\".\";break a}e=null}}if(e)throw new N(\"argument-error\",d+\" failed: \"+e);return b.apply(this,a)};for(var e in b)a[e]=b[e];for(e in b.prototype)a.prototype[e]=\nb.prototype[e];return a},Tj=function(a){a=a.split(\".\");return a[a.length-1]};Z(V.prototype,{applyActionCode:{name:\"applyActionCode\",a:[X(\"code\")]},checkActionCode:{name:\"checkActionCode\",a:[X(\"code\")]},confirmPasswordReset:{name:\"confirmPasswordReset\",a:[X(\"code\"),X(\"newPassword\")]},createUserWithEmailAndPassword:{name:\"createUserWithEmailAndPassword\",a:[X(\"email\"),X(\"password\")]},fetchProvidersForEmail:{name:\"fetchProvidersForEmail\",a:[X(\"email\")]},getRedirectResult:{name:\"getRedirectResult\",a:[]},onAuthStateChanged:{name:\"onAuthStateChanged\",a:[Qj(Y(),Mj(),\"nextOrObserver\"),\nMj(\"opt_error\",!0),Mj(\"opt_completed\",!0)]},sendPasswordResetEmail:{name:\"sendPasswordResetEmail\",a:[X(\"email\")]},signInAnonymously:{name:\"signInAnonymously\",a:[]},signInWithCredential:{name:\"signInWithCredential\",a:[Oj()]},signInWithCustomToken:{name:\"signInWithCustomToken\",a:[X(\"token\")]},signInWithEmailAndPassword:{name:\"signInWithEmailAndPassword\",a:[X(\"email\"),X(\"password\")]},signInWithPopup:{name:\"signInWithPopup\",a:[Pj()]},signInWithRedirect:{name:\"signInWithRedirect\",a:[Pj()]},signOut:{name:\"signOut\",\na:[]},toJSON:{name:\"toJSON\",a:[X(null,!0)]},verifyPasswordResetCode:{name:\"verifyPasswordResetCode\",a:[X(\"code\")]}});\nZ(T.prototype,{\"delete\":{name:\"delete\",a:[]},getToken:{name:\"getToken\",a:[{name:\"opt_forceRefresh\",ha:\"a boolean\",optional:!0,ja:function(a){return\"boolean\"==typeof a}}]},link:{name:\"link\",a:[Oj()]},linkWithPopup:{name:\"linkWithPopup\",a:[Pj()]},linkWithRedirect:{name:\"linkWithRedirect\",a:[Pj()]},reauthenticate:{name:\"reauthenticate\",a:[Oj()]},reload:{name:\"reload\",a:[]},sendEmailVerification:{name:\"sendEmailVerification\",a:[]},toJSON:{name:\"toJSON\",a:[X(null,!0)]},unlink:{name:\"unlink\",a:[X(\"provider\")]},\nupdateEmail:{name:\"updateEmail\",a:[X(\"email\")]},updatePassword:{name:\"updatePassword\",a:[X(\"password\")]},updateProfile:{name:\"updateProfile\",a:[Y(\"profile\")]}});Z(A.prototype,{f:{name:\"catch\"},then:{name:\"then\"}});Sj(lg,\"credential\",function(a,b){return new ig(a,b)},[X(\"email\"),X(\"password\")]);Z(ag.prototype,{addScope:{name:\"addScope\",a:[X(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[Y(\"customOAuthParameters\")]}});Sj(ag,\"credential\",bg,[Qj(X(),Y(),\"token\")]);\nZ(cg.prototype,{addScope:{name:\"addScope\",a:[X(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[Y(\"customOAuthParameters\")]}});Sj(cg,\"credential\",dg,[Qj(X(),Y(),\"token\")]);Z(eg.prototype,{addScope:{name:\"addScope\",a:[X(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[Y(\"customOAuthParameters\")]}});Sj(eg,\"credential\",fg,[Qj(X(),Qj(Y(),Nj()),\"idToken\"),Qj(X(),Nj(),\"accessToken\",!0)]);Z(gg.prototype,{setCustomParameters:{name:\"setCustomParameters\",a:[Y(\"customOAuthParameters\")]}});\nSj(gg,\"credential\",hg,[Qj(X(),Y(),\"token\"),X(\"secret\",!0)]);Z(N.prototype,{toJSON:{name:\"toJSON\",a:[X(null,!0)]}});Z(og.prototype,{toJSON:{name:\"toJSON\",a:[X(null,!0)]}});Z(Sf.prototype,{toJSON:{name:\"toJSON\",a:[X(null,!0)]}});\n(function(){if(\"undefined\"!==typeof firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService){var a={Auth:V,Error:N};Sj(a,\"EmailAuthProvider\",lg,[]);Sj(a,\"FacebookAuthProvider\",ag,[]);Sj(a,\"GithubAuthProvider\",cg,[]);Sj(a,\"GoogleAuthProvider\",eg,[]);Sj(a,\"TwitterAuthProvider\",gg,[]);firebase.INTERNAL.registerService(\"auth\",function(a,c){a=new V(a);c({INTERNAL:{getUid:q(a.getUid,a),getToken:q(a.getToken,a),addAuthTokenListener:q(a.se,a),removeAuthTokenListener:q(a.hf,a)}});return a},a,function(a,\nc){if(\"create\"===a)try{c.auth()}catch(d){}});firebase.INTERNAL.extendNamespace({User:T})}else throw Error(\"Cannot find the firebase namespace; be sure to include firebase-app.js before this library.\");})();}).call(this);\n}).call(typeof global !== undefined ? global : typeof self !== undefined ? self : typeof window !== undefined ? window : {});\nmodule.exports = firebase.auth;","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/server-auth-node/index.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nvar Auth = require('./auth.js');\nvar firebase = require('../app-node');\n\nvar serviceFactory = function(app, extendApp) {\n  var auth = new Auth(app);\n  extendApp({\n    'INTERNAL': {\n      'getToken': auth.INTERNAL.getToken.bind(auth),\n      'addAuthTokenListener': auth.INTERNAL.addAuthTokenListener.bind(auth),\n      'removeAuthTokenListener': auth.INTERNAL.removeAuthTokenListener.bind(auth)\n    }\n  });\n  return auth;\n};\n\nfunction appHook(event, app) {\n  if (event === 'create') {\n    app.auth();\n  }\n}\n\nmodule.exports = firebase.INTERNAL.registerService(\n  'serverAuth',\n  serviceFactory,\n  {'Auth': Auth},\n  appHook);\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/server-auth-node/auth.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nvar FirebaseTokenGenerator = require('./token-generator');\nvar fs = require('fs');\nvar firebase = require('../app-node');\nvar credential = require('./credential.js');\n\nfunction getServiceAccount(app_) {\n  var serviceAccountPathOrObject = typeof app_.options.serviceAccount === 'undefined' ?\n    process.env.GOOGLE_APPLICATION_CREDENTIALS :\n    app_.options.serviceAccount;\n  var serviceAccount;\n  if (typeof serviceAccountPathOrObject === 'undefined') {\n    return null;\n  } else if (typeof serviceAccountPathOrObject === 'string') {\n    try {\n      serviceAccount = JSON.parse(fs.readFileSync(serviceAccountPathOrObject, 'utf8'));\n    } catch (error) {\n      throw new Error('Failed to parse service account key file: ' + error);\n    }\n  } else if (typeof serviceAccountPathOrObject === 'object') {\n    serviceAccount = {};\n\n    var projectId = serviceAccountPathOrObject.project_id || serviceAccountPathOrObject.projectId;\n    if (typeof projectId !== 'undefined') {\n      serviceAccount.project_id = projectId;\n    }\n\n    var privateKey = serviceAccountPathOrObject.private_key || serviceAccountPathOrObject.privateKey;\n    if (typeof privateKey !== 'undefined') {\n      serviceAccount.private_key = privateKey;\n    }\n\n    var clientEmail = serviceAccountPathOrObject.client_email || serviceAccountPathOrObject.clientEmail;\n    if (typeof clientEmail !== 'undefined') {\n      serviceAccount.client_email = clientEmail;\n    }\n  } else {\n    throw new Error('Invalid service account provided');\n  }\n\n  if (typeof serviceAccount.private_key !== 'string' || !serviceAccount.private_key) {\n    throw new Error('Service account must contain a \"private_key\" field');\n  } else if (typeof serviceAccount.client_email !== 'string' || !serviceAccount.client_email) {\n    throw new Error('Service account must contain a \"client_email\" field');\n  }\n\n  return serviceAccount;\n}\n\nvar Auth = function(app_) {\n  if (!('options' in app_)) {\n    throw new Error('First parameter to Auth constructor must be an instance of firebase.App');\n  }\n\n  var cachedToken_ = null;\n  var tokenListeners_ = [];\n\n  var credential_ = app_.options.credential;\n  var serviceAccount_ = getServiceAccount(app_);\n  var tokenGenerator_;\n\n  if (credential_ && typeof credential_.getAccessToken !== 'function') {\n    throw new Error('Called firebase.initializeApp with an invalid credential parameter');\n  }\n  if (serviceAccount_) {\n    credential_ = credential_ || new credential.CertCredential(serviceAccount_);\n    tokenGenerator_ = new FirebaseTokenGenerator(serviceAccount_);\n  } else {\n    credential_ = credential_ || new credential.UnauthenticatedCredential();\n  }\n\n  Object.defineProperty(this, 'app', {\n    get: function() { return app_; }\n  });\n\n  this.createCustomToken = function(uid, developerClaims) {\n    console.log(\n      'createCustomToken() is deprecated and will be removed in the next major version. You ' +\n      'should instead use the same method in the `firebase-admin` package. See ' +\n      'https://firebase.google.com/docs/admin/setup for details on how to get started.'\n    );\n\n    if (typeof tokenGenerator_ === 'undefined') {\n      throw new Error('Must initialize FirebaseApp with a service account to call auth().createCustomToken()');\n    }\n    return tokenGenerator_.createCustomToken(uid, developerClaims);\n  };\n\n  this.verifyIdToken = function(idToken) {\n    console.log(\n      'verifyIdToken() is deprecated and will be removed in the next major version. You ' +\n      'should instead use the same method in the `firebase-admin` package. See ' +\n      'https://firebase.google.com/docs/admin/setup for details on how to get started.'\n    );\n\n    if (typeof tokenGenerator_ === 'undefined') {\n      throw new Error('Must initialize FirebaseApp with a service account to call auth().verifyIdToken()');\n    }\n    return tokenGenerator_.verifyIdToken(idToken);\n  };\n\n  this.INTERNAL = {};\n\n  this.INTERNAL.delete = function() {\n    return firebase.Promise.resolve();\n  };\n\n  this.INTERNAL.getToken = function(forceRefresh) {\n    var expired = cachedToken_ && cachedToken_.expirationTime < Date.now();\n    if (cachedToken_ && !forceRefresh && !expired) {\n      return firebase.Promise.resolve(cachedToken_);\n    } else {\n      return firebase.Promise.resolve().then(function() {\n        return credential_.getAccessToken();\n      }).then(function(result) {\n        if (result === null) {\n          return null;\n        }\n        if (typeof result !== 'object' ||\n            typeof result.expires_in !== 'number' ||\n            typeof result.access_token !== 'string') {\n          throw new Error('firebase.initializeApp was called with a credential ' +\n              'that creates invalid access tokens: ' + JSON.stringify(result));\n        }\n        var token = {\n          accessToken: result.access_token,\n          expirationTime: Date.now() + (result.expires_in * 1000)\n        };\n\n        var hasAccessTokenChanged = (cachedToken_ && cachedToken_.accessToken !== token.accessToken);\n        var hasExpirationTimeChanged = (cachedToken_ && cachedToken_.expirationTime !== token.expirationTime);\n        if (!cachedToken_ || hasAccessTokenChanged || hasExpirationTimeChanged) {\n          cachedToken_ = token;\n          tokenListeners_.forEach(function(listener) {\n            listener(token.accessToken);\n          });\n        }\n\n        return token;\n      });\n    }\n  };\n\n  this.INTERNAL.addAuthTokenListener = function(listener) {\n    tokenListeners_.push(listener);\n    if (cachedToken_) {\n      listener(cachedToken_);\n    }\n  };\n\n  this.INTERNAL.removeAuthTokenListener = function(listener) {\n    tokenListeners_ = tokenListeners_.filter(function(other) {\n      return other !== listener;\n    });\n  };\n};\n\nmodule.exports = Auth;\n\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/server-auth-node/token-generator.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nvar fs = require('fs');\nvar https = require('https');\nvar jwt = require('jsonwebtoken');\nvar firebase = require('../app-node');\n\n\nvar ALGORITHM = 'RS256';\nvar ONE_HOUR_IN_SECONDS = 60 * 60;\n\nvar BLACKLISTED_CLAIMS = [\n  'acr', 'amr', 'at_hash', 'aud', 'auth_time', 'azp', 'cnf', 'c_hash', 'exp', 'iat', 'iss', 'jti',\n  'nbf', 'nonce'\n];\n\nvar CLIENT_CERT_URL = 'https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com';\n\nvar FIREBASE_AUDIENCE = 'https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit';\n\n\nvar FirebaseTokenGenerator = function(serviceAccount) {\n  serviceAccount = serviceAccount || process.env.GOOGLE_APPLICATION_CREDENTIALS;\n  if (typeof serviceAccount === 'string') {\n    try {\n      this.serviceAccount = JSON.parse(fs.readFileSync(serviceAccount, 'utf8'));\n    } catch (error) {\n      throw new Error('Failed to parse service account key file: ' + error);\n    }\n  } else if (typeof serviceAccount === 'object' && serviceAccount !== null) {\n    this.serviceAccount = serviceAccount;\n  } else {\n    throw new Error('Must provide a service account to use FirebaseTokenGenerator');\n  }\n\n  if (typeof this.serviceAccount.private_key !== 'string' || this.serviceAccount.private_key === '') {\n    throw new Error('Service account key must contain a string \"private_key\" field');\n  } else if (typeof this.serviceAccount.client_email !== 'string' || this.serviceAccount.client_email === '') {\n    throw new Error('Service account key must contain a string \"client_email\" field');\n  }\n};\n\n\nFirebaseTokenGenerator.prototype.createCustomToken = function(uid, developerClaims) {\n  if (typeof uid !== 'string' || uid === '') {\n    throw new Error('First argument to createCustomToken() must be a non-empty string uid');\n  } else if (uid.length > 128) {\n    throw new Error('First argument to createCustomToken() must a uid with less than or equal to 128 characters');\n  } else if (typeof developerClaims !== 'undefined' && (typeof developerClaims !== 'object' || developerClaims === null || developerClaims instanceof Array)) {\n    throw new Error('Optional second argument to createCustomToken() must be an object containing the developer claims');\n  }\n\n  var jwtPayload = {};\n\n  if (typeof developerClaims !== 'undefined') {\n    jwtPayload.claims = {};\n\n    for (var key in developerClaims) {\n      if (developerClaims.hasOwnProperty(key)) {\n        if (BLACKLISTED_CLAIMS.indexOf(key) !== -1) {\n          throw new Error('Developer claim \"' + key + '\" is reserved and cannot be specified');\n        }\n\n        jwtPayload.claims[key] = developerClaims[key];\n      }\n    }\n  }\n  jwtPayload.uid = uid;\n\n  return jwt.sign(jwtPayload, this.serviceAccount.private_key, {\n    audience: FIREBASE_AUDIENCE,\n    expiresIn: ONE_HOUR_IN_SECONDS,\n    issuer: this.serviceAccount.client_email,\n    subject: this.serviceAccount.client_email,\n    algorithm: ALGORITHM\n  });\n};\n\n\nFirebaseTokenGenerator.prototype.verifyIdToken = function(idToken) {\n  if (typeof idToken !== 'string') {\n    throw new Error('First argument to verifyIdToken() must be a Firebase ID token');\n  }\n\n  if (typeof this.serviceAccount.project_id !== 'string' || this.serviceAccount.project_id === '') {\n    throw new Error('verifyIdToken() requires a service account with \"project_id\" set');\n  }\n\n  var fullDecodedToken = jwt.decode(idToken, {\n    complete: true\n  });\n\n  var header = fullDecodedToken && fullDecodedToken.header;\n  var payload = fullDecodedToken && fullDecodedToken.payload;\n\n  var projectIdMatchMessage = ' Make sure the ID token comes from the same Firebase project as the ' +\n    'service account used to authenticate this SDK.';\n  var verifyIdTokenDocsMessage = ' See https://firebase.google.com/docs/auth/server/verify-id-tokens ' +\n    'for details on how to retrieve an ID token.';\n\n  var errorMessage;\n  if (!fullDecodedToken) {\n    errorMessage = 'Decoding Firebase ID token failed. Make sure you passed the entire string JWT ' +\n      'which represents an ID token.' + verifyIdTokenDocsMessage;\n  } else if (typeof header.kid === 'undefined') {\n    var isCustomToken = (payload.aud === FIREBASE_AUDIENCE);\n    var isLegacyCustomToken = (header.alg === 'HS256' && payload.v === 0 && 'd' in payload && 'uid' in payload.d);\n\n    if (isCustomToken) {\n      errorMessage = 'verifyIdToken() expects an ID token, but was given a custom token.';\n    } else if (isLegacyCustomToken) {\n      errorMessage = 'verifyIdToken() expects an ID token, but was given a legacy custom token.';\n    } else {\n      errorMessage = 'Firebase ID token has no \"kid\" claim.';\n    }\n\n    errorMessage += verifyIdTokenDocsMessage;\n  } else if (header.alg !== ALGORITHM) {\n    errorMessage = 'Firebase ID token has incorrect algorithm. Expected \"' + ALGORITHM + '\" but got ' +\n      '\"' + header.alg + '\".' + verifyIdTokenDocsMessage;\n  } else if (payload.aud !== this.serviceAccount.project_id) {\n    errorMessage = 'Firebase ID token has incorrect \"aud\" (audience) claim. Expected \"' + this.serviceAccount.project_id +\n      '\" but got \"' + payload.aud + '\".' + projectIdMatchMessage + verifyIdTokenDocsMessage;\n  } else if (payload.iss !== 'https://securetoken.google.com/' + this.serviceAccount.project_id) {\n    errorMessage = 'Firebase ID token has incorrect \"iss\" (issuer) claim. Expected \"https://securetoken.google.com/' +\n      this.serviceAccount.project_id + '\" but got \"' + payload.iss + '\".' + projectIdMatchMessage + verifyIdTokenDocsMessage;\n  } else if (typeof payload.sub !== 'string') {\n    errorMessage = 'Firebase ID token has no \"sub\" (subject) claim.' + verifyIdTokenDocsMessage;\n  } else if (payload.sub === '') {\n    errorMessage = 'Firebase ID token has an empty string \"sub\" (subject) claim.' + verifyIdTokenDocsMessage;\n  } else if (payload.sub.length > 128) {\n    errorMessage = 'Firebase ID token has \"sub\" (subject) claim longer than 128 characters.' + verifyIdTokenDocsMessage;\n  }\n\n  if (typeof errorMessage !== 'undefined') {\n    return firebase.Promise.reject(new Error(errorMessage));\n  }\n\n  return this._fetchPublicKeys().then(function(publicKeys) {\n    if (!publicKeys.hasOwnProperty(header.kid)) {\n      return firebase.Promise.reject('Firebase ID token has \"kid\" claim which does not correspond to ' +\n        'a known public key. Most likely the ID token is expired, so get a fresh token from your client ' +\n        'app and try again.' + verifyIdTokenDocsMessage);\n    }\n\n    return new firebase.Promise(function(resolve, reject) {\n      jwt.verify(idToken, publicKeys[header.kid], {\n        algorithms: [ALGORITHM]\n      }, function(error, decodedToken) {\n        if (error) {\n          if (error.name === 'TokenExpiredError') {\n            error = 'Firebase ID token has expired. Get a fresh token from your client app and try ' +\n              'again.' + verifyIdTokenDocsMessage;\n          } else if (error.name === 'JsonWebTokenError') {\n            error = 'Firebase ID token has invalid signature.' + verifyIdTokenDocsMessage;\n          }\n          reject(error);\n        } else {\n          decodedToken.uid = decodedToken.sub;\n          resolve(decodedToken);\n        }\n      });\n    });\n  });\n};\n\n\nFirebaseTokenGenerator.prototype._fetchPublicKeys = function() {\n  if (typeof this._publicKeys !== 'undefined' && typeof this._publicKeysExpireAt !== 'undefined' && Date.now() < this._publicKeysExpireAt) {\n    return firebase.Promise.resolve(this._publicKeys);\n  }\n\n  var self = this;\n\n  return new firebase.Promise(function(resolve, reject) {\n    https.get(CLIENT_CERT_URL, function(res) {\n      var buffers = [];\n\n      res.on('data', function(buffer) {\n        buffers.push(buffer);\n      });\n\n      res.on('end', function() {\n        try {\n          var response = JSON.parse(Buffer.concat(buffers));\n\n          if (response.error) {\n            var errorMessage = 'Error fetching public keys for Google certs: ' + response.error;\n            if (response.error_description) {\n              errorMessage += ' (' + response.error_description + ')';\n            }\n            reject(new Error(errorMessage));\n          } else {\n            if (res.headers.hasOwnProperty('cache-control')) {\n              var cacheControlHeader = res.headers['cache-control'];\n              var parts = cacheControlHeader.split(',');\n              parts.forEach(function(part) {\n                var subParts = part.trim().split('=');\n                if (subParts[0] === 'max-age') {\n                  var maxAge = subParts[1];\n                  self._publicKeysExpireAt = Date.now() + (maxAge * 1000);\n                }\n              });\n            }\n\n            self._publicKeys = response;\n            resolve(response);\n          }\n        } catch (e) {\n          reject(e);\n        }\n      });\n    }).on('error', reject);\n  });\n};\n\n\nmodule.exports = FirebaseTokenGenerator;\n\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/index.js":"module.exports = {\n  decode: require('./decode'),\n  verify: require('./verify'),\n  sign: require('./sign'),\n  JsonWebTokenError: require('./lib/JsonWebTokenError'),\n  NotBeforeError: require('./lib/NotBeforeError'),\n  TokenExpiredError: require('./lib/TokenExpiredError'),\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/decode.js":"var jws = require('jws');\n\nmodule.exports = function (jwt, options) {\n  options = options || {};\n  var decoded = jws.decode(jwt, options);\n  if (!decoded) { return null; }\n  var payload = decoded.payload;\n\n  //try parse the payload\n  if(typeof payload === 'string') {\n    try {\n      var obj = JSON.parse(payload);\n      if(typeof obj === 'object') {\n        payload = obj;\n      }\n    } catch (e) { }\n  }\n\n  //return header if `complete` option is enabled.  header includes claims\n  //such as `kid` and `alg` used to select the key within a JWKS needed to\n  //verify the signature\n  if (options.complete === true) {\n    return {\n      header: decoded.header,\n      payload: payload,\n      signature: decoded.signature\n    };\n  }\n  return payload;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jws/index.js":"/*global exports*/\nvar SignStream = require('./lib/sign-stream');\nvar VerifyStream = require('./lib/verify-stream');\n\nvar ALGORITHMS = [\n  'HS256', 'HS384', 'HS512',\n  'RS256', 'RS384', 'RS512',\n  'ES256', 'ES384', 'ES512'\n];\n\nexports.ALGORITHMS = ALGORITHMS;\nexports.sign = SignStream.sign;\nexports.verify = VerifyStream.verify;\nexports.decode = VerifyStream.decode;\nexports.isValid = VerifyStream.isValid;\nexports.createSign = function createSign(opts) {\n  return new SignStream(opts);\n};\nexports.createVerify = function createVerify(opts) {\n  return new VerifyStream(opts);\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jws/lib/sign-stream.js":"/*global module*/\nvar base64url = require('base64url');\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\n\nfunction jwsSecuredInput(header, payload, encoding) {\n  encoding = encoding || 'utf8';\n  var encodedHeader = base64url(toString(header), 'binary');\n  var encodedPayload = base64url(toString(payload), encoding);\n  return util.format('%s.%s', encodedHeader, encodedPayload);\n}\n\nfunction jwsSign(opts) {\n  var header = opts.header;\n  var payload = opts.payload;\n  var secretOrKey = opts.secret || opts.privateKey;\n  var encoding = opts.encoding;\n  var algo = jwa(header.alg);\n  var securedInput = jwsSecuredInput(header, payload, encoding);\n  var signature = algo.sign(securedInput, secretOrKey);\n  return util.format('%s.%s', securedInput, signature);\n}\n\nfunction SignStream(opts) {\n  var secret = opts.secret||opts.privateKey||opts.key;\n  var secretStream = new DataStream(secret);\n  this.readable = true;\n  this.header = opts.header;\n  this.encoding = opts.encoding;\n  this.secret = this.privateKey = this.key = secretStream;\n  this.payload = new DataStream(opts.payload);\n  this.secret.once('close', function () {\n    if (!this.payload.writable && this.readable)\n      this.sign();\n  }.bind(this));\n\n  this.payload.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.sign();\n  }.bind(this));\n}\nutil.inherits(SignStream, Stream);\n\nSignStream.prototype.sign = function sign() {\n  try {\n    var signature = jwsSign({\n      header: this.header,\n      payload: this.payload.buffer,\n      secret: this.secret.buffer,\n      encoding: this.encoding\n    });\n    this.emit('done', signature);\n    this.emit('data', signature);\n    this.emit('end');\n    this.readable = false;\n    return signature;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nSignStream.sign = jwsSign;\n\nmodule.exports = SignStream;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/base64url/index.js":"module.exports = require('./dist/base64url').default;\nmodule.exports.default = module.exports;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/base64url/dist/base64url.js":"\"use strict\";\nvar pad_string_1 = require(\"./pad-string\");\nfunction encode(input, encoding) {\n    if (encoding === void 0) { encoding = \"utf8\"; }\n    if (Buffer.isBuffer(input)) {\n        return fromBase64(input.toString(\"base64\"));\n    }\n    return fromBase64(new Buffer(input, encoding).toString(\"base64\"));\n}\n;\nfunction decode(base64url, encoding) {\n    if (encoding === void 0) { encoding = \"utf8\"; }\n    return new Buffer(toBase64(base64url), \"base64\").toString(encoding);\n}\nfunction toBase64(base64url) {\n    base64url = base64url.toString();\n    return pad_string_1.default(base64url)\n        .replace(/\\-/g, \"+\")\n        .replace(/_/g, \"/\");\n}\nfunction fromBase64(base64) {\n    return base64\n        .replace(/=/g, \"\")\n        .replace(/\\+/g, \"-\")\n        .replace(/\\//g, \"_\");\n}\nfunction toBuffer(base64url) {\n    return new Buffer(toBase64(base64url), \"base64\");\n}\nvar base64url = encode;\nbase64url.encode = encode;\nbase64url.decode = decode;\nbase64url.toBase64 = toBase64;\nbase64url.fromBase64 = fromBase64;\nbase64url.toBuffer = toBuffer;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = base64url;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/base64url/dist/pad-string.js":"\"use strict\";\nfunction padString(input) {\n    var segmentLength = 4;\n    var stringLength = input.length;\n    var diff = stringLength % segmentLength;\n    if (!diff) {\n        return input;\n    }\n    var position = stringLength;\n    var padLength = segmentLength - diff;\n    var paddedStringLength = stringLength + padLength;\n    var buffer = new Buffer(paddedStringLength);\n    buffer.write(input);\n    while (padLength--) {\n        buffer.write(\"=\", position++);\n    }\n    return buffer.toString();\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = padString;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jws/lib/data-stream.js":"/*global module, process*/\nvar Buffer = require('safe-buffer').Buffer;\nvar Stream = require('stream');\nvar util = require('util');\n\nfunction DataStream(data) {\n  this.buffer = null;\n  this.writable = true;\n  this.readable = true;\n\n  // No input\n  if (!data) {\n    this.buffer = Buffer.alloc(0);\n    return this;\n  }\n\n  // Stream\n  if (typeof data.pipe === 'function') {\n    this.buffer = Buffer.alloc(0);\n    data.pipe(this);\n    return this;\n  }\n\n  // Buffer or String\n  // or Object (assumedly a passworded key)\n  if (data.length || typeof data === 'object') {\n    this.buffer = data;\n    this.writable = false;\n    process.nextTick(function () {\n      this.emit('end', data);\n      this.readable = false;\n      this.emit('close');\n    }.bind(this));\n    return this;\n  }\n\n  throw new TypeError('Unexpected data type ('+ typeof data + ')');\n}\nutil.inherits(DataStream, Stream);\n\nDataStream.prototype.write = function write(data) {\n  this.buffer = Buffer.concat([this.buffer, Buffer.from(data)]);\n  this.emit('data', data);\n};\n\nDataStream.prototype.end = function end(data) {\n  if (data)\n    this.write(data);\n  this.emit('end', data);\n  this.emit('close');\n  this.writable = false;\n  this.readable = false;\n};\n\nmodule.exports = DataStream;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/safe-buffer/index.js":"var buffer = require('buffer')\n\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  Object.keys(buffer).forEach(function (prop) {\n    exports[prop] = buffer[prop]\n  })\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\nObject.keys(Buffer).forEach(function (prop) {\n  SafeBuffer[prop] = Buffer[prop]\n})\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jwa/index.js":"var bufferEqual = require('buffer-equal-constant-time');\nvar base64url = require('base64url');\nvar Buffer = require('safe-buffer').Buffer;\nvar crypto = require('crypto');\nvar formatEcdsa = require('ecdsa-sig-formatter');\nvar util = require('util');\n\nvar MSG_INVALID_ALGORITHM = '\"%s\" is not a valid algorithm.\\n  Supported algorithms are:\\n  \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\" and \"none\".'\nvar MSG_INVALID_SECRET = 'secret must be a string or buffer';\nvar MSG_INVALID_VERIFIER_KEY = 'key must be a string or a buffer';\nvar MSG_INVALID_SIGNER_KEY = 'key must be a string, a buffer or an object';\n\nfunction typeError(template) {\n  var args = [].slice.call(arguments, 1);\n  var errMsg = util.format.bind(util, template).apply(null, args);\n  return new TypeError(errMsg);\n}\n\nfunction bufferOrString(obj) {\n  return Buffer.isBuffer(obj) || typeof obj === 'string';\n}\n\nfunction normalizeInput(thing) {\n  if (!bufferOrString(thing))\n    thing = JSON.stringify(thing);\n  return thing;\n}\n\nfunction createHmacSigner(bits) {\n  return function sign(thing, secret) {\n    if (!bufferOrString(secret))\n      throw typeError(MSG_INVALID_SECRET);\n    thing = normalizeInput(thing);\n    var hmac = crypto.createHmac('sha' + bits, secret);\n    var sig = (hmac.update(thing), hmac.digest('base64'))\n    return base64url.fromBase64(sig);\n  }\n}\n\nfunction createHmacVerifier(bits) {\n  return function verify(thing, signature, secret) {\n    var computedSig = createHmacSigner(bits)(thing, secret);\n    return bufferEqual(Buffer.from(signature), Buffer.from(computedSig));\n  }\n}\n\nfunction createKeySigner(bits) {\n return function sign(thing, privateKey) {\n    if (!bufferOrString(privateKey) && !(typeof privateKey === 'object'))\n      throw typeError(MSG_INVALID_SIGNER_KEY);\n    thing = normalizeInput(thing);\n    // Even though we are specifying \"RSA\" here, this works with ECDSA\n    // keys as well.\n    var signer = crypto.createSign('RSA-SHA' + bits);\n    var sig = (signer.update(thing), signer.sign(privateKey, 'base64'));\n    return base64url.fromBase64(sig);\n  }\n}\n\nfunction createKeyVerifier(bits) {\n  return function verify(thing, signature, publicKey) {\n    if (!bufferOrString(publicKey))\n      throw typeError(MSG_INVALID_VERIFIER_KEY);\n    thing = normalizeInput(thing);\n    signature = base64url.toBase64(signature);\n    var verifier = crypto.createVerify('RSA-SHA' + bits);\n    verifier.update(thing);\n    return verifier.verify(publicKey, signature, 'base64');\n  }\n}\n\nfunction createECDSASigner(bits) {\n  var inner = createKeySigner(bits);\n  return function sign() {\n    var signature = inner.apply(null, arguments);\n    signature = formatEcdsa.derToJose(signature, 'ES' + bits);\n    return signature;\n  };\n}\n\nfunction createECDSAVerifer(bits) {\n  var inner = createKeyVerifier(bits);\n  return function verify(thing, signature, publicKey) {\n    signature = formatEcdsa.joseToDer(signature, 'ES' + bits).toString('base64');\n    var result = inner(thing, signature, publicKey);\n    return result;\n  };\n}\n\nfunction createNoneSigner() {\n  return function sign() {\n    return '';\n  }\n}\n\nfunction createNoneVerifier() {\n  return function verify(thing, signature) {\n    return signature === '';\n  }\n}\n\nmodule.exports = function jwa(algorithm) {\n  var signerFactories = {\n    hs: createHmacSigner,\n    rs: createKeySigner,\n    es: createECDSASigner,\n    none: createNoneSigner,\n  }\n  var verifierFactories = {\n    hs: createHmacVerifier,\n    rs: createKeyVerifier,\n    es: createECDSAVerifer,\n    none: createNoneVerifier,\n  }\n  var match = algorithm.match(/^(RS|ES|HS)(256|384|512)$|^(none)$/i);\n  if (!match)\n    throw typeError(MSG_INVALID_ALGORITHM, algorithm);\n  var algo = (match[1] || match[3]).toLowerCase();\n  var bits = match[2];\n\n  return {\n    sign: signerFactories[algo](bits),\n    verify: verifierFactories[algo](bits),\n  }\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/buffer-equal-constant-time/index.js":"/*jshint node:true */\n'use strict';\nvar Buffer = require('buffer').Buffer; // browserify\nvar SlowBuffer = require('buffer').SlowBuffer;\n\nmodule.exports = bufferEq;\n\nfunction bufferEq(a, b) {\n\n  // shortcutting on type is necessary for correctness\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    return false;\n  }\n\n  // buffer sizes should be well-known information, so despite this\n  // shortcutting, it doesn't leak any information about the *contents* of the\n  // buffers.\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  var c = 0;\n  for (var i = 0; i < a.length; i++) {\n    /*jshint bitwise:false */\n    c |= a[i] ^ b[i]; // XOR\n  }\n  return c === 0;\n}\n\nbufferEq.install = function() {\n  Buffer.prototype.equal = SlowBuffer.prototype.equal = function equal(that) {\n    return bufferEq(this, that);\n  };\n};\n\nvar origBufEqual = Buffer.prototype.equal;\nvar origSlowBufEqual = SlowBuffer.prototype.equal;\nbufferEq.restore = function() {\n  Buffer.prototype.equal = origBufEqual;\n  SlowBuffer.prototype.equal = origSlowBufEqual;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/ecdsa-sig-formatter/src/ecdsa-sig-formatter.js":"'use strict';\n\nvar base64Url = require('base64url').fromBase64;\nvar Buffer = require('safe-buffer').Buffer;\n\nvar getParamBytesForAlg = require('./param-bytes-for-alg');\n\nvar MAX_OCTET = 0x80,\n\tCLASS_UNIVERSAL = 0,\n\tPRIMITIVE_BIT = 0x20,\n\tTAG_SEQ = 0x10,\n\tTAG_INT = 0x02,\n\tENCODED_TAG_SEQ = (TAG_SEQ | PRIMITIVE_BIT) | (CLASS_UNIVERSAL << 6),\n\tENCODED_TAG_INT = TAG_INT | (CLASS_UNIVERSAL << 6);\n\nfunction signatureAsBuffer(signature) {\n\tif (Buffer.isBuffer(signature)) {\n\t\treturn signature;\n\t} else if ('string' === typeof signature) {\n\t\treturn Buffer.from(signature, 'base64');\n\t}\n\n\tthrow new TypeError('ECDSA signature must be a Base64 string or a Buffer');\n}\n\nfunction derToJose(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\t// the DER encoded param should at most be the param size, plus a padding\n\t// zero, since due to being a signed integer\n\tvar maxEncodedParamLength = paramBytes + 1;\n\n\tvar inputLength = signature.length;\n\n\tvar offset = 0;\n\tif (signature[offset++] !== ENCODED_TAG_SEQ) {\n\t\tthrow new Error('Could not find expected \"seq\"');\n\t}\n\n\tvar seqLength = signature[offset++];\n\tif (seqLength === (MAX_OCTET | 1)) {\n\t\tseqLength = signature[offset++];\n\t}\n\n\tif (inputLength - offset < seqLength) {\n\t\tthrow new Error('\"seq\" specified length of \"' + seqLength + '\", only \"' + (inputLength - offset) + '\" remaining');\n\t}\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"r\"');\n\t}\n\n\tvar rLength = signature[offset++];\n\n\tif (inputLength - offset - 2 < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", only \"' + (inputLength - offset - 2) + '\" available');\n\t}\n\n\tif (maxEncodedParamLength < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar rOffset = offset;\n\toffset += rLength;\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"s\"');\n\t}\n\n\tvar sLength = signature[offset++];\n\n\tif (inputLength - offset !== sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", expected \"' + (inputLength - offset) + '\"');\n\t}\n\n\tif (maxEncodedParamLength < sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar sOffset = offset;\n\toffset += sLength;\n\n\tif (offset !== inputLength) {\n\t\tthrow new Error('Expected to consume entire buffer, but \"' + (inputLength - offset) + '\" bytes remain');\n\t}\n\n\tvar rPadding = paramBytes - rLength,\n\t\tsPadding = paramBytes - sLength;\n\n\tvar dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength);\n\n\tfor (offset = 0; offset < rPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, rOffset + Math.max(-rPadding, 0), rOffset + rLength);\n\n\toffset = paramBytes;\n\n\tfor (var o = offset; offset < o + sPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, sOffset + Math.max(-sPadding, 0), sOffset + sLength);\n\n\tdst = dst.toString('base64');\n\tdst = base64Url(dst);\n\n\treturn dst;\n}\n\nfunction countPadding(buf, start, stop) {\n\tvar padding = 0;\n\twhile (start + padding < stop && buf[start + padding] === 0) {\n\t\t++padding;\n\t}\n\n\tvar needsSign = buf[start + padding] >= MAX_OCTET;\n\tif (needsSign) {\n\t\t--padding;\n\t}\n\n\treturn padding;\n}\n\nfunction joseToDer(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\tvar signatureBytes = signature.length;\n\tif (signatureBytes !== paramBytes * 2) {\n\t\tthrow new TypeError('\"' + alg + '\" signatures must be \"' + paramBytes * 2 + '\" bytes, saw \"' + signatureBytes + '\"');\n\t}\n\n\tvar rPadding = countPadding(signature, 0, paramBytes);\n\tvar sPadding = countPadding(signature, paramBytes, signature.length);\n\tvar rLength = paramBytes - rPadding;\n\tvar sLength = paramBytes - sPadding;\n\n\tvar rsBytes = 1 + 1 + rLength + 1 + 1 + sLength;\n\n\tvar shortLength = rsBytes < MAX_OCTET;\n\n\tvar dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes);\n\n\tvar offset = 0;\n\tdst[offset++] = ENCODED_TAG_SEQ;\n\tif (shortLength) {\n\t\t// Bit 8 has value \"0\"\n\t\t// bits 7-1 give the length.\n\t\tdst[offset++] = rsBytes;\n\t} else {\n\t\t// Bit 8 of first octet has value \"1\"\n\t\t// bits 7-1 give the number of additional length octets.\n\t\tdst[offset++] = MAX_OCTET\t| 1;\n\t\t// length, base 256\n\t\tdst[offset++] = rsBytes & 0xff;\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = rLength;\n\tif (rPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\toffset += signature.copy(dst, offset, 0, paramBytes);\n\t} else {\n\t\toffset += signature.copy(dst, offset, rPadding, paramBytes);\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = sLength;\n\tif (sPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\tsignature.copy(dst, offset, paramBytes);\n\t} else {\n\t\tsignature.copy(dst, offset, paramBytes + sPadding);\n\t}\n\n\treturn dst;\n}\n\nmodule.exports = {\n\tderToJose: derToJose,\n\tjoseToDer: joseToDer\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/ecdsa-sig-formatter/src/param-bytes-for-alg.js":"'use strict';\n\nfunction getParamSize(keySize) {\n\tvar result = ((keySize / 8) | 0) + (keySize % 8 === 0 ? 0 : 1);\n\treturn result;\n}\n\nvar paramBytesForAlg = {\n\tES256: getParamSize(256),\n\tES384: getParamSize(384),\n\tES512: getParamSize(521)\n};\n\nfunction getParamBytesForAlg(alg) {\n\tvar paramBytes = paramBytesForAlg[alg];\n\tif (paramBytes) {\n\t\treturn paramBytes;\n\t}\n\n\tthrow new Error('Unknown algorithm \"' + alg + '\"');\n}\n\nmodule.exports = getParamBytesForAlg;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jws/lib/tostring.js":"/*global module*/\nvar Buffer = require('buffer').Buffer;\n\nmodule.exports = function toString(obj) {\n  if (typeof obj === 'string')\n    return obj;\n  if (typeof obj === 'number' || Buffer.isBuffer(obj))\n    return obj.toString();\n  return JSON.stringify(obj);\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jws/lib/verify-stream.js":"/*global module*/\nvar base64url = require('base64url');\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction safeJsonParse(thing) {\n  if (isObject(thing))\n    return thing;\n  try { return JSON.parse(thing); }\n  catch (e) { return undefined; }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(base64url.decode(encodedHeader, 'binary'));\n}\n\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\n\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\n\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return base64url.decode(payload, encoding);\n}\n\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\n\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\n\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n\n  if (!isValidJws(jwsSig))\n    return null;\n\n  var header = headerFromJWS(jwsSig);\n\n  if (!header)\n    return null;\n\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json)\n    payload = JSON.parse(payload, opts.encoding);\n\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\n\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret||opts.publicKey||opts.key;\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable)\n      this.verify();\n  }.bind(this));\n\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\n\nmodule.exports = VerifyStream;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/verify.js":"var JsonWebTokenError = require('./lib/JsonWebTokenError');\nvar NotBeforeError    = require('./lib/NotBeforeError');\nvar TokenExpiredError = require('./lib/TokenExpiredError');\nvar decode            = require('./decode');\nvar jws               = require('jws');\nvar ms                = require('ms');\nvar xtend             = require('xtend');\n\nmodule.exports = function (jwtString, secretOrPublicKey, options, callback) {\n  if ((typeof options === 'function') && !callback) {\n    callback = options;\n    options = {};\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  //clone this object since we are going to mutate it.\n  options = xtend(options);\n  var done;\n\n  if (callback) {\n    done = function() {\n      var args = Array.prototype.slice.call(arguments, 0);\n      return process.nextTick(function() {\n        callback.apply(null, args);\n      });\n    };\n  } else {\n    done = function(err, data) {\n      if (err) throw err;\n      return data;\n    };\n  }\n\n  if (options.clockTimestamp && typeof options.clockTimestamp !== 'number') {\n    return done(new JsonWebTokenError('clockTimestamp must be a number'));\n  }\n\n  var clockTimestamp = options.clockTimestamp || Math.floor(Date.now() / 1000);\n\n  if (!jwtString){\n    return done(new JsonWebTokenError('jwt must be provided'));\n  }\n\n  if (typeof jwtString !== 'string') {\n    return done(new JsonWebTokenError('jwt must be a string'));\n  }\n\n  var parts = jwtString.split('.');\n\n  if (parts.length !== 3){\n    return done(new JsonWebTokenError('jwt malformed'));\n  }\n\n  var hasSignature = parts[2].trim() !== '';\n\n  if (!hasSignature && secretOrPublicKey){\n    return done(new JsonWebTokenError('jwt signature is required'));\n  }\n\n  if (hasSignature && !secretOrPublicKey) {\n    return done(new JsonWebTokenError('secret or public key must be provided'));\n  }\n\n  if (!hasSignature && !options.algorithms) {\n    options.algorithms = ['none'];\n  }\n\n  if (!options.algorithms) {\n    options.algorithms = ~secretOrPublicKey.toString().indexOf('BEGIN CERTIFICATE') ||\n                         ~secretOrPublicKey.toString().indexOf('BEGIN PUBLIC KEY') ?\n                          [ 'RS256','RS384','RS512','ES256','ES384','ES512' ] :\n                         ~secretOrPublicKey.toString().indexOf('BEGIN RSA PUBLIC KEY') ?\n                          [ 'RS256','RS384','RS512' ] :\n                          [ 'HS256','HS384','HS512' ];\n\n  }\n\n  var decodedToken;\n  try {\n    decodedToken = jws.decode(jwtString);\n  } catch(err) {\n    return done(err);\n  }\n\n  if (!decodedToken) {\n    return done(new JsonWebTokenError('invalid token'));\n  }\n\n  var header = decodedToken.header;\n\n  if (!~options.algorithms.indexOf(header.alg)) {\n    return done(new JsonWebTokenError('invalid algorithm'));\n  }\n\n  var valid;\n\n  try {\n    valid = jws.verify(jwtString, header.alg, secretOrPublicKey);\n  } catch (e) {\n    return done(e);\n  }\n\n  if (!valid)\n    return done(new JsonWebTokenError('invalid signature'));\n\n  var payload;\n\n  try {\n    payload = decode(jwtString);\n  } catch(err) {\n    return done(err);\n  }\n\n  if (typeof payload.nbf !== 'undefined' && !options.ignoreNotBefore) {\n    if (typeof payload.nbf !== 'number') {\n      return done(new JsonWebTokenError('invalid nbf value'));\n    }\n    if (payload.nbf > clockTimestamp + (options.clockTolerance || 0)) {\n      return done(new NotBeforeError('jwt not active', new Date(payload.nbf * 1000)));\n    }\n  }\n\n  if (typeof payload.exp !== 'undefined' && !options.ignoreExpiration) {\n    if (typeof payload.exp !== 'number') {\n      return done(new JsonWebTokenError('invalid exp value'));\n    }\n    if (clockTimestamp >= payload.exp + (options.clockTolerance || 0)) {\n      return done(new TokenExpiredError('jwt expired', new Date(payload.exp * 1000)));\n    }\n  }\n\n  if (options.audience) {\n    var audiences = Array.isArray(options.audience)? options.audience : [options.audience];\n    var target = Array.isArray(payload.aud) ? payload.aud : [payload.aud];\n\n    var match = target.some(function(aud) { return audiences.indexOf(aud) != -1; });\n\n    if (!match)\n      return done(new JsonWebTokenError('jwt audience invalid. expected: ' + audiences.join(' or ')));\n  }\n\n  if (options.issuer) {\n    var invalid_issuer =\n        (typeof options.issuer === 'string' && payload.iss !== options.issuer) ||\n        (Array.isArray(options.issuer) && options.issuer.indexOf(payload.iss) === -1);\n\n    if (invalid_issuer) {\n      return done(new JsonWebTokenError('jwt issuer invalid. expected: ' + options.issuer));\n    }\n  }\n\n  if (options.subject) {\n    if (payload.sub !== options.subject) {\n      return done(new JsonWebTokenError('jwt subject invalid. expected: ' + options.subject));\n    }\n  }\n\n  if (options.jwtid) {\n    if (payload.jti !== options.jwtid) {\n      return done(new JsonWebTokenError('jwt jwtid invalid. expected: ' + options.jwtid));\n    }\n  }\n\n  if (options.maxAge) {\n    var maxAge = ms(options.maxAge);\n    if (typeof payload.iat !== 'number') {\n      return done(new JsonWebTokenError('iat required when maxAge is specified'));\n    }\n    // We have to compare against either options.clockTimestamp or the currentDate _with_ millis\n    // to not change behaviour (version 7.2.1). Should be resolve somehow for next major.\n    var nowOrClockTimestamp = ((options.clockTimestamp || 0) * 1000) || Date.now();\n    if (nowOrClockTimestamp - (payload.iat * 1000) > maxAge + (options.clockTolerance || 0) * 1000) {\n      return done(new TokenExpiredError('maxAge exceeded', new Date(payload.iat * 1000 + maxAge)));\n    }\n  }\n\n  return done(null, payload);\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/lib/JsonWebTokenError.js":"var JsonWebTokenError = function (message, error) {\n  Error.call(this, message);\n  Error.captureStackTrace(this, this.constructor);\n  this.name = 'JsonWebTokenError';\n  this.message = message;\n  if (error) this.inner = error;\n};\n\nJsonWebTokenError.prototype = Object.create(Error.prototype);\nJsonWebTokenError.prototype.constructor = JsonWebTokenError;\n\nmodule.exports = JsonWebTokenError;","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/lib/NotBeforeError.js":"var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar NotBeforeError = function (message, date) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'NotBeforeError';\n  this.date = date;\n};\n\nNotBeforeError.prototype = Object.create(JsonWebTokenError.prototype);\n\nNotBeforeError.prototype.constructor = NotBeforeError;\n\nmodule.exports = NotBeforeError;","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/lib/TokenExpiredError.js":"var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar TokenExpiredError = function (message, expiredAt) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'TokenExpiredError';\n  this.expiredAt = expiredAt;\n};\n\nTokenExpiredError.prototype = Object.create(JsonWebTokenError.prototype);\n\nTokenExpiredError.prototype.constructor = TokenExpiredError;\n\nmodule.exports = TokenExpiredError;","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/ms/index.js":"/**\n * Helpers.\n */\n\nvar s = 1000\nvar m = s * 60\nvar h = m * 60\nvar d = h * 24\nvar y = d * 365.25\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {}\n  var type = typeof val\n  if (type === 'string' && val.length > 0) {\n    return parse(val)\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ?\n\t\t\tfmtLong(val) :\n\t\t\tfmtShort(val)\n  }\n  throw new Error('val is not a non-empty string or a valid number. val=' + JSON.stringify(val))\n}\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str)\n  if (str.length > 10000) {\n    return\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str)\n  if (!match) {\n    return\n  }\n  var n = parseFloat(match[1])\n  var type = (match[2] || 'ms').toLowerCase()\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n\n    default:\n      return undefined\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd'\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h'\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm'\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's'\n  }\n  return ms + 'ms'\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms'\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's'\n}\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/xtend/immutable.js":"module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/sign.js":"var Joi = require('joi');\nvar timespan = require('./lib/timespan');\nvar xtend = require('xtend');\nvar jws = require('jws');\nvar once = require('lodash.once');\n\nvar sign_options_schema = Joi.object().keys({\n  expiresIn: [Joi.number().integer(), Joi.string()],\n  notBefore: [Joi.number().integer(), Joi.string()],\n  audience: [Joi.string(), Joi.array()],\n  algorithm: Joi.string().valid('RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'none'),\n  header: Joi.object(),\n  encoding: Joi.string(),\n  issuer: Joi.string(),\n  subject: Joi.string(),\n  jwtid: Joi.string(),\n  noTimestamp: Joi.boolean(),\n  keyid: Joi.string()\n});\n\nvar registered_claims_schema = Joi.object().keys({\n  iat: Joi.number(),\n  exp: Joi.number(),\n  nbf: Joi.number()\n}).unknown();\n\n\nvar options_to_payload = {\n  'audience': 'aud',\n  'issuer': 'iss',\n  'subject': 'sub',\n  'jwtid': 'jti'\n};\n\nvar options_for_objects = [\n  'expiresIn',\n  'notBefore',\n  'noTimestamp',\n  'audience',\n  'issuer',\n  'subject',\n  'jwtid',\n];\n\nmodule.exports = function (payload, secretOrPrivateKey, options, callback) {\n  options = options || {};\n\n  var isObjectPayload = typeof payload === 'object' &&\n                        !Buffer.isBuffer(payload);\n\n  var header = xtend({\n    alg: options.algorithm || 'HS256',\n    typ: isObjectPayload ? 'JWT' : undefined,\n    kid: options.keyid\n  }, options.header);\n\n  function failure(err) {\n    if (callback) {\n      return callback(err);\n    }\n    throw err;\n  }\n\n\n  if (typeof payload === 'undefined') {\n    return failure(new Error('payload is required'));\n  } else if (isObjectPayload) {\n    var payload_validation_result = registered_claims_schema.validate(payload);\n\n    if (payload_validation_result.error) {\n      return failure(payload_validation_result.error);\n    }\n\n    payload = xtend(payload);\n  } else {\n    var invalid_options = options_for_objects.filter(function (opt) {\n      return typeof options[opt] !== 'undefined';\n    });\n\n    if (invalid_options.length > 0) {\n      return failure(new Error('invalid ' + invalid_options.join(',') + ' option for ' + (typeof payload ) + ' payload'));\n    }\n  }\n\n  if (typeof payload.exp !== 'undefined' && typeof options.expiresIn !== 'undefined') {\n    return failure(new Error('Bad \"options.expiresIn\" option the payload already has an \"exp\" property.'));\n  }\n\n  if (typeof payload.nbf !== 'undefined' && typeof options.notBefore !== 'undefined') {\n    return failure(new Error('Bad \"options.notBefore\" option the payload already has an \"nbf\" property.'));\n  }\n\n  var validation_result = sign_options_schema.validate(options);\n\n  if (validation_result.error) {\n    return failure(validation_result.error);\n  }\n\n  var timestamp = payload.iat || Math.floor(Date.now() / 1000);\n\n  if (!options.noTimestamp) {\n    payload.iat = timestamp;\n  } else {\n    delete payload.iat;\n  }\n\n  if (typeof options.notBefore !== 'undefined') {\n    payload.nbf = timespan(options.notBefore);\n    if (typeof payload.nbf === 'undefined') {\n      return failure(new Error('\"notBefore\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  if (typeof options.expiresIn !== 'undefined' && typeof payload === 'object') {\n    payload.exp = timespan(options.expiresIn, timestamp);\n    if (typeof payload.exp === 'undefined') {\n      return failure(new Error('\"expiresIn\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  Object.keys(options_to_payload).forEach(function (key) {\n    var claim = options_to_payload[key];\n    if (typeof options[key] !== 'undefined') {\n      if (typeof payload[claim] !== 'undefined') {\n        return failure(new Error('Bad \"options.' + key + '\" option. The payload already has an \"' + claim + '\" property.'));\n      }\n      payload[claim] = options[key];\n    }\n  });\n\n  var encoding = options.encoding || 'utf8';\n\n  if (typeof callback === 'function') {\n    callback = callback && once(callback);\n\n    jws.createSign({\n      header: header,\n      privateKey: secretOrPrivateKey,\n      payload: payload,\n      encoding: encoding\n    }).once('error', callback)\n      .once('done', function (signature) {\n        callback(null, signature);\n      });\n  } else {\n    return jws.sign({header: header, payload: payload, secret: secretOrPrivateKey, encoding: encoding});\n  }\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/index.js":"// Load modules\n\nvar Any = require('./any');\nvar Cast = require('./cast');\nvar Ref = require('./ref');\n\n\n// Declare internals\n\nvar internals = {\n    alternatives: require('./alternatives'),\n    array: require('./array'),\n    boolean: require('./boolean'),\n    binary: require('./binary'),\n    date: require('./date'),\n    number: require('./number'),\n    object: require('./object'),\n    string: require('./string')\n};\n\n\ninternals.root = function () {\n\n    var any = new Any();\n\n    var root = any.clone();\n    root.any = function () {\n\n        return any;\n    };\n\n    root.alternatives = root.alt = function () {\n\n        return arguments.length ? internals.alternatives.try.apply(internals.alternatives, arguments) : internals.alternatives;\n    };\n\n    root.array = function () {\n\n        return internals.array;\n    };\n\n    root.boolean = root.bool = function () {\n\n        return internals.boolean;\n    };\n\n    root.binary = function () {\n\n        return internals.binary;\n    };\n\n    root.date = function () {\n\n        return internals.date;\n    };\n\n    root.func = function () {\n\n        return internals.object._func();\n    };\n\n    root.number = function () {\n\n        return internals.number;\n    };\n\n    root.object = function () {\n\n        return arguments.length ? internals.object.keys.apply(internals.object, arguments) : internals.object;\n    };\n\n    root.string = function () {\n\n        return internals.string;\n    };\n\n    root.ref = function () {\n\n        return Ref.create.apply(null, arguments);\n    };\n\n    root.isRef = function (ref) {\n\n        return Ref.isRef(ref);\n    };\n\n    root.validate = function (value /*, [schema], [options], callback */) {\n\n        var last = arguments[arguments.length - 1];\n        var callback = typeof last === 'function' ? last : null;\n\n        var count = arguments.length - (callback ? 1 : 0);\n        if (count === 1) {\n            return any.validate(value, callback);\n        }\n\n        var options = count === 3 ? arguments[2] : {};\n        var schema = root.compile(arguments[1]);\n\n        return schema._validateWithOptions(value, options, callback);\n    };\n\n    root.describe = function () {\n\n        var schema = arguments.length ? root.compile(arguments[0]) : any;\n        return schema.describe();\n    };\n\n    root.compile = function (schema) {\n\n        try {\n            return Cast.schema(schema);\n        }\n        catch (err) {\n            if (err.hasOwnProperty('path')) {\n                err.message += '(' + err.path + ')';\n            }\n            throw err;\n        }\n    };\n\n    root.assert = function (value, schema, message) {\n\n        root.attempt(value, schema, message);\n    };\n\n    root.attempt = function (value, schema, message) {\n\n        var result = root.validate(value, schema);\n        var error = result.error;\n        if (error) {\n            if (!message) {\n                error.message = error.annotate();\n                throw error;\n            }\n\n            if (!(message instanceof Error)) {\n                error.message = message + ' ' + error.annotate();\n                throw error;\n            }\n\n            throw message;\n        }\n\n        return result.value;\n    };\n\n    return root;\n};\n\n\nmodule.exports = internals.root();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/any.js":"// Load modules\n\nvar Hoek = require('hoek');\nvar Ref = require('./ref');\nvar Errors = require('./errors');\nvar Alternatives = null;                // Delay-loaded to prevent circular dependencies\nvar Cast = null;\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.defaults = {\n    abortEarly: true,\n    convert: true,\n    allowUnknown: false,\n    skipFunctions: false,\n    stripUnknown: false,\n    language: {},\n    presence: 'optional',\n    raw: false,\n    strip: false,\n    noDefaults: false\n\n    // context: null\n};\n\n\ninternals.checkOptions = function (options) {\n\n    var optionType = {\n        abortEarly: 'boolean',\n        convert: 'boolean',\n        allowUnknown: 'boolean',\n        skipFunctions: 'boolean',\n        stripUnknown: 'boolean',\n        language: 'object',\n        presence: ['string', 'required', 'optional', 'forbidden', 'ignore'],\n        raw: 'boolean',\n        context: 'object',\n        strip: 'boolean',\n        noDefaults: 'boolean'\n    };\n\n    var keys = Object.keys(options);\n    for (var k = 0, kl = keys.length; k < kl; ++k) {\n        var key = keys[k];\n        var opt = optionType[key];\n        var type = opt;\n        var values = null;\n\n        if (Array.isArray(opt)) {\n            type = opt[0];\n            values = opt.slice(1);\n        }\n\n        Hoek.assert(type, 'unknown key ' + key);\n        Hoek.assert(typeof options[key] === type, key + ' should be of type ' + type);\n        if (values) {\n            Hoek.assert(values.indexOf(options[key]) >= 0, key + ' should be one of ' + values.join(', '));\n        }\n    }\n};\n\n\nmodule.exports = internals.Any = function () {\n\n    Cast = Cast || require('./cast');\n\n    this.isJoi = true;\n    this._type = 'any';\n    this._settings = null;\n    this._valids = new internals.Set();\n    this._invalids = new internals.Set();\n    this._tests = [];\n    this._refs = [];\n    this._flags = { /*\n        presence: 'optional',                   // optional, required, forbidden, ignore\n        allowOnly: false,\n        allowUnknown: undefined,\n        default: undefined,\n        forbidden: false,\n        encoding: undefined,\n        insensitive: false,\n        trim: false,\n        case: undefined,                        // upper, lower\n        empty: undefined,\n        func: false\n    */ };\n\n    this._description = null;\n    this._unit = null;\n    this._notes = [];\n    this._tags = [];\n    this._examples = [];\n    this._meta = [];\n\n    this._inner = {};                           // Hash of arrays of immutable objects\n};\n\n\ninternals.Any.prototype.isImmutable = true;     // Prevents Hoek from deep cloning schema objects\n\n\ninternals.Any.prototype.clone = function () {\n\n    var obj = Object.create(Object.getPrototypeOf(this));\n\n    obj.isJoi = true;\n    obj._type = this._type;\n    obj._settings = internals.concatSettings(this._settings);\n    obj._valids = Hoek.clone(this._valids);\n    obj._invalids = Hoek.clone(this._invalids);\n    obj._tests = this._tests.slice();\n    obj._refs = this._refs.slice();\n    obj._flags = Hoek.clone(this._flags);\n\n    obj._description = this._description;\n    obj._unit = this._unit;\n    obj._notes = this._notes.slice();\n    obj._tags = this._tags.slice();\n    obj._examples = this._examples.slice();\n    obj._meta = this._meta.slice();\n\n    obj._inner = {};\n    var inners = Object.keys(this._inner);\n    for (var i = 0, il = inners.length; i < il; ++i) {\n        var key = inners[i];\n        obj._inner[key] = this._inner[key] ? this._inner[key].slice() : null;\n    }\n\n    return obj;\n};\n\n\ninternals.Any.prototype.concat = function (schema) {\n\n    Hoek.assert(schema && schema.isJoi, 'Invalid schema object');\n    Hoek.assert(this._type === 'any' || schema._type === 'any' || schema._type === this._type, 'Cannot merge type', this._type, 'with another type:', schema._type);\n\n    var obj = this.clone();\n\n    if (this._type === 'any' && schema._type !== 'any') {\n\n        // Reset values as if we were \"this\"\n        var tmpObj = schema.clone();\n        var keysToRestore = ['_settings', '_valids', '_invalids', '_tests', '_refs', '_flags', '_description', '_unit',\n            '_notes', '_tags', '_examples', '_meta', '_inner'];\n\n        for (var j = 0, jl = keysToRestore.length; j < jl; ++j) {\n            tmpObj[keysToRestore[j]] = obj[keysToRestore[j]];\n        }\n\n        obj = tmpObj;\n    }\n\n    obj._settings = obj._settings ? internals.concatSettings(obj._settings, schema._settings) : schema._settings;\n    obj._valids.merge(schema._valids, schema._invalids);\n    obj._invalids.merge(schema._invalids, schema._valids);\n    obj._tests = obj._tests.concat(schema._tests);\n    obj._refs = obj._refs.concat(schema._refs);\n    Hoek.merge(obj._flags, schema._flags);\n\n    obj._description = schema._description || obj._description;\n    obj._unit = schema._unit || obj._unit;\n    obj._notes = obj._notes.concat(schema._notes);\n    obj._tags = obj._tags.concat(schema._tags);\n    obj._examples = obj._examples.concat(schema._examples);\n    obj._meta = obj._meta.concat(schema._meta);\n\n    var inners = Object.keys(schema._inner);\n    var isObject = obj._type === 'object';\n    for (var i = 0, il = inners.length; i < il; ++i) {\n        var key = inners[i];\n        var source = schema._inner[key];\n        if (source) {\n            var target = obj._inner[key];\n            if (target) {\n                if (isObject && key === 'children') {\n                    var keys = {};\n\n                    for (var k = 0, kl = target.length; k < kl; ++k) {\n                        keys[target[k].key] = k;\n                    }\n\n                    for (k = 0, kl = source.length; k < kl; ++k) {\n                        var sourceKey = source[k].key;\n                        if (keys[sourceKey] >= 0) {\n                            target[keys[sourceKey]] = {\n                                key: sourceKey,\n                                schema: target[keys[sourceKey]].schema.concat(source[k].schema)\n                            };\n                        }\n                        else {\n                            target.push(source[k]);\n                        }\n                    }\n                }\n                else {\n                    obj._inner[key] = obj._inner[key].concat(source);\n                }\n            }\n            else {\n                obj._inner[key] = source.slice();\n            }\n        }\n    }\n\n    return obj;\n};\n\n\ninternals.Any.prototype._test = function (name, arg, func) {\n\n    Hoek.assert(!this._flags.allowOnly, 'Cannot define rules when valid values specified');\n\n    var obj = this.clone();\n    obj._tests.push({ func: func, name: name, arg: arg });\n    return obj;\n};\n\n\ninternals.Any.prototype.options = function (options) {\n\n    Hoek.assert(!options.context, 'Cannot override context');\n    internals.checkOptions(options);\n\n    var obj = this.clone();\n    obj._settings = internals.concatSettings(obj._settings, options);\n    return obj;\n};\n\n\ninternals.Any.prototype.strict = function (isStrict) {\n\n    var obj = this.clone();\n    obj._settings = obj._settings || {};\n    obj._settings.convert = isStrict === undefined ? false : !isStrict;\n    return obj;\n};\n\n\ninternals.Any.prototype.raw = function (isRaw) {\n\n    var obj = this.clone();\n    obj._settings = obj._settings || {};\n    obj._settings.raw = isRaw === undefined ? true : isRaw;\n    return obj;\n};\n\n\ninternals.Any.prototype._allow = function () {\n\n    var values = Hoek.flatten(Array.prototype.slice.call(arguments));\n    for (var i = 0, il = values.length; i < il; ++i) {\n        var value = values[i];\n\n        Hoek.assert(value !== undefined, 'Cannot call allow/valid/invalid with undefined');\n        this._invalids.remove(value);\n        this._valids.add(value, this._refs);\n    }\n};\n\n\ninternals.Any.prototype.allow = function () {\n\n    var obj = this.clone();\n    obj._allow.apply(obj, arguments);\n    return obj;\n};\n\n\ninternals.Any.prototype.valid = internals.Any.prototype.only = internals.Any.prototype.equal = function () {\n\n    Hoek.assert(!this._tests.length, 'Cannot set valid values when rules specified');\n\n    var obj = this.allow.apply(this, arguments);\n    obj._flags.allowOnly = true;\n    return obj;\n};\n\n\ninternals.Any.prototype.invalid = internals.Any.prototype.disallow = internals.Any.prototype.not = function (value) {\n\n    var obj = this.clone();\n    var values = Hoek.flatten(Array.prototype.slice.call(arguments));\n    for (var i = 0, il = values.length; i < il; ++i) {\n        value = values[i];\n\n        Hoek.assert(value !== undefined, 'Cannot call allow/valid/invalid with undefined');\n        obj._valids.remove(value);\n        obj._invalids.add(value, this._refs);\n    }\n\n    return obj;\n};\n\n\ninternals.Any.prototype.required = internals.Any.prototype.exist = function () {\n\n    var obj = this.clone();\n    obj._flags.presence = 'required';\n    return obj;\n};\n\n\ninternals.Any.prototype.optional = function () {\n\n    var obj = this.clone();\n    obj._flags.presence = 'optional';\n    return obj;\n};\n\n\ninternals.Any.prototype.forbidden = function () {\n\n    var obj = this.clone();\n    obj._flags.presence = 'forbidden';\n    return obj;\n};\n\n\ninternals.Any.prototype.strip = function () {\n\n    var obj = this.clone();\n    obj._flags.strip = true;\n    return obj;\n};\n\n\ninternals.Any.prototype.applyFunctionToChildren = function (children, fn, args, root) {\n\n    children = [].concat(children);\n\n    if (children.length !== 1 || children[0] !== '') {\n        root = root ? (root + '.') : '';\n\n        var extraChildren = (children[0] === '' ? children.slice(1) : children).map(function (child) {\n\n            return root + child;\n        });\n\n        throw new Error('unknown key(s) ' + extraChildren.join(', '));\n    }\n\n    return this[fn].apply(this, args);\n};\n\n\ninternals.Any.prototype.default = function (value, description) {\n\n    if (typeof value === 'function' &&\n        !Ref.isRef(value)) {\n\n        if (!value.description &&\n            description) {\n\n            value.description = description;\n        }\n\n        if (!this._flags.func) {\n            Hoek.assert(typeof value.description === 'string' && value.description.length > 0, 'description must be provided when default value is a function');\n        }\n    }\n\n    var obj = this.clone();\n    obj._flags.default = value;\n    Ref.push(obj._refs, value);\n    return obj;\n};\n\n\ninternals.Any.prototype.empty = function (schema) {\n\n    var obj;\n    if (schema === undefined) {\n        obj = this.clone();\n        obj._flags.empty = undefined;\n    }\n    else {\n        schema = Cast.schema(schema);\n\n        obj = this.clone();\n        obj._flags.empty = schema;\n    }\n\n    return obj;\n};\n\n\ninternals.Any.prototype.when = function (ref, options) {\n\n    Hoek.assert(options && typeof options === 'object', 'Invalid options');\n    Hoek.assert(options.then !== undefined || options.otherwise !== undefined, 'options must have at least one of \"then\" or \"otherwise\"');\n\n    var then = options.then ? this.concat(Cast.schema(options.then)) : this;\n    var otherwise = options.otherwise ? this.concat(Cast.schema(options.otherwise)) : this;\n\n    Alternatives = Alternatives || require('./alternatives');\n    var obj = Alternatives.when(ref, { is: options.is, then: then, otherwise: otherwise });\n    obj._flags.presence = 'ignore';\n    return obj;\n};\n\n\ninternals.Any.prototype.description = function (desc) {\n\n    Hoek.assert(desc && typeof desc === 'string', 'Description must be a non-empty string');\n\n    var obj = this.clone();\n    obj._description = desc;\n    return obj;\n};\n\n\ninternals.Any.prototype.notes = function (notes) {\n\n    Hoek.assert(notes && (typeof notes === 'string' || Array.isArray(notes)), 'Notes must be a non-empty string or array');\n\n    var obj = this.clone();\n    obj._notes = obj._notes.concat(notes);\n    return obj;\n};\n\n\ninternals.Any.prototype.tags = function (tags) {\n\n    Hoek.assert(tags && (typeof tags === 'string' || Array.isArray(tags)), 'Tags must be a non-empty string or array');\n\n    var obj = this.clone();\n    obj._tags = obj._tags.concat(tags);\n    return obj;\n};\n\ninternals.Any.prototype.meta = function (meta) {\n\n    Hoek.assert(meta !== undefined, 'Meta cannot be undefined');\n\n    var obj = this.clone();\n    obj._meta = obj._meta.concat(meta);\n    return obj;\n};\n\n\ninternals.Any.prototype.example = function (value) {\n\n    Hoek.assert(arguments.length, 'Missing example');\n    var result = this._validate(value, null, internals.defaults);\n    Hoek.assert(!result.errors, 'Bad example:', result.errors && Errors.process(result.errors, value));\n\n    var obj = this.clone();\n    obj._examples = obj._examples.concat(value);\n    return obj;\n};\n\n\ninternals.Any.prototype.unit = function (name) {\n\n    Hoek.assert(name && typeof name === 'string', 'Unit name must be a non-empty string');\n\n    var obj = this.clone();\n    obj._unit = name;\n    return obj;\n};\n\n\ninternals._try = function (fn, arg) {\n\n    var err;\n    var result;\n\n    try {\n        result = fn.call(null, arg);\n    } catch (e) {\n        err = e;\n    }\n\n    return {\n        value: result,\n        error: err\n    };\n};\n\n\ninternals.Any.prototype._validate = function (value, state, options, reference) {\n\n    var self = this;\n    var originalValue = value;\n\n    // Setup state and settings\n\n    state = state || { key: '', path: '', parent: null, reference: reference };\n\n    if (this._settings) {\n        options = internals.concatSettings(options, this._settings);\n    }\n\n    var errors = [];\n    var finish = function () {\n\n        var finalValue;\n\n        if (!self._flags.strip) {\n            if (value !== undefined) {\n                finalValue = options.raw ? originalValue : value;\n            }\n            else if (options.noDefaults) {\n                finalValue = originalValue;\n            }\n            else if (Ref.isRef(self._flags.default)) {\n                finalValue = self._flags.default(state.parent, options);\n            }\n            else if (typeof self._flags.default === 'function' &&\n                    !(self._flags.func && !self._flags.default.description)) {\n\n                var arg;\n\n                if (state.parent !== null &&\n                    self._flags.default.length > 0) {\n\n                    arg = Hoek.clone(state.parent);\n                }\n\n                var defaultValue = internals._try(self._flags.default, arg);\n                finalValue = defaultValue.value;\n                if (defaultValue.error) {\n                    errors.push(Errors.create('any.default', defaultValue.error, state, options));\n                }\n            }\n            else {\n                finalValue = Hoek.clone(self._flags.default);\n            }\n        }\n\n        return {\n            value: finalValue,\n            errors: errors.length ? errors : null\n        };\n    };\n\n    // Check presence requirements\n\n    var presence = this._flags.presence || options.presence;\n    if (presence === 'optional') {\n        if (value === undefined) {\n            var isDeepDefault = this._flags.hasOwnProperty('default') && this._flags.default === undefined;\n            if (isDeepDefault && this._type === 'object') {\n                value = {};\n            }\n            else {\n                return finish();\n            }\n        }\n    }\n    else if (presence === 'required' &&\n            value === undefined) {\n\n        errors.push(Errors.create('any.required', null, state, options));\n        return finish();\n    }\n    else if (presence === 'forbidden') {\n        if (value === undefined) {\n            return finish();\n        }\n\n        errors.push(Errors.create('any.unknown', null, state, options));\n        return finish();\n    }\n\n    if (this._flags.empty && !this._flags.empty._validate(value, null, internals.defaults).errors) {\n        value = undefined;\n        return finish();\n    }\n\n    // Check allowed and denied values using the original value\n\n    if (this._valids.has(value, state, options, this._flags.insensitive)) {\n        return finish();\n    }\n\n    if (this._invalids.has(value, state, options, this._flags.insensitive)) {\n        errors.push(Errors.create(value === '' ? 'any.empty' : 'any.invalid', null, state, options));\n        if (options.abortEarly ||\n            value === undefined) {          // No reason to keep validating missing value\n\n            return finish();\n        }\n    }\n\n    // Convert value and validate type\n\n    if (this._base) {\n        var base = this._base.call(this, value, state, options);\n        if (base.errors) {\n            value = base.value;\n            errors = errors.concat(base.errors);\n            return finish();                            // Base error always aborts early\n        }\n\n        if (base.value !== value) {\n            value = base.value;\n\n            // Check allowed and denied values using the converted value\n\n            if (this._valids.has(value, state, options, this._flags.insensitive)) {\n                return finish();\n            }\n\n            if (this._invalids.has(value, state, options, this._flags.insensitive)) {\n                errors.push(Errors.create('any.invalid', null, state, options));\n                if (options.abortEarly) {\n                    return finish();\n                }\n            }\n        }\n    }\n\n    // Required values did not match\n\n    if (this._flags.allowOnly) {\n        errors.push(Errors.create('any.allowOnly', { valids: this._valids.values({ stripUndefined: true }) }, state, options));\n        if (options.abortEarly) {\n            return finish();\n        }\n    }\n\n    // Helper.validate tests\n\n    for (var i = 0, il = this._tests.length; i < il; ++i) {\n        var test = this._tests[i];\n        var err = test.func.call(this, value, state, options);\n        if (err) {\n            errors.push(err);\n            if (options.abortEarly) {\n                return finish();\n            }\n        }\n    }\n\n    return finish();\n};\n\n\ninternals.Any.prototype._validateWithOptions = function (value, options, callback) {\n\n    if (options) {\n        internals.checkOptions(options);\n    }\n\n    var settings = internals.concatSettings(internals.defaults, options);\n    var result = this._validate(value, null, settings);\n    var errors = Errors.process(result.errors, value);\n\n    if (callback) {\n        return callback(errors, result.value);\n    }\n\n    return { error: errors, value: result.value };\n};\n\n\ninternals.Any.prototype.validate = function (value, callback) {\n\n    var result = this._validate(value, null, internals.defaults);\n    var errors = Errors.process(result.errors, value);\n\n    if (callback) {\n        return callback(errors, result.value);\n    }\n\n    return { error: errors, value: result.value };\n};\n\n\ninternals.Any.prototype.describe = function () {\n\n    var description = {\n        type: this._type\n    };\n\n    var flags = Object.keys(this._flags);\n    if (flags.length) {\n        if (this._flags.empty) {\n            description.flags = {};\n            for (var f = 0, fl = flags.length; f < fl; ++f) {\n                var flag = flags[f];\n                description.flags[flag] = flag === 'empty' ? this._flags[flag].describe() : this._flags[flag];\n            }\n        }\n        else {\n            description.flags = this._flags;\n        }\n    }\n\n    if (this._description) {\n        description.description = this._description;\n    }\n\n    if (this._notes.length) {\n        description.notes = this._notes;\n    }\n\n    if (this._tags.length) {\n        description.tags = this._tags;\n    }\n\n    if (this._meta.length) {\n        description.meta = this._meta;\n    }\n\n    if (this._examples.length) {\n        description.examples = this._examples;\n    }\n\n    if (this._unit) {\n        description.unit = this._unit;\n    }\n\n    var valids = this._valids.values();\n    if (valids.length) {\n        description.valids = valids;\n    }\n\n    var invalids = this._invalids.values();\n    if (invalids.length) {\n        description.invalids = invalids;\n    }\n\n    description.rules = [];\n\n    for (var i = 0, il = this._tests.length; i < il; ++i) {\n        var validator = this._tests[i];\n        var item = { name: validator.name };\n        if (validator.arg !== void 0) {\n            item.arg = validator.arg;\n        }\n        description.rules.push(item);\n    }\n\n    if (!description.rules.length) {\n        delete description.rules;\n    }\n\n    var label = Hoek.reach(this._settings, 'language.label');\n    if (label) {\n        description.label = label;\n    }\n\n    return description;\n};\n\ninternals.Any.prototype.label = function (name) {\n\n    Hoek.assert(name && typeof name === 'string', 'Label name must be a non-empty string');\n\n    var obj = this.clone();\n    var options = { language: { label: name } };\n\n    // If language.label is set, it should override this label\n    obj._settings = internals.concatSettings(options, obj._settings);\n    return obj;\n};\n\n\n// Set\n\ninternals.Set = function () {\n\n    this._set = [];\n};\n\n\ninternals.Set.prototype.add = function (value, refs) {\n\n    Hoek.assert(value === null || value === undefined || value instanceof Date || Buffer.isBuffer(value) || Ref.isRef(value) || (typeof value !== 'function' && typeof value !== 'object'), 'Value cannot be an object or function');\n\n    if (typeof value !== 'function' &&\n        this.has(value, null, null, false)) {\n\n        return;\n    }\n\n    Ref.push(refs, value);\n    this._set.push(value);\n};\n\n\ninternals.Set.prototype.merge = function (add, remove) {\n\n    for (var i = 0, il = add._set.length; i < il; ++i) {\n        this.add(add._set[i]);\n    }\n\n    for (i = 0, il = remove._set.length; i < il; ++i) {\n        this.remove(remove._set[i]);\n    }\n};\n\n\ninternals.Set.prototype.remove = function (value) {\n\n    this._set = this._set.filter(function (item) {\n\n        return value !== item;\n    });\n};\n\n\ninternals.Set.prototype.has = function (value, state, options, insensitive) {\n\n    for (var i = 0, il = this._set.length; i < il; ++i) {\n        var items = this._set[i];\n\n        if (Ref.isRef(items)) {\n            items = items(state.reference || state.parent, options);\n        }\n\n        if (!Array.isArray(items)) {\n            items = [items];\n        }\n\n        for (var j = 0, jl = items.length; j < jl; ++j) {\n            var item = items[j];\n            if (typeof value !== typeof item) {\n                continue;\n            }\n\n            if (value === item ||\n                (value instanceof Date && item instanceof Date && value.getTime() === item.getTime()) ||\n                (insensitive && typeof value === 'string' && value.toLowerCase() === item.toLowerCase()) ||\n                (Buffer.isBuffer(value) && Buffer.isBuffer(item) && value.length === item.length && value.toString('binary') === item.toString('binary'))) {\n\n                return true;\n            }\n        }\n    }\n\n    return false;\n};\n\n\ninternals.Set.prototype.values = function (options) {\n\n    if (options && options.stripUndefined) {\n        var values = [];\n\n        for (var i = 0, il = this._set.length; i < il; ++i) {\n            var item = this._set[i];\n            if (item !== undefined) {\n                values.push(item);\n            }\n        }\n\n        return values;\n    }\n\n    return this._set.slice();\n};\n\n\ninternals.concatSettings = function (target, source) {\n\n    // Used to avoid cloning context\n\n    if (!target &&\n        !source) {\n\n        return null;\n    }\n\n    var key, obj = {};\n\n    if (target) {\n        var tKeys = Object.keys(target);\n        for (var i = 0, il = tKeys.length; i < il; ++i) {\n            key = tKeys[i];\n            obj[key] = target[key];\n        }\n    }\n\n    if (source) {\n        var sKeys = Object.keys(source);\n        for (var j = 0, jl = sKeys.length; j < jl; ++j) {\n            key = sKeys[j];\n            if (key !== 'language' ||\n                !obj.hasOwnProperty(key)) {\n\n                obj[key] = source[key];\n            }\n            else {\n                obj[key] = Hoek.applyToDefaults(obj[key], source[key]);\n            }\n        }\n    }\n\n    return obj;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/hoek/lib/index.js":"// Load modules\n\nvar Crypto = require('crypto');\nvar Path = require('path');\nvar Util = require('util');\nvar Escape = require('./escape');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Clone object or array\n\nexports.clone = function (obj, seen) {\n\n    if (typeof obj !== 'object' ||\n        obj === null) {\n\n        return obj;\n    }\n\n    seen = seen || { orig: [], copy: [] };\n\n    var lookup = seen.orig.indexOf(obj);\n    if (lookup !== -1) {\n        return seen.copy[lookup];\n    }\n\n    var newObj;\n    var cloneDeep = false;\n\n    if (!Array.isArray(obj)) {\n        if (Buffer.isBuffer(obj)) {\n            newObj = new Buffer(obj);\n        }\n        else if (obj instanceof Date) {\n            newObj = new Date(obj.getTime());\n        }\n        else if (obj instanceof RegExp) {\n            newObj = new RegExp(obj);\n        }\n        else {\n            var proto = Object.getPrototypeOf(obj);\n            if (proto &&\n                proto.isImmutable) {\n\n                newObj = obj;\n            }\n            else {\n                newObj = Object.create(proto);\n                cloneDeep = true;\n            }\n        }\n    }\n    else {\n        newObj = [];\n        cloneDeep = true;\n    }\n\n    seen.orig.push(obj);\n    seen.copy.push(newObj);\n\n    if (cloneDeep) {\n        var keys = Object.getOwnPropertyNames(obj);\n        for (var i = 0, il = keys.length; i < il; ++i) {\n            var key = keys[i];\n            var descriptor = Object.getOwnPropertyDescriptor(obj, key);\n            if (descriptor &&\n                (descriptor.get ||\n                 descriptor.set)) {\n\n                Object.defineProperty(newObj, key, descriptor);\n            }\n            else {\n                newObj[key] = exports.clone(obj[key], seen);\n            }\n        }\n    }\n\n    return newObj;\n};\n\n\n// Merge all the properties of source into target, source wins in conflict, and by default null and undefined from source are applied\n/*eslint-disable */\nexports.merge = function (target, source, isNullOverride /* = true */, isMergeArrays /* = true */) {\n/*eslint-enable */\n    exports.assert(target && typeof target === 'object', 'Invalid target value: must be an object');\n    exports.assert(source === null || source === undefined || typeof source === 'object', 'Invalid source value: must be null, undefined, or an object');\n\n    if (!source) {\n        return target;\n    }\n\n    if (Array.isArray(source)) {\n        exports.assert(Array.isArray(target), 'Cannot merge array onto an object');\n        if (isMergeArrays === false) {                                                  // isMergeArrays defaults to true\n            target.length = 0;                                                          // Must not change target assignment\n        }\n\n        for (var i = 0, il = source.length; i < il; ++i) {\n            target.push(exports.clone(source[i]));\n        }\n\n        return target;\n    }\n\n    var keys = Object.keys(source);\n    for (var k = 0, kl = keys.length; k < kl; ++k) {\n        var key = keys[k];\n        var value = source[key];\n        if (value &&\n            typeof value === 'object') {\n\n            if (!target[key] ||\n                typeof target[key] !== 'object' ||\n                (Array.isArray(target[key]) ^ Array.isArray(value)) ||\n                value instanceof Date ||\n                Buffer.isBuffer(value) ||\n                value instanceof RegExp) {\n\n                target[key] = exports.clone(value);\n            }\n            else {\n                exports.merge(target[key], value, isNullOverride, isMergeArrays);\n            }\n        }\n        else {\n            if (value !== null &&\n                value !== undefined) {                              // Explicit to preserve empty strings\n\n                target[key] = value;\n            }\n            else if (isNullOverride !== false) {                    // Defaults to true\n                target[key] = value;\n            }\n        }\n    }\n\n    return target;\n};\n\n\n// Apply options to a copy of the defaults\n\nexports.applyToDefaults = function (defaults, options, isNullOverride) {\n\n    exports.assert(defaults && typeof defaults === 'object', 'Invalid defaults value: must be an object');\n    exports.assert(!options || options === true || typeof options === 'object', 'Invalid options value: must be true, falsy or an object');\n\n    if (!options) {                                                 // If no options, return null\n        return null;\n    }\n\n    var copy = exports.clone(defaults);\n\n    if (options === true) {                                         // If options is set to true, use defaults\n        return copy;\n    }\n\n    return exports.merge(copy, options, isNullOverride === true, false);\n};\n\n\n// Clone an object except for the listed keys which are shallow copied\n\nexports.cloneWithShallow = function (source, keys) {\n\n    if (!source ||\n        typeof source !== 'object') {\n\n        return source;\n    }\n\n    var storage = internals.store(source, keys);    // Move shallow copy items to storage\n    var copy = exports.clone(source);               // Deep copy the rest\n    internals.restore(copy, source, storage);       // Shallow copy the stored items and restore\n    return copy;\n};\n\n\ninternals.store = function (source, keys) {\n\n    var storage = {};\n    for (var i = 0, il = keys.length; i < il; ++i) {\n        var key = keys[i];\n        var value = exports.reach(source, key);\n        if (value !== undefined) {\n            storage[key] = value;\n            internals.reachSet(source, key, undefined);\n        }\n    }\n\n    return storage;\n};\n\n\ninternals.restore = function (copy, source, storage) {\n\n    var keys = Object.keys(storage);\n    for (var i = 0, il = keys.length; i < il; ++i) {\n        var key = keys[i];\n        internals.reachSet(copy, key, storage[key]);\n        internals.reachSet(source, key, storage[key]);\n    }\n};\n\n\ninternals.reachSet = function (obj, key, value) {\n\n    var path = key.split('.');\n    var ref = obj;\n    for (var i = 0, il = path.length; i < il; ++i) {\n        var segment = path[i];\n        if (i + 1 === il) {\n            ref[segment] = value;\n        }\n\n        ref = ref[segment];\n    }\n};\n\n\n// Apply options to defaults except for the listed keys which are shallow copied from option without merging\n\nexports.applyToDefaultsWithShallow = function (defaults, options, keys) {\n\n    exports.assert(defaults && typeof defaults === 'object', 'Invalid defaults value: must be an object');\n    exports.assert(!options || options === true || typeof options === 'object', 'Invalid options value: must be true, falsy or an object');\n    exports.assert(keys && Array.isArray(keys), 'Invalid keys');\n\n    if (!options) {                                                 // If no options, return null\n        return null;\n    }\n\n    var copy = exports.cloneWithShallow(defaults, keys);\n\n    if (options === true) {                                         // If options is set to true, use defaults\n        return copy;\n    }\n\n    var storage = internals.store(options, keys);   // Move shallow copy items to storage\n    exports.merge(copy, options, false, false);     // Deep copy the rest\n    internals.restore(copy, options, storage);      // Shallow copy the stored items and restore\n    return copy;\n};\n\n\n// Deep object or array comparison\n\nexports.deepEqual = function (obj, ref, options, seen) {\n\n    options = options || { prototype: true };\n\n    var type = typeof obj;\n\n    if (type !== typeof ref) {\n        return false;\n    }\n\n    if (type !== 'object' ||\n        obj === null ||\n        ref === null) {\n\n        if (obj === ref) {                                                      // Copied from Deep-eql, copyright(c) 2013 Jake Luer, jake@alogicalparadox.com, MIT Licensed, https://github.com/chaijs/deep-eql\n            return obj !== 0 || 1 / obj === 1 / ref;        // -0 / +0\n        }\n\n        return obj !== obj && ref !== ref;                  // NaN\n    }\n\n    seen = seen || [];\n    if (seen.indexOf(obj) !== -1) {\n        return true;                            // If previous comparison failed, it would have stopped execution\n    }\n\n    seen.push(obj);\n\n    if (Array.isArray(obj)) {\n        if (!Array.isArray(ref)) {\n            return false;\n        }\n\n        if (!options.part && obj.length !== ref.length) {\n            return false;\n        }\n\n        for (var i = 0, il = obj.length; i < il; ++i) {\n            if (options.part) {\n                var found = false;\n                for (var r = 0, rl = ref.length; r < rl; ++r) {\n                    if (exports.deepEqual(obj[i], ref[r], options, seen)) {\n                        found = true;\n                        break;\n                    }\n                }\n\n                return found;\n            }\n\n            if (!exports.deepEqual(obj[i], ref[i], options, seen)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    if (Buffer.isBuffer(obj)) {\n        if (!Buffer.isBuffer(ref)) {\n            return false;\n        }\n\n        if (obj.length !== ref.length) {\n            return false;\n        }\n\n        for (var j = 0, jl = obj.length; j < jl; ++j) {\n            if (obj[j] !== ref[j]) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    if (obj instanceof Date) {\n        return (ref instanceof Date && obj.getTime() === ref.getTime());\n    }\n\n    if (obj instanceof RegExp) {\n        return (ref instanceof RegExp && obj.toString() === ref.toString());\n    }\n\n    if (options.prototype) {\n        if (Object.getPrototypeOf(obj) !== Object.getPrototypeOf(ref)) {\n            return false;\n        }\n    }\n\n    var keys = Object.getOwnPropertyNames(obj);\n\n    if (!options.part && keys.length !== Object.getOwnPropertyNames(ref).length) {\n        return false;\n    }\n\n    for (var k = 0, kl = keys.length; k < kl; ++k) {\n        var key = keys[k];\n        var descriptor = Object.getOwnPropertyDescriptor(obj, key);\n        if (descriptor.get) {\n            if (!exports.deepEqual(descriptor, Object.getOwnPropertyDescriptor(ref, key), options, seen)) {\n                return false;\n            }\n        }\n        else if (!exports.deepEqual(obj[key], ref[key], options, seen)) {\n            return false;\n        }\n    }\n\n    return true;\n};\n\n\n// Remove duplicate items from array\n\nexports.unique = function (array, key) {\n\n    var index = {};\n    var result = [];\n\n    for (var i = 0, il = array.length; i < il; ++i) {\n        var id = (key ? array[i][key] : array[i]);\n        if (index[id] !== true) {\n\n            result.push(array[i]);\n            index[id] = true;\n        }\n    }\n\n    return result;\n};\n\n\n// Convert array into object\n\nexports.mapToObject = function (array, key) {\n\n    if (!array) {\n        return null;\n    }\n\n    var obj = {};\n    for (var i = 0, il = array.length; i < il; ++i) {\n        if (key) {\n            if (array[i][key]) {\n                obj[array[i][key]] = true;\n            }\n        }\n        else {\n            obj[array[i]] = true;\n        }\n    }\n\n    return obj;\n};\n\n\n// Find the common unique items in two arrays\n\nexports.intersect = function (array1, array2, justFirst) {\n\n    if (!array1 || !array2) {\n        return [];\n    }\n\n    var common = [];\n    var hash = (Array.isArray(array1) ? exports.mapToObject(array1) : array1);\n    var found = {};\n    for (var i = 0, il = array2.length; i < il; ++i) {\n        if (hash[array2[i]] && !found[array2[i]]) {\n            if (justFirst) {\n                return array2[i];\n            }\n\n            common.push(array2[i]);\n            found[array2[i]] = true;\n        }\n    }\n\n    return (justFirst ? null : common);\n};\n\n\n// Test if the reference contains the values\n\nexports.contain = function (ref, values, options) {\n\n    /*\n        string -> string(s)\n        array -> item(s)\n        object -> key(s)\n        object -> object (key:value)\n    */\n\n    var valuePairs = null;\n    if (typeof ref === 'object' &&\n        typeof values === 'object' &&\n        !Array.isArray(ref) &&\n        !Array.isArray(values)) {\n\n        valuePairs = values;\n        values = Object.keys(values);\n    }\n    else {\n        values = [].concat(values);\n    }\n\n    options = options || {};            // deep, once, only, part\n\n    exports.assert(arguments.length >= 2, 'Insufficient arguments');\n    exports.assert(typeof ref === 'string' || typeof ref === 'object', 'Reference must be string or an object');\n    exports.assert(values.length, 'Values array cannot be empty');\n\n    var compare, compareFlags;\n    if (options.deep) {\n        compare = exports.deepEqual;\n\n        var hasOnly = options.hasOwnProperty('only'), hasPart = options.hasOwnProperty('part');\n\n        compareFlags = {\n            prototype: hasOnly ? options.only : hasPart ? !options.part : false,\n            part: hasOnly ? !options.only : hasPart ? options.part : true\n        };\n    }\n    else {\n        compare = function (a, b) {\n\n            return a === b;\n        };\n    }\n\n    var misses = false;\n    var matches = new Array(values.length);\n    for (var i = 0, il = matches.length; i < il; ++i) {\n        matches[i] = 0;\n    }\n\n    if (typeof ref === 'string') {\n        var pattern = '(';\n        for (i = 0, il = values.length; i < il; ++i) {\n            var value = values[i];\n            exports.assert(typeof value === 'string', 'Cannot compare string reference to non-string value');\n            pattern += (i ? '|' : '') + exports.escapeRegex(value);\n        }\n\n        var regex = new RegExp(pattern + ')', 'g');\n        var leftovers = ref.replace(regex, function ($0, $1) {\n\n            var index = values.indexOf($1);\n            ++matches[index];\n            return '';          // Remove from string\n        });\n\n        misses = !!leftovers;\n    }\n    else if (Array.isArray(ref)) {\n        for (i = 0, il = ref.length; i < il; ++i) {\n            for (var j = 0, jl = values.length, matched = false; j < jl && matched === false; ++j) {\n                matched = compare(values[j], ref[i], compareFlags) && j;\n            }\n\n            if (matched !== false) {\n                ++matches[matched];\n            }\n            else {\n                misses = true;\n            }\n        }\n    }\n    else {\n        var keys = Object.keys(ref);\n        for (i = 0, il = keys.length; i < il; ++i) {\n            var key = keys[i];\n            var pos = values.indexOf(key);\n            if (pos !== -1) {\n                if (valuePairs &&\n                    !compare(valuePairs[key], ref[key], compareFlags)) {\n\n                    return false;\n                }\n\n                ++matches[pos];\n            }\n            else {\n                misses = true;\n            }\n        }\n    }\n\n    var result = false;\n    for (i = 0, il = matches.length; i < il; ++i) {\n        result = result || !!matches[i];\n        if ((options.once && matches[i] > 1) ||\n            (!options.part && !matches[i])) {\n\n            return false;\n        }\n    }\n\n    if (options.only &&\n        misses) {\n\n        return false;\n    }\n\n    return result;\n};\n\n\n// Flatten array\n\nexports.flatten = function (array, target) {\n\n    var result = target || [];\n\n    for (var i = 0, il = array.length; i < il; ++i) {\n        if (Array.isArray(array[i])) {\n            exports.flatten(array[i], result);\n        }\n        else {\n            result.push(array[i]);\n        }\n    }\n\n    return result;\n};\n\n\n// Convert an object key chain string ('a.b.c') to reference (object[a][b][c])\n\nexports.reach = function (obj, chain, options) {\n\n    if (chain === false ||\n        chain === null ||\n        typeof chain === 'undefined') {\n\n        return obj;\n    }\n\n    options = options || {};\n    if (typeof options === 'string') {\n        options = { separator: options };\n    }\n\n    var path = chain.split(options.separator || '.');\n    var ref = obj;\n    for (var i = 0, il = path.length; i < il; ++i) {\n        var key = path[i];\n        if (key[0] === '-' && Array.isArray(ref)) {\n            key = key.slice(1, key.length);\n            key = ref.length - key;\n        }\n\n        if (!ref ||\n            !ref.hasOwnProperty(key) ||\n            (typeof ref !== 'object' && options.functions === false)) {         // Only object and function can have properties\n\n            exports.assert(!options.strict || i + 1 === il, 'Missing segment', key, 'in reach path ', chain);\n            exports.assert(typeof ref === 'object' || options.functions === true || typeof ref !== 'function', 'Invalid segment', key, 'in reach path ', chain);\n            ref = options.default;\n            break;\n        }\n\n        ref = ref[key];\n    }\n\n    return ref;\n};\n\n\nexports.reachTemplate = function (obj, template, options) {\n\n    return template.replace(/{([^}]+)}/g, function ($0, chain) {\n\n        var value = exports.reach(obj, chain, options);\n        return (value === undefined || value === null ? '' : value);\n    });\n};\n\n\nexports.formatStack = function (stack) {\n\n    var trace = [];\n    for (var i = 0, il = stack.length; i < il; ++i) {\n        var item = stack[i];\n        trace.push([item.getFileName(), item.getLineNumber(), item.getColumnNumber(), item.getFunctionName(), item.isConstructor()]);\n    }\n\n    return trace;\n};\n\n\nexports.formatTrace = function (trace) {\n\n    var display = [];\n\n    for (var i = 0, il = trace.length; i < il; ++i) {\n        var row = trace[i];\n        display.push((row[4] ? 'new ' : '') + row[3] + ' (' + row[0] + ':' + row[1] + ':' + row[2] + ')');\n    }\n\n    return display;\n};\n\n\nexports.callStack = function (slice) {\n\n    // http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\n\n    var v8 = Error.prepareStackTrace;\n    Error.prepareStackTrace = function (err, stack) {\n\n        return stack;\n    };\n\n    var capture = {};\n    Error.captureStackTrace(capture, arguments.callee);     /*eslint no-caller:0 */\n    var stack = capture.stack;\n\n    Error.prepareStackTrace = v8;\n\n    var trace = exports.formatStack(stack);\n\n    if (slice) {\n        return trace.slice(slice);\n    }\n\n    return trace;\n};\n\n\nexports.displayStack = function (slice) {\n\n    var trace = exports.callStack(slice === undefined ? 1 : slice + 1);\n\n    return exports.formatTrace(trace);\n};\n\n\nexports.abortThrow = false;\n\n\nexports.abort = function (message, hideStack) {\n\n    if (process.env.NODE_ENV === 'test' || exports.abortThrow === true) {\n        throw new Error(message || 'Unknown error');\n    }\n\n    var stack = '';\n    if (!hideStack) {\n        stack = exports.displayStack(1).join('\\n\\t');\n    }\n    console.log('ABORT: ' + message + '\\n\\t' + stack);\n    process.exit(1);\n};\n\n\nexports.assert = function (condition /*, msg1, msg2, msg3 */) {\n\n    if (condition) {\n        return;\n    }\n\n    if (arguments.length === 2 && arguments[1] instanceof Error) {\n        throw arguments[1];\n    }\n\n    var msgs = [];\n    for (var i = 1, il = arguments.length; i < il; ++i) {\n        if (arguments[i] !== '') {\n            msgs.push(arguments[i]);            // Avoids Array.slice arguments leak, allowing for V8 optimizations\n        }\n    }\n\n    msgs = msgs.map(function (msg) {\n\n        return typeof msg === 'string' ? msg : msg instanceof Error ? msg.message : exports.stringify(msg);\n    });\n    throw new Error(msgs.join(' ') || 'Unknown error');\n};\n\n\nexports.Timer = function () {\n\n    this.ts = 0;\n    this.reset();\n};\n\n\nexports.Timer.prototype.reset = function () {\n\n    this.ts = Date.now();\n};\n\n\nexports.Timer.prototype.elapsed = function () {\n\n    return Date.now() - this.ts;\n};\n\n\nexports.Bench = function () {\n\n    this.ts = 0;\n    this.reset();\n};\n\n\nexports.Bench.prototype.reset = function () {\n\n    this.ts = exports.Bench.now();\n};\n\n\nexports.Bench.prototype.elapsed = function () {\n\n    return exports.Bench.now() - this.ts;\n};\n\n\nexports.Bench.now = function () {\n\n    var ts = process.hrtime();\n    return (ts[0] * 1e3) + (ts[1] / 1e6);\n};\n\n\n// Escape string for Regex construction\n\nexports.escapeRegex = function (string) {\n\n    // Escape ^$.*+-?=!:|\\/()[]{},\n    return string.replace(/[\\^\\$\\.\\*\\+\\-\\?\\=\\!\\:\\|\\\\\\/\\(\\)\\[\\]\\{\\}\\,]/g, '\\\\$&');\n};\n\n\n// Base64url (RFC 4648) encode\n\nexports.base64urlEncode = function (value, encoding) {\n\n    var buf = (Buffer.isBuffer(value) ? value : new Buffer(value, encoding || 'binary'));\n    return buf.toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n};\n\n\n// Base64url (RFC 4648) decode\n\nexports.base64urlDecode = function (value, encoding) {\n\n    if (value &&\n        !/^[\\w\\-]*$/.test(value)) {\n\n        return new Error('Invalid character');\n    }\n\n    try {\n        var buf = new Buffer(value, 'base64');\n        return (encoding === 'buffer' ? buf : buf.toString(encoding || 'binary'));\n    }\n    catch (err) {\n        return err;\n    }\n};\n\n\n// Escape attribute value for use in HTTP header\n\nexports.escapeHeaderAttribute = function (attribute) {\n\n    // Allowed value characters: !#$%&'()*+,-./:;<=>?@[]^_`{|}~ and space, a-z, A-Z, 0-9, \\, \"\n\n    exports.assert(/^[ \\w\\!#\\$%&'\\(\\)\\*\\+,\\-\\.\\/\\:;<\\=>\\?@\\[\\]\\^`\\{\\|\\}~\\\"\\\\]*$/.test(attribute), 'Bad attribute value (' + attribute + ')');\n\n    return attribute.replace(/\\\\/g, '\\\\\\\\').replace(/\\\"/g, '\\\\\"');                             // Escape quotes and slash\n};\n\n\nexports.escapeHtml = function (string) {\n\n    return Escape.escapeHtml(string);\n};\n\n\nexports.escapeJavaScript = function (string) {\n\n    return Escape.escapeJavaScript(string);\n};\n\n\nexports.nextTick = function (callback) {\n\n    return function () {\n\n        var args = arguments;\n        process.nextTick(function () {\n\n            callback.apply(null, args);\n        });\n    };\n};\n\n\nexports.once = function (method) {\n\n    if (method._hoekOnce) {\n        return method;\n    }\n\n    var once = false;\n    var wrapped = function () {\n\n        if (!once) {\n            once = true;\n            method.apply(null, arguments);\n        }\n    };\n\n    wrapped._hoekOnce = true;\n\n    return wrapped;\n};\n\n\nexports.isAbsolutePath = function (path, platform) {\n\n    if (!path) {\n        return false;\n    }\n\n    if (Path.isAbsolute) {                      // node >= 0.11\n        return Path.isAbsolute(path);\n    }\n\n    platform = platform || process.platform;\n\n    // Unix\n\n    if (platform !== 'win32') {\n        return path[0] === '/';\n    }\n\n    // Windows\n\n    return !!/^(?:[a-zA-Z]:[\\\\\\/])|(?:[\\\\\\/]{2}[^\\\\\\/]+[\\\\\\/]+[^\\\\\\/])/.test(path);        // C:\\ or \\\\something\\something\n};\n\n\nexports.isInteger = function (value) {\n\n    return (typeof value === 'number' &&\n            parseFloat(value) === parseInt(value, 10) &&\n            !isNaN(value));\n};\n\n\nexports.ignore = function () { };\n\n\nexports.inherits = Util.inherits;\n\n\nexports.format = Util.format;\n\n\nexports.transform = function (source, transform, options) {\n\n    exports.assert(source === null || source === undefined || typeof source === 'object' || Array.isArray(source), 'Invalid source object: must be null, undefined, an object, or an array');\n\n    if (Array.isArray(source)) {\n        var results = [];\n        for (var i = 0, il = source.length; i < il; ++i) {\n            results.push(exports.transform(source[i], transform, options));\n        }\n        return results;\n    }\n\n    var result = {};\n    var keys = Object.keys(transform);\n\n    for (var k = 0, kl = keys.length; k < kl; ++k) {\n        var key = keys[k];\n        var path = key.split('.');\n        var sourcePath = transform[key];\n\n        exports.assert(typeof sourcePath === 'string', 'All mappings must be \".\" delineated strings');\n\n        var segment;\n        var res = result;\n\n        while (path.length > 1) {\n            segment = path.shift();\n            if (!res[segment]) {\n                res[segment] = {};\n            }\n            res = res[segment];\n        }\n        segment = path.shift();\n        res[segment] = exports.reach(source, sourcePath, options);\n    }\n\n    return result;\n};\n\n\nexports.uniqueFilename = function (path, extension) {\n\n    if (extension) {\n        extension = extension[0] !== '.' ? '.' + extension : extension;\n    }\n    else {\n        extension = '';\n    }\n\n    path = Path.resolve(path);\n    var name = [Date.now(), process.pid, Crypto.randomBytes(8).toString('hex')].join('-') + extension;\n    return Path.join(path, name);\n};\n\n\nexports.stringify = function () {\n\n    try {\n        return JSON.stringify.apply(null, arguments);\n    }\n    catch (err) {\n        return '[Cannot display object: ' + err.message + ']';\n    }\n};\n\n\nexports.shallow = function (source) {\n\n    var target = {};\n    var keys = Object.keys(source);\n    for (var i = 0, il = keys.length; i < il; ++i) {\n        var key = keys[i];\n        target[key] = source[key];\n    }\n\n    return target;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/hoek/lib/escape.js":"// Declare internals\n\nvar internals = {};\n\n\nexports.escapeJavaScript = function (input) {\n\n    if (!input) {\n        return '';\n    }\n\n    var escaped = '';\n\n    for (var i = 0, il = input.length; i < il; ++i) {\n\n        var charCode = input.charCodeAt(i);\n\n        if (internals.isSafe(charCode)) {\n            escaped += input[i];\n        }\n        else {\n            escaped += internals.escapeJavaScriptChar(charCode);\n        }\n    }\n\n    return escaped;\n};\n\n\nexports.escapeHtml = function (input) {\n\n    if (!input) {\n        return '';\n    }\n\n    var escaped = '';\n\n    for (var i = 0, il = input.length; i < il; ++i) {\n\n        var charCode = input.charCodeAt(i);\n\n        if (internals.isSafe(charCode)) {\n            escaped += input[i];\n        }\n        else {\n            escaped += internals.escapeHtmlChar(charCode);\n        }\n    }\n\n    return escaped;\n};\n\n\ninternals.escapeJavaScriptChar = function (charCode) {\n\n    if (charCode >= 256) {\n        return '\\\\u' + internals.padLeft('' + charCode, 4);\n    }\n\n    var hexValue = new Buffer(String.fromCharCode(charCode), 'ascii').toString('hex');\n    return '\\\\x' + internals.padLeft(hexValue, 2);\n};\n\n\ninternals.escapeHtmlChar = function (charCode) {\n\n    var namedEscape = internals.namedHtml[charCode];\n    if (typeof namedEscape !== 'undefined') {\n        return namedEscape;\n    }\n\n    if (charCode >= 256) {\n        return '&#' + charCode + ';';\n    }\n\n    var hexValue = new Buffer(String.fromCharCode(charCode), 'ascii').toString('hex');\n    return '&#x' + internals.padLeft(hexValue, 2) + ';';\n};\n\n\ninternals.padLeft = function (str, len) {\n\n    while (str.length < len) {\n        str = '0' + str;\n    }\n\n    return str;\n};\n\n\ninternals.isSafe = function (charCode) {\n\n    return (typeof internals.safeCharCodes[charCode] !== 'undefined');\n};\n\n\ninternals.namedHtml = {\n    '38': '&amp;',\n    '60': '&lt;',\n    '62': '&gt;',\n    '34': '&quot;',\n    '160': '&nbsp;',\n    '162': '&cent;',\n    '163': '&pound;',\n    '164': '&curren;',\n    '169': '&copy;',\n    '174': '&reg;'\n};\n\n\ninternals.safeCharCodes = (function () {\n\n    var safe = {};\n\n    for (var i = 32; i < 123; ++i) {\n\n        if ((i >= 97) ||                    // a-z\n            (i >= 65 && i <= 90) ||         // A-Z\n            (i >= 48 && i <= 57) ||         // 0-9\n            i === 32 ||                     // space\n            i === 46 ||                     // .\n            i === 44 ||                     // ,\n            i === 45 ||                     // -\n            i === 58 ||                     // :\n            i === 95) {                     // _\n\n            safe[i] = null;\n        }\n    }\n\n    return safe;\n}());\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/ref.js":"// Load modules\n\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\nexports.create = function (key, options) {\n\n    Hoek.assert(typeof key === 'string', 'Invalid reference key:', key);\n\n    var settings = Hoek.clone(options);         // options can be reused and modified\n\n    var ref = function (value, validationOptions) {\n\n        return Hoek.reach(ref.isContext ? validationOptions.context : value, ref.key, settings);\n    };\n\n    ref.isContext = (key[0] === ((settings && settings.contextPrefix) || '$'));\n    ref.key = (ref.isContext ? key.slice(1) : key);\n    ref.path = ref.key.split((settings && settings.separator) || '.');\n    ref.depth = ref.path.length;\n    ref.root = ref.path[0];\n    ref.isJoi = true;\n\n    ref.toString = function () {\n\n        return (ref.isContext ? 'context:' : 'ref:') + ref.key;\n    };\n\n    return ref;\n};\n\n\nexports.isRef = function (ref) {\n\n    return typeof ref === 'function' && ref.isJoi;\n};\n\n\nexports.push = function (array, ref) {\n\n    if (exports.isRef(ref) &&\n        !ref.isContext) {\n\n        array.push(ref.root);\n    }\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/errors.js":"// Load modules\n\nvar Hoek = require('hoek');\nvar Language = require('./language');\n\n\n// Declare internals\n\nvar internals = {};\n\ninternals.stringify = function (value, wrapArrays) {\n\n    var type = typeof value;\n\n    if (value === null) {\n        return 'null';\n    }\n\n    if (type === 'string') {\n        return value;\n    }\n\n    if (value instanceof internals.Err || type === 'function') {\n        return value.toString();\n    }\n\n    if (type === 'object') {\n        if (Array.isArray(value)) {\n            var partial = '';\n\n            for (var i = 0, il = value.length; i < il; ++i) {\n                partial += (partial.length ? ', ' : '') + internals.stringify(value[i], wrapArrays);\n            }\n\n            return wrapArrays ? '[' + partial + ']' : partial;\n        }\n\n        return value.toString();\n    }\n\n    return JSON.stringify(value);\n};\n\ninternals.Err = function (type, context, state, options) {\n\n    this.type = type;\n    this.context = context || {};\n    this.context.key = state.key;\n    this.path = state.path;\n    this.options = options;\n};\n\n\ninternals.Err.prototype.toString = function () {\n\n    var self = this;\n\n    var localized = this.options.language;\n\n    if (localized.label) {\n        this.context.key = localized.label;\n    }\n    else if (this.context.key === '' || this.context.key === null) {\n        this.context.key = localized.root || Language.errors.root;\n    }\n\n    var format = Hoek.reach(localized, this.type) || Hoek.reach(Language.errors, this.type);\n    var hasKey = /\\{\\{\\!?key\\}\\}/.test(format);\n    var skipKey = format.length > 2 && format[0] === '!' && format[1] === '!';\n\n    if (skipKey) {\n        format = format.slice(2);\n    }\n\n    if (!hasKey && !skipKey) {\n        format = (Hoek.reach(localized, 'key') || Hoek.reach(Language.errors, 'key')) + format;\n    }\n\n    var wrapArrays = Hoek.reach(localized, 'messages.wrapArrays');\n    if (typeof wrapArrays !== 'boolean') {\n        wrapArrays = Language.errors.messages.wrapArrays;\n    }\n\n    var message = format.replace(/\\{\\{(\\!?)([^}]+)\\}\\}/g, function ($0, isSecure, name) {\n\n        var value = Hoek.reach(self.context, name);\n        var normalized = internals.stringify(value, wrapArrays);\n        return (isSecure ? Hoek.escapeHtml(normalized) : normalized);\n    });\n\n    return message;\n};\n\n\nexports.create = function (type, context, state, options) {\n\n    return new internals.Err(type, context, state, options);\n};\n\n\nexports.process = function (errors, object) {\n\n    if (!errors || !errors.length) {\n        return null;\n    }\n\n    // Construct error\n\n    var message = '';\n    var details = [];\n\n    var processErrors = function (localErrors, parent) {\n\n        for (var i = 0, il = localErrors.length; i < il; ++i) {\n            var item = localErrors[i];\n\n            var detail = {\n                message: item.toString(),\n                path: internals.getPath(item),\n                type: item.type,\n                context: item.context\n            };\n\n            if (!parent) {\n                message += (message ? '. ' : '') + detail.message;\n            }\n\n            // Do not push intermediate errors, we're only interested in leafs\n            if (item.context.reason && item.context.reason.length) {\n                processErrors(item.context.reason, item.path);\n            }\n            else {\n                details.push(detail);\n            }\n        }\n    };\n\n    processErrors(errors);\n\n    var error = new Error(message);\n    error.name = 'ValidationError';\n    error.details = details;\n    error._object = object;\n    error.annotate = internals.annotate;\n    return error;\n};\n\n\ninternals.getPath = function (item) {\n\n    var recursePath = function (it) {\n\n        var reachedItem = Hoek.reach(it, 'context.reason.0');\n        if (reachedItem && reachedItem.context) {\n            return recursePath(reachedItem);\n        }\n\n        return it.path;\n    };\n\n    return recursePath(item) || item.context.key;\n};\n\n\n// Inspired by json-stringify-safe\ninternals.safeStringify = function (obj, spaces) {\n\n    return JSON.stringify(obj, internals.serializer(), spaces);\n};\n\ninternals.serializer = function () {\n\n    var cycleReplacer = function (key, value) {\n\n        if (stack[0] === value) {\n            return '[Circular ~]';\n        }\n\n        return '[Circular ~.' + keys.slice(0, stack.indexOf(value)).join('.') + ']';\n    };\n\n    var keys = [], stack = [];\n\n    return function (key, value) {\n\n        if (stack.length > 0) {\n            var thisPos = stack.indexOf(this);\n            if (~thisPos) {\n                stack.length = thisPos + 1;\n                keys.length = thisPos + 1;\n                keys[thisPos] = key;\n            }\n            else {\n                stack.push(this);\n                keys.push(key);\n            }\n\n            if (~stack.indexOf(value)) {\n                value = cycleReplacer.call(this, key, value);\n            }\n        }\n        else {\n            stack.push(value);\n        }\n\n        if (Array.isArray(value) && value.placeholders) {\n            var placeholders = value.placeholders;\n            var arrWithPlaceholders = [];\n            for (var i = 0, il = value.length; i < il; ++i) {\n                if (placeholders[i]) {\n                    arrWithPlaceholders.push(placeholders[i]);\n                }\n                arrWithPlaceholders.push(value[i]);\n            }\n\n            value = arrWithPlaceholders;\n        }\n\n        return value;\n    };\n};\n\n\ninternals.annotate = function () {\n\n    var obj = Hoek.clone(this._object || {});\n\n    var lookup = {};\n    var el = this.details.length;\n    for (var e = el - 1; e >= 0; --e) {        // Reverse order to process deepest child first\n        var pos = el - e;\n        var error = this.details[e];\n        var path = error.path.split('.');\n        var ref = obj;\n        for (var i = 0, il = path.length; i < il && ref; ++i) {\n            var seg = path[i];\n            if (i + 1 < il) {\n                ref = ref[seg];\n            }\n            else {\n                var value = ref[seg];\n                if (Array.isArray(ref)) {\n                    var arrayLabel = '_$idx$_' + (e + 1) + '_$end$_';\n                    if (!ref.placeholders) {\n                        ref.placeholders = {};\n                    }\n\n                    if (ref.placeholders[seg]) {\n                        ref.placeholders[seg] = ref.placeholders[seg].replace('_$end$_', ', ' + (e + 1) + '_$end$_');\n                    }\n                    else {\n                        ref.placeholders[seg] = arrayLabel;\n                    }\n                } else {\n                    if (value !== undefined) {\n                        delete ref[seg];\n                        var objectLabel = seg + '_$key$_' + pos + '_$end$_';\n                        ref[objectLabel] = value;\n                        lookup[error.path] = objectLabel;\n                    }\n                    else if (lookup[error.path]) {\n                        var replacement = lookup[error.path];\n                        var appended = replacement.replace('_$end$_', ', ' + pos + '_$end$_');\n                        ref[appended] = ref[replacement];\n                        lookup[error.path] = appended;\n                        delete ref[replacement];\n                    }\n                    else {\n                        ref['_$miss$_' + seg + '|' + pos + '_$end$_'] = '__missing__';\n                    }\n                }\n            }\n        }\n    }\n\n    var message = internals.safeStringify(obj, 2)\n        .replace(/_\\$key\\$_([, \\d]+)_\\$end\\$_\\\"/g, function ($0, $1) {\n\n            return '\" \\u001b[31m[' + $1 + ']\\u001b[0m';\n        }).replace(/\\\"_\\$miss\\$_([^\\|]+)\\|(\\d+)_\\$end\\$_\\\"\\: \\\"__missing__\\\"/g, function ($0, $1, $2) {\n\n            return '\\u001b[41m\"' + $1 + '\"\\u001b[0m\\u001b[31m [' + $2 + ']: -- missing --\\u001b[0m';\n        }).replace(/\\s*\\\"_\\$idx\\$_([, \\d]+)_\\$end\\$_\\\",?\\n(.*)/g, function ($0, $1, $2) {\n\n            return '\\n' + $2 + ' \\u001b[31m[' + $1 + ']\\u001b[0m';\n        });\n\n    message += '\\n\\u001b[31m';\n\n    for (e = 0; e < el; ++e) {\n        message += '\\n[' + (e + 1) + '] ' + this.details[e].message;\n    }\n\n    message += '\\u001b[0m';\n\n    return message;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/language.js":"// Load modules\n\n\n// Declare internals\n\nvar internals = {};\n\n\nexports.errors = {\n    root: 'value',\n    key: '\"{{!key}}\" ',\n    messages: {\n        wrapArrays: true\n    },\n    any: {\n        unknown: 'is not allowed',\n        invalid: 'contains an invalid value',\n        empty: 'is not allowed to be empty',\n        required: 'is required',\n        allowOnly: 'must be one of {{valids}}',\n        default: 'threw an error when running default method'\n    },\n    alternatives: {\n        base: 'not matching any of the allowed alternatives'\n    },\n    array: {\n        base: 'must be an array',\n        includes: 'at position {{pos}} does not match any of the allowed types',\n        includesSingle: 'single value of \"{{!key}}\" does not match any of the allowed types',\n        includesOne: 'at position {{pos}} fails because {{reason}}',\n        includesOneSingle: 'single value of \"{{!key}}\" fails because {{reason}}',\n        includesRequiredUnknowns: 'does not contain {{unknownMisses}} required value(s)',\n        includesRequiredKnowns: 'does not contain {{knownMisses}}',\n        includesRequiredBoth: 'does not contain {{knownMisses}} and {{unknownMisses}} other required value(s)',\n        excludes: 'at position {{pos}} contains an excluded value',\n        excludesSingle: 'single value of \"{{!key}}\" contains an excluded value',\n        min: 'must contain at least {{limit}} items',\n        max: 'must contain less than or equal to {{limit}} items',\n        length: 'must contain {{limit}} items',\n        ordered: 'at position {{pos}} fails because {{reason}}',\n        orderedLength: 'at position {{pos}} fails because array must contain at most {{limit}} items',\n        sparse: 'must not be a sparse array',\n        unique: 'position {{pos}} contains a duplicate value'\n    },\n    boolean: {\n        base: 'must be a boolean'\n    },\n    binary: {\n        base: 'must be a buffer or a string',\n        min: 'must be at least {{limit}} bytes',\n        max: 'must be less than or equal to {{limit}} bytes',\n        length: 'must be {{limit}} bytes'\n    },\n    date: {\n        base: 'must be a number of milliseconds or valid date string',\n        min: 'must be larger than or equal to \"{{limit}}\"',\n        max: 'must be less than or equal to \"{{limit}}\"',\n        isoDate: 'must be a valid ISO 8601 date',\n        ref: 'references \"{{ref}}\" which is not a date'\n    },\n    function: {\n        base: 'must be a Function'\n    },\n    object: {\n        base: 'must be an object',\n        child: 'child \"{{!key}}\" fails because {{reason}}',\n        min: 'must have at least {{limit}} children',\n        max: 'must have less than or equal to {{limit}} children',\n        length: 'must have {{limit}} children',\n        allowUnknown: 'is not allowed',\n        with: 'missing required peer \"{{peer}}\"',\n        without: 'conflict with forbidden peer \"{{peer}}\"',\n        missing: 'must contain at least one of {{peers}}',\n        xor: 'contains a conflict between exclusive peers {{peers}}',\n        or: 'must contain at least one of {{peers}}',\n        and: 'contains {{present}} without its required peers {{missing}}',\n        nand: '!!\"{{main}}\" must not exist simultaneously with {{peers}}',\n        assert: '!!\"{{ref}}\" validation failed because \"{{ref}}\" failed to {{message}}',\n        rename: {\n            multiple: 'cannot rename child \"{{from}}\" because multiple renames are disabled and another key was already renamed to \"{{to}}\"',\n            override: 'cannot rename child \"{{from}}\" because override is disabled and target \"{{to}}\" exists'\n        },\n        type: 'must be an instance of \"{{type}}\"'\n    },\n    number: {\n        base: 'must be a number',\n        min: 'must be larger than or equal to {{limit}}',\n        max: 'must be less than or equal to {{limit}}',\n        less: 'must be less than {{limit}}',\n        greater: 'must be greater than {{limit}}',\n        float: 'must be a float or double',\n        integer: 'must be an integer',\n        negative: 'must be a negative number',\n        positive: 'must be a positive number',\n        precision: 'must have no more than {{limit}} decimal places',\n        ref: 'references \"{{ref}}\" which is not a number',\n        multiple: 'must be a multiple of {{multiple}}'\n    },\n    string: {\n        base: 'must be a string',\n        min: 'length must be at least {{limit}} characters long',\n        max: 'length must be less than or equal to {{limit}} characters long',\n        length: 'length must be {{limit}} characters long',\n        alphanum: 'must only contain alpha-numeric characters',\n        token: 'must only contain alpha-numeric and underscore characters',\n        regex: {\n            base: 'with value \"{{!value}}\" fails to match the required pattern: {{pattern}}',\n            name: 'with value \"{{!value}}\" fails to match the {{name}} pattern'\n        },\n        email: 'must be a valid email',\n        uri: 'must be a valid uri',\n        uriCustomScheme: 'must be a valid uri with a scheme matching the {{scheme}} pattern',\n        isoDate: 'must be a valid ISO 8601 date',\n        guid: 'must be a valid GUID',\n        hex: 'must only contain hexadecimal characters',\n        hostname: 'must be a valid hostname',\n        lowercase: 'must only contain lowercase characters',\n        uppercase: 'must only contain uppercase characters',\n        trim: 'must not have leading or trailing whitespace',\n        creditCard: 'must be a credit card',\n        ref: 'references \"{{ref}}\" which is not a number',\n        ip: 'must be a valid ip address with a {{cidr}} CIDR',\n        ipVersion: 'must be a valid ip address of one of the following versions {{version}} with a {{cidr}} CIDR'\n    }\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/cast.js":"// Load modules\n\nvar Hoek = require('hoek');\nvar Ref = require('./ref');\n\n// Type modules are delay-loaded to prevent circular dependencies\n\n\n// Declare internals\n\nvar internals = {\n    any: null,\n    date: require('./date'),\n    string: require('./string'),\n    number: require('./number'),\n    boolean: require('./boolean'),\n    alt: null,\n    object: null\n};\n\n\nexports.schema = function (config) {\n\n    internals.any = internals.any || new (require('./any'))();\n    internals.alt = internals.alt || require('./alternatives');\n    internals.object = internals.object || require('./object');\n\n    if (config &&\n        typeof config === 'object') {\n\n        if (config.isJoi) {\n            return config;\n        }\n\n        if (Array.isArray(config)) {\n            return internals.alt.try(config);\n        }\n\n        if (config instanceof RegExp) {\n            return internals.string.regex(config);\n        }\n\n        if (config instanceof Date) {\n            return internals.date.valid(config);\n        }\n\n        return internals.object.keys(config);\n    }\n\n    if (typeof config === 'string') {\n        return internals.string.valid(config);\n    }\n\n    if (typeof config === 'number') {\n        return internals.number.valid(config);\n    }\n\n    if (typeof config === 'boolean') {\n        return internals.boolean.valid(config);\n    }\n\n    if (Ref.isRef(config)) {\n        return internals.any.valid(config);\n    }\n\n    Hoek.assert(config === null, 'Invalid schema content:', config);\n\n    return internals.any.valid(null);\n};\n\n\nexports.ref = function (id) {\n\n    return Ref.isRef(id) ? id : Ref.create(id);\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/date.js":"// Load modules\n\nvar Any = require('./any');\nvar Errors = require('./errors');\nvar Ref = require('./ref');\nvar Hoek = require('hoek');\nvar Moment = require('moment');\n\n\n// Declare internals\n\nvar internals = {};\n\ninternals.isoDate = /^(?:\\d{4}(?!\\d{2}\\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\\1(?:[12]\\d|0[1-9]|3[01]))?|W(?:[0-4]\\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\\d|[12]\\d{2}|3(?:[0-5]\\d|6[1-6])))(?![T]$|[T][\\d]+Z$)(?:[T\\s](?:(?:(?:[01]\\d|2[0-3])(?:(:?)[0-5]\\d)?|24\\:?00)(?:[.,]\\d+(?!:))?)(?:\\2[0-5]\\d(?:[.,]\\d+)?)?(?:[Z]|(?:[+-])(?:[01]\\d|2[0-3])(?::?[0-5]\\d)?)?)?)?$/;\ninternals.invalidDate = new Date('');\ninternals.isIsoDate = (function () {\n\n    var isoString = internals.isoDate.toString();\n\n    return function (date) {\n\n        return date && (date.toString() === isoString);\n    };\n})();\n\ninternals.Date = function () {\n\n    Any.call(this);\n    this._type = 'date';\n};\n\nHoek.inherits(internals.Date, Any);\n\n\ninternals.Date.prototype._base = function (value, state, options) {\n\n    var result = {\n        value: (options.convert && internals.toDate(value, this._flags.format)) || value\n    };\n\n    if (result.value instanceof Date && !isNaN(result.value.getTime())) {\n        result.errors = null;\n    }\n    else {\n        result.errors = Errors.create(internals.isIsoDate(this._flags.format) ? 'date.isoDate' : 'date.base', null, state, options);\n    }\n\n    return result;\n};\n\n\ninternals.toDate = function (value, format) {\n\n    if (value instanceof Date) {\n        return value;\n    }\n\n    if (typeof value === 'string' ||\n        Hoek.isInteger(value)) {\n\n        if (typeof value === 'string' &&\n            /^[+-]?\\d+$/.test(value)) {\n\n            value = parseInt(value, 10);\n        }\n\n        var date;\n        if (format) {\n            if (internals.isIsoDate(format)) {\n                date = format.test(value) ? new Date(value) : internals.invalidDate;\n            }\n            else {\n                date = Moment(value, format, true);\n                date = date.isValid() ? date.toDate() : internals.invalidDate;\n            }\n        }\n        else {\n            date = new Date(value);\n        }\n\n        if (!isNaN(date.getTime())) {\n            return date;\n        }\n    }\n\n    return null;\n};\n\n\ninternals.compare = function (type, compare) {\n\n    return function (date) {\n\n        var isNow = date === 'now';\n        var isRef = Ref.isRef(date);\n\n        if (!isNow && !isRef) {\n            date = internals.toDate(date);\n        }\n\n        Hoek.assert(date, 'Invalid date format');\n\n        return this._test(type, date, function (value, state, options) {\n\n            var compareTo;\n            if (isNow) {\n                compareTo = Date.now();\n            }\n            else if (isRef) {\n                compareTo = internals.toDate(date(state.parent, options));\n\n                if (!compareTo) {\n                    return Errors.create('date.ref', { ref: date.key }, state, options);\n                }\n\n                compareTo = compareTo.getTime();\n            }\n            else {\n                compareTo = date.getTime();\n            }\n\n            if (compare(value.getTime(), compareTo)) {\n                return null;\n            }\n\n            return Errors.create('date.' + type, { limit: new Date(compareTo) }, state, options);\n        });\n    };\n};\n\n\ninternals.Date.prototype.min = internals.compare('min', function (value, date) {\n\n    return value >= date;\n});\n\n\ninternals.Date.prototype.max = internals.compare('max', function (value, date) {\n\n    return value <= date;\n});\n\n\ninternals.Date.prototype.format = function (format) {\n\n    Hoek.assert(typeof format === 'string' || (Array.isArray(format) && format.every(function (f) {\n\n        return typeof f === 'string';\n    })), 'Invalid format.');\n\n    var obj = this.clone();\n    obj._flags.format = format;\n    return obj;\n};\n\ninternals.Date.prototype.iso = function () {\n\n    var obj = this.clone();\n    obj._flags.format = internals.isoDate;\n    return obj;\n};\n\ninternals.Date.prototype._isIsoDate = function (value) {\n\n    return internals.isoDate.test(value);\n};\n\nmodule.exports = new internals.Date();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/moment/moment.js":"//! moment.js\n//! version : 2.18.1\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.moment = factory()\n}(this, (function () { 'use strict';\n\nvar hookCallback;\n\nfunction hooks () {\n    return hookCallback.apply(null, arguments);\n}\n\n// This is done to register the method called with moment()\n// without creating circular dependencies.\nfunction setHookCallback (callback) {\n    hookCallback = callback;\n}\n\nfunction isArray(input) {\n    return input instanceof Array || Object.prototype.toString.call(input) === '[object Array]';\n}\n\nfunction isObject(input) {\n    // IE8 will treat undefined and null as object if it wasn't for\n    // input != null\n    return input != null && Object.prototype.toString.call(input) === '[object Object]';\n}\n\nfunction isObjectEmpty(obj) {\n    var k;\n    for (k in obj) {\n        // even if its not own property I'd still call it non-empty\n        return false;\n    }\n    return true;\n}\n\nfunction isUndefined(input) {\n    return input === void 0;\n}\n\nfunction isNumber(input) {\n    return typeof input === 'number' || Object.prototype.toString.call(input) === '[object Number]';\n}\n\nfunction isDate(input) {\n    return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';\n}\n\nfunction map(arr, fn) {\n    var res = [], i;\n    for (i = 0; i < arr.length; ++i) {\n        res.push(fn(arr[i], i));\n    }\n    return res;\n}\n\nfunction hasOwnProp(a, b) {\n    return Object.prototype.hasOwnProperty.call(a, b);\n}\n\nfunction extend(a, b) {\n    for (var i in b) {\n        if (hasOwnProp(b, i)) {\n            a[i] = b[i];\n        }\n    }\n\n    if (hasOwnProp(b, 'toString')) {\n        a.toString = b.toString;\n    }\n\n    if (hasOwnProp(b, 'valueOf')) {\n        a.valueOf = b.valueOf;\n    }\n\n    return a;\n}\n\nfunction createUTC (input, format, locale, strict) {\n    return createLocalOrUTC(input, format, locale, strict, true).utc();\n}\n\nfunction defaultParsingFlags() {\n    // We need to deep clone this object.\n    return {\n        empty           : false,\n        unusedTokens    : [],\n        unusedInput     : [],\n        overflow        : -2,\n        charsLeftOver   : 0,\n        nullInput       : false,\n        invalidMonth    : null,\n        invalidFormat   : false,\n        userInvalidated : false,\n        iso             : false,\n        parsedDateParts : [],\n        meridiem        : null,\n        rfc2822         : false,\n        weekdayMismatch : false\n    };\n}\n\nfunction getParsingFlags(m) {\n    if (m._pf == null) {\n        m._pf = defaultParsingFlags();\n    }\n    return m._pf;\n}\n\nvar some;\nif (Array.prototype.some) {\n    some = Array.prototype.some;\n} else {\n    some = function (fun) {\n        var t = Object(this);\n        var len = t.length >>> 0;\n\n        for (var i = 0; i < len; i++) {\n            if (i in t && fun.call(this, t[i], i, t)) {\n                return true;\n            }\n        }\n\n        return false;\n    };\n}\n\nvar some$1 = some;\n\nfunction isValid(m) {\n    if (m._isValid == null) {\n        var flags = getParsingFlags(m);\n        var parsedParts = some$1.call(flags.parsedDateParts, function (i) {\n            return i != null;\n        });\n        var isNowValid = !isNaN(m._d.getTime()) &&\n            flags.overflow < 0 &&\n            !flags.empty &&\n            !flags.invalidMonth &&\n            !flags.invalidWeekday &&\n            !flags.nullInput &&\n            !flags.invalidFormat &&\n            !flags.userInvalidated &&\n            (!flags.meridiem || (flags.meridiem && parsedParts));\n\n        if (m._strict) {\n            isNowValid = isNowValid &&\n                flags.charsLeftOver === 0 &&\n                flags.unusedTokens.length === 0 &&\n                flags.bigHour === undefined;\n        }\n\n        if (Object.isFrozen == null || !Object.isFrozen(m)) {\n            m._isValid = isNowValid;\n        }\n        else {\n            return isNowValid;\n        }\n    }\n    return m._isValid;\n}\n\nfunction createInvalid (flags) {\n    var m = createUTC(NaN);\n    if (flags != null) {\n        extend(getParsingFlags(m), flags);\n    }\n    else {\n        getParsingFlags(m).userInvalidated = true;\n    }\n\n    return m;\n}\n\n// Plugins that add properties should also add the key here (null value),\n// so we can properly clone ourselves.\nvar momentProperties = hooks.momentProperties = [];\n\nfunction copyConfig(to, from) {\n    var i, prop, val;\n\n    if (!isUndefined(from._isAMomentObject)) {\n        to._isAMomentObject = from._isAMomentObject;\n    }\n    if (!isUndefined(from._i)) {\n        to._i = from._i;\n    }\n    if (!isUndefined(from._f)) {\n        to._f = from._f;\n    }\n    if (!isUndefined(from._l)) {\n        to._l = from._l;\n    }\n    if (!isUndefined(from._strict)) {\n        to._strict = from._strict;\n    }\n    if (!isUndefined(from._tzm)) {\n        to._tzm = from._tzm;\n    }\n    if (!isUndefined(from._isUTC)) {\n        to._isUTC = from._isUTC;\n    }\n    if (!isUndefined(from._offset)) {\n        to._offset = from._offset;\n    }\n    if (!isUndefined(from._pf)) {\n        to._pf = getParsingFlags(from);\n    }\n    if (!isUndefined(from._locale)) {\n        to._locale = from._locale;\n    }\n\n    if (momentProperties.length > 0) {\n        for (i = 0; i < momentProperties.length; i++) {\n            prop = momentProperties[i];\n            val = from[prop];\n            if (!isUndefined(val)) {\n                to[prop] = val;\n            }\n        }\n    }\n\n    return to;\n}\n\nvar updateInProgress = false;\n\n// Moment prototype object\nfunction Moment(config) {\n    copyConfig(this, config);\n    this._d = new Date(config._d != null ? config._d.getTime() : NaN);\n    if (!this.isValid()) {\n        this._d = new Date(NaN);\n    }\n    // Prevent infinite loop in case updateOffset creates new moment\n    // objects.\n    if (updateInProgress === false) {\n        updateInProgress = true;\n        hooks.updateOffset(this);\n        updateInProgress = false;\n    }\n}\n\nfunction isMoment (obj) {\n    return obj instanceof Moment || (obj != null && obj._isAMomentObject != null);\n}\n\nfunction absFloor (number) {\n    if (number < 0) {\n        // -0 -> 0\n        return Math.ceil(number) || 0;\n    } else {\n        return Math.floor(number);\n    }\n}\n\nfunction toInt(argumentForCoercion) {\n    var coercedNumber = +argumentForCoercion,\n        value = 0;\n\n    if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n        value = absFloor(coercedNumber);\n    }\n\n    return value;\n}\n\n// compare two arrays, return the number of differences\nfunction compareArrays(array1, array2, dontConvert) {\n    var len = Math.min(array1.length, array2.length),\n        lengthDiff = Math.abs(array1.length - array2.length),\n        diffs = 0,\n        i;\n    for (i = 0; i < len; i++) {\n        if ((dontConvert && array1[i] !== array2[i]) ||\n            (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {\n            diffs++;\n        }\n    }\n    return diffs + lengthDiff;\n}\n\nfunction warn(msg) {\n    if (hooks.suppressDeprecationWarnings === false &&\n            (typeof console !==  'undefined') && console.warn) {\n        console.warn('Deprecation warning: ' + msg);\n    }\n}\n\nfunction deprecate(msg, fn) {\n    var firstTime = true;\n\n    return extend(function () {\n        if (hooks.deprecationHandler != null) {\n            hooks.deprecationHandler(null, msg);\n        }\n        if (firstTime) {\n            var args = [];\n            var arg;\n            for (var i = 0; i < arguments.length; i++) {\n                arg = '';\n                if (typeof arguments[i] === 'object') {\n                    arg += '\\n[' + i + '] ';\n                    for (var key in arguments[0]) {\n                        arg += key + ': ' + arguments[0][key] + ', ';\n                    }\n                    arg = arg.slice(0, -2); // Remove trailing comma and space\n                } else {\n                    arg = arguments[i];\n                }\n                args.push(arg);\n            }\n            warn(msg + '\\nArguments: ' + Array.prototype.slice.call(args).join('') + '\\n' + (new Error()).stack);\n            firstTime = false;\n        }\n        return fn.apply(this, arguments);\n    }, fn);\n}\n\nvar deprecations = {};\n\nfunction deprecateSimple(name, msg) {\n    if (hooks.deprecationHandler != null) {\n        hooks.deprecationHandler(name, msg);\n    }\n    if (!deprecations[name]) {\n        warn(msg);\n        deprecations[name] = true;\n    }\n}\n\nhooks.suppressDeprecationWarnings = false;\nhooks.deprecationHandler = null;\n\nfunction isFunction(input) {\n    return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';\n}\n\nfunction set (config) {\n    var prop, i;\n    for (i in config) {\n        prop = config[i];\n        if (isFunction(prop)) {\n            this[i] = prop;\n        } else {\n            this['_' + i] = prop;\n        }\n    }\n    this._config = config;\n    // Lenient ordinal parsing accepts just a number in addition to\n    // number + (possibly) stuff coming from _dayOfMonthOrdinalParse.\n    // TODO: Remove \"ordinalParse\" fallback in next major release.\n    this._dayOfMonthOrdinalParseLenient = new RegExp(\n        (this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) +\n            '|' + (/\\d{1,2}/).source);\n}\n\nfunction mergeConfigs(parentConfig, childConfig) {\n    var res = extend({}, parentConfig), prop;\n    for (prop in childConfig) {\n        if (hasOwnProp(childConfig, prop)) {\n            if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {\n                res[prop] = {};\n                extend(res[prop], parentConfig[prop]);\n                extend(res[prop], childConfig[prop]);\n            } else if (childConfig[prop] != null) {\n                res[prop] = childConfig[prop];\n            } else {\n                delete res[prop];\n            }\n        }\n    }\n    for (prop in parentConfig) {\n        if (hasOwnProp(parentConfig, prop) &&\n                !hasOwnProp(childConfig, prop) &&\n                isObject(parentConfig[prop])) {\n            // make sure changes to properties don't modify parent config\n            res[prop] = extend({}, res[prop]);\n        }\n    }\n    return res;\n}\n\nfunction Locale(config) {\n    if (config != null) {\n        this.set(config);\n    }\n}\n\nvar keys;\n\nif (Object.keys) {\n    keys = Object.keys;\n} else {\n    keys = function (obj) {\n        var i, res = [];\n        for (i in obj) {\n            if (hasOwnProp(obj, i)) {\n                res.push(i);\n            }\n        }\n        return res;\n    };\n}\n\nvar keys$1 = keys;\n\nvar defaultCalendar = {\n    sameDay : '[Today at] LT',\n    nextDay : '[Tomorrow at] LT',\n    nextWeek : 'dddd [at] LT',\n    lastDay : '[Yesterday at] LT',\n    lastWeek : '[Last] dddd [at] LT',\n    sameElse : 'L'\n};\n\nfunction calendar (key, mom, now) {\n    var output = this._calendar[key] || this._calendar['sameElse'];\n    return isFunction(output) ? output.call(mom, now) : output;\n}\n\nvar defaultLongDateFormat = {\n    LTS  : 'h:mm:ss A',\n    LT   : 'h:mm A',\n    L    : 'MM/DD/YYYY',\n    LL   : 'MMMM D, YYYY',\n    LLL  : 'MMMM D, YYYY h:mm A',\n    LLLL : 'dddd, MMMM D, YYYY h:mm A'\n};\n\nfunction longDateFormat (key) {\n    var format = this._longDateFormat[key],\n        formatUpper = this._longDateFormat[key.toUpperCase()];\n\n    if (format || !formatUpper) {\n        return format;\n    }\n\n    this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {\n        return val.slice(1);\n    });\n\n    return this._longDateFormat[key];\n}\n\nvar defaultInvalidDate = 'Invalid date';\n\nfunction invalidDate () {\n    return this._invalidDate;\n}\n\nvar defaultOrdinal = '%d';\nvar defaultDayOfMonthOrdinalParse = /\\d{1,2}/;\n\nfunction ordinal (number) {\n    return this._ordinal.replace('%d', number);\n}\n\nvar defaultRelativeTime = {\n    future : 'in %s',\n    past   : '%s ago',\n    s  : 'a few seconds',\n    ss : '%d seconds',\n    m  : 'a minute',\n    mm : '%d minutes',\n    h  : 'an hour',\n    hh : '%d hours',\n    d  : 'a day',\n    dd : '%d days',\n    M  : 'a month',\n    MM : '%d months',\n    y  : 'a year',\n    yy : '%d years'\n};\n\nfunction relativeTime (number, withoutSuffix, string, isFuture) {\n    var output = this._relativeTime[string];\n    return (isFunction(output)) ?\n        output(number, withoutSuffix, string, isFuture) :\n        output.replace(/%d/i, number);\n}\n\nfunction pastFuture (diff, output) {\n    var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n    return isFunction(format) ? format(output) : format.replace(/%s/i, output);\n}\n\nvar aliases = {};\n\nfunction addUnitAlias (unit, shorthand) {\n    var lowerCase = unit.toLowerCase();\n    aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;\n}\n\nfunction normalizeUnits(units) {\n    return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;\n}\n\nfunction normalizeObjectUnits(inputObject) {\n    var normalizedInput = {},\n        normalizedProp,\n        prop;\n\n    for (prop in inputObject) {\n        if (hasOwnProp(inputObject, prop)) {\n            normalizedProp = normalizeUnits(prop);\n            if (normalizedProp) {\n                normalizedInput[normalizedProp] = inputObject[prop];\n            }\n        }\n    }\n\n    return normalizedInput;\n}\n\nvar priorities = {};\n\nfunction addUnitPriority(unit, priority) {\n    priorities[unit] = priority;\n}\n\nfunction getPrioritizedUnits(unitsObj) {\n    var units = [];\n    for (var u in unitsObj) {\n        units.push({unit: u, priority: priorities[u]});\n    }\n    units.sort(function (a, b) {\n        return a.priority - b.priority;\n    });\n    return units;\n}\n\nfunction makeGetSet (unit, keepTime) {\n    return function (value) {\n        if (value != null) {\n            set$1(this, unit, value);\n            hooks.updateOffset(this, keepTime);\n            return this;\n        } else {\n            return get(this, unit);\n        }\n    };\n}\n\nfunction get (mom, unit) {\n    return mom.isValid() ?\n        mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;\n}\n\nfunction set$1 (mom, unit, value) {\n    if (mom.isValid()) {\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n    }\n}\n\n// MOMENTS\n\nfunction stringGet (units) {\n    units = normalizeUnits(units);\n    if (isFunction(this[units])) {\n        return this[units]();\n    }\n    return this;\n}\n\n\nfunction stringSet (units, value) {\n    if (typeof units === 'object') {\n        units = normalizeObjectUnits(units);\n        var prioritized = getPrioritizedUnits(units);\n        for (var i = 0; i < prioritized.length; i++) {\n            this[prioritized[i].unit](units[prioritized[i].unit]);\n        }\n    } else {\n        units = normalizeUnits(units);\n        if (isFunction(this[units])) {\n            return this[units](value);\n        }\n    }\n    return this;\n}\n\nfunction zeroFill(number, targetLength, forceSign) {\n    var absNumber = '' + Math.abs(number),\n        zerosToFill = targetLength - absNumber.length,\n        sign = number >= 0;\n    return (sign ? (forceSign ? '+' : '') : '-') +\n        Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;\n}\n\nvar formattingTokens = /(\\[[^\\[]*\\])|(\\\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;\n\nvar localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g;\n\nvar formatFunctions = {};\n\nvar formatTokenFunctions = {};\n\n// token:    'M'\n// padded:   ['MM', 2]\n// ordinal:  'Mo'\n// callback: function () { this.month() + 1 }\nfunction addFormatToken (token, padded, ordinal, callback) {\n    var func = callback;\n    if (typeof callback === 'string') {\n        func = function () {\n            return this[callback]();\n        };\n    }\n    if (token) {\n        formatTokenFunctions[token] = func;\n    }\n    if (padded) {\n        formatTokenFunctions[padded[0]] = function () {\n            return zeroFill(func.apply(this, arguments), padded[1], padded[2]);\n        };\n    }\n    if (ordinal) {\n        formatTokenFunctions[ordinal] = function () {\n            return this.localeData().ordinal(func.apply(this, arguments), token);\n        };\n    }\n}\n\nfunction removeFormattingTokens(input) {\n    if (input.match(/\\[[\\s\\S]/)) {\n        return input.replace(/^\\[|\\]$/g, '');\n    }\n    return input.replace(/\\\\/g, '');\n}\n\nfunction makeFormatFunction(format) {\n    var array = format.match(formattingTokens), i, length;\n\n    for (i = 0, length = array.length; i < length; i++) {\n        if (formatTokenFunctions[array[i]]) {\n            array[i] = formatTokenFunctions[array[i]];\n        } else {\n            array[i] = removeFormattingTokens(array[i]);\n        }\n    }\n\n    return function (mom) {\n        var output = '', i;\n        for (i = 0; i < length; i++) {\n            output += isFunction(array[i]) ? array[i].call(mom, format) : array[i];\n        }\n        return output;\n    };\n}\n\n// format date using native date object\nfunction formatMoment(m, format) {\n    if (!m.isValid()) {\n        return m.localeData().invalidDate();\n    }\n\n    format = expandFormat(format, m.localeData());\n    formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);\n\n    return formatFunctions[format](m);\n}\n\nfunction expandFormat(format, locale) {\n    var i = 5;\n\n    function replaceLongDateFormatTokens(input) {\n        return locale.longDateFormat(input) || input;\n    }\n\n    localFormattingTokens.lastIndex = 0;\n    while (i >= 0 && localFormattingTokens.test(format)) {\n        format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);\n        localFormattingTokens.lastIndex = 0;\n        i -= 1;\n    }\n\n    return format;\n}\n\nvar match1         = /\\d/;            //       0 - 9\nvar match2         = /\\d\\d/;          //      00 - 99\nvar match3         = /\\d{3}/;         //     000 - 999\nvar match4         = /\\d{4}/;         //    0000 - 9999\nvar match6         = /[+-]?\\d{6}/;    // -999999 - 999999\nvar match1to2      = /\\d\\d?/;         //       0 - 99\nvar match3to4      = /\\d\\d\\d\\d?/;     //     999 - 9999\nvar match5to6      = /\\d\\d\\d\\d\\d\\d?/; //   99999 - 999999\nvar match1to3      = /\\d{1,3}/;       //       0 - 999\nvar match1to4      = /\\d{1,4}/;       //       0 - 9999\nvar match1to6      = /[+-]?\\d{1,6}/;  // -999999 - 999999\n\nvar matchUnsigned  = /\\d+/;           //       0 - inf\nvar matchSigned    = /[+-]?\\d+/;      //    -inf - inf\n\nvar matchOffset    = /Z|[+-]\\d\\d:?\\d\\d/gi; // +00:00 -00:00 +0000 -0000 or Z\nvar matchShortOffset = /Z|[+-]\\d\\d(?::?\\d\\d)?/gi; // +00 -00 +00:00 -00:00 +0000 -0000 or Z\n\nvar matchTimestamp = /[+-]?\\d+(\\.\\d{1,3})?/; // 123456789 123456789.123\n\n// any word (or two) characters or numbers including two/three word month in arabic.\n// includes scottish gaelic two word and hyphenated months\nvar matchWord = /[0-9]*['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+|[\\u0600-\\u06FF\\/]+(\\s*?[\\u0600-\\u06FF]+){1,2}/i;\n\n\nvar regexes = {};\n\nfunction addRegexToken (token, regex, strictRegex) {\n    regexes[token] = isFunction(regex) ? regex : function (isStrict, localeData) {\n        return (isStrict && strictRegex) ? strictRegex : regex;\n    };\n}\n\nfunction getParseRegexForToken (token, config) {\n    if (!hasOwnProp(regexes, token)) {\n        return new RegExp(unescapeFormat(token));\n    }\n\n    return regexes[token](config._strict, config._locale);\n}\n\n// Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\nfunction unescapeFormat(s) {\n    return regexEscape(s.replace('\\\\', '').replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g, function (matched, p1, p2, p3, p4) {\n        return p1 || p2 || p3 || p4;\n    }));\n}\n\nfunction regexEscape(s) {\n    return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n\nvar tokens = {};\n\nfunction addParseToken (token, callback) {\n    var i, func = callback;\n    if (typeof token === 'string') {\n        token = [token];\n    }\n    if (isNumber(callback)) {\n        func = function (input, array) {\n            array[callback] = toInt(input);\n        };\n    }\n    for (i = 0; i < token.length; i++) {\n        tokens[token[i]] = func;\n    }\n}\n\nfunction addWeekParseToken (token, callback) {\n    addParseToken(token, function (input, array, config, token) {\n        config._w = config._w || {};\n        callback(input, config._w, config, token);\n    });\n}\n\nfunction addTimeToArrayFromToken(token, input, config) {\n    if (input != null && hasOwnProp(tokens, token)) {\n        tokens[token](input, config._a, config, token);\n    }\n}\n\nvar YEAR = 0;\nvar MONTH = 1;\nvar DATE = 2;\nvar HOUR = 3;\nvar MINUTE = 4;\nvar SECOND = 5;\nvar MILLISECOND = 6;\nvar WEEK = 7;\nvar WEEKDAY = 8;\n\nvar indexOf;\n\nif (Array.prototype.indexOf) {\n    indexOf = Array.prototype.indexOf;\n} else {\n    indexOf = function (o) {\n        // I know\n        var i;\n        for (i = 0; i < this.length; ++i) {\n            if (this[i] === o) {\n                return i;\n            }\n        }\n        return -1;\n    };\n}\n\nvar indexOf$1 = indexOf;\n\nfunction daysInMonth(year, month) {\n    return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n}\n\n// FORMATTING\n\naddFormatToken('M', ['MM', 2], 'Mo', function () {\n    return this.month() + 1;\n});\n\naddFormatToken('MMM', 0, 0, function (format) {\n    return this.localeData().monthsShort(this, format);\n});\n\naddFormatToken('MMMM', 0, 0, function (format) {\n    return this.localeData().months(this, format);\n});\n\n// ALIASES\n\naddUnitAlias('month', 'M');\n\n// PRIORITY\n\naddUnitPriority('month', 8);\n\n// PARSING\n\naddRegexToken('M',    match1to2);\naddRegexToken('MM',   match1to2, match2);\naddRegexToken('MMM',  function (isStrict, locale) {\n    return locale.monthsShortRegex(isStrict);\n});\naddRegexToken('MMMM', function (isStrict, locale) {\n    return locale.monthsRegex(isStrict);\n});\n\naddParseToken(['M', 'MM'], function (input, array) {\n    array[MONTH] = toInt(input) - 1;\n});\n\naddParseToken(['MMM', 'MMMM'], function (input, array, config, token) {\n    var month = config._locale.monthsParse(input, token, config._strict);\n    // if we didn't find a month name, mark the date as invalid.\n    if (month != null) {\n        array[MONTH] = month;\n    } else {\n        getParsingFlags(config).invalidMonth = input;\n    }\n});\n\n// LOCALES\n\nvar MONTHS_IN_FORMAT = /D[oD]?(\\[[^\\[\\]]*\\]|\\s)+MMMM?/;\nvar defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');\nfunction localeMonths (m, format) {\n    if (!m) {\n        return isArray(this._months) ? this._months :\n            this._months['standalone'];\n    }\n    return isArray(this._months) ? this._months[m.month()] :\n        this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format) ? 'format' : 'standalone'][m.month()];\n}\n\nvar defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');\nfunction localeMonthsShort (m, format) {\n    if (!m) {\n        return isArray(this._monthsShort) ? this._monthsShort :\n            this._monthsShort['standalone'];\n    }\n    return isArray(this._monthsShort) ? this._monthsShort[m.month()] :\n        this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];\n}\n\nfunction handleStrictParse(monthName, format, strict) {\n    var i, ii, mom, llc = monthName.toLocaleLowerCase();\n    if (!this._monthsParse) {\n        // this is not used\n        this._monthsParse = [];\n        this._longMonthsParse = [];\n        this._shortMonthsParse = [];\n        for (i = 0; i < 12; ++i) {\n            mom = createUTC([2000, i]);\n            this._shortMonthsParse[i] = this.monthsShort(mom, '').toLocaleLowerCase();\n            this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();\n        }\n    }\n\n    if (strict) {\n        if (format === 'MMM') {\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    } else {\n        if (format === 'MMM') {\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._longMonthsParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortMonthsParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    }\n}\n\nfunction localeMonthsParse (monthName, format, strict) {\n    var i, mom, regex;\n\n    if (this._monthsParseExact) {\n        return handleStrictParse.call(this, monthName, format, strict);\n    }\n\n    if (!this._monthsParse) {\n        this._monthsParse = [];\n        this._longMonthsParse = [];\n        this._shortMonthsParse = [];\n    }\n\n    // TODO: add sorting\n    // Sorting makes sure if one month (or abbr) is a prefix of another\n    // see sorting in computeMonthsParse\n    for (i = 0; i < 12; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, i]);\n        if (strict && !this._longMonthsParse[i]) {\n            this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');\n            this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');\n        }\n        if (!strict && !this._monthsParse[i]) {\n            regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n            this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n        }\n        // test the regex\n        if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {\n            return i;\n        } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {\n            return i;\n        } else if (!strict && this._monthsParse[i].test(monthName)) {\n            return i;\n        }\n    }\n}\n\n// MOMENTS\n\nfunction setMonth (mom, value) {\n    var dayOfMonth;\n\n    if (!mom.isValid()) {\n        // No op\n        return mom;\n    }\n\n    if (typeof value === 'string') {\n        if (/^\\d+$/.test(value)) {\n            value = toInt(value);\n        } else {\n            value = mom.localeData().monthsParse(value);\n            // TODO: Another silent failure?\n            if (!isNumber(value)) {\n                return mom;\n            }\n        }\n    }\n\n    dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));\n    mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n    return mom;\n}\n\nfunction getSetMonth (value) {\n    if (value != null) {\n        setMonth(this, value);\n        hooks.updateOffset(this, true);\n        return this;\n    } else {\n        return get(this, 'Month');\n    }\n}\n\nfunction getDaysInMonth () {\n    return daysInMonth(this.year(), this.month());\n}\n\nvar defaultMonthsShortRegex = matchWord;\nfunction monthsShortRegex (isStrict) {\n    if (this._monthsParseExact) {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            computeMonthsParse.call(this);\n        }\n        if (isStrict) {\n            return this._monthsShortStrictRegex;\n        } else {\n            return this._monthsShortRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_monthsShortRegex')) {\n            this._monthsShortRegex = defaultMonthsShortRegex;\n        }\n        return this._monthsShortStrictRegex && isStrict ?\n            this._monthsShortStrictRegex : this._monthsShortRegex;\n    }\n}\n\nvar defaultMonthsRegex = matchWord;\nfunction monthsRegex (isStrict) {\n    if (this._monthsParseExact) {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            computeMonthsParse.call(this);\n        }\n        if (isStrict) {\n            return this._monthsStrictRegex;\n        } else {\n            return this._monthsRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_monthsRegex')) {\n            this._monthsRegex = defaultMonthsRegex;\n        }\n        return this._monthsStrictRegex && isStrict ?\n            this._monthsStrictRegex : this._monthsRegex;\n    }\n}\n\nfunction computeMonthsParse () {\n    function cmpLenRev(a, b) {\n        return b.length - a.length;\n    }\n\n    var shortPieces = [], longPieces = [], mixedPieces = [],\n        i, mom;\n    for (i = 0; i < 12; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, i]);\n        shortPieces.push(this.monthsShort(mom, ''));\n        longPieces.push(this.months(mom, ''));\n        mixedPieces.push(this.months(mom, ''));\n        mixedPieces.push(this.monthsShort(mom, ''));\n    }\n    // Sorting makes sure if one month (or abbr) is a prefix of another it\n    // will match the longer piece.\n    shortPieces.sort(cmpLenRev);\n    longPieces.sort(cmpLenRev);\n    mixedPieces.sort(cmpLenRev);\n    for (i = 0; i < 12; i++) {\n        shortPieces[i] = regexEscape(shortPieces[i]);\n        longPieces[i] = regexEscape(longPieces[i]);\n    }\n    for (i = 0; i < 24; i++) {\n        mixedPieces[i] = regexEscape(mixedPieces[i]);\n    }\n\n    this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n    this._monthsShortRegex = this._monthsRegex;\n    this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');\n    this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');\n}\n\n// FORMATTING\n\naddFormatToken('Y', 0, 0, function () {\n    var y = this.year();\n    return y <= 9999 ? '' + y : '+' + y;\n});\n\naddFormatToken(0, ['YY', 2], 0, function () {\n    return this.year() % 100;\n});\n\naddFormatToken(0, ['YYYY',   4],       0, 'year');\naddFormatToken(0, ['YYYYY',  5],       0, 'year');\naddFormatToken(0, ['YYYYYY', 6, true], 0, 'year');\n\n// ALIASES\n\naddUnitAlias('year', 'y');\n\n// PRIORITIES\n\naddUnitPriority('year', 1);\n\n// PARSING\n\naddRegexToken('Y',      matchSigned);\naddRegexToken('YY',     match1to2, match2);\naddRegexToken('YYYY',   match1to4, match4);\naddRegexToken('YYYYY',  match1to6, match6);\naddRegexToken('YYYYYY', match1to6, match6);\n\naddParseToken(['YYYYY', 'YYYYYY'], YEAR);\naddParseToken('YYYY', function (input, array) {\n    array[YEAR] = input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);\n});\naddParseToken('YY', function (input, array) {\n    array[YEAR] = hooks.parseTwoDigitYear(input);\n});\naddParseToken('Y', function (input, array) {\n    array[YEAR] = parseInt(input, 10);\n});\n\n// HELPERS\n\nfunction daysInYear(year) {\n    return isLeapYear(year) ? 366 : 365;\n}\n\nfunction isLeapYear(year) {\n    return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n}\n\n// HOOKS\n\nhooks.parseTwoDigitYear = function (input) {\n    return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n};\n\n// MOMENTS\n\nvar getSetYear = makeGetSet('FullYear', true);\n\nfunction getIsLeapYear () {\n    return isLeapYear(this.year());\n}\n\nfunction createDate (y, m, d, h, M, s, ms) {\n    // can't just apply() to create a date:\n    // https://stackoverflow.com/q/181348\n    var date = new Date(y, m, d, h, M, s, ms);\n\n    // the date constructor remaps years 0-99 to 1900-1999\n    if (y < 100 && y >= 0 && isFinite(date.getFullYear())) {\n        date.setFullYear(y);\n    }\n    return date;\n}\n\nfunction createUTCDate (y) {\n    var date = new Date(Date.UTC.apply(null, arguments));\n\n    // the Date.UTC function remaps years 0-99 to 1900-1999\n    if (y < 100 && y >= 0 && isFinite(date.getUTCFullYear())) {\n        date.setUTCFullYear(y);\n    }\n    return date;\n}\n\n// start-of-first-week - start-of-year\nfunction firstWeekOffset(year, dow, doy) {\n    var // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n        fwd = 7 + dow - doy,\n        // first-week day local weekday -- which local weekday is fwd\n        fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;\n\n    return -fwdlw + fwd - 1;\n}\n\n// https://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\nfunction dayOfYearFromWeeks(year, week, weekday, dow, doy) {\n    var localWeekday = (7 + weekday - dow) % 7,\n        weekOffset = firstWeekOffset(year, dow, doy),\n        dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,\n        resYear, resDayOfYear;\n\n    if (dayOfYear <= 0) {\n        resYear = year - 1;\n        resDayOfYear = daysInYear(resYear) + dayOfYear;\n    } else if (dayOfYear > daysInYear(year)) {\n        resYear = year + 1;\n        resDayOfYear = dayOfYear - daysInYear(year);\n    } else {\n        resYear = year;\n        resDayOfYear = dayOfYear;\n    }\n\n    return {\n        year: resYear,\n        dayOfYear: resDayOfYear\n    };\n}\n\nfunction weekOfYear(mom, dow, doy) {\n    var weekOffset = firstWeekOffset(mom.year(), dow, doy),\n        week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,\n        resWeek, resYear;\n\n    if (week < 1) {\n        resYear = mom.year() - 1;\n        resWeek = week + weeksInYear(resYear, dow, doy);\n    } else if (week > weeksInYear(mom.year(), dow, doy)) {\n        resWeek = week - weeksInYear(mom.year(), dow, doy);\n        resYear = mom.year() + 1;\n    } else {\n        resYear = mom.year();\n        resWeek = week;\n    }\n\n    return {\n        week: resWeek,\n        year: resYear\n    };\n}\n\nfunction weeksInYear(year, dow, doy) {\n    var weekOffset = firstWeekOffset(year, dow, doy),\n        weekOffsetNext = firstWeekOffset(year + 1, dow, doy);\n    return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;\n}\n\n// FORMATTING\n\naddFormatToken('w', ['ww', 2], 'wo', 'week');\naddFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');\n\n// ALIASES\n\naddUnitAlias('week', 'w');\naddUnitAlias('isoWeek', 'W');\n\n// PRIORITIES\n\naddUnitPriority('week', 5);\naddUnitPriority('isoWeek', 5);\n\n// PARSING\n\naddRegexToken('w',  match1to2);\naddRegexToken('ww', match1to2, match2);\naddRegexToken('W',  match1to2);\naddRegexToken('WW', match1to2, match2);\n\naddWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {\n    week[token.substr(0, 1)] = toInt(input);\n});\n\n// HELPERS\n\n// LOCALES\n\nfunction localeWeek (mom) {\n    return weekOfYear(mom, this._week.dow, this._week.doy).week;\n}\n\nvar defaultLocaleWeek = {\n    dow : 0, // Sunday is the first day of the week.\n    doy : 6  // The week that contains Jan 1st is the first week of the year.\n};\n\nfunction localeFirstDayOfWeek () {\n    return this._week.dow;\n}\n\nfunction localeFirstDayOfYear () {\n    return this._week.doy;\n}\n\n// MOMENTS\n\nfunction getSetWeek (input) {\n    var week = this.localeData().week(this);\n    return input == null ? week : this.add((input - week) * 7, 'd');\n}\n\nfunction getSetISOWeek (input) {\n    var week = weekOfYear(this, 1, 4).week;\n    return input == null ? week : this.add((input - week) * 7, 'd');\n}\n\n// FORMATTING\n\naddFormatToken('d', 0, 'do', 'day');\n\naddFormatToken('dd', 0, 0, function (format) {\n    return this.localeData().weekdaysMin(this, format);\n});\n\naddFormatToken('ddd', 0, 0, function (format) {\n    return this.localeData().weekdaysShort(this, format);\n});\n\naddFormatToken('dddd', 0, 0, function (format) {\n    return this.localeData().weekdays(this, format);\n});\n\naddFormatToken('e', 0, 0, 'weekday');\naddFormatToken('E', 0, 0, 'isoWeekday');\n\n// ALIASES\n\naddUnitAlias('day', 'd');\naddUnitAlias('weekday', 'e');\naddUnitAlias('isoWeekday', 'E');\n\n// PRIORITY\naddUnitPriority('day', 11);\naddUnitPriority('weekday', 11);\naddUnitPriority('isoWeekday', 11);\n\n// PARSING\n\naddRegexToken('d',    match1to2);\naddRegexToken('e',    match1to2);\naddRegexToken('E',    match1to2);\naddRegexToken('dd',   function (isStrict, locale) {\n    return locale.weekdaysMinRegex(isStrict);\n});\naddRegexToken('ddd',   function (isStrict, locale) {\n    return locale.weekdaysShortRegex(isStrict);\n});\naddRegexToken('dddd',   function (isStrict, locale) {\n    return locale.weekdaysRegex(isStrict);\n});\n\naddWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {\n    var weekday = config._locale.weekdaysParse(input, token, config._strict);\n    // if we didn't get a weekday name, mark the date as invalid\n    if (weekday != null) {\n        week.d = weekday;\n    } else {\n        getParsingFlags(config).invalidWeekday = input;\n    }\n});\n\naddWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {\n    week[token] = toInt(input);\n});\n\n// HELPERS\n\nfunction parseWeekday(input, locale) {\n    if (typeof input !== 'string') {\n        return input;\n    }\n\n    if (!isNaN(input)) {\n        return parseInt(input, 10);\n    }\n\n    input = locale.weekdaysParse(input);\n    if (typeof input === 'number') {\n        return input;\n    }\n\n    return null;\n}\n\nfunction parseIsoWeekday(input, locale) {\n    if (typeof input === 'string') {\n        return locale.weekdaysParse(input) % 7 || 7;\n    }\n    return isNaN(input) ? null : input;\n}\n\n// LOCALES\n\nvar defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');\nfunction localeWeekdays (m, format) {\n    if (!m) {\n        return isArray(this._weekdays) ? this._weekdays :\n            this._weekdays['standalone'];\n    }\n    return isArray(this._weekdays) ? this._weekdays[m.day()] :\n        this._weekdays[this._weekdays.isFormat.test(format) ? 'format' : 'standalone'][m.day()];\n}\n\nvar defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');\nfunction localeWeekdaysShort (m) {\n    return (m) ? this._weekdaysShort[m.day()] : this._weekdaysShort;\n}\n\nvar defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');\nfunction localeWeekdaysMin (m) {\n    return (m) ? this._weekdaysMin[m.day()] : this._weekdaysMin;\n}\n\nfunction handleStrictParse$1(weekdayName, format, strict) {\n    var i, ii, mom, llc = weekdayName.toLocaleLowerCase();\n    if (!this._weekdaysParse) {\n        this._weekdaysParse = [];\n        this._shortWeekdaysParse = [];\n        this._minWeekdaysParse = [];\n\n        for (i = 0; i < 7; ++i) {\n            mom = createUTC([2000, 1]).day(i);\n            this._minWeekdaysParse[i] = this.weekdaysMin(mom, '').toLocaleLowerCase();\n            this._shortWeekdaysParse[i] = this.weekdaysShort(mom, '').toLocaleLowerCase();\n            this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();\n        }\n    }\n\n    if (strict) {\n        if (format === 'dddd') {\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else if (format === 'ddd') {\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    } else {\n        if (format === 'dddd') {\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else if (format === 'ddd') {\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        } else {\n            ii = indexOf$1.call(this._minWeekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._weekdaysParse, llc);\n            if (ii !== -1) {\n                return ii;\n            }\n            ii = indexOf$1.call(this._shortWeekdaysParse, llc);\n            return ii !== -1 ? ii : null;\n        }\n    }\n}\n\nfunction localeWeekdaysParse (weekdayName, format, strict) {\n    var i, mom, regex;\n\n    if (this._weekdaysParseExact) {\n        return handleStrictParse$1.call(this, weekdayName, format, strict);\n    }\n\n    if (!this._weekdaysParse) {\n        this._weekdaysParse = [];\n        this._minWeekdaysParse = [];\n        this._shortWeekdaysParse = [];\n        this._fullWeekdaysParse = [];\n    }\n\n    for (i = 0; i < 7; i++) {\n        // make the regex if we don't have it already\n\n        mom = createUTC([2000, 1]).day(i);\n        if (strict && !this._fullWeekdaysParse[i]) {\n            this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\\.?') + '$', 'i');\n            this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\\.?') + '$', 'i');\n            this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\\.?') + '$', 'i');\n        }\n        if (!this._weekdaysParse[i]) {\n            regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');\n            this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n        }\n        // test the regex\n        if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {\n            return i;\n        } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {\n            return i;\n        }\n    }\n}\n\n// MOMENTS\n\nfunction getSetDayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n    if (input != null) {\n        input = parseWeekday(input, this.localeData());\n        return this.add(input - day, 'd');\n    } else {\n        return day;\n    }\n}\n\nfunction getSetLocaleDayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;\n    return input == null ? weekday : this.add(input - weekday, 'd');\n}\n\nfunction getSetISODayOfWeek (input) {\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n\n    // behaves the same as moment#day except\n    // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n    // as a setter, sunday should belong to the previous week.\n\n    if (input != null) {\n        var weekday = parseIsoWeekday(input, this.localeData());\n        return this.day(this.day() % 7 ? weekday : weekday - 7);\n    } else {\n        return this.day() || 7;\n    }\n}\n\nvar defaultWeekdaysRegex = matchWord;\nfunction weekdaysRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysStrictRegex;\n        } else {\n            return this._weekdaysRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            this._weekdaysRegex = defaultWeekdaysRegex;\n        }\n        return this._weekdaysStrictRegex && isStrict ?\n            this._weekdaysStrictRegex : this._weekdaysRegex;\n    }\n}\n\nvar defaultWeekdaysShortRegex = matchWord;\nfunction weekdaysShortRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysShortStrictRegex;\n        } else {\n            return this._weekdaysShortRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysShortRegex')) {\n            this._weekdaysShortRegex = defaultWeekdaysShortRegex;\n        }\n        return this._weekdaysShortStrictRegex && isStrict ?\n            this._weekdaysShortStrictRegex : this._weekdaysShortRegex;\n    }\n}\n\nvar defaultWeekdaysMinRegex = matchWord;\nfunction weekdaysMinRegex (isStrict) {\n    if (this._weekdaysParseExact) {\n        if (!hasOwnProp(this, '_weekdaysRegex')) {\n            computeWeekdaysParse.call(this);\n        }\n        if (isStrict) {\n            return this._weekdaysMinStrictRegex;\n        } else {\n            return this._weekdaysMinRegex;\n        }\n    } else {\n        if (!hasOwnProp(this, '_weekdaysMinRegex')) {\n            this._weekdaysMinRegex = defaultWeekdaysMinRegex;\n        }\n        return this._weekdaysMinStrictRegex && isStrict ?\n            this._weekdaysMinStrictRegex : this._weekdaysMinRegex;\n    }\n}\n\n\nfunction computeWeekdaysParse () {\n    function cmpLenRev(a, b) {\n        return b.length - a.length;\n    }\n\n    var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [],\n        i, mom, minp, shortp, longp;\n    for (i = 0; i < 7; i++) {\n        // make the regex if we don't have it already\n        mom = createUTC([2000, 1]).day(i);\n        minp = this.weekdaysMin(mom, '');\n        shortp = this.weekdaysShort(mom, '');\n        longp = this.weekdays(mom, '');\n        minPieces.push(minp);\n        shortPieces.push(shortp);\n        longPieces.push(longp);\n        mixedPieces.push(minp);\n        mixedPieces.push(shortp);\n        mixedPieces.push(longp);\n    }\n    // Sorting makes sure if one weekday (or abbr) is a prefix of another it\n    // will match the longer piece.\n    minPieces.sort(cmpLenRev);\n    shortPieces.sort(cmpLenRev);\n    longPieces.sort(cmpLenRev);\n    mixedPieces.sort(cmpLenRev);\n    for (i = 0; i < 7; i++) {\n        shortPieces[i] = regexEscape(shortPieces[i]);\n        longPieces[i] = regexEscape(longPieces[i]);\n        mixedPieces[i] = regexEscape(mixedPieces[i]);\n    }\n\n    this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n    this._weekdaysShortRegex = this._weekdaysRegex;\n    this._weekdaysMinRegex = this._weekdaysRegex;\n\n    this._weekdaysStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');\n    this._weekdaysShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');\n    this._weekdaysMinStrictRegex = new RegExp('^(' + minPieces.join('|') + ')', 'i');\n}\n\n// FORMATTING\n\nfunction hFormat() {\n    return this.hours() % 12 || 12;\n}\n\nfunction kFormat() {\n    return this.hours() || 24;\n}\n\naddFormatToken('H', ['HH', 2], 0, 'hour');\naddFormatToken('h', ['hh', 2], 0, hFormat);\naddFormatToken('k', ['kk', 2], 0, kFormat);\n\naddFormatToken('hmm', 0, 0, function () {\n    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);\n});\n\naddFormatToken('hmmss', 0, 0, function () {\n    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2) +\n        zeroFill(this.seconds(), 2);\n});\n\naddFormatToken('Hmm', 0, 0, function () {\n    return '' + this.hours() + zeroFill(this.minutes(), 2);\n});\n\naddFormatToken('Hmmss', 0, 0, function () {\n    return '' + this.hours() + zeroFill(this.minutes(), 2) +\n        zeroFill(this.seconds(), 2);\n});\n\nfunction meridiem (token, lowercase) {\n    addFormatToken(token, 0, 0, function () {\n        return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);\n    });\n}\n\nmeridiem('a', true);\nmeridiem('A', false);\n\n// ALIASES\n\naddUnitAlias('hour', 'h');\n\n// PRIORITY\naddUnitPriority('hour', 13);\n\n// PARSING\n\nfunction matchMeridiem (isStrict, locale) {\n    return locale._meridiemParse;\n}\n\naddRegexToken('a',  matchMeridiem);\naddRegexToken('A',  matchMeridiem);\naddRegexToken('H',  match1to2);\naddRegexToken('h',  match1to2);\naddRegexToken('k',  match1to2);\naddRegexToken('HH', match1to2, match2);\naddRegexToken('hh', match1to2, match2);\naddRegexToken('kk', match1to2, match2);\n\naddRegexToken('hmm', match3to4);\naddRegexToken('hmmss', match5to6);\naddRegexToken('Hmm', match3to4);\naddRegexToken('Hmmss', match5to6);\n\naddParseToken(['H', 'HH'], HOUR);\naddParseToken(['k', 'kk'], function (input, array, config) {\n    var kInput = toInt(input);\n    array[HOUR] = kInput === 24 ? 0 : kInput;\n});\naddParseToken(['a', 'A'], function (input, array, config) {\n    config._isPm = config._locale.isPM(input);\n    config._meridiem = input;\n});\naddParseToken(['h', 'hh'], function (input, array, config) {\n    array[HOUR] = toInt(input);\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('hmm', function (input, array, config) {\n    var pos = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos));\n    array[MINUTE] = toInt(input.substr(pos));\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('hmmss', function (input, array, config) {\n    var pos1 = input.length - 4;\n    var pos2 = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos1));\n    array[MINUTE] = toInt(input.substr(pos1, 2));\n    array[SECOND] = toInt(input.substr(pos2));\n    getParsingFlags(config).bigHour = true;\n});\naddParseToken('Hmm', function (input, array, config) {\n    var pos = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos));\n    array[MINUTE] = toInt(input.substr(pos));\n});\naddParseToken('Hmmss', function (input, array, config) {\n    var pos1 = input.length - 4;\n    var pos2 = input.length - 2;\n    array[HOUR] = toInt(input.substr(0, pos1));\n    array[MINUTE] = toInt(input.substr(pos1, 2));\n    array[SECOND] = toInt(input.substr(pos2));\n});\n\n// LOCALES\n\nfunction localeIsPM (input) {\n    // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n    // Using charAt should be more compatible.\n    return ((input + '').toLowerCase().charAt(0) === 'p');\n}\n\nvar defaultLocaleMeridiemParse = /[ap]\\.?m?\\.?/i;\nfunction localeMeridiem (hours, minutes, isLower) {\n    if (hours > 11) {\n        return isLower ? 'pm' : 'PM';\n    } else {\n        return isLower ? 'am' : 'AM';\n    }\n}\n\n\n// MOMENTS\n\n// Setting the hour should keep the time, because the user explicitly\n// specified which hour he wants. So trying to maintain the same hour (in\n// a new timezone) makes sense. Adding/subtracting hours does not follow\n// this rule.\nvar getSetHour = makeGetSet('Hours', true);\n\n// months\n// week\n// weekdays\n// meridiem\nvar baseConfig = {\n    calendar: defaultCalendar,\n    longDateFormat: defaultLongDateFormat,\n    invalidDate: defaultInvalidDate,\n    ordinal: defaultOrdinal,\n    dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,\n    relativeTime: defaultRelativeTime,\n\n    months: defaultLocaleMonths,\n    monthsShort: defaultLocaleMonthsShort,\n\n    week: defaultLocaleWeek,\n\n    weekdays: defaultLocaleWeekdays,\n    weekdaysMin: defaultLocaleWeekdaysMin,\n    weekdaysShort: defaultLocaleWeekdaysShort,\n\n    meridiemParse: defaultLocaleMeridiemParse\n};\n\n// internal storage for locale config files\nvar locales = {};\nvar localeFamilies = {};\nvar globalLocale;\n\nfunction normalizeLocale(key) {\n    return key ? key.toLowerCase().replace('_', '-') : key;\n}\n\n// pick the locale from the array\n// try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n// substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\nfunction chooseLocale(names) {\n    var i = 0, j, next, locale, split;\n\n    while (i < names.length) {\n        split = normalizeLocale(names[i]).split('-');\n        j = split.length;\n        next = normalizeLocale(names[i + 1]);\n        next = next ? next.split('-') : null;\n        while (j > 0) {\n            locale = loadLocale(split.slice(0, j).join('-'));\n            if (locale) {\n                return locale;\n            }\n            if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {\n                //the next array item is better than a shallower substring of this one\n                break;\n            }\n            j--;\n        }\n        i++;\n    }\n    return null;\n}\n\nfunction loadLocale(name) {\n    var oldLocale = null;\n    // TODO: Find a better way to register and load all the locales in Node\n    if (!locales[name] && (typeof module !== 'undefined') &&\n            module && module.exports) {\n        try {\n            oldLocale = globalLocale._abbr;\n            require('./locale/' + name);\n            // because defineLocale currently also sets the global locale, we\n            // want to undo that for lazy loaded locales\n            getSetGlobalLocale(oldLocale);\n        } catch (e) { }\n    }\n    return locales[name];\n}\n\n// This function will load locale and then set the global locale.  If\n// no arguments are passed in, it will simply return the current global\n// locale key.\nfunction getSetGlobalLocale (key, values) {\n    var data;\n    if (key) {\n        if (isUndefined(values)) {\n            data = getLocale(key);\n        }\n        else {\n            data = defineLocale(key, values);\n        }\n\n        if (data) {\n            // moment.duration._locale = moment._locale = data;\n            globalLocale = data;\n        }\n    }\n\n    return globalLocale._abbr;\n}\n\nfunction defineLocale (name, config) {\n    if (config !== null) {\n        var parentConfig = baseConfig;\n        config.abbr = name;\n        if (locales[name] != null) {\n            deprecateSimple('defineLocaleOverride',\n                    'use moment.updateLocale(localeName, config) to change ' +\n                    'an existing locale. moment.defineLocale(localeName, ' +\n                    'config) should only be used for creating a new locale ' +\n                    'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');\n            parentConfig = locales[name]._config;\n        } else if (config.parentLocale != null) {\n            if (locales[config.parentLocale] != null) {\n                parentConfig = locales[config.parentLocale]._config;\n            } else {\n                if (!localeFamilies[config.parentLocale]) {\n                    localeFamilies[config.parentLocale] = [];\n                }\n                localeFamilies[config.parentLocale].push({\n                    name: name,\n                    config: config\n                });\n                return null;\n            }\n        }\n        locales[name] = new Locale(mergeConfigs(parentConfig, config));\n\n        if (localeFamilies[name]) {\n            localeFamilies[name].forEach(function (x) {\n                defineLocale(x.name, x.config);\n            });\n        }\n\n        // backwards compat for now: also set the locale\n        // make sure we set the locale AFTER all child locales have been\n        // created, so we won't end up with the child locale set.\n        getSetGlobalLocale(name);\n\n\n        return locales[name];\n    } else {\n        // useful for testing\n        delete locales[name];\n        return null;\n    }\n}\n\nfunction updateLocale(name, config) {\n    if (config != null) {\n        var locale, parentConfig = baseConfig;\n        // MERGE\n        if (locales[name] != null) {\n            parentConfig = locales[name]._config;\n        }\n        config = mergeConfigs(parentConfig, config);\n        locale = new Locale(config);\n        locale.parentLocale = locales[name];\n        locales[name] = locale;\n\n        // backwards compat for now: also set the locale\n        getSetGlobalLocale(name);\n    } else {\n        // pass null for config to unupdate, useful for tests\n        if (locales[name] != null) {\n            if (locales[name].parentLocale != null) {\n                locales[name] = locales[name].parentLocale;\n            } else if (locales[name] != null) {\n                delete locales[name];\n            }\n        }\n    }\n    return locales[name];\n}\n\n// returns locale data\nfunction getLocale (key) {\n    var locale;\n\n    if (key && key._locale && key._locale._abbr) {\n        key = key._locale._abbr;\n    }\n\n    if (!key) {\n        return globalLocale;\n    }\n\n    if (!isArray(key)) {\n        //short-circuit everything else\n        locale = loadLocale(key);\n        if (locale) {\n            return locale;\n        }\n        key = [key];\n    }\n\n    return chooseLocale(key);\n}\n\nfunction listLocales() {\n    return keys$1(locales);\n}\n\nfunction checkOverflow (m) {\n    var overflow;\n    var a = m._a;\n\n    if (a && getParsingFlags(m).overflow === -2) {\n        overflow =\n            a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :\n            a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :\n            a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :\n            a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :\n            a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :\n            a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :\n            -1;\n\n        if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {\n            overflow = DATE;\n        }\n        if (getParsingFlags(m)._overflowWeeks && overflow === -1) {\n            overflow = WEEK;\n        }\n        if (getParsingFlags(m)._overflowWeekday && overflow === -1) {\n            overflow = WEEKDAY;\n        }\n\n        getParsingFlags(m).overflow = overflow;\n    }\n\n    return m;\n}\n\n// iso 8601 regex\n// 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)\nvar extendedIsoRegex = /^\\s*((?:[+-]\\d{6}|\\d{4})-(?:\\d\\d-\\d\\d|W\\d\\d-\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?::\\d\\d(?::\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\nvar basicIsoRegex = /^\\s*((?:[+-]\\d{6}|\\d{4})(?:\\d\\d\\d\\d|W\\d\\d\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?:\\d\\d(?:\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\n\nvar tzRegex = /Z|[+-]\\d\\d(?::?\\d\\d)?/;\n\nvar isoDates = [\n    ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d\\d-\\d\\d/],\n    ['YYYY-MM-DD', /\\d{4}-\\d\\d-\\d\\d/],\n    ['GGGG-[W]WW-E', /\\d{4}-W\\d\\d-\\d/],\n    ['GGGG-[W]WW', /\\d{4}-W\\d\\d/, false],\n    ['YYYY-DDD', /\\d{4}-\\d{3}/],\n    ['YYYY-MM', /\\d{4}-\\d\\d/, false],\n    ['YYYYYYMMDD', /[+-]\\d{10}/],\n    ['YYYYMMDD', /\\d{8}/],\n    // YYYYMM is NOT allowed by the standard\n    ['GGGG[W]WWE', /\\d{4}W\\d{3}/],\n    ['GGGG[W]WW', /\\d{4}W\\d{2}/, false],\n    ['YYYYDDD', /\\d{7}/]\n];\n\n// iso time formats and regexes\nvar isoTimes = [\n    ['HH:mm:ss.SSSS', /\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n    ['HH:mm:ss,SSSS', /\\d\\d:\\d\\d:\\d\\d,\\d+/],\n    ['HH:mm:ss', /\\d\\d:\\d\\d:\\d\\d/],\n    ['HH:mm', /\\d\\d:\\d\\d/],\n    ['HHmmss.SSSS', /\\d\\d\\d\\d\\d\\d\\.\\d+/],\n    ['HHmmss,SSSS', /\\d\\d\\d\\d\\d\\d,\\d+/],\n    ['HHmmss', /\\d\\d\\d\\d\\d\\d/],\n    ['HHmm', /\\d\\d\\d\\d/],\n    ['HH', /\\d\\d/]\n];\n\nvar aspNetJsonRegex = /^\\/?Date\\((\\-?\\d+)/i;\n\n// date from iso format\nfunction configFromISO(config) {\n    var i, l,\n        string = config._i,\n        match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),\n        allowTime, dateFormat, timeFormat, tzFormat;\n\n    if (match) {\n        getParsingFlags(config).iso = true;\n\n        for (i = 0, l = isoDates.length; i < l; i++) {\n            if (isoDates[i][1].exec(match[1])) {\n                dateFormat = isoDates[i][0];\n                allowTime = isoDates[i][2] !== false;\n                break;\n            }\n        }\n        if (dateFormat == null) {\n            config._isValid = false;\n            return;\n        }\n        if (match[3]) {\n            for (i = 0, l = isoTimes.length; i < l; i++) {\n                if (isoTimes[i][1].exec(match[3])) {\n                    // match[2] should be 'T' or space\n                    timeFormat = (match[2] || ' ') + isoTimes[i][0];\n                    break;\n                }\n            }\n            if (timeFormat == null) {\n                config._isValid = false;\n                return;\n            }\n        }\n        if (!allowTime && timeFormat != null) {\n            config._isValid = false;\n            return;\n        }\n        if (match[4]) {\n            if (tzRegex.exec(match[4])) {\n                tzFormat = 'Z';\n            } else {\n                config._isValid = false;\n                return;\n            }\n        }\n        config._f = dateFormat + (timeFormat || '') + (tzFormat || '');\n        configFromStringAndFormat(config);\n    } else {\n        config._isValid = false;\n    }\n}\n\n// RFC 2822 regex: For details see https://tools.ietf.org/html/rfc2822#section-3.3\nvar basicRfcRegex = /^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\\s)?(\\d?\\d\\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s(?:\\d\\d)?\\d\\d\\s)(\\d\\d:\\d\\d)(\\:\\d\\d)?(\\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\\d{4}))$/;\n\n// date and time from ref 2822 format\nfunction configFromRFC2822(config) {\n    var string, match, dayFormat,\n        dateFormat, timeFormat, tzFormat;\n    var timezones = {\n        ' GMT': ' +0000',\n        ' EDT': ' -0400',\n        ' EST': ' -0500',\n        ' CDT': ' -0500',\n        ' CST': ' -0600',\n        ' MDT': ' -0600',\n        ' MST': ' -0700',\n        ' PDT': ' -0700',\n        ' PST': ' -0800'\n    };\n    var military = 'YXWVUTSRQPONZABCDEFGHIKLM';\n    var timezone, timezoneIndex;\n\n    string = config._i\n        .replace(/\\([^\\)]*\\)|[\\n\\t]/g, ' ') // Remove comments and folding whitespace\n        .replace(/(\\s\\s+)/g, ' ') // Replace multiple-spaces with a single space\n        .replace(/^\\s|\\s$/g, ''); // Remove leading and trailing spaces\n    match = basicRfcRegex.exec(string);\n\n    if (match) {\n        dayFormat = match[1] ? 'ddd' + ((match[1].length === 5) ? ', ' : ' ') : '';\n        dateFormat = 'D MMM ' + ((match[2].length > 10) ? 'YYYY ' : 'YY ');\n        timeFormat = 'HH:mm' + (match[4] ? ':ss' : '');\n\n        // TODO: Replace the vanilla JS Date object with an indepentent day-of-week check.\n        if (match[1]) { // day of week given\n            var momentDate = new Date(match[2]);\n            var momentDay = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][momentDate.getDay()];\n\n            if (match[1].substr(0,3) !== momentDay) {\n                getParsingFlags(config).weekdayMismatch = true;\n                config._isValid = false;\n                return;\n            }\n        }\n\n        switch (match[5].length) {\n            case 2: // military\n                if (timezoneIndex === 0) {\n                    timezone = ' +0000';\n                } else {\n                    timezoneIndex = military.indexOf(match[5][1].toUpperCase()) - 12;\n                    timezone = ((timezoneIndex < 0) ? ' -' : ' +') +\n                        (('' + timezoneIndex).replace(/^-?/, '0')).match(/..$/)[0] + '00';\n                }\n                break;\n            case 4: // Zone\n                timezone = timezones[match[5]];\n                break;\n            default: // UT or +/-9999\n                timezone = timezones[' GMT'];\n        }\n        match[5] = timezone;\n        config._i = match.splice(1).join('');\n        tzFormat = ' ZZ';\n        config._f = dayFormat + dateFormat + timeFormat + tzFormat;\n        configFromStringAndFormat(config);\n        getParsingFlags(config).rfc2822 = true;\n    } else {\n        config._isValid = false;\n    }\n}\n\n// date from iso format or fallback\nfunction configFromString(config) {\n    var matched = aspNetJsonRegex.exec(config._i);\n\n    if (matched !== null) {\n        config._d = new Date(+matched[1]);\n        return;\n    }\n\n    configFromISO(config);\n    if (config._isValid === false) {\n        delete config._isValid;\n    } else {\n        return;\n    }\n\n    configFromRFC2822(config);\n    if (config._isValid === false) {\n        delete config._isValid;\n    } else {\n        return;\n    }\n\n    // Final attempt, use Input Fallback\n    hooks.createFromInputFallback(config);\n}\n\nhooks.createFromInputFallback = deprecate(\n    'value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), ' +\n    'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are ' +\n    'discouraged and will be removed in an upcoming major release. Please refer to ' +\n    'http://momentjs.com/guides/#/warnings/js-date/ for more info.',\n    function (config) {\n        config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));\n    }\n);\n\n// Pick the first defined of two or three arguments.\nfunction defaults(a, b, c) {\n    if (a != null) {\n        return a;\n    }\n    if (b != null) {\n        return b;\n    }\n    return c;\n}\n\nfunction currentDateArray(config) {\n    // hooks is actually the exported moment object\n    var nowValue = new Date(hooks.now());\n    if (config._useUTC) {\n        return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];\n    }\n    return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];\n}\n\n// convert an array to a date.\n// the array should mirror the parameters below\n// note: all values past the year are optional and will default to the lowest possible value.\n// [year, month, day , hour, minute, second, millisecond]\nfunction configFromArray (config) {\n    var i, date, input = [], currentDate, yearToUse;\n\n    if (config._d) {\n        return;\n    }\n\n    currentDate = currentDateArray(config);\n\n    //compute day of the year from weeks and weekdays\n    if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n        dayOfYearFromWeekInfo(config);\n    }\n\n    //if the day of the year is set, figure out what it is\n    if (config._dayOfYear != null) {\n        yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);\n\n        if (config._dayOfYear > daysInYear(yearToUse) || config._dayOfYear === 0) {\n            getParsingFlags(config)._overflowDayOfYear = true;\n        }\n\n        date = createUTCDate(yearToUse, 0, config._dayOfYear);\n        config._a[MONTH] = date.getUTCMonth();\n        config._a[DATE] = date.getUTCDate();\n    }\n\n    // Default to current date.\n    // * if no year, month, day of month are given, default to today\n    // * if day of month is given, default month and year\n    // * if month is given, default only year\n    // * if year is given, don't default anything\n    for (i = 0; i < 3 && config._a[i] == null; ++i) {\n        config._a[i] = input[i] = currentDate[i];\n    }\n\n    // Zero out whatever was not defaulted, including time\n    for (; i < 7; i++) {\n        config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];\n    }\n\n    // Check for 24:00:00.000\n    if (config._a[HOUR] === 24 &&\n            config._a[MINUTE] === 0 &&\n            config._a[SECOND] === 0 &&\n            config._a[MILLISECOND] === 0) {\n        config._nextDay = true;\n        config._a[HOUR] = 0;\n    }\n\n    config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);\n    // Apply timezone offset from input. The actual utcOffset can be changed\n    // with parseZone.\n    if (config._tzm != null) {\n        config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n    }\n\n    if (config._nextDay) {\n        config._a[HOUR] = 24;\n    }\n}\n\nfunction dayOfYearFromWeekInfo(config) {\n    var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;\n\n    w = config._w;\n    if (w.GG != null || w.W != null || w.E != null) {\n        dow = 1;\n        doy = 4;\n\n        // TODO: We need to take the current isoWeekYear, but that depends on\n        // how we interpret now (local, utc, fixed offset). So create\n        // a now version of current config (take local/utc/offset flags, and\n        // create now).\n        weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(createLocal(), 1, 4).year);\n        week = defaults(w.W, 1);\n        weekday = defaults(w.E, 1);\n        if (weekday < 1 || weekday > 7) {\n            weekdayOverflow = true;\n        }\n    } else {\n        dow = config._locale._week.dow;\n        doy = config._locale._week.doy;\n\n        var curWeek = weekOfYear(createLocal(), dow, doy);\n\n        weekYear = defaults(w.gg, config._a[YEAR], curWeek.year);\n\n        // Default to current week.\n        week = defaults(w.w, curWeek.week);\n\n        if (w.d != null) {\n            // weekday -- low day numbers are considered next week\n            weekday = w.d;\n            if (weekday < 0 || weekday > 6) {\n                weekdayOverflow = true;\n            }\n        } else if (w.e != null) {\n            // local weekday -- counting starts from begining of week\n            weekday = w.e + dow;\n            if (w.e < 0 || w.e > 6) {\n                weekdayOverflow = true;\n            }\n        } else {\n            // default to begining of week\n            weekday = dow;\n        }\n    }\n    if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {\n        getParsingFlags(config)._overflowWeeks = true;\n    } else if (weekdayOverflow != null) {\n        getParsingFlags(config)._overflowWeekday = true;\n    } else {\n        temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);\n        config._a[YEAR] = temp.year;\n        config._dayOfYear = temp.dayOfYear;\n    }\n}\n\n// constant that refers to the ISO standard\nhooks.ISO_8601 = function () {};\n\n// constant that refers to the RFC 2822 form\nhooks.RFC_2822 = function () {};\n\n// date from string and format string\nfunction configFromStringAndFormat(config) {\n    // TODO: Move this to another part of the creation flow to prevent circular deps\n    if (config._f === hooks.ISO_8601) {\n        configFromISO(config);\n        return;\n    }\n    if (config._f === hooks.RFC_2822) {\n        configFromRFC2822(config);\n        return;\n    }\n    config._a = [];\n    getParsingFlags(config).empty = true;\n\n    // This array is used to make a Date, either with `new Date` or `Date.UTC`\n    var string = '' + config._i,\n        i, parsedInput, tokens, token, skipped,\n        stringLength = string.length,\n        totalParsedInputLength = 0;\n\n    tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];\n\n    for (i = 0; i < tokens.length; i++) {\n        token = tokens[i];\n        parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];\n        // console.log('token', token, 'parsedInput', parsedInput,\n        //         'regex', getParseRegexForToken(token, config));\n        if (parsedInput) {\n            skipped = string.substr(0, string.indexOf(parsedInput));\n            if (skipped.length > 0) {\n                getParsingFlags(config).unusedInput.push(skipped);\n            }\n            string = string.slice(string.indexOf(parsedInput) + parsedInput.length);\n            totalParsedInputLength += parsedInput.length;\n        }\n        // don't parse if it's not a known token\n        if (formatTokenFunctions[token]) {\n            if (parsedInput) {\n                getParsingFlags(config).empty = false;\n            }\n            else {\n                getParsingFlags(config).unusedTokens.push(token);\n            }\n            addTimeToArrayFromToken(token, parsedInput, config);\n        }\n        else if (config._strict && !parsedInput) {\n            getParsingFlags(config).unusedTokens.push(token);\n        }\n    }\n\n    // add remaining unparsed input length to the string\n    getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;\n    if (string.length > 0) {\n        getParsingFlags(config).unusedInput.push(string);\n    }\n\n    // clear _12h flag if hour is <= 12\n    if (config._a[HOUR] <= 12 &&\n        getParsingFlags(config).bigHour === true &&\n        config._a[HOUR] > 0) {\n        getParsingFlags(config).bigHour = undefined;\n    }\n\n    getParsingFlags(config).parsedDateParts = config._a.slice(0);\n    getParsingFlags(config).meridiem = config._meridiem;\n    // handle meridiem\n    config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);\n\n    configFromArray(config);\n    checkOverflow(config);\n}\n\n\nfunction meridiemFixWrap (locale, hour, meridiem) {\n    var isPm;\n\n    if (meridiem == null) {\n        // nothing to do\n        return hour;\n    }\n    if (locale.meridiemHour != null) {\n        return locale.meridiemHour(hour, meridiem);\n    } else if (locale.isPM != null) {\n        // Fallback\n        isPm = locale.isPM(meridiem);\n        if (isPm && hour < 12) {\n            hour += 12;\n        }\n        if (!isPm && hour === 12) {\n            hour = 0;\n        }\n        return hour;\n    } else {\n        // this is not supposed to happen\n        return hour;\n    }\n}\n\n// date from string and array of format strings\nfunction configFromStringAndArray(config) {\n    var tempConfig,\n        bestMoment,\n\n        scoreToBeat,\n        i,\n        currentScore;\n\n    if (config._f.length === 0) {\n        getParsingFlags(config).invalidFormat = true;\n        config._d = new Date(NaN);\n        return;\n    }\n\n    for (i = 0; i < config._f.length; i++) {\n        currentScore = 0;\n        tempConfig = copyConfig({}, config);\n        if (config._useUTC != null) {\n            tempConfig._useUTC = config._useUTC;\n        }\n        tempConfig._f = config._f[i];\n        configFromStringAndFormat(tempConfig);\n\n        if (!isValid(tempConfig)) {\n            continue;\n        }\n\n        // if there is any input that was not parsed add a penalty for that format\n        currentScore += getParsingFlags(tempConfig).charsLeftOver;\n\n        //or tokens\n        currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;\n\n        getParsingFlags(tempConfig).score = currentScore;\n\n        if (scoreToBeat == null || currentScore < scoreToBeat) {\n            scoreToBeat = currentScore;\n            bestMoment = tempConfig;\n        }\n    }\n\n    extend(config, bestMoment || tempConfig);\n}\n\nfunction configFromObject(config) {\n    if (config._d) {\n        return;\n    }\n\n    var i = normalizeObjectUnits(config._i);\n    config._a = map([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {\n        return obj && parseInt(obj, 10);\n    });\n\n    configFromArray(config);\n}\n\nfunction createFromConfig (config) {\n    var res = new Moment(checkOverflow(prepareConfig(config)));\n    if (res._nextDay) {\n        // Adding is smart enough around DST\n        res.add(1, 'd');\n        res._nextDay = undefined;\n    }\n\n    return res;\n}\n\nfunction prepareConfig (config) {\n    var input = config._i,\n        format = config._f;\n\n    config._locale = config._locale || getLocale(config._l);\n\n    if (input === null || (format === undefined && input === '')) {\n        return createInvalid({nullInput: true});\n    }\n\n    if (typeof input === 'string') {\n        config._i = input = config._locale.preparse(input);\n    }\n\n    if (isMoment(input)) {\n        return new Moment(checkOverflow(input));\n    } else if (isDate(input)) {\n        config._d = input;\n    } else if (isArray(format)) {\n        configFromStringAndArray(config);\n    } else if (format) {\n        configFromStringAndFormat(config);\n    }  else {\n        configFromInput(config);\n    }\n\n    if (!isValid(config)) {\n        config._d = null;\n    }\n\n    return config;\n}\n\nfunction configFromInput(config) {\n    var input = config._i;\n    if (isUndefined(input)) {\n        config._d = new Date(hooks.now());\n    } else if (isDate(input)) {\n        config._d = new Date(input.valueOf());\n    } else if (typeof input === 'string') {\n        configFromString(config);\n    } else if (isArray(input)) {\n        config._a = map(input.slice(0), function (obj) {\n            return parseInt(obj, 10);\n        });\n        configFromArray(config);\n    } else if (isObject(input)) {\n        configFromObject(config);\n    } else if (isNumber(input)) {\n        // from milliseconds\n        config._d = new Date(input);\n    } else {\n        hooks.createFromInputFallback(config);\n    }\n}\n\nfunction createLocalOrUTC (input, format, locale, strict, isUTC) {\n    var c = {};\n\n    if (locale === true || locale === false) {\n        strict = locale;\n        locale = undefined;\n    }\n\n    if ((isObject(input) && isObjectEmpty(input)) ||\n            (isArray(input) && input.length === 0)) {\n        input = undefined;\n    }\n    // object construction must be done this way.\n    // https://github.com/moment/moment/issues/1423\n    c._isAMomentObject = true;\n    c._useUTC = c._isUTC = isUTC;\n    c._l = locale;\n    c._i = input;\n    c._f = format;\n    c._strict = strict;\n\n    return createFromConfig(c);\n}\n\nfunction createLocal (input, format, locale, strict) {\n    return createLocalOrUTC(input, format, locale, strict, false);\n}\n\nvar prototypeMin = deprecate(\n    'moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',\n    function () {\n        var other = createLocal.apply(null, arguments);\n        if (this.isValid() && other.isValid()) {\n            return other < this ? this : other;\n        } else {\n            return createInvalid();\n        }\n    }\n);\n\nvar prototypeMax = deprecate(\n    'moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',\n    function () {\n        var other = createLocal.apply(null, arguments);\n        if (this.isValid() && other.isValid()) {\n            return other > this ? this : other;\n        } else {\n            return createInvalid();\n        }\n    }\n);\n\n// Pick a moment m from moments so that m[fn](other) is true for all\n// other. This relies on the function fn to be transitive.\n//\n// moments should either be an array of moment objects or an array, whose\n// first element is an array of moment objects.\nfunction pickBy(fn, moments) {\n    var res, i;\n    if (moments.length === 1 && isArray(moments[0])) {\n        moments = moments[0];\n    }\n    if (!moments.length) {\n        return createLocal();\n    }\n    res = moments[0];\n    for (i = 1; i < moments.length; ++i) {\n        if (!moments[i].isValid() || moments[i][fn](res)) {\n            res = moments[i];\n        }\n    }\n    return res;\n}\n\n// TODO: Use [].sort instead?\nfunction min () {\n    var args = [].slice.call(arguments, 0);\n\n    return pickBy('isBefore', args);\n}\n\nfunction max () {\n    var args = [].slice.call(arguments, 0);\n\n    return pickBy('isAfter', args);\n}\n\nvar now = function () {\n    return Date.now ? Date.now() : +(new Date());\n};\n\nvar ordering = ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond'];\n\nfunction isDurationValid(m) {\n    for (var key in m) {\n        if (!(ordering.indexOf(key) !== -1 && (m[key] == null || !isNaN(m[key])))) {\n            return false;\n        }\n    }\n\n    var unitHasDecimal = false;\n    for (var i = 0; i < ordering.length; ++i) {\n        if (m[ordering[i]]) {\n            if (unitHasDecimal) {\n                return false; // only allow non-integers for smallest unit\n            }\n            if (parseFloat(m[ordering[i]]) !== toInt(m[ordering[i]])) {\n                unitHasDecimal = true;\n            }\n        }\n    }\n\n    return true;\n}\n\nfunction isValid$1() {\n    return this._isValid;\n}\n\nfunction createInvalid$1() {\n    return createDuration(NaN);\n}\n\nfunction Duration (duration) {\n    var normalizedInput = normalizeObjectUnits(duration),\n        years = normalizedInput.year || 0,\n        quarters = normalizedInput.quarter || 0,\n        months = normalizedInput.month || 0,\n        weeks = normalizedInput.week || 0,\n        days = normalizedInput.day || 0,\n        hours = normalizedInput.hour || 0,\n        minutes = normalizedInput.minute || 0,\n        seconds = normalizedInput.second || 0,\n        milliseconds = normalizedInput.millisecond || 0;\n\n    this._isValid = isDurationValid(normalizedInput);\n\n    // representation for dateAddRemove\n    this._milliseconds = +milliseconds +\n        seconds * 1e3 + // 1000\n        minutes * 6e4 + // 1000 * 60\n        hours * 1000 * 60 * 60; //using 1000 * 60 * 60 instead of 36e5 to avoid floating point rounding errors https://github.com/moment/moment/issues/2978\n    // Because of dateAddRemove treats 24 hours as different from a\n    // day when working around DST, we need to store them separately\n    this._days = +days +\n        weeks * 7;\n    // It is impossible translate months into days without knowing\n    // which months you are are talking about, so we have to store\n    // it separately.\n    this._months = +months +\n        quarters * 3 +\n        years * 12;\n\n    this._data = {};\n\n    this._locale = getLocale();\n\n    this._bubble();\n}\n\nfunction isDuration (obj) {\n    return obj instanceof Duration;\n}\n\nfunction absRound (number) {\n    if (number < 0) {\n        return Math.round(-1 * number) * -1;\n    } else {\n        return Math.round(number);\n    }\n}\n\n// FORMATTING\n\nfunction offset (token, separator) {\n    addFormatToken(token, 0, 0, function () {\n        var offset = this.utcOffset();\n        var sign = '+';\n        if (offset < 0) {\n            offset = -offset;\n            sign = '-';\n        }\n        return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);\n    });\n}\n\noffset('Z', ':');\noffset('ZZ', '');\n\n// PARSING\n\naddRegexToken('Z',  matchShortOffset);\naddRegexToken('ZZ', matchShortOffset);\naddParseToken(['Z', 'ZZ'], function (input, array, config) {\n    config._useUTC = true;\n    config._tzm = offsetFromString(matchShortOffset, input);\n});\n\n// HELPERS\n\n// timezone chunker\n// '+10:00' > ['10',  '00']\n// '-1530'  > ['-15', '30']\nvar chunkOffset = /([\\+\\-]|\\d\\d)/gi;\n\nfunction offsetFromString(matcher, string) {\n    var matches = (string || '').match(matcher);\n\n    if (matches === null) {\n        return null;\n    }\n\n    var chunk   = matches[matches.length - 1] || [];\n    var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];\n    var minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n    return minutes === 0 ?\n      0 :\n      parts[0] === '+' ? minutes : -minutes;\n}\n\n// Return a moment from input, that is local/utc/zone equivalent to model.\nfunction cloneWithOffset(input, model) {\n    var res, diff;\n    if (model._isUTC) {\n        res = model.clone();\n        diff = (isMoment(input) || isDate(input) ? input.valueOf() : createLocal(input).valueOf()) - res.valueOf();\n        // Use low-level api, because this fn is low-level api.\n        res._d.setTime(res._d.valueOf() + diff);\n        hooks.updateOffset(res, false);\n        return res;\n    } else {\n        return createLocal(input).local();\n    }\n}\n\nfunction getDateOffset (m) {\n    // On Firefox.24 Date#getTimezoneOffset returns a floating point.\n    // https://github.com/moment/moment/pull/1871\n    return -Math.round(m._d.getTimezoneOffset() / 15) * 15;\n}\n\n// HOOKS\n\n// This function will be called whenever a moment is mutated.\n// It is intended to keep the offset in sync with the timezone.\nhooks.updateOffset = function () {};\n\n// MOMENTS\n\n// keepLocalTime = true means only change the timezone, without\n// affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->\n// 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset\n// +0200, so we adjust the time as needed, to be valid.\n//\n// Keeping the time actually adds/subtracts (one hour)\n// from the actual represented time. That is why we call updateOffset\n// a second time. In case it wants us to change the offset again\n// _changeInProgress == true case, then we have to adjust, because\n// there is no such time in the given timezone.\nfunction getSetOffset (input, keepLocalTime, keepMinutes) {\n    var offset = this._offset || 0,\n        localAdjust;\n    if (!this.isValid()) {\n        return input != null ? this : NaN;\n    }\n    if (input != null) {\n        if (typeof input === 'string') {\n            input = offsetFromString(matchShortOffset, input);\n            if (input === null) {\n                return this;\n            }\n        } else if (Math.abs(input) < 16 && !keepMinutes) {\n            input = input * 60;\n        }\n        if (!this._isUTC && keepLocalTime) {\n            localAdjust = getDateOffset(this);\n        }\n        this._offset = input;\n        this._isUTC = true;\n        if (localAdjust != null) {\n            this.add(localAdjust, 'm');\n        }\n        if (offset !== input) {\n            if (!keepLocalTime || this._changeInProgress) {\n                addSubtract(this, createDuration(input - offset, 'm'), 1, false);\n            } else if (!this._changeInProgress) {\n                this._changeInProgress = true;\n                hooks.updateOffset(this, true);\n                this._changeInProgress = null;\n            }\n        }\n        return this;\n    } else {\n        return this._isUTC ? offset : getDateOffset(this);\n    }\n}\n\nfunction getSetZone (input, keepLocalTime) {\n    if (input != null) {\n        if (typeof input !== 'string') {\n            input = -input;\n        }\n\n        this.utcOffset(input, keepLocalTime);\n\n        return this;\n    } else {\n        return -this.utcOffset();\n    }\n}\n\nfunction setOffsetToUTC (keepLocalTime) {\n    return this.utcOffset(0, keepLocalTime);\n}\n\nfunction setOffsetToLocal (keepLocalTime) {\n    if (this._isUTC) {\n        this.utcOffset(0, keepLocalTime);\n        this._isUTC = false;\n\n        if (keepLocalTime) {\n            this.subtract(getDateOffset(this), 'm');\n        }\n    }\n    return this;\n}\n\nfunction setOffsetToParsedOffset () {\n    if (this._tzm != null) {\n        this.utcOffset(this._tzm, false, true);\n    } else if (typeof this._i === 'string') {\n        var tZone = offsetFromString(matchOffset, this._i);\n        if (tZone != null) {\n            this.utcOffset(tZone);\n        }\n        else {\n            this.utcOffset(0, true);\n        }\n    }\n    return this;\n}\n\nfunction hasAlignedHourOffset (input) {\n    if (!this.isValid()) {\n        return false;\n    }\n    input = input ? createLocal(input).utcOffset() : 0;\n\n    return (this.utcOffset() - input) % 60 === 0;\n}\n\nfunction isDaylightSavingTime () {\n    return (\n        this.utcOffset() > this.clone().month(0).utcOffset() ||\n        this.utcOffset() > this.clone().month(5).utcOffset()\n    );\n}\n\nfunction isDaylightSavingTimeShifted () {\n    if (!isUndefined(this._isDSTShifted)) {\n        return this._isDSTShifted;\n    }\n\n    var c = {};\n\n    copyConfig(c, this);\n    c = prepareConfig(c);\n\n    if (c._a) {\n        var other = c._isUTC ? createUTC(c._a) : createLocal(c._a);\n        this._isDSTShifted = this.isValid() &&\n            compareArrays(c._a, other.toArray()) > 0;\n    } else {\n        this._isDSTShifted = false;\n    }\n\n    return this._isDSTShifted;\n}\n\nfunction isLocal () {\n    return this.isValid() ? !this._isUTC : false;\n}\n\nfunction isUtcOffset () {\n    return this.isValid() ? this._isUTC : false;\n}\n\nfunction isUtc () {\n    return this.isValid() ? this._isUTC && this._offset === 0 : false;\n}\n\n// ASP.NET json date format regex\nvar aspNetRegex = /^(\\-)?(?:(\\d*)[. ])?(\\d+)\\:(\\d+)(?:\\:(\\d+)(\\.\\d*)?)?$/;\n\n// from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n// somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n// and further modified to allow for strings containing both week and day\nvar isoRegex = /^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;\n\nfunction createDuration (input, key) {\n    var duration = input,\n        // matching against regexp is expensive, do it on demand\n        match = null,\n        sign,\n        ret,\n        diffRes;\n\n    if (isDuration(input)) {\n        duration = {\n            ms : input._milliseconds,\n            d  : input._days,\n            M  : input._months\n        };\n    } else if (isNumber(input)) {\n        duration = {};\n        if (key) {\n            duration[key] = input;\n        } else {\n            duration.milliseconds = input;\n        }\n    } else if (!!(match = aspNetRegex.exec(input))) {\n        sign = (match[1] === '-') ? -1 : 1;\n        duration = {\n            y  : 0,\n            d  : toInt(match[DATE])                         * sign,\n            h  : toInt(match[HOUR])                         * sign,\n            m  : toInt(match[MINUTE])                       * sign,\n            s  : toInt(match[SECOND])                       * sign,\n            ms : toInt(absRound(match[MILLISECOND] * 1000)) * sign // the millisecond decimal point is included in the match\n        };\n    } else if (!!(match = isoRegex.exec(input))) {\n        sign = (match[1] === '-') ? -1 : 1;\n        duration = {\n            y : parseIso(match[2], sign),\n            M : parseIso(match[3], sign),\n            w : parseIso(match[4], sign),\n            d : parseIso(match[5], sign),\n            h : parseIso(match[6], sign),\n            m : parseIso(match[7], sign),\n            s : parseIso(match[8], sign)\n        };\n    } else if (duration == null) {// checks for null or undefined\n        duration = {};\n    } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {\n        diffRes = momentsDifference(createLocal(duration.from), createLocal(duration.to));\n\n        duration = {};\n        duration.ms = diffRes.milliseconds;\n        duration.M = diffRes.months;\n    }\n\n    ret = new Duration(duration);\n\n    if (isDuration(input) && hasOwnProp(input, '_locale')) {\n        ret._locale = input._locale;\n    }\n\n    return ret;\n}\n\ncreateDuration.fn = Duration.prototype;\ncreateDuration.invalid = createInvalid$1;\n\nfunction parseIso (inp, sign) {\n    // We'd normally use ~~inp for this, but unfortunately it also\n    // converts floats to ints.\n    // inp may be undefined, so careful calling replace on it.\n    var res = inp && parseFloat(inp.replace(',', '.'));\n    // apply sign while we're at it\n    return (isNaN(res) ? 0 : res) * sign;\n}\n\nfunction positiveMomentsDifference(base, other) {\n    var res = {milliseconds: 0, months: 0};\n\n    res.months = other.month() - base.month() +\n        (other.year() - base.year()) * 12;\n    if (base.clone().add(res.months, 'M').isAfter(other)) {\n        --res.months;\n    }\n\n    res.milliseconds = +other - +(base.clone().add(res.months, 'M'));\n\n    return res;\n}\n\nfunction momentsDifference(base, other) {\n    var res;\n    if (!(base.isValid() && other.isValid())) {\n        return {milliseconds: 0, months: 0};\n    }\n\n    other = cloneWithOffset(other, base);\n    if (base.isBefore(other)) {\n        res = positiveMomentsDifference(base, other);\n    } else {\n        res = positiveMomentsDifference(other, base);\n        res.milliseconds = -res.milliseconds;\n        res.months = -res.months;\n    }\n\n    return res;\n}\n\n// TODO: remove 'name' arg after deprecation is removed\nfunction createAdder(direction, name) {\n    return function (val, period) {\n        var dur, tmp;\n        //invert the arguments, but complain about it\n        if (period !== null && !isNaN(+period)) {\n            deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period). ' +\n            'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');\n            tmp = val; val = period; period = tmp;\n        }\n\n        val = typeof val === 'string' ? +val : val;\n        dur = createDuration(val, period);\n        addSubtract(this, dur, direction);\n        return this;\n    };\n}\n\nfunction addSubtract (mom, duration, isAdding, updateOffset) {\n    var milliseconds = duration._milliseconds,\n        days = absRound(duration._days),\n        months = absRound(duration._months);\n\n    if (!mom.isValid()) {\n        // No op\n        return;\n    }\n\n    updateOffset = updateOffset == null ? true : updateOffset;\n\n    if (milliseconds) {\n        mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);\n    }\n    if (days) {\n        set$1(mom, 'Date', get(mom, 'Date') + days * isAdding);\n    }\n    if (months) {\n        setMonth(mom, get(mom, 'Month') + months * isAdding);\n    }\n    if (updateOffset) {\n        hooks.updateOffset(mom, days || months);\n    }\n}\n\nvar add      = createAdder(1, 'add');\nvar subtract = createAdder(-1, 'subtract');\n\nfunction getCalendarFormat(myMoment, now) {\n    var diff = myMoment.diff(now, 'days', true);\n    return diff < -6 ? 'sameElse' :\n            diff < -1 ? 'lastWeek' :\n            diff < 0 ? 'lastDay' :\n            diff < 1 ? 'sameDay' :\n            diff < 2 ? 'nextDay' :\n            diff < 7 ? 'nextWeek' : 'sameElse';\n}\n\nfunction calendar$1 (time, formats) {\n    // We want to compare the start of today, vs this.\n    // Getting start-of-today depends on whether we're local/utc/offset or not.\n    var now = time || createLocal(),\n        sod = cloneWithOffset(now, this).startOf('day'),\n        format = hooks.calendarFormat(this, sod) || 'sameElse';\n\n    var output = formats && (isFunction(formats[format]) ? formats[format].call(this, now) : formats[format]);\n\n    return this.format(output || this.localeData().calendar(format, this, createLocal(now)));\n}\n\nfunction clone () {\n    return new Moment(this);\n}\n\nfunction isAfter (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input);\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() > localInput.valueOf();\n    } else {\n        return localInput.valueOf() < this.clone().startOf(units).valueOf();\n    }\n}\n\nfunction isBefore (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input);\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() < localInput.valueOf();\n    } else {\n        return this.clone().endOf(units).valueOf() < localInput.valueOf();\n    }\n}\n\nfunction isBetween (from, to, units, inclusivity) {\n    inclusivity = inclusivity || '()';\n    return (inclusivity[0] === '(' ? this.isAfter(from, units) : !this.isBefore(from, units)) &&\n        (inclusivity[1] === ')' ? this.isBefore(to, units) : !this.isAfter(to, units));\n}\n\nfunction isSame (input, units) {\n    var localInput = isMoment(input) ? input : createLocal(input),\n        inputMs;\n    if (!(this.isValid() && localInput.isValid())) {\n        return false;\n    }\n    units = normalizeUnits(units || 'millisecond');\n    if (units === 'millisecond') {\n        return this.valueOf() === localInput.valueOf();\n    } else {\n        inputMs = localInput.valueOf();\n        return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();\n    }\n}\n\nfunction isSameOrAfter (input, units) {\n    return this.isSame(input, units) || this.isAfter(input,units);\n}\n\nfunction isSameOrBefore (input, units) {\n    return this.isSame(input, units) || this.isBefore(input,units);\n}\n\nfunction diff (input, units, asFloat) {\n    var that,\n        zoneDelta,\n        delta, output;\n\n    if (!this.isValid()) {\n        return NaN;\n    }\n\n    that = cloneWithOffset(input, this);\n\n    if (!that.isValid()) {\n        return NaN;\n    }\n\n    zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;\n\n    units = normalizeUnits(units);\n\n    if (units === 'year' || units === 'month' || units === 'quarter') {\n        output = monthDiff(this, that);\n        if (units === 'quarter') {\n            output = output / 3;\n        } else if (units === 'year') {\n            output = output / 12;\n        }\n    } else {\n        delta = this - that;\n        output = units === 'second' ? delta / 1e3 : // 1000\n            units === 'minute' ? delta / 6e4 : // 1000 * 60\n            units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60\n            units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst\n            units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst\n            delta;\n    }\n    return asFloat ? output : absFloor(output);\n}\n\nfunction monthDiff (a, b) {\n    // difference in months\n    var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),\n        // b is in (anchor - 1 month, anchor + 1 month)\n        anchor = a.clone().add(wholeMonthDiff, 'months'),\n        anchor2, adjust;\n\n    if (b - anchor < 0) {\n        anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');\n        // linear across the month\n        adjust = (b - anchor) / (anchor - anchor2);\n    } else {\n        anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');\n        // linear across the month\n        adjust = (b - anchor) / (anchor2 - anchor);\n    }\n\n    //check for negative zero, return zero if negative zero\n    return -(wholeMonthDiff + adjust) || 0;\n}\n\nhooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';\nhooks.defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';\n\nfunction toString () {\n    return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');\n}\n\nfunction toISOString() {\n    if (!this.isValid()) {\n        return null;\n    }\n    var m = this.clone().utc();\n    if (m.year() < 0 || m.year() > 9999) {\n        return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n    }\n    if (isFunction(Date.prototype.toISOString)) {\n        // native implementation is ~50x faster, use it when we can\n        return this.toDate().toISOString();\n    }\n    return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n}\n\n/**\n * Return a human readable representation of a moment that can\n * also be evaluated to get a new moment which is the same\n *\n * @link https://nodejs.org/dist/latest/docs/api/util.html#util_custom_inspect_function_on_objects\n */\nfunction inspect () {\n    if (!this.isValid()) {\n        return 'moment.invalid(/* ' + this._i + ' */)';\n    }\n    var func = 'moment';\n    var zone = '';\n    if (!this.isLocal()) {\n        func = this.utcOffset() === 0 ? 'moment.utc' : 'moment.parseZone';\n        zone = 'Z';\n    }\n    var prefix = '[' + func + '(\"]';\n    var year = (0 <= this.year() && this.year() <= 9999) ? 'YYYY' : 'YYYYYY';\n    var datetime = '-MM-DD[T]HH:mm:ss.SSS';\n    var suffix = zone + '[\")]';\n\n    return this.format(prefix + year + datetime + suffix);\n}\n\nfunction format (inputString) {\n    if (!inputString) {\n        inputString = this.isUtc() ? hooks.defaultFormatUtc : hooks.defaultFormat;\n    }\n    var output = formatMoment(this, inputString);\n    return this.localeData().postformat(output);\n}\n\nfunction from (time, withoutSuffix) {\n    if (this.isValid() &&\n            ((isMoment(time) && time.isValid()) ||\n             createLocal(time).isValid())) {\n        return createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);\n    } else {\n        return this.localeData().invalidDate();\n    }\n}\n\nfunction fromNow (withoutSuffix) {\n    return this.from(createLocal(), withoutSuffix);\n}\n\nfunction to (time, withoutSuffix) {\n    if (this.isValid() &&\n            ((isMoment(time) && time.isValid()) ||\n             createLocal(time).isValid())) {\n        return createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);\n    } else {\n        return this.localeData().invalidDate();\n    }\n}\n\nfunction toNow (withoutSuffix) {\n    return this.to(createLocal(), withoutSuffix);\n}\n\n// If passed a locale key, it will set the locale for this\n// instance.  Otherwise, it will return the locale configuration\n// variables for this instance.\nfunction locale (key) {\n    var newLocaleData;\n\n    if (key === undefined) {\n        return this._locale._abbr;\n    } else {\n        newLocaleData = getLocale(key);\n        if (newLocaleData != null) {\n            this._locale = newLocaleData;\n        }\n        return this;\n    }\n}\n\nvar lang = deprecate(\n    'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',\n    function (key) {\n        if (key === undefined) {\n            return this.localeData();\n        } else {\n            return this.locale(key);\n        }\n    }\n);\n\nfunction localeData () {\n    return this._locale;\n}\n\nfunction startOf (units) {\n    units = normalizeUnits(units);\n    // the following switch intentionally omits break keywords\n    // to utilize falling through the cases.\n    switch (units) {\n        case 'year':\n            this.month(0);\n            /* falls through */\n        case 'quarter':\n        case 'month':\n            this.date(1);\n            /* falls through */\n        case 'week':\n        case 'isoWeek':\n        case 'day':\n        case 'date':\n            this.hours(0);\n            /* falls through */\n        case 'hour':\n            this.minutes(0);\n            /* falls through */\n        case 'minute':\n            this.seconds(0);\n            /* falls through */\n        case 'second':\n            this.milliseconds(0);\n    }\n\n    // weeks are a special case\n    if (units === 'week') {\n        this.weekday(0);\n    }\n    if (units === 'isoWeek') {\n        this.isoWeekday(1);\n    }\n\n    // quarters are also special\n    if (units === 'quarter') {\n        this.month(Math.floor(this.month() / 3) * 3);\n    }\n\n    return this;\n}\n\nfunction endOf (units) {\n    units = normalizeUnits(units);\n    if (units === undefined || units === 'millisecond') {\n        return this;\n    }\n\n    // 'date' is an alias for 'day', so it should be considered as such.\n    if (units === 'date') {\n        units = 'day';\n    }\n\n    return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');\n}\n\nfunction valueOf () {\n    return this._d.valueOf() - ((this._offset || 0) * 60000);\n}\n\nfunction unix () {\n    return Math.floor(this.valueOf() / 1000);\n}\n\nfunction toDate () {\n    return new Date(this.valueOf());\n}\n\nfunction toArray () {\n    var m = this;\n    return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];\n}\n\nfunction toObject () {\n    var m = this;\n    return {\n        years: m.year(),\n        months: m.month(),\n        date: m.date(),\n        hours: m.hours(),\n        minutes: m.minutes(),\n        seconds: m.seconds(),\n        milliseconds: m.milliseconds()\n    };\n}\n\nfunction toJSON () {\n    // new Date(NaN).toJSON() === null\n    return this.isValid() ? this.toISOString() : null;\n}\n\nfunction isValid$2 () {\n    return isValid(this);\n}\n\nfunction parsingFlags () {\n    return extend({}, getParsingFlags(this));\n}\n\nfunction invalidAt () {\n    return getParsingFlags(this).overflow;\n}\n\nfunction creationData() {\n    return {\n        input: this._i,\n        format: this._f,\n        locale: this._locale,\n        isUTC: this._isUTC,\n        strict: this._strict\n    };\n}\n\n// FORMATTING\n\naddFormatToken(0, ['gg', 2], 0, function () {\n    return this.weekYear() % 100;\n});\n\naddFormatToken(0, ['GG', 2], 0, function () {\n    return this.isoWeekYear() % 100;\n});\n\nfunction addWeekYearFormatToken (token, getter) {\n    addFormatToken(0, [token, token.length], 0, getter);\n}\n\naddWeekYearFormatToken('gggg',     'weekYear');\naddWeekYearFormatToken('ggggg',    'weekYear');\naddWeekYearFormatToken('GGGG',  'isoWeekYear');\naddWeekYearFormatToken('GGGGG', 'isoWeekYear');\n\n// ALIASES\n\naddUnitAlias('weekYear', 'gg');\naddUnitAlias('isoWeekYear', 'GG');\n\n// PRIORITY\n\naddUnitPriority('weekYear', 1);\naddUnitPriority('isoWeekYear', 1);\n\n\n// PARSING\n\naddRegexToken('G',      matchSigned);\naddRegexToken('g',      matchSigned);\naddRegexToken('GG',     match1to2, match2);\naddRegexToken('gg',     match1to2, match2);\naddRegexToken('GGGG',   match1to4, match4);\naddRegexToken('gggg',   match1to4, match4);\naddRegexToken('GGGGG',  match1to6, match6);\naddRegexToken('ggggg',  match1to6, match6);\n\naddWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {\n    week[token.substr(0, 2)] = toInt(input);\n});\n\naddWeekParseToken(['gg', 'GG'], function (input, week, config, token) {\n    week[token] = hooks.parseTwoDigitYear(input);\n});\n\n// MOMENTS\n\nfunction getSetWeekYear (input) {\n    return getSetWeekYearHelper.call(this,\n            input,\n            this.week(),\n            this.weekday(),\n            this.localeData()._week.dow,\n            this.localeData()._week.doy);\n}\n\nfunction getSetISOWeekYear (input) {\n    return getSetWeekYearHelper.call(this,\n            input, this.isoWeek(), this.isoWeekday(), 1, 4);\n}\n\nfunction getISOWeeksInYear () {\n    return weeksInYear(this.year(), 1, 4);\n}\n\nfunction getWeeksInYear () {\n    var weekInfo = this.localeData()._week;\n    return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n}\n\nfunction getSetWeekYearHelper(input, week, weekday, dow, doy) {\n    var weeksTarget;\n    if (input == null) {\n        return weekOfYear(this, dow, doy).year;\n    } else {\n        weeksTarget = weeksInYear(input, dow, doy);\n        if (week > weeksTarget) {\n            week = weeksTarget;\n        }\n        return setWeekAll.call(this, input, week, weekday, dow, doy);\n    }\n}\n\nfunction setWeekAll(weekYear, week, weekday, dow, doy) {\n    var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),\n        date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);\n\n    this.year(date.getUTCFullYear());\n    this.month(date.getUTCMonth());\n    this.date(date.getUTCDate());\n    return this;\n}\n\n// FORMATTING\n\naddFormatToken('Q', 0, 'Qo', 'quarter');\n\n// ALIASES\n\naddUnitAlias('quarter', 'Q');\n\n// PRIORITY\n\naddUnitPriority('quarter', 7);\n\n// PARSING\n\naddRegexToken('Q', match1);\naddParseToken('Q', function (input, array) {\n    array[MONTH] = (toInt(input) - 1) * 3;\n});\n\n// MOMENTS\n\nfunction getSetQuarter (input) {\n    return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);\n}\n\n// FORMATTING\n\naddFormatToken('D', ['DD', 2], 'Do', 'date');\n\n// ALIASES\n\naddUnitAlias('date', 'D');\n\n// PRIOROITY\naddUnitPriority('date', 9);\n\n// PARSING\n\naddRegexToken('D',  match1to2);\naddRegexToken('DD', match1to2, match2);\naddRegexToken('Do', function (isStrict, locale) {\n    // TODO: Remove \"ordinalParse\" fallback in next major release.\n    return isStrict ?\n      (locale._dayOfMonthOrdinalParse || locale._ordinalParse) :\n      locale._dayOfMonthOrdinalParseLenient;\n});\n\naddParseToken(['D', 'DD'], DATE);\naddParseToken('Do', function (input, array) {\n    array[DATE] = toInt(input.match(match1to2)[0], 10);\n});\n\n// MOMENTS\n\nvar getSetDayOfMonth = makeGetSet('Date', true);\n\n// FORMATTING\n\naddFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');\n\n// ALIASES\n\naddUnitAlias('dayOfYear', 'DDD');\n\n// PRIORITY\naddUnitPriority('dayOfYear', 4);\n\n// PARSING\n\naddRegexToken('DDD',  match1to3);\naddRegexToken('DDDD', match3);\naddParseToken(['DDD', 'DDDD'], function (input, array, config) {\n    config._dayOfYear = toInt(input);\n});\n\n// HELPERS\n\n// MOMENTS\n\nfunction getSetDayOfYear (input) {\n    var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;\n    return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');\n}\n\n// FORMATTING\n\naddFormatToken('m', ['mm', 2], 0, 'minute');\n\n// ALIASES\n\naddUnitAlias('minute', 'm');\n\n// PRIORITY\n\naddUnitPriority('minute', 14);\n\n// PARSING\n\naddRegexToken('m',  match1to2);\naddRegexToken('mm', match1to2, match2);\naddParseToken(['m', 'mm'], MINUTE);\n\n// MOMENTS\n\nvar getSetMinute = makeGetSet('Minutes', false);\n\n// FORMATTING\n\naddFormatToken('s', ['ss', 2], 0, 'second');\n\n// ALIASES\n\naddUnitAlias('second', 's');\n\n// PRIORITY\n\naddUnitPriority('second', 15);\n\n// PARSING\n\naddRegexToken('s',  match1to2);\naddRegexToken('ss', match1to2, match2);\naddParseToken(['s', 'ss'], SECOND);\n\n// MOMENTS\n\nvar getSetSecond = makeGetSet('Seconds', false);\n\n// FORMATTING\n\naddFormatToken('S', 0, 0, function () {\n    return ~~(this.millisecond() / 100);\n});\n\naddFormatToken(0, ['SS', 2], 0, function () {\n    return ~~(this.millisecond() / 10);\n});\n\naddFormatToken(0, ['SSS', 3], 0, 'millisecond');\naddFormatToken(0, ['SSSS', 4], 0, function () {\n    return this.millisecond() * 10;\n});\naddFormatToken(0, ['SSSSS', 5], 0, function () {\n    return this.millisecond() * 100;\n});\naddFormatToken(0, ['SSSSSS', 6], 0, function () {\n    return this.millisecond() * 1000;\n});\naddFormatToken(0, ['SSSSSSS', 7], 0, function () {\n    return this.millisecond() * 10000;\n});\naddFormatToken(0, ['SSSSSSSS', 8], 0, function () {\n    return this.millisecond() * 100000;\n});\naddFormatToken(0, ['SSSSSSSSS', 9], 0, function () {\n    return this.millisecond() * 1000000;\n});\n\n\n// ALIASES\n\naddUnitAlias('millisecond', 'ms');\n\n// PRIORITY\n\naddUnitPriority('millisecond', 16);\n\n// PARSING\n\naddRegexToken('S',    match1to3, match1);\naddRegexToken('SS',   match1to3, match2);\naddRegexToken('SSS',  match1to3, match3);\n\nvar token;\nfor (token = 'SSSS'; token.length <= 9; token += 'S') {\n    addRegexToken(token, matchUnsigned);\n}\n\nfunction parseMs(input, array) {\n    array[MILLISECOND] = toInt(('0.' + input) * 1000);\n}\n\nfor (token = 'S'; token.length <= 9; token += 'S') {\n    addParseToken(token, parseMs);\n}\n// MOMENTS\n\nvar getSetMillisecond = makeGetSet('Milliseconds', false);\n\n// FORMATTING\n\naddFormatToken('z',  0, 0, 'zoneAbbr');\naddFormatToken('zz', 0, 0, 'zoneName');\n\n// MOMENTS\n\nfunction getZoneAbbr () {\n    return this._isUTC ? 'UTC' : '';\n}\n\nfunction getZoneName () {\n    return this._isUTC ? 'Coordinated Universal Time' : '';\n}\n\nvar proto = Moment.prototype;\n\nproto.add               = add;\nproto.calendar          = calendar$1;\nproto.clone             = clone;\nproto.diff              = diff;\nproto.endOf             = endOf;\nproto.format            = format;\nproto.from              = from;\nproto.fromNow           = fromNow;\nproto.to                = to;\nproto.toNow             = toNow;\nproto.get               = stringGet;\nproto.invalidAt         = invalidAt;\nproto.isAfter           = isAfter;\nproto.isBefore          = isBefore;\nproto.isBetween         = isBetween;\nproto.isSame            = isSame;\nproto.isSameOrAfter     = isSameOrAfter;\nproto.isSameOrBefore    = isSameOrBefore;\nproto.isValid           = isValid$2;\nproto.lang              = lang;\nproto.locale            = locale;\nproto.localeData        = localeData;\nproto.max               = prototypeMax;\nproto.min               = prototypeMin;\nproto.parsingFlags      = parsingFlags;\nproto.set               = stringSet;\nproto.startOf           = startOf;\nproto.subtract          = subtract;\nproto.toArray           = toArray;\nproto.toObject          = toObject;\nproto.toDate            = toDate;\nproto.toISOString       = toISOString;\nproto.inspect           = inspect;\nproto.toJSON            = toJSON;\nproto.toString          = toString;\nproto.unix              = unix;\nproto.valueOf           = valueOf;\nproto.creationData      = creationData;\n\n// Year\nproto.year       = getSetYear;\nproto.isLeapYear = getIsLeapYear;\n\n// Week Year\nproto.weekYear    = getSetWeekYear;\nproto.isoWeekYear = getSetISOWeekYear;\n\n// Quarter\nproto.quarter = proto.quarters = getSetQuarter;\n\n// Month\nproto.month       = getSetMonth;\nproto.daysInMonth = getDaysInMonth;\n\n// Week\nproto.week           = proto.weeks        = getSetWeek;\nproto.isoWeek        = proto.isoWeeks     = getSetISOWeek;\nproto.weeksInYear    = getWeeksInYear;\nproto.isoWeeksInYear = getISOWeeksInYear;\n\n// Day\nproto.date       = getSetDayOfMonth;\nproto.day        = proto.days             = getSetDayOfWeek;\nproto.weekday    = getSetLocaleDayOfWeek;\nproto.isoWeekday = getSetISODayOfWeek;\nproto.dayOfYear  = getSetDayOfYear;\n\n// Hour\nproto.hour = proto.hours = getSetHour;\n\n// Minute\nproto.minute = proto.minutes = getSetMinute;\n\n// Second\nproto.second = proto.seconds = getSetSecond;\n\n// Millisecond\nproto.millisecond = proto.milliseconds = getSetMillisecond;\n\n// Offset\nproto.utcOffset            = getSetOffset;\nproto.utc                  = setOffsetToUTC;\nproto.local                = setOffsetToLocal;\nproto.parseZone            = setOffsetToParsedOffset;\nproto.hasAlignedHourOffset = hasAlignedHourOffset;\nproto.isDST                = isDaylightSavingTime;\nproto.isLocal              = isLocal;\nproto.isUtcOffset          = isUtcOffset;\nproto.isUtc                = isUtc;\nproto.isUTC                = isUtc;\n\n// Timezone\nproto.zoneAbbr = getZoneAbbr;\nproto.zoneName = getZoneName;\n\n// Deprecations\nproto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);\nproto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);\nproto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);\nproto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/', getSetZone);\nproto.isDSTShifted = deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information', isDaylightSavingTimeShifted);\n\nfunction createUnix (input) {\n    return createLocal(input * 1000);\n}\n\nfunction createInZone () {\n    return createLocal.apply(null, arguments).parseZone();\n}\n\nfunction preParsePostFormat (string) {\n    return string;\n}\n\nvar proto$1 = Locale.prototype;\n\nproto$1.calendar        = calendar;\nproto$1.longDateFormat  = longDateFormat;\nproto$1.invalidDate     = invalidDate;\nproto$1.ordinal         = ordinal;\nproto$1.preparse        = preParsePostFormat;\nproto$1.postformat      = preParsePostFormat;\nproto$1.relativeTime    = relativeTime;\nproto$1.pastFuture      = pastFuture;\nproto$1.set             = set;\n\n// Month\nproto$1.months            =        localeMonths;\nproto$1.monthsShort       =        localeMonthsShort;\nproto$1.monthsParse       =        localeMonthsParse;\nproto$1.monthsRegex       = monthsRegex;\nproto$1.monthsShortRegex  = monthsShortRegex;\n\n// Week\nproto$1.week = localeWeek;\nproto$1.firstDayOfYear = localeFirstDayOfYear;\nproto$1.firstDayOfWeek = localeFirstDayOfWeek;\n\n// Day of Week\nproto$1.weekdays       =        localeWeekdays;\nproto$1.weekdaysMin    =        localeWeekdaysMin;\nproto$1.weekdaysShort  =        localeWeekdaysShort;\nproto$1.weekdaysParse  =        localeWeekdaysParse;\n\nproto$1.weekdaysRegex       =        weekdaysRegex;\nproto$1.weekdaysShortRegex  =        weekdaysShortRegex;\nproto$1.weekdaysMinRegex    =        weekdaysMinRegex;\n\n// Hours\nproto$1.isPM = localeIsPM;\nproto$1.meridiem = localeMeridiem;\n\nfunction get$1 (format, index, field, setter) {\n    var locale = getLocale();\n    var utc = createUTC().set(setter, index);\n    return locale[field](utc, format);\n}\n\nfunction listMonthsImpl (format, index, field) {\n    if (isNumber(format)) {\n        index = format;\n        format = undefined;\n    }\n\n    format = format || '';\n\n    if (index != null) {\n        return get$1(format, index, field, 'month');\n    }\n\n    var i;\n    var out = [];\n    for (i = 0; i < 12; i++) {\n        out[i] = get$1(format, i, field, 'month');\n    }\n    return out;\n}\n\n// ()\n// (5)\n// (fmt, 5)\n// (fmt)\n// (true)\n// (true, 5)\n// (true, fmt, 5)\n// (true, fmt)\nfunction listWeekdaysImpl (localeSorted, format, index, field) {\n    if (typeof localeSorted === 'boolean') {\n        if (isNumber(format)) {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n    } else {\n        format = localeSorted;\n        index = format;\n        localeSorted = false;\n\n        if (isNumber(format)) {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n    }\n\n    var locale = getLocale(),\n        shift = localeSorted ? locale._week.dow : 0;\n\n    if (index != null) {\n        return get$1(format, (index + shift) % 7, field, 'day');\n    }\n\n    var i;\n    var out = [];\n    for (i = 0; i < 7; i++) {\n        out[i] = get$1(format, (i + shift) % 7, field, 'day');\n    }\n    return out;\n}\n\nfunction listMonths (format, index) {\n    return listMonthsImpl(format, index, 'months');\n}\n\nfunction listMonthsShort (format, index) {\n    return listMonthsImpl(format, index, 'monthsShort');\n}\n\nfunction listWeekdays (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdays');\n}\n\nfunction listWeekdaysShort (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');\n}\n\nfunction listWeekdaysMin (localeSorted, format, index) {\n    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');\n}\n\ngetSetGlobalLocale('en', {\n    dayOfMonthOrdinalParse: /\\d{1,2}(th|st|nd|rd)/,\n    ordinal : function (number) {\n        var b = number % 10,\n            output = (toInt(number % 100 / 10) === 1) ? 'th' :\n            (b === 1) ? 'st' :\n            (b === 2) ? 'nd' :\n            (b === 3) ? 'rd' : 'th';\n        return number + output;\n    }\n});\n\n// Side effect imports\nhooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', getSetGlobalLocale);\nhooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', getLocale);\n\nvar mathAbs = Math.abs;\n\nfunction abs () {\n    var data           = this._data;\n\n    this._milliseconds = mathAbs(this._milliseconds);\n    this._days         = mathAbs(this._days);\n    this._months       = mathAbs(this._months);\n\n    data.milliseconds  = mathAbs(data.milliseconds);\n    data.seconds       = mathAbs(data.seconds);\n    data.minutes       = mathAbs(data.minutes);\n    data.hours         = mathAbs(data.hours);\n    data.months        = mathAbs(data.months);\n    data.years         = mathAbs(data.years);\n\n    return this;\n}\n\nfunction addSubtract$1 (duration, input, value, direction) {\n    var other = createDuration(input, value);\n\n    duration._milliseconds += direction * other._milliseconds;\n    duration._days         += direction * other._days;\n    duration._months       += direction * other._months;\n\n    return duration._bubble();\n}\n\n// supports only 2.0-style add(1, 's') or add(duration)\nfunction add$1 (input, value) {\n    return addSubtract$1(this, input, value, 1);\n}\n\n// supports only 2.0-style subtract(1, 's') or subtract(duration)\nfunction subtract$1 (input, value) {\n    return addSubtract$1(this, input, value, -1);\n}\n\nfunction absCeil (number) {\n    if (number < 0) {\n        return Math.floor(number);\n    } else {\n        return Math.ceil(number);\n    }\n}\n\nfunction bubble () {\n    var milliseconds = this._milliseconds;\n    var days         = this._days;\n    var months       = this._months;\n    var data         = this._data;\n    var seconds, minutes, hours, years, monthsFromDays;\n\n    // if we have a mix of positive and negative values, bubble down first\n    // check: https://github.com/moment/moment/issues/2166\n    if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||\n            (milliseconds <= 0 && days <= 0 && months <= 0))) {\n        milliseconds += absCeil(monthsToDays(months) + days) * 864e5;\n        days = 0;\n        months = 0;\n    }\n\n    // The following code bubbles up values, see the tests for\n    // examples of what that means.\n    data.milliseconds = milliseconds % 1000;\n\n    seconds           = absFloor(milliseconds / 1000);\n    data.seconds      = seconds % 60;\n\n    minutes           = absFloor(seconds / 60);\n    data.minutes      = minutes % 60;\n\n    hours             = absFloor(minutes / 60);\n    data.hours        = hours % 24;\n\n    days += absFloor(hours / 24);\n\n    // convert days to months\n    monthsFromDays = absFloor(daysToMonths(days));\n    months += monthsFromDays;\n    days -= absCeil(monthsToDays(monthsFromDays));\n\n    // 12 months -> 1 year\n    years = absFloor(months / 12);\n    months %= 12;\n\n    data.days   = days;\n    data.months = months;\n    data.years  = years;\n\n    return this;\n}\n\nfunction daysToMonths (days) {\n    // 400 years have 146097 days (taking into account leap year rules)\n    // 400 years have 12 months === 4800\n    return days * 4800 / 146097;\n}\n\nfunction monthsToDays (months) {\n    // the reverse of daysToMonths\n    return months * 146097 / 4800;\n}\n\nfunction as (units) {\n    if (!this.isValid()) {\n        return NaN;\n    }\n    var days;\n    var months;\n    var milliseconds = this._milliseconds;\n\n    units = normalizeUnits(units);\n\n    if (units === 'month' || units === 'year') {\n        days   = this._days   + milliseconds / 864e5;\n        months = this._months + daysToMonths(days);\n        return units === 'month' ? months : months / 12;\n    } else {\n        // handle milliseconds separately because of floating point math errors (issue #1867)\n        days = this._days + Math.round(monthsToDays(this._months));\n        switch (units) {\n            case 'week'   : return days / 7     + milliseconds / 6048e5;\n            case 'day'    : return days         + milliseconds / 864e5;\n            case 'hour'   : return days * 24    + milliseconds / 36e5;\n            case 'minute' : return days * 1440  + milliseconds / 6e4;\n            case 'second' : return days * 86400 + milliseconds / 1000;\n            // Math.floor prevents floating point math errors here\n            case 'millisecond': return Math.floor(days * 864e5) + milliseconds;\n            default: throw new Error('Unknown unit ' + units);\n        }\n    }\n}\n\n// TODO: Use this.as('ms')?\nfunction valueOf$1 () {\n    if (!this.isValid()) {\n        return NaN;\n    }\n    return (\n        this._milliseconds +\n        this._days * 864e5 +\n        (this._months % 12) * 2592e6 +\n        toInt(this._months / 12) * 31536e6\n    );\n}\n\nfunction makeAs (alias) {\n    return function () {\n        return this.as(alias);\n    };\n}\n\nvar asMilliseconds = makeAs('ms');\nvar asSeconds      = makeAs('s');\nvar asMinutes      = makeAs('m');\nvar asHours        = makeAs('h');\nvar asDays         = makeAs('d');\nvar asWeeks        = makeAs('w');\nvar asMonths       = makeAs('M');\nvar asYears        = makeAs('y');\n\nfunction get$2 (units) {\n    units = normalizeUnits(units);\n    return this.isValid() ? this[units + 's']() : NaN;\n}\n\nfunction makeGetter(name) {\n    return function () {\n        return this.isValid() ? this._data[name] : NaN;\n    };\n}\n\nvar milliseconds = makeGetter('milliseconds');\nvar seconds      = makeGetter('seconds');\nvar minutes      = makeGetter('minutes');\nvar hours        = makeGetter('hours');\nvar days         = makeGetter('days');\nvar months       = makeGetter('months');\nvar years        = makeGetter('years');\n\nfunction weeks () {\n    return absFloor(this.days() / 7);\n}\n\nvar round = Math.round;\nvar thresholds = {\n    ss: 44,         // a few seconds to seconds\n    s : 45,         // seconds to minute\n    m : 45,         // minutes to hour\n    h : 22,         // hours to day\n    d : 26,         // days to month\n    M : 11          // months to year\n};\n\n// helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\nfunction substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {\n    return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n}\n\nfunction relativeTime$1 (posNegDuration, withoutSuffix, locale) {\n    var duration = createDuration(posNegDuration).abs();\n    var seconds  = round(duration.as('s'));\n    var minutes  = round(duration.as('m'));\n    var hours    = round(duration.as('h'));\n    var days     = round(duration.as('d'));\n    var months   = round(duration.as('M'));\n    var years    = round(duration.as('y'));\n\n    var a = seconds <= thresholds.ss && ['s', seconds]  ||\n            seconds < thresholds.s   && ['ss', seconds] ||\n            minutes <= 1             && ['m']           ||\n            minutes < thresholds.m   && ['mm', minutes] ||\n            hours   <= 1             && ['h']           ||\n            hours   < thresholds.h   && ['hh', hours]   ||\n            days    <= 1             && ['d']           ||\n            days    < thresholds.d   && ['dd', days]    ||\n            months  <= 1             && ['M']           ||\n            months  < thresholds.M   && ['MM', months]  ||\n            years   <= 1             && ['y']           || ['yy', years];\n\n    a[2] = withoutSuffix;\n    a[3] = +posNegDuration > 0;\n    a[4] = locale;\n    return substituteTimeAgo.apply(null, a);\n}\n\n// This function allows you to set the rounding function for relative time strings\nfunction getSetRelativeTimeRounding (roundingFunction) {\n    if (roundingFunction === undefined) {\n        return round;\n    }\n    if (typeof(roundingFunction) === 'function') {\n        round = roundingFunction;\n        return true;\n    }\n    return false;\n}\n\n// This function allows you to set a threshold for relative time strings\nfunction getSetRelativeTimeThreshold (threshold, limit) {\n    if (thresholds[threshold] === undefined) {\n        return false;\n    }\n    if (limit === undefined) {\n        return thresholds[threshold];\n    }\n    thresholds[threshold] = limit;\n    if (threshold === 's') {\n        thresholds.ss = limit - 1;\n    }\n    return true;\n}\n\nfunction humanize (withSuffix) {\n    if (!this.isValid()) {\n        return this.localeData().invalidDate();\n    }\n\n    var locale = this.localeData();\n    var output = relativeTime$1(this, !withSuffix, locale);\n\n    if (withSuffix) {\n        output = locale.pastFuture(+this, output);\n    }\n\n    return locale.postformat(output);\n}\n\nvar abs$1 = Math.abs;\n\nfunction toISOString$1() {\n    // for ISO strings we do not use the normal bubbling rules:\n    //  * milliseconds bubble up until they become hours\n    //  * days do not bubble at all\n    //  * months bubble up until they become years\n    // This is because there is no context-free conversion between hours and days\n    // (think of clock changes)\n    // and also not between days and months (28-31 days per month)\n    if (!this.isValid()) {\n        return this.localeData().invalidDate();\n    }\n\n    var seconds = abs$1(this._milliseconds) / 1000;\n    var days         = abs$1(this._days);\n    var months       = abs$1(this._months);\n    var minutes, hours, years;\n\n    // 3600 seconds -> 60 minutes -> 1 hour\n    minutes           = absFloor(seconds / 60);\n    hours             = absFloor(minutes / 60);\n    seconds %= 60;\n    minutes %= 60;\n\n    // 12 months -> 1 year\n    years  = absFloor(months / 12);\n    months %= 12;\n\n\n    // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n    var Y = years;\n    var M = months;\n    var D = days;\n    var h = hours;\n    var m = minutes;\n    var s = seconds;\n    var total = this.asSeconds();\n\n    if (!total) {\n        // this is the same as C#'s (Noda) and python (isodate)...\n        // but not other JS (goog.date)\n        return 'P0D';\n    }\n\n    return (total < 0 ? '-' : '') +\n        'P' +\n        (Y ? Y + 'Y' : '') +\n        (M ? M + 'M' : '') +\n        (D ? D + 'D' : '') +\n        ((h || m || s) ? 'T' : '') +\n        (h ? h + 'H' : '') +\n        (m ? m + 'M' : '') +\n        (s ? s + 'S' : '');\n}\n\nvar proto$2 = Duration.prototype;\n\nproto$2.isValid        = isValid$1;\nproto$2.abs            = abs;\nproto$2.add            = add$1;\nproto$2.subtract       = subtract$1;\nproto$2.as             = as;\nproto$2.asMilliseconds = asMilliseconds;\nproto$2.asSeconds      = asSeconds;\nproto$2.asMinutes      = asMinutes;\nproto$2.asHours        = asHours;\nproto$2.asDays         = asDays;\nproto$2.asWeeks        = asWeeks;\nproto$2.asMonths       = asMonths;\nproto$2.asYears        = asYears;\nproto$2.valueOf        = valueOf$1;\nproto$2._bubble        = bubble;\nproto$2.get            = get$2;\nproto$2.milliseconds   = milliseconds;\nproto$2.seconds        = seconds;\nproto$2.minutes        = minutes;\nproto$2.hours          = hours;\nproto$2.days           = days;\nproto$2.weeks          = weeks;\nproto$2.months         = months;\nproto$2.years          = years;\nproto$2.humanize       = humanize;\nproto$2.toISOString    = toISOString$1;\nproto$2.toString       = toISOString$1;\nproto$2.toJSON         = toISOString$1;\nproto$2.locale         = locale;\nproto$2.localeData     = localeData;\n\n// Deprecations\nproto$2.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', toISOString$1);\nproto$2.lang = lang;\n\n// Side effect imports\n\n// FORMATTING\n\naddFormatToken('X', 0, 0, 'unix');\naddFormatToken('x', 0, 0, 'valueOf');\n\n// PARSING\n\naddRegexToken('x', matchSigned);\naddRegexToken('X', matchTimestamp);\naddParseToken('X', function (input, array, config) {\n    config._d = new Date(parseFloat(input, 10) * 1000);\n});\naddParseToken('x', function (input, array, config) {\n    config._d = new Date(toInt(input));\n});\n\n// Side effect imports\n\n\nhooks.version = '2.18.1';\n\nsetHookCallback(createLocal);\n\nhooks.fn                    = proto;\nhooks.min                   = min;\nhooks.max                   = max;\nhooks.now                   = now;\nhooks.utc                   = createUTC;\nhooks.unix                  = createUnix;\nhooks.months                = listMonths;\nhooks.isDate                = isDate;\nhooks.locale                = getSetGlobalLocale;\nhooks.invalid               = createInvalid;\nhooks.duration              = createDuration;\nhooks.isMoment              = isMoment;\nhooks.weekdays              = listWeekdays;\nhooks.parseZone             = createInZone;\nhooks.localeData            = getLocale;\nhooks.isDuration            = isDuration;\nhooks.monthsShort           = listMonthsShort;\nhooks.weekdaysMin           = listWeekdaysMin;\nhooks.defineLocale          = defineLocale;\nhooks.updateLocale          = updateLocale;\nhooks.locales               = listLocales;\nhooks.weekdaysShort         = listWeekdaysShort;\nhooks.normalizeUnits        = normalizeUnits;\nhooks.relativeTimeRounding = getSetRelativeTimeRounding;\nhooks.relativeTimeThreshold = getSetRelativeTimeThreshold;\nhooks.calendarFormat        = getCalendarFormat;\nhooks.prototype             = proto;\n\nreturn hooks;\n\n})));\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/string.js":"// Load modules\n\nvar Net = require('net');\nvar Hoek = require('hoek');\nvar Isemail = require('isemail');\nvar Any = require('./any');\nvar Ref = require('./ref');\nvar JoiDate = require('./date');\nvar Errors = require('./errors');\nvar Uri = require('./string/uri');\nvar Ip = require('./string/ip');\n\n// Declare internals\n\nvar internals = {\n    uriRegex: Uri.createUriRegex(),\n    ipRegex: Ip.createIpRegex(['ipv4', 'ipv6', 'ipvfuture'], 'optional')\n};\n\ninternals.String = function () {\n\n    Any.call(this);\n    this._type = 'string';\n    this._invalids.add('');\n};\n\nHoek.inherits(internals.String, Any);\n\ninternals.compare = function (type, compare) {\n\n    return function (limit, encoding) {\n\n        var isRef = Ref.isRef(limit);\n\n        Hoek.assert((Hoek.isInteger(limit) && limit >= 0) || isRef, 'limit must be a positive integer or reference');\n        Hoek.assert(!encoding || Buffer.isEncoding(encoding), 'Invalid encoding:', encoding);\n\n        return this._test(type, limit, function (value, state, options) {\n\n            var compareTo;\n            if (isRef) {\n                compareTo = limit(state.parent, options);\n\n                if (!Hoek.isInteger(compareTo)) {\n                    return Errors.create('string.ref', { ref: limit.key }, state, options);\n                }\n            }\n            else {\n                compareTo = limit;\n            }\n\n            if (compare(value, compareTo, encoding)) {\n                return null;\n            }\n\n            return Errors.create('string.' + type, { limit: compareTo, value: value, encoding: encoding }, state, options);\n        });\n    };\n};\n\ninternals.String.prototype._base = function (value, state, options) {\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        if (this._flags.case) {\n            value = (this._flags.case === 'upper' ? value.toLocaleUpperCase() : value.toLocaleLowerCase());\n        }\n\n        if (this._flags.trim) {\n            value = value.trim();\n        }\n\n        if (this._inner.replacements) {\n\n            for (var r = 0, rl = this._inner.replacements.length; r < rl; ++r) {\n                var replacement = this._inner.replacements[r];\n                value = value.replace(replacement.pattern, replacement.replacement);\n            }\n        }\n    }\n\n    return {\n        value: value,\n        errors: (typeof value === 'string') ? null : Errors.create('string.base', { value: value }, state, options)\n    };\n};\n\n\ninternals.String.prototype.insensitive = function () {\n\n    var obj = this.clone();\n    obj._flags.insensitive = true;\n    return obj;\n};\n\n\ninternals.String.prototype.min = internals.compare('min', function (value, limit, encoding) {\n\n    var length = encoding ? Buffer.byteLength(value, encoding) : value.length;\n    return length >= limit;\n});\n\n\ninternals.String.prototype.max = internals.compare('max', function (value, limit, encoding) {\n\n    var length = encoding ? Buffer.byteLength(value, encoding) : value.length;\n    return length <= limit;\n});\n\n\ninternals.String.prototype.creditCard = function () {\n\n    return this._test('creditCard', undefined, function (value, state, options) {\n\n        var i = value.length;\n        var sum = 0;\n        var mul = 1;\n        var char;\n\n        while (i--) {\n            char = value.charAt(i) * mul;\n            sum += char - (char > 9) * 9;\n            mul ^= 3;\n        }\n\n        var check = (sum % 10 === 0) && (sum > 0);\n        return check ? null : Errors.create('string.creditCard', { value: value }, state, options);\n    });\n};\n\ninternals.String.prototype.length = internals.compare('length', function (value, limit, encoding) {\n\n    var length = encoding ? Buffer.byteLength(value, encoding) : value.length;\n    return length === limit;\n});\n\n\ninternals.String.prototype.regex = function (pattern, name) {\n\n    Hoek.assert(pattern instanceof RegExp, 'pattern must be a RegExp');\n\n    pattern = new RegExp(pattern.source, pattern.ignoreCase ? 'i' : undefined);         // Future version should break this and forbid unsupported regex flags\n\n    return this._test('regex', pattern, function (value, state, options) {\n\n        if (pattern.test(value)) {\n            return null;\n        }\n\n        return Errors.create((name ? 'string.regex.name' : 'string.regex.base'), { name: name, pattern: pattern, value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.alphanum = function () {\n\n    return this._test('alphanum', undefined, function (value, state, options) {\n\n        if (/^[a-zA-Z0-9]+$/.test(value)) {\n            return null;\n        }\n\n        return Errors.create('string.alphanum', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.token = function () {\n\n    return this._test('token', undefined, function (value, state, options) {\n\n        if (/^\\w+$/.test(value)) {\n            return null;\n        }\n\n        return Errors.create('string.token', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.email = function (isEmailOptions) {\n\n    if (isEmailOptions) {\n        Hoek.assert(typeof isEmailOptions === 'object', 'email options must be an object');\n        Hoek.assert(typeof isEmailOptions.checkDNS === 'undefined', 'checkDNS option is not supported');\n        Hoek.assert(typeof isEmailOptions.tldWhitelist === 'undefined' ||\n            typeof isEmailOptions.tldWhitelist === 'object', 'tldWhitelist must be an array or object');\n        Hoek.assert(typeof isEmailOptions.minDomainAtoms === 'undefined' ||\n            Hoek.isInteger(isEmailOptions.minDomainAtoms) && isEmailOptions.minDomainAtoms > 0,\n            'minDomainAtoms must be a positive integer');\n        Hoek.assert(typeof isEmailOptions.errorLevel === 'undefined' || typeof isEmailOptions.errorLevel === 'boolean' ||\n            (Hoek.isInteger(isEmailOptions.errorLevel) && isEmailOptions.errorLevel >= 0),\n            'errorLevel must be a non-negative integer or boolean');\n    }\n\n    return this._test('email', isEmailOptions, function (value, state, options) {\n\n        try {\n            var result = Isemail(value, isEmailOptions);\n            if (result === true || result === 0) {\n                return null;\n            }\n        }\n        catch (e) {}\n\n        return Errors.create('string.email', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.ip = function (ipOptions) {\n\n    var regex = internals.ipRegex;\n    ipOptions = ipOptions || {};\n    Hoek.assert(typeof ipOptions === 'object', 'options must be an object');\n\n    if (ipOptions.cidr) {\n        Hoek.assert(typeof ipOptions.cidr === 'string', 'cidr must be a string');\n        ipOptions.cidr = ipOptions.cidr.toLowerCase();\n\n        Hoek.assert(ipOptions.cidr in Ip.cidrs, 'cidr must be one of ' + Object.keys(Ip.cidrs).join(', '));\n\n        // If we only received a `cidr` setting, create a regex for it. But we don't need to create one if `cidr` is \"optional\" since that is the default\n        if (!ipOptions.version && ipOptions.cidr !== 'optional') {\n            regex = Ip.createIpRegex(['ipv4', 'ipv6', 'ipvfuture'], ipOptions.cidr);\n        }\n    }\n    else {\n\n        // Set our default cidr strategy\n        ipOptions.cidr = 'optional';\n    }\n\n    if (ipOptions.version) {\n        if (!Array.isArray(ipOptions.version)) {\n            ipOptions.version = [ipOptions.version];\n        }\n\n        Hoek.assert(ipOptions.version.length >= 1, 'version must have at least 1 version specified');\n\n        var versions = [];\n        for (var i = 0, il = ipOptions.version.length; i < il; ++i) {\n            var version = ipOptions.version[i];\n            Hoek.assert(typeof version === 'string', 'version at position ' + i + ' must be a string');\n            version = version.toLowerCase();\n            Hoek.assert(Ip.versions[version], 'version at position ' + i + ' must be one of ' + Object.keys(Ip.versions).join(', '));\n            versions.push(version);\n        }\n\n        // Make sure we have a set of versions\n        versions = Hoek.unique(versions);\n\n        regex = Ip.createIpRegex(versions, ipOptions.cidr);\n    }\n\n    return this._test('ip', ipOptions, function (value, state, options) {\n\n        if (regex.test(value)) {\n            return null;\n        }\n\n        if (versions) {\n            return Errors.create('string.ipVersion', { value: value, cidr: ipOptions.cidr, version: versions }, state, options);\n        }\n\n        return Errors.create('string.ip', { value: value, cidr: ipOptions.cidr }, state, options);\n    });\n};\n\n\ninternals.String.prototype.uri = function (uriOptions) {\n\n    var customScheme = '',\n        regex = internals.uriRegex;\n\n    if (uriOptions) {\n        Hoek.assert(typeof uriOptions === 'object', 'options must be an object');\n\n        if (uriOptions.scheme) {\n            Hoek.assert(uriOptions.scheme instanceof RegExp || typeof uriOptions.scheme === 'string' || Array.isArray(uriOptions.scheme), 'scheme must be a RegExp, String, or Array');\n\n            if (!Array.isArray(uriOptions.scheme)) {\n                uriOptions.scheme = [uriOptions.scheme];\n            }\n\n            Hoek.assert(uriOptions.scheme.length >= 1, 'scheme must have at least 1 scheme specified');\n\n            // Flatten the array into a string to be used to match the schemes.\n            for (var i = 0, il = uriOptions.scheme.length; i < il; ++i) {\n                var scheme = uriOptions.scheme[i];\n                Hoek.assert(scheme instanceof RegExp || typeof scheme === 'string', 'scheme at position ' + i + ' must be a RegExp or String');\n\n                // Add OR separators if a value already exists\n                customScheme += customScheme ? '|' : '';\n\n                // If someone wants to match HTTP or HTTPS for example then we need to support both RegExp and String so we don't escape their pattern unknowingly.\n                if (scheme instanceof RegExp) {\n                    customScheme += scheme.source;\n                }\n                else {\n                    Hoek.assert(/[a-zA-Z][a-zA-Z0-9+-\\.]*/.test(scheme), 'scheme at position ' + i + ' must be a valid scheme');\n                    customScheme += Hoek.escapeRegex(scheme);\n                }\n            }\n        }\n    }\n\n    if (customScheme) {\n        regex = Uri.createUriRegex(customScheme);\n    }\n\n    return this._test('uri', uriOptions, function (value, state, options) {\n\n        if (regex.test(value)) {\n            return null;\n        }\n\n        if (customScheme) {\n            return Errors.create('string.uriCustomScheme', { scheme: customScheme, value: value }, state, options);\n        }\n\n        return Errors.create('string.uri', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.isoDate = function () {\n\n    return this._test('isoDate', undefined, function (value, state, options) {\n\n        if (JoiDate._isIsoDate(value)) {\n            return null;\n        }\n\n        return Errors.create('string.isoDate', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.guid = function () {\n\n    var regex = /^[A-F0-9]{8}(?:-?[A-F0-9]{4}){3}-?[A-F0-9]{12}$/i;\n    var regex2 = /^\\{[A-F0-9]{8}(?:-?[A-F0-9]{4}){3}-?[A-F0-9]{12}\\}$/i;\n\n    return this._test('guid', undefined, function (value, state, options) {\n\n        if (regex.test(value) || regex2.test(value)) {\n            return null;\n        }\n\n        return Errors.create('string.guid', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.hex = function () {\n\n    var regex = /^[a-f0-9]+$/i;\n\n    return this._test('hex', regex, function (value, state, options) {\n\n        if (regex.test(value)) {\n            return null;\n        }\n\n        return Errors.create('string.hex', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.hostname = function () {\n\n    var regex = /^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$/;\n\n    return this._test('hostname', undefined, function (value, state, options) {\n\n        if ((value.length <= 255 && regex.test(value)) ||\n            Net.isIPv6(value)) {\n\n            return null;\n        }\n\n        return Errors.create('string.hostname', { value: value }, state, options);\n    });\n};\n\n\ninternals.String.prototype.lowercase = function () {\n\n    var obj = this._test('lowercase', undefined, function (value, state, options) {\n\n        if (options.convert ||\n            value === value.toLocaleLowerCase()) {\n\n            return null;\n        }\n\n        return Errors.create('string.lowercase', { value: value }, state, options);\n    });\n\n    obj._flags.case = 'lower';\n    return obj;\n};\n\n\ninternals.String.prototype.uppercase = function () {\n\n    var obj = this._test('uppercase', undefined, function (value, state, options) {\n\n        if (options.convert ||\n            value === value.toLocaleUpperCase()) {\n\n            return null;\n        }\n\n        return Errors.create('string.uppercase', { value: value }, state, options);\n    });\n\n    obj._flags.case = 'upper';\n    return obj;\n};\n\n\ninternals.String.prototype.trim = function () {\n\n    var obj = this._test('trim', undefined, function (value, state, options) {\n\n        if (options.convert ||\n            value === value.trim()) {\n\n            return null;\n        }\n\n        return Errors.create('string.trim', { value: value }, state, options);\n    });\n\n    obj._flags.trim = true;\n    return obj;\n};\n\n\ninternals.String.prototype.replace = function (pattern, replacement) {\n\n    if (typeof pattern === 'string') {\n        pattern = new RegExp(Hoek.escapeRegex(pattern), 'g');\n    }\n\n    Hoek.assert(pattern instanceof RegExp, 'pattern must be a RegExp');\n    Hoek.assert(typeof replacement === 'string', 'replacement must be a String');\n\n    // This can not be considere a test like trim, we can't \"reject\"\n    // anything from this rule, so just clone the current object\n    var obj = this.clone();\n\n    if (!obj._inner.replacements) {\n        obj._inner.replacements = [];\n    }\n\n    obj._inner.replacements.push({\n        pattern: pattern,\n        replacement: replacement\n    });\n\n    return obj;\n};\n\nmodule.exports = new internals.String();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/isemail/index.js":"module.exports = require('./lib/isemail');\r\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/isemail/lib/isemail.js":"/**\r\n * To validate an email address according to RFCs 5321, 5322 and others\r\n *\r\n * Copyright © 2008-2011, Dominic Sayers\r\n * Test schema documentation Copyright © 2011, Daniel Marschall\r\n * Port for Node.js Copyright © 2013-2014, GlobeSherpa\r\n *              and Copyright © 2014-2015, Eli Skeggs\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n *   - Redistributions of source code must retain the above copyright notice,\r\n *     this list of conditions and the following disclaimer.\r\n *   - Redistributions in binary form must reproduce the above copyright notice,\r\n *     this list of conditions and the following disclaimer in the documentation\r\n *     and/or other materials provided with the distribution.\r\n *   - Neither the name of Dominic Sayers nor the names of its contributors may\r\n *     be used to endorse or promote products derived from this software without\r\n *     specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\r\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\r\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\r\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\r\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\r\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n * POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * @author      Dominic Sayers <dominic@sayers.cc>\r\n * @author      Eli Skeggs <skeggse@gmail.com>\r\n * @copyright   2008-2011 Dominic Sayers\r\n * @copyright   2013-2014 GlobeSherpa\r\n * @copyright   2014-2015 Eli Skeggs\r\n * @license     http://www.opensource.org/licenses/bsd-license.php BSD License\r\n * @link        http://www.dominicsayers.com/isemail\r\n * @link        https://github.com/hapijs/isemail\r\n * @version     1.2.0 Drop Node 0.8, fix style, switch to lab/code\r\n */\r\n\r\nvar Dns = require('dns');\r\n\r\nvar internals = {\r\n    defaultThreshold: 16,\r\n    maxIPv6Groups: 8,\r\n    categories: {\r\n        valid: 1,\r\n        dnsWarn: 7,\r\n        rfc5321: 15,\r\n        cfws: 31,\r\n        deprecated: 63,\r\n        rfc5322: 127,\r\n        error: 255\r\n    },\r\n\r\n    diagnoses: {\r\n        // Address is valid\r\n        valid: 0,\r\n\r\n        // Address is valid, but the DNS check failed\r\n        dnsWarnNoMXRecord: 5,\r\n        dnsWarnNoRecord: 6,\r\n\r\n        // Address is valid for SMTP but has unusual elements\r\n        rfc5321TLD: 9,\r\n        rfc5321TLDNumeric: 10,\r\n        rfc5321QuotedString: 11,\r\n        rfc5321AddressLiteral: 12,\r\n\r\n        // Address is valid for message, but must be modified for envelope\r\n        cfwsComment: 17,\r\n        cfwsFWS: 18,\r\n\r\n        // Address contains deprecated elements, but may still be valid in some contexts\r\n        deprecatedLocalPart: 33,\r\n        deprecatedFWS: 34,\r\n        deprecatedQTEXT: 35,\r\n        deprecatedQP: 36,\r\n        deprecatedComment: 37,\r\n        deprecatedCTEXT: 38,\r\n        deprecatedIPv6: 39,\r\n        deprecatedCFWSNearAt: 49,\r\n\r\n        // Address is only valid according to broad definition in RFC 5322, but is otherwise invalid\r\n        rfc5322Domain: 65,\r\n        rfc5322TooLong: 66,\r\n        rfc5322LocalTooLong: 67,\r\n        rfc5322DomainTooLong: 68,\r\n        rfc5322LabelTooLong: 69,\r\n        rfc5322DomainLiteral: 70,\r\n        rfc5322DomainLiteralOBSDText: 71,\r\n        rfc5322IPv6GroupCount: 72,\r\n        rfc5322IPv62x2xColon: 73,\r\n        rfc5322IPv6BadCharacter: 74,\r\n        rfc5322IPv6MaxGroups: 75,\r\n        rfc5322IPv6ColonStart: 76,\r\n        rfc5322IPv6ColonEnd: 77,\r\n\r\n        // Address is invalid for any purpose\r\n        errExpectingDTEXT: 129,\r\n        errNoLocalPart: 130,\r\n        errNoDomain: 131,\r\n        errConsecutiveDots: 132,\r\n        errATEXTAfterCFWS: 133,\r\n        errATEXTAfterQS: 134,\r\n        errATEXTAfterDomainLiteral: 135,\r\n        errExpectingQPair: 136,\r\n        errExpectingATEXT: 137,\r\n        errExpectingQTEXT: 138,\r\n        errExpectingCTEXT: 139,\r\n        errBackslashEnd: 140,\r\n        errDotStart: 141,\r\n        errDotEnd: 142,\r\n        errDomainHyphenStart: 143,\r\n        errDomainHyphenEnd: 144,\r\n        errUnclosedQuotedString: 145,\r\n        errUnclosedComment: 146,\r\n        errUnclosedDomainLiteral: 147,\r\n        errFWSCRLFx2: 148,\r\n        errFWSCRLFEnd: 149,\r\n        errCRNoLF: 150,\r\n        errUnknownTLD: 160,\r\n        errDomainTooShort: 161\r\n    },\r\n\r\n    components: {\r\n        localpart: 0,\r\n        domain: 1,\r\n        literal: 2,\r\n        contextComment: 3,\r\n        contextFWS: 4,\r\n        contextQuotedString: 5,\r\n        contextQuotedPair: 6\r\n    }\r\n};\r\n\r\n// $lab:coverage:off$\r\ninternals.defer = typeof process !== 'undefined' && process && typeof process.nextTick === 'function' ?\r\n    process.nextTick.bind(process) :\r\n    function (callback) {\r\n\r\n        return setTimeout(callback, 0);\r\n    };\r\n// $lab:coverage:on$\r\n\r\n\r\n// US-ASCII visible characters not valid for atext\r\n// (http://tools.ietf.org/html/rfc5322#section-3.2.3)\r\nvar SPECIALS = '()<>[]:;@\\\\,.\"';\r\n\r\n// A silly little optimized function generator\r\nvar optimizeLookup = function optimizeLookup (string) {\r\n\r\n    var lookup = new Array(0x100);\r\n\r\n    for (var i = 0xff; i >= 0; --i) {\r\n        lookup[i] = false;\r\n    }\r\n\r\n    for (var il = string.length; i < il; ++i) {\r\n        lookup[string.charCodeAt(i)] = true;\r\n    }\r\n\r\n    var body = 'return function (code) {\\n';\r\n    body += '  return lookup[code];\\n';\r\n    body += '}';\r\n    return (new Function('lookup', body))(lookup);\r\n};\r\n\r\n\r\nvar specialsLookup = optimizeLookup(SPECIALS);\r\n\r\n// This matches valid IPv4 addresses from the end of a string\r\nvar IPv4_REGEX =\r\n    /\\b(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/;\r\nvar IPv6_REGEX = /^[a-fA-F\\d]{0,4}$/;\r\nvar IPv6_REGEX_TEST = IPv6_REGEX.test.bind(IPv6_REGEX);\r\n\r\nvar hasOwn = Object.prototype.hasOwnProperty;\r\n\r\n/**\r\n * Check that an email address conforms to RFCs 5321, 5322 and others\r\n *\r\n * We distinguish clearly between a Mailbox as defined by RFC 5321 and an\r\n * addr-spec as defined by RFC 5322. Depending on the context, either can be\r\n * regarded as a valid email address. The RFC 5321 Mailbox specification is\r\n * more restrictive (comments, white space and obsolete forms are not allowed).\r\n *\r\n * @param {string} email The email address to check.\r\n * @param {Object} options The (optional) options:\r\n *   {boolean} checkDNS If true then will check DNS for MX records. If\r\n *     true this call to isEmail _will_ be asynchronous.\r\n *   {*} errorLevel Determines the boundary between valid and invalid\r\n *     addresses. Status codes above this number will be returned as-is, status\r\n *     codes below will be returned as valid. Thus the calling program can\r\n *     simply look for diagnoses.valid if it is only interested in whether an\r\n *     address is valid or not. The errorLevel will determine how \"picky\"\r\n *     isEmail() is about the address. If omitted or passed as false then\r\n *     isEmail() will return true or false rather than an integer error or\r\n *     warning. NB Note the difference between errorLevel = false and\r\n *     errorLevel = 0.\r\n * @param {function(number|boolean)} callback The (optional) callback handler.\r\n * @return {*}\r\n */\r\nvar isEmail = function isEmail (email, options, callback) {\r\n\r\n    if (typeof options === 'function') {\r\n        callback = options;\r\n        options = {};\r\n    }\r\n\r\n    if (!options) {\r\n        options = {};\r\n    }\r\n\r\n    if (typeof callback !== 'function') {\r\n        if (options.checkDNS) {\r\n            throw new TypeError('expected callback function for checkDNS option');\r\n        }\r\n\r\n        callback = null;\r\n    }\r\n\r\n    var diagnose;\r\n    var threshold;\r\n\r\n    if (typeof options.errorLevel === 'number') {\r\n        diagnose = true;\r\n        threshold = options.errorLevel;\r\n    }\r\n    else {\r\n        diagnose = !!options.errorLevel;\r\n        threshold = internals.diagnoses.valid;\r\n    }\r\n\r\n    if (options.tldWhitelist) {\r\n        if (typeof options.tldWhitelist === 'string') {\r\n            options.tldWhitelist = [options.tldWhitelist];\r\n        } else if (typeof options.tldWhitelist !== 'object') {\r\n            throw new TypeError('expected array or object tldWhitelist');\r\n        }\r\n    }\r\n\r\n    if (options.minDomainAtoms && (options.minDomainAtoms !== ((+options.minDomainAtoms) | 0) || options.minDomainAtoms < 0)) {\r\n        throw new TypeError('expected positive integer minDomainAtoms');\r\n    }\r\n\r\n    var maxResult = internals.diagnoses.valid;\r\n\r\n    var updateResult = function updateResult (value) {\r\n\r\n        if (value > maxResult) {\r\n            maxResult = value;\r\n        }\r\n    };\r\n\r\n    var context = {\r\n        now: internals.components.localpart,\r\n        prev: internals.components.localpart,\r\n        stack: [internals.components.localpart]\r\n    };\r\n\r\n    var token;\r\n    var prevToken = '';\r\n    var charCode = 0;\r\n\r\n    var parseData = {\r\n        local: '',\r\n        domain: ''\r\n    };\r\n    var atomData = {\r\n        locals: [''],\r\n        domains: ['']\r\n    };\r\n\r\n    var elementCount = 0;\r\n    var elementLength = 0;\r\n    var crlfCount = 0;\r\n\r\n    var hyphenFlag = false;\r\n    var assertEnd = false;\r\n\r\n    var emailLength = email.length;\r\n\r\n    for (var i = 0, il = emailLength; i < il; ++i) {\r\n        // Token is used outside the loop, must declare similarly\r\n        token = email[i];\r\n\r\n        switch (context.now) {\r\n            // Local-part\r\n            case internals.components.localpart:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                //   local-part      =   dot-atom / quoted-string / obs-local-part\r\n                //\r\n                //   dot-atom        =   [CFWS] dot-atom-text [CFWS]\r\n                //\r\n                //   dot-atom-text   =   1*atext *(\".\" 1*atext)\r\n                //\r\n                //   quoted-string   =   [CFWS]\r\n                //                       DQUOTE *([FWS] qcontent) [FWS] DQUOTE\r\n                //                       [CFWS]\r\n                //\r\n                //   obs-local-part  =   word *(\".\" word)\r\n                //\r\n                //   word            =   atom / quoted-string\r\n                //\r\n                //   atom            =   [CFWS] 1*atext [CFWS]\r\n                switch (token) {\r\n                    // Comment\r\n                    case '(':\r\n                        if (elementLength === 0) {\r\n                            // Comments are OK at the beginning of an element\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.cfwsComment : internals.diagnoses.deprecatedComment);\r\n                        }\r\n                        else {\r\n                            updateResult(internals.diagnoses.cfwsComment);\r\n                             // Cannot start a comment in an element, should be end\r\n                            assertEnd = true;\r\n                        }\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextComment;\r\n                        break;\r\n\r\n                    // Next dot-atom element\r\n                    case '.':\r\n                        if (elementLength === 0) {\r\n                            // Another dot, already?\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.errDotStart : internals.diagnoses.errConsecutiveDots);\r\n                        }\r\n                        else {\r\n                            // The entire local-part can be a quoted string for RFC 5321; if one atom is quoted it's an RFC 5322 obsolete form\r\n                            if (assertEnd) {\r\n                                updateResult(internals.diagnoses.deprecatedLocalPart);\r\n                            }\r\n\r\n                            // CFWS & quoted strings are OK again now we're at the beginning of an element (although they are obsolete forms)\r\n                            assertEnd = false;\r\n                            elementLength = 0;\r\n                            ++elementCount;\r\n                            parseData.local += token;\r\n                            atomData.locals[elementCount] = '';\r\n                        }\r\n\r\n                        break;\r\n\r\n                    // Quoted string\r\n                    case '\"':\r\n                        if (elementLength === 0) {\r\n                            // The entire local-part can be a quoted string for RFC 5321; if one atom is quoted it's an RFC 5322 obsolete form\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.rfc5321QuotedString : internals.diagnoses.deprecatedLocalPart);\r\n\r\n                            parseData.local += token;\r\n                            atomData.locals[elementCount] += token;\r\n                            ++elementLength;\r\n\r\n                            // Quoted string must be the entire element\r\n                            assertEnd = true;\r\n                            context.stack.push(context.now);\r\n                            context.now = internals.components.contextQuotedString;\r\n                        }\r\n                        else {\r\n                            updateResult(internals.diagnoses.errExpectingATEXT);\r\n                        }\r\n\r\n                        break;\r\n\r\n                    // Folding white space\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                            break;\r\n                        }\r\n\r\n                        // Fallthrough\r\n\r\n                    case ' ':\r\n                    case '\\t':\r\n                        if (elementLength === 0) {\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.cfwsFWS : internals.diagnoses.deprecatedFWS);\r\n                        }\r\n                        else {\r\n                            // We can't start FWS in the middle of an element, better be end\r\n                            assertEnd = true;\r\n                        }\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextFWS;\r\n                        prevToken = token;\r\n                        break;\r\n\r\n                    case '@':\r\n                        // At this point we should have a valid local-part\r\n                        // $lab:coverage:off$\r\n                        if (context.stack.length !== 1) {\r\n                            throw new Error('unexpected item on context stack');\r\n                        }\r\n                        // $lab:coverage:on$\r\n\r\n                        if (parseData.local.length === 0) {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errNoLocalPart);\r\n                        }\r\n                        else if (elementLength === 0) {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errDotEnd);\r\n                        }\r\n                        // http://tools.ietf.org/html/rfc5321#section-4.5.3.1.1 the maximum total length of a user name or other local-part is 64\r\n                        //    octets\r\n                        else if (parseData.local.length > 64) {\r\n                            updateResult(internals.diagnoses.rfc5322LocalTooLong);\r\n                        }\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.4.1 comments and folding white space SHOULD NOT be used around \"@\" in the\r\n                        //    addr-spec\r\n                        //\r\n                        // http://tools.ietf.org/html/rfc2119\r\n                        // 4. SHOULD NOT this phrase, or the phrase \"NOT RECOMMENDED\" mean that there may exist valid reasons in particular\r\n                        //    circumstances when the particular behavior is acceptable or even useful, but the full implications should be understood\r\n                        //    and the case carefully weighed before implementing any behavior described with this label.\r\n                        else if (context.prev === internals.components.contextComment || context.prev === internals.components.contextFWS) {\r\n                            updateResult(internals.diagnoses.deprecatedCFWSNearAt);\r\n                        }\r\n\r\n                        // Clear everything down for the domain parsing\r\n                        context.now = internals.components.domain;\r\n                        context.stack[0] = internals.components.domain;\r\n                        elementCount = 0;\r\n                        elementLength = 0;\r\n                        assertEnd = false; // CFWS can only appear at the end of the element\r\n                        break;\r\n\r\n                    // ATEXT\r\n                    default:\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.3\r\n                        //    atext = ALPHA / DIGIT / ; Printable US-ASCII\r\n                        //            \"!\" / \"#\" /     ;  characters not including\r\n                        //            \"$\" / \"%\" /     ;  specials.  Used for atoms.\r\n                        //            \"&\" / \"'\" /\r\n                        //            \"*\" / \"+\" /\r\n                        //            \"-\" / \"/\" /\r\n                        //            \"=\" / \"?\" /\r\n                        //            \"^\" / \"_\" /\r\n                        //            \"`\" / \"{\" /\r\n                        //            \"|\" / \"}\" /\r\n                        //            \"~\"\r\n                        if (assertEnd) {\r\n                            // We have encountered atext where it is no longer valid\r\n                            switch (context.prev) {\r\n                                case internals.components.contextComment:\r\n                                case internals.components.contextFWS:\r\n                                    updateResult(internals.diagnoses.errATEXTAfterCFWS);\r\n                                    break;\r\n\r\n                                case internals.components.contextQuotedString:\r\n                                    updateResult(internals.diagnoses.errATEXTAfterQS);\r\n                                    break;\r\n\r\n                                // $lab:coverage:off$\r\n                                default:\r\n                                    throw new Error('more atext found where none is allowed, but unrecognized prev context: ' + context.prev);\r\n                                // $lab:coverage:on$\r\n                            }\r\n                        }\r\n                        else {\r\n                            context.prev = context.now;\r\n                            charCode = token.charCodeAt(0);\r\n\r\n                            // Especially if charCode == 10\r\n                            if (charCode < 33 || charCode > 126 || specialsLookup(charCode)) {\r\n\r\n                                // Fatal error\r\n                                updateResult(internals.diagnoses.errExpectingATEXT);\r\n                            }\r\n\r\n                            parseData.local += token;\r\n                            atomData.locals[elementCount] += token;\r\n                            ++elementLength;\r\n                        }\r\n                }\r\n\r\n                break;\r\n\r\n            case internals.components.domain:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                //   domain          =   dot-atom / domain-literal / obs-domain\r\n                //\r\n                //   dot-atom        =   [CFWS] dot-atom-text [CFWS]\r\n                //\r\n                //   dot-atom-text   =   1*atext *(\".\" 1*atext)\r\n                //\r\n                //   domain-literal  =   [CFWS] \"[\" *([FWS] dtext) [FWS] \"]\" [CFWS]\r\n                //\r\n                //   dtext           =   %d33-90 /          ; Printable US-ASCII\r\n                //                       %d94-126 /         ;  characters not including\r\n                //                       obs-dtext          ;  \"[\", \"]\", or \"\\\"\r\n                //\r\n                //   obs-domain      =   atom *(\".\" atom)\r\n                //\r\n                //   atom            =   [CFWS] 1*atext [CFWS]\r\n\r\n                // http://tools.ietf.org/html/rfc5321#section-4.1.2\r\n                //   Mailbox        = Local-part \"@\" ( Domain / address-literal )\r\n                //\r\n                //   Domain         = sub-domain *(\".\" sub-domain)\r\n                //\r\n                //   address-literal  = \"[\" ( IPv4-address-literal /\r\n                //                    IPv6-address-literal /\r\n                //                    General-address-literal ) \"]\"\r\n                //                    ; See Section 4.1.3\r\n\r\n                // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                //      Note: A liberal syntax for the domain portion of addr-spec is\r\n                //      given here.  However, the domain portion contains addressing\r\n                //      information specified by and used in other protocols (e.g.,\r\n                //      [RFC1034], [RFC1035], [RFC1123], [RFC5321]).  It is therefore\r\n                //      incumbent upon implementations to conform to the syntax of\r\n                //      addresses for the context in which they are used.\r\n                //\r\n                // is_email() author's note: it's not clear how to interpret this in\r\n                // he context of a general email address validator. The conclusion I\r\n                // have reached is this: \"addressing information\" must comply with\r\n                // RFC 5321 (and in turn RFC 1035), anything that is \"semantically\r\n                // invisible\" must comply only with RFC 5322.\r\n                switch (token) {\r\n                    // Comment\r\n                    case '(':\r\n                        if (elementLength === 0) {\r\n                            // Comments at the start of the domain are deprecated in the text, comments at the start of a subdomain are obs-domain\r\n                            // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.deprecatedCFWSNearAt : internals.diagnoses.deprecatedComment);\r\n                        }\r\n                        else {\r\n                            // We can't start a comment mid-element, better be at the end\r\n                            assertEnd = true;\r\n                            updateResult(internals.diagnoses.cfwsComment);\r\n                        }\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextComment;\r\n                        break;\r\n\r\n                    // Next dot-atom element\r\n                    case '.':\r\n                        if (elementLength === 0) {\r\n                            // Another dot, already? Fatal error.\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.errDotStart : internals.diagnoses.errConsecutiveDots);\r\n                        }\r\n                        else if (hyphenFlag) {\r\n                            // Previous subdomain ended in a hyphen. Fatal error.\r\n                            updateResult(internals.diagnoses.errDomainHyphenEnd);\r\n                        }\r\n                        else if (elementLength > 63) {\r\n                            // Nowhere in RFC 5321 does it say explicitly that the domain part of a Mailbox must be a valid domain according to the\r\n                            // DNS standards set out in RFC 1035, but this *is* implied in several places. For instance, wherever the idea of host\r\n                            // routing is discussed the RFC says that the domain must be looked up in the DNS. This would be nonsense unless the\r\n                            // domain was designed to be a valid DNS domain. Hence we must conclude that the RFC 1035 restriction on label length\r\n                            // also applies to RFC 5321 domains.\r\n                            //\r\n                            // http://tools.ietf.org/html/rfc1035#section-2.3.4\r\n                            // labels          63 octets or less\r\n\r\n                            updateResult(internals.diagnoses.rfc5322LabelTooLong);\r\n                        }\r\n\r\n                        // CFWS is OK again now we're at the beginning of an element (although\r\n                        // it may be obsolete CFWS)\r\n                        assertEnd = false;\r\n                        elementLength = 0;\r\n                        ++elementCount;\r\n                        atomData.domains[elementCount] = '';\r\n                        parseData.domain += token;\r\n\r\n                        break;\r\n\r\n                    // Domain literal\r\n                    case '[':\r\n                        if (parseData.domain.length === 0) {\r\n                            // Domain literal must be the only component\r\n                            assertEnd = true;\r\n                            ++elementLength;\r\n                            context.stack.push(context.now);\r\n                            context.now = internals.components.literal;\r\n                            parseData.domain += token;\r\n                            atomData.domains[elementCount] += token;\r\n                            parseData.literal = '';\r\n                        }\r\n                        else {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errExpectingATEXT);\r\n                        }\r\n\r\n                        break;\r\n\r\n                    // Folding white space\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                            break;\r\n                        }\r\n\r\n                        // Fallthrough\r\n\r\n                    case ' ':\r\n                    case '\\t':\r\n                        if (elementLength === 0) {\r\n                            updateResult(elementCount === 0 ? internals.diagnoses.deprecatedCFWSNearAt : internals.diagnoses.deprecatedFWS);\r\n                        }\r\n                        else {\r\n                            // We can't start FWS in the middle of an element, so this better be the end\r\n                            updateResult(internals.diagnoses.cfwsFWS);\r\n                            assertEnd = true;\r\n                        }\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextFWS;\r\n                        prevToken = token;\r\n                        break;\r\n\r\n                    // This must be ATEXT\r\n                    default:\r\n                        // RFC 5322 allows any atext...\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.3\r\n                        //    atext = ALPHA / DIGIT / ; Printable US-ASCII\r\n                        //            \"!\" / \"#\" /     ;  characters not including\r\n                        //            \"$\" / \"%\" /     ;  specials.  Used for atoms.\r\n                        //            \"&\" / \"'\" /\r\n                        //            \"*\" / \"+\" /\r\n                        //            \"-\" / \"/\" /\r\n                        //            \"=\" / \"?\" /\r\n                        //            \"^\" / \"_\" /\r\n                        //            \"`\" / \"{\" /\r\n                        //            \"|\" / \"}\" /\r\n                        //            \"~\"\r\n\r\n                        // But RFC 5321 only allows letter-digit-hyphen to comply with DNS rules\r\n                        //   (RFCs 1034 & 1123)\r\n                        // http://tools.ietf.org/html/rfc5321#section-4.1.2\r\n                        //   sub-domain     = Let-dig [Ldh-str]\r\n                        //\r\n                        //   Let-dig        = ALPHA / DIGIT\r\n                        //\r\n                        //   Ldh-str        = *( ALPHA / DIGIT / \"-\" ) Let-dig\r\n                        //\r\n                        if (assertEnd) {\r\n                            // We have encountered ATEXT where it is no longer valid\r\n                            switch (context.prev) {\r\n                                case internals.components.contextComment:\r\n                                case internals.components.contextFWS:\r\n                                    updateResult(internals.diagnoses.errATEXTAfterCFWS);\r\n                                    break;\r\n\r\n                                case internals.components.literal:\r\n                                    updateResult(internals.diagnoses.errATEXTAfterDomainLiteral);\r\n                                    break;\r\n\r\n                                // $lab:coverage:off$\r\n                                default:\r\n                                    throw new Error('more atext found where none is allowed, but unrecognized prev context: ' + context.prev);\r\n                                // $lab:coverage:on$\r\n                            }\r\n                        }\r\n\r\n                        charCode = token.charCodeAt(0);\r\n                        // Assume this token isn't a hyphen unless we discover it is\r\n                        hyphenFlag = false;\r\n\r\n                        if (charCode < 33 || charCode > 126 || specialsLookup(charCode)) {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errExpectingATEXT);\r\n                        }\r\n                        else if (token === '-') {\r\n                            if (elementLength === 0) {\r\n                                // Hyphens cannot be at the beginning of a subdomain, fatal error\r\n                                updateResult(internals.diagnoses.errDomainHyphenStart);\r\n                            }\r\n\r\n                            hyphenFlag = true;\r\n                        }\r\n                        // Check if it's a neither a number nor a latin letter\r\n                        else if (charCode < 48 || charCode > 122 || (charCode > 57 && charCode < 65) || (charCode > 90 && charCode < 97)) {\r\n                            // This is not an RFC 5321 subdomain, but still OK by RFC 5322\r\n                            updateResult(internals.diagnoses.rfc5322Domain);\r\n                        }\r\n\r\n                        parseData.domain += token;\r\n                        atomData.domains[elementCount] += token;\r\n                        ++elementLength;\r\n                }\r\n\r\n                break;\r\n\r\n            // Domain literal\r\n            case internals.components.literal:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                //   domain-literal  =   [CFWS] \"[\" *([FWS] dtext) [FWS] \"]\" [CFWS]\r\n                //\r\n                //   dtext           =   %d33-90 /          ; Printable US-ASCII\r\n                //                       %d94-126 /         ;  characters not including\r\n                //                       obs-dtext          ;  \"[\", \"]\", or \"\\\"\r\n                //\r\n                //   obs-dtext       =   obs-NO-WS-CTL / quoted-pair\r\n                switch (token) {\r\n                    // End of domain literal\r\n                    case ']':\r\n                        if (maxResult < internals.categories.deprecated) {\r\n                            // Could be a valid RFC 5321 address literal, so let's check\r\n\r\n                            // http://tools.ietf.org/html/rfc5321#section-4.1.2\r\n                            //   address-literal  = \"[\" ( IPv4-address-literal /\r\n                            //                    IPv6-address-literal /\r\n                            //                    General-address-literal ) \"]\"\r\n                            //                    ; See Section 4.1.3\r\n                            //\r\n                            // http://tools.ietf.org/html/rfc5321#section-4.1.3\r\n                            //   IPv4-address-literal  = Snum 3(\".\"  Snum)\r\n                            //\r\n                            //   IPv6-address-literal  = \"IPv6:\" IPv6-addr\r\n                            //\r\n                            //   General-address-literal  = Standardized-tag \":\" 1*dcontent\r\n                            //\r\n                            //   Standardized-tag  = Ldh-str\r\n                            //                     ; Standardized-tag MUST be specified in a\r\n                            //                     ; Standards-Track RFC and registered with IANA\r\n                            //\r\n                            //   dcontent      = %d33-90 / ; Printable US-ASCII\r\n                            //                 %d94-126 ; excl. \"[\", \"\\\", \"]\"\r\n                            //\r\n                            //   Snum          = 1*3DIGIT\r\n                            //                 ; representing a decimal integer\r\n                            //                 ; value in the range 0 through 255\r\n                            //\r\n                            //   IPv6-addr     = IPv6-full / IPv6-comp / IPv6v4-full / IPv6v4-comp\r\n                            //\r\n                            //   IPv6-hex      = 1*4HEXDIG\r\n                            //\r\n                            //   IPv6-full     = IPv6-hex 7(\":\" IPv6-hex)\r\n                            //\r\n                            //   IPv6-comp     = [IPv6-hex *5(\":\" IPv6-hex)] \"::\"\r\n                            //                 [IPv6-hex *5(\":\" IPv6-hex)]\r\n                            //                 ; The \"::\" represents at least 2 16-bit groups of\r\n                            //                 ; zeros.  No more than 6 groups in addition to the\r\n                            //                 ; \"::\" may be present.\r\n                            //\r\n                            //   IPv6v4-full   = IPv6-hex 5(\":\" IPv6-hex) \":\" IPv4-address-literal\r\n                            //\r\n                            //   IPv6v4-comp   = [IPv6-hex *3(\":\" IPv6-hex)] \"::\"\r\n                            //                 [IPv6-hex *3(\":\" IPv6-hex) \":\"]\r\n                            //                 IPv4-address-literal\r\n                            //                 ; The \"::\" represents at least 2 16-bit groups of\r\n                            //                 ; zeros.  No more than 4 groups in addition to the\r\n                            //                 ; \"::\" and IPv4-address-literal may be present.\r\n\r\n                            var index = -1;\r\n                            var addressLiteral = parseData.literal;\r\n                            var matchesIP = IPv4_REGEX.exec(addressLiteral);\r\n\r\n                            // Maybe extract IPv4 part from the end of the address-literal\r\n                            if (matchesIP) {\r\n                                index = matchesIP.index;\r\n                                if (index !== 0) {\r\n                                    // Convert IPv4 part to IPv6 format for futher testing\r\n                                    addressLiteral = addressLiteral.slice(0, index) + '0:0';\r\n                                }\r\n                            }\r\n\r\n                            if (index === 0) {\r\n                                // Nothing there except a valid IPv4 address, so...\r\n                                updateResult(internals.diagnoses.rfc5321AddressLiteral);\r\n                            }\r\n                            else if (addressLiteral.slice(0, 5).toLowerCase() !== 'ipv6:') {\r\n                                updateResult(internals.diagnoses.rfc5322DomainLiteral);\r\n                            }\r\n                            else {\r\n                                var match = addressLiteral.slice(5);\r\n                                var maxGroups = internals.maxIPv6Groups;\r\n                                var groups = match.split(':');\r\n                                index = match.indexOf('::');\r\n\r\n                                if (!~index) {\r\n                                    // Need exactly the right number of groups\r\n                                    if (groups.length !== maxGroups) {\r\n                                        updateResult(internals.diagnoses.rfc5322IPv6GroupCount);\r\n                                    }\r\n                                }\r\n                                else if (index !== match.lastIndexOf('::')) {\r\n                                    updateResult(internals.diagnoses.rfc5322IPv62x2xColon);\r\n                                }\r\n                                else {\r\n                                    if (index === 0 || index === match.length - 2) {\r\n                                        // RFC 4291 allows :: at the start or end of an address with 7 other groups in addition\r\n                                        ++maxGroups;\r\n                                    }\r\n\r\n                                    if (groups.length > maxGroups) {\r\n                                        updateResult(internals.diagnoses.rfc5322IPv6MaxGroups);\r\n                                    }\r\n                                    else if (groups.length === maxGroups) {\r\n                                        // Eliding a single \"::\"\r\n                                        updateResult(internals.diagnoses.deprecatedIPv6);\r\n                                    }\r\n                                }\r\n\r\n                                // IPv6 testing strategy\r\n                                if (match[0] === ':' && match[1] !== ':') {\r\n                                    updateResult(internals.diagnoses.rfc5322IPv6ColonStart);\r\n                                }\r\n                                else if (match[match.length - 1] === ':' && match[match.length - 2] !== ':') {\r\n                                    updateResult(internals.diagnoses.rfc5322IPv6ColonEnd);\r\n                                }\r\n                                else if (groups.every(IPv6_REGEX_TEST)) {\r\n                                    updateResult(internals.diagnoses.rfc5321AddressLiteral);\r\n                                }\r\n                                else {\r\n                                    updateResult(internals.diagnoses.rfc5322IPv6BadCharacter);\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            updateResult(internals.diagnoses.rfc5322DomainLiteral);\r\n                        }\r\n\r\n                        parseData.domain += token;\r\n                        atomData.domains[elementCount] += token;\r\n                        ++elementLength;\r\n                        context.prev = context.now;\r\n                        context.now = context.stack.pop();\r\n                        break;\r\n\r\n                    case '\\\\':\r\n                        updateResult(internals.diagnoses.rfc5322DomainLiteralOBSDText);\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextQuotedPair;\r\n                        break;\r\n\r\n                    // Folding white space\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                            break;\r\n                        }\r\n\r\n                        // Fallthrough\r\n\r\n                    case ' ':\r\n                    case '\\t':\r\n                        updateResult(internals.diagnoses.cfwsFWS);\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextFWS;\r\n                        prevToken = token;\r\n                        break;\r\n\r\n                    // DTEXT\r\n                    default:\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                        //   dtext         =   %d33-90 /  ; Printable US-ASCII\r\n                        //                     %d94-126 / ;  characters not including\r\n                        //                     obs-dtext  ;  \"[\", \"]\", or \"\\\"\r\n                        //\r\n                        //   obs-dtext     =   obs-NO-WS-CTL / quoted-pair\r\n                        //\r\n                        //   obs-NO-WS-CTL =   %d1-8 /    ; US-ASCII control\r\n                        //                     %d11 /     ;  characters that do not\r\n                        //                     %d12 /     ;  include the carriage\r\n                        //                     %d14-31 /  ;  return, line feed, and\r\n                        //                     %d127      ;  white space characters\r\n                        charCode = token.charCodeAt(0);\r\n\r\n                        // '\\r', '\\n', ' ', and '\\t' have already been parsed above\r\n                        if (charCode > 127 || charCode === 0 || token === '[') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errExpectingDTEXT);\r\n                            break;\r\n                        }\r\n                        else if (charCode < 33 || charCode === 127) {\r\n                            updateResult(internals.diagnoses.rfc5322DomainLiteralOBSDText);\r\n                        }\r\n\r\n                        parseData.literal += token;\r\n                        parseData.domain += token;\r\n                        atomData.domains[elementCount] += token;\r\n                        ++elementLength;\r\n                }\r\n\r\n                break;\r\n\r\n            // Quoted string\r\n            case internals.components.contextQuotedString:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.2.4\r\n                //   quoted-string = [CFWS]\r\n                //                   DQUOTE *([FWS] qcontent) [FWS] DQUOTE\r\n                //                   [CFWS]\r\n                //\r\n                //   qcontent      = qtext / quoted-pair\r\n                switch (token) {\r\n                    // Quoted pair\r\n                    case '\\\\':\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextQuotedPair;\r\n                        break;\r\n\r\n                    // Folding white space. Spaces are allowed as regular characters inside a quoted string - it's only FWS if we include '\\t' or '\\r\\n'\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                            break;\r\n                        }\r\n\r\n                        // Fallthrough\r\n\r\n                    case '\\t':\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.2\r\n                        //   Runs of FWS, comment, or CFWS that occur between lexical tokens in\r\n                        //   a structured header field are semantically interpreted as a single\r\n                        //   space character.\r\n\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.4\r\n                        //   the CRLF in any FWS/CFWS that appears within the quoted-string [is]\r\n                        //   semantically \"invisible\" and therefore not part of the\r\n                        //   quoted-string\r\n\r\n                        parseData.local += ' ';\r\n                        atomData.locals[elementCount] += ' ';\r\n                        ++elementLength;\r\n\r\n                        updateResult(internals.diagnoses.cfwsFWS);\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextFWS;\r\n                        prevToken = token;\r\n                        break;\r\n\r\n                    // End of quoted string\r\n                    case '\"':\r\n                        parseData.local += token;\r\n                        atomData.locals[elementCount] += token;\r\n                        ++elementLength;\r\n                        context.prev = context.now;\r\n                        context.now = context.stack.pop();\r\n                        break;\r\n\r\n                    // QTEXT\r\n                    default:\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.4\r\n                        //   qtext          =   %d33 /             ; Printable US-ASCII\r\n                        //                      %d35-91 /          ;  characters not including\r\n                        //                      %d93-126 /         ;  \"\\\" or the quote character\r\n                        //                      obs-qtext\r\n                        //\r\n                        //   obs-qtext      =   obs-NO-WS-CTL\r\n                        //\r\n                        //   obs-NO-WS-CTL  =   %d1-8 /            ; US-ASCII control\r\n                        //                      %d11 /             ;  characters that do not\r\n                        //                      %d12 /             ;  include the carriage\r\n                        //                      %d14-31 /          ;  return, line feed, and\r\n                        //                      %d127              ;  white space characters\r\n                        charCode = token.charCodeAt(0);\r\n\r\n                        if (charCode > 127 || charCode === 0 || charCode === 10) {\r\n                            updateResult(internals.diagnoses.errExpectingQTEXT);\r\n                        }\r\n                        else if (charCode < 32 || charCode === 127) {\r\n                            updateResult(internals.diagnoses.deprecatedQTEXT);\r\n                        }\r\n\r\n                        parseData.local += token;\r\n                        atomData.locals[elementCount] += token;\r\n                        ++elementLength;\r\n                }\r\n\r\n                // http://tools.ietf.org/html/rfc5322#section-3.4.1\r\n                //   If the string can be represented as a dot-atom (that is, it contains\r\n                //   no characters other than atext characters or \".\" surrounded by atext\r\n                //   characters), then the dot-atom form SHOULD be used and the quoted-\r\n                //   string form SHOULD NOT be used.\r\n\r\n                break;\r\n            // Quoted pair\r\n            case internals.components.contextQuotedPair:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.2.1\r\n                //   quoted-pair     =   (\"\\\" (VCHAR / WSP)) / obs-qp\r\n                //\r\n                //   VCHAR           =  %d33-126   ; visible (printing) characters\r\n                //   WSP             =  SP / HTAB  ; white space\r\n                //\r\n                //   obs-qp          =   \"\\\" (%d0 / obs-NO-WS-CTL / LF / CR)\r\n                //\r\n                //   obs-NO-WS-CTL   =   %d1-8 /   ; US-ASCII control\r\n                //                       %d11 /    ;  characters that do not\r\n                //                       %d12 /    ;  include the carriage\r\n                //                       %d14-31 / ;  return, line feed, and\r\n                //                       %d127     ;  white space characters\r\n                //\r\n                // i.e. obs-qp       =  \"\\\" (%d0-8, %d10-31 / %d127)\r\n                charCode = token.charCodeAt(0);\r\n\r\n                if (charCode > 127) {\r\n                    // Fatal error\r\n                    updateResult(internals.diagnoses.errExpectingQPair);\r\n                }\r\n                else if ((charCode < 31 && charCode !== 9) || charCode === 127) {\r\n                    // ' ' and '\\t' are allowed\r\n                    updateResult(internals.diagnoses.deprecatedQP);\r\n                }\r\n\r\n                // At this point we know where this qpair occurred so we could check to see if the character actually needed to be quoted at all.\r\n                // http://tools.ietf.org/html/rfc5321#section-4.1.2\r\n                //   the sending system SHOULD transmit the form that uses the minimum quoting possible.\r\n\r\n                context.prev = context.now;\r\n                // End of qpair\r\n                context.now = context.stack.pop();\r\n                token = '\\\\' + token;\r\n\r\n                switch (context.now) {\r\n                    case internals.components.contextComment:\r\n                        break;\r\n\r\n                    case internals.components.contextQuotedString:\r\n                        parseData.local += token;\r\n                        atomData.locals[elementCount] += token;\r\n\r\n                        // The maximum sizes specified by RFC 5321 are octet counts, so we must include the backslash\r\n                        elementLength += 2;\r\n                        break;\r\n\r\n                    case internals.components.literal:\r\n                        parseData.domain += token;\r\n                        atomData.domains[elementCount] += token;\r\n\r\n                        // The maximum sizes specified by RFC 5321 are octet counts, so we must include the backslash\r\n                        elementLength += 2;\r\n                        break;\r\n\r\n                    // $lab:coverage:off$\r\n                    default:\r\n                        throw new Error('quoted pair logic invoked in an invalid context: ' + context.now);\r\n                    // $lab:coverage:on$\r\n                }\r\n                break;\r\n\r\n            // Comment\r\n            case internals.components.contextComment:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.2.2\r\n                //   comment  = \"(\" *([FWS] ccontent) [FWS] \")\"\r\n                //\r\n                //   ccontent = ctext / quoted-pair / comment\r\n                switch (token) {\r\n                    // Nested comment\r\n                    case '(':\r\n                        // Nested comments are ok\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextComment;\r\n                        break;\r\n\r\n                    // End of comment\r\n                    case ')':\r\n                        context.prev = context.now;\r\n                        context.now = context.stack.pop();\r\n                        break;\r\n\r\n                    // Quoted pair\r\n                    case '\\\\':\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextQuotedPair;\r\n                        break;\r\n\r\n                    // Folding white space\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                            break;\r\n                        }\r\n\r\n                        // Fallthrough\r\n\r\n                    case ' ':\r\n                    case '\\t':\r\n                        updateResult(internals.diagnoses.cfwsFWS);\r\n\r\n                        context.stack.push(context.now);\r\n                        context.now = internals.components.contextFWS;\r\n                        prevToken = token;\r\n                        break;\r\n\r\n                    // CTEXT\r\n                    default:\r\n                        // http://tools.ietf.org/html/rfc5322#section-3.2.3\r\n                        //   ctext         = %d33-39 /  ; Printable US-ASCII\r\n                        //                   %d42-91 /  ;  characters not including\r\n                        //                   %d93-126 / ;  \"(\", \")\", or \"\\\"\r\n                        //                   obs-ctext\r\n                        //\r\n                        //   obs-ctext     = obs-NO-WS-CTL\r\n                        //\r\n                        //   obs-NO-WS-CTL = %d1-8 /    ; US-ASCII control\r\n                        //                   %d11 /     ;  characters that do not\r\n                        //                   %d12 /     ;  include the carriage\r\n                        //                   %d14-31 /  ;  return, line feed, and\r\n                        //                   %d127      ;  white space characters\r\n                        charCode = token.charCodeAt(0);\r\n\r\n                        if (charCode > 127 || charCode === 0 || charCode === 10) {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errExpectingCTEXT);\r\n                            break;\r\n                        }\r\n                        else if (charCode < 32 || charCode === 127) {\r\n                            updateResult(internals.diagnoses.deprecatedCTEXT);\r\n                        }\r\n                }\r\n\r\n                break;\r\n\r\n            // Folding white space\r\n            case internals.components.contextFWS:\r\n                // http://tools.ietf.org/html/rfc5322#section-3.2.2\r\n                //   FWS     =   ([*WSP CRLF] 1*WSP) /  obs-FWS\r\n                //                                   ; Folding white space\r\n\r\n                // But note the erratum:\r\n                // http://www.rfc-editor.org/errata_search.php?rfc=5322&eid=1908:\r\n                //   In the obsolete syntax, any amount of folding white space MAY be\r\n                //   inserted where the obs-FWS rule is allowed.  This creates the\r\n                //   possibility of having two consecutive \"folds\" in a line, and\r\n                //   therefore the possibility that a line which makes up a folded header\r\n                //   field could be composed entirely of white space.\r\n                //\r\n                //   obs-FWS =   1*([CRLF] WSP)\r\n\r\n                if (prevToken === '\\r') {\r\n                    if (token === '\\r') {\r\n                        // Fatal error\r\n                        updateResult(internals.diagnoses.errFWSCRLFx2);\r\n                        break;\r\n                    }\r\n\r\n                    if (++crlfCount > 1) {\r\n                        // Multiple folds => obsolete FWS\r\n                        updateResult(internals.diagnoses.deprecatedFWS);\r\n                    }\r\n                    else {\r\n                        crlfCount = 1;\r\n                    }\r\n                }\r\n\r\n                switch (token) {\r\n                    case '\\r':\r\n                        if (emailLength === ++i || email[i] !== '\\n') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errCRNoLF);\r\n                        }\r\n\r\n                        break;\r\n\r\n                    case ' ':\r\n                    case '\\t':\r\n                        break;\r\n\r\n                    default:\r\n                        if (prevToken === '\\r') {\r\n                            // Fatal error\r\n                            updateResult(internals.diagnoses.errFWSCRLFEnd);\r\n                        }\r\n\r\n                        crlfCount = 0;\r\n\r\n                        // End of FWS\r\n                        context.prev = context.now;\r\n                        context.now = context.stack.pop();\r\n\r\n                        // Look at this token again in the parent context\r\n                        --i;\r\n                }\r\n\r\n                prevToken = token;\r\n                break;\r\n\r\n            // Unexpected context\r\n            // $lab:coverage:off$\r\n            default:\r\n                throw new Error('unknown context: ' + context.now);\r\n            // $lab:coverage:on$\r\n        } // Primary state machine\r\n\r\n        if (maxResult > internals.categories.rfc5322) {\r\n            // Fatal error, no point continuing\r\n            break;\r\n        }\r\n    } // Token loop\r\n\r\n    // Check for errors\r\n    if (maxResult < internals.categories.rfc5322) {\r\n        // Fatal errors\r\n        if (context.now === internals.components.contextQuotedString) {\r\n            updateResult(internals.diagnoses.errUnclosedQuotedString);\r\n        }\r\n        else if (context.now === internals.components.contextQuotedPair) {\r\n            updateResult(internals.diagnoses.errBackslashEnd);\r\n        }\r\n        else if (context.now === internals.components.contextComment) {\r\n            updateResult(internals.diagnoses.errUnclosedComment);\r\n        }\r\n        else if (context.now === internals.components.literal) {\r\n            updateResult(internals.diagnoses.errUnclosedDomainLiteral);\r\n        }\r\n        else if (token === '\\r') {\r\n            updateResult(internals.diagnoses.errFWSCRLFEnd);\r\n        }\r\n        else if (parseData.domain.length === 0) {\r\n            updateResult(internals.diagnoses.errNoDomain);\r\n        }\r\n        else if (elementLength === 0) {\r\n            updateResult(internals.diagnoses.errDotEnd);\r\n        }\r\n        else if (hyphenFlag) {\r\n            updateResult(internals.diagnoses.errDomainHyphenEnd);\r\n        }\r\n\r\n        // Other errors\r\n        else if (parseData.domain.length > 255) {\r\n            // http://tools.ietf.org/html/rfc5321#section-4.5.3.1.2\r\n            //   The maximum total length of a domain name or number is 255 octets.\r\n            updateResult(internals.diagnoses.rfc5322DomainTooLong);\r\n        }\r\n        else if (parseData.local.length + parseData.domain.length + /* '@' */ 1 > 254) {\r\n            // http://tools.ietf.org/html/rfc5321#section-4.1.2\r\n            //   Forward-path   = Path\r\n            //\r\n            //   Path           = \"<\" [ A-d-l \":\" ] Mailbox \">\"\r\n            //\r\n            // http://tools.ietf.org/html/rfc5321#section-4.5.3.1.3\r\n            //   The maximum total length of a reverse-path or forward-path is 256 octets (including the punctuation and element separators).\r\n            //\r\n            // Thus, even without (obsolete) routing information, the Mailbox can only be 254 characters long. This is confirmed by this verified\r\n            // erratum to RFC 3696:\r\n            //\r\n            // http://www.rfc-editor.org/errata_search.php?rfc=3696&eid=1690\r\n            //   However, there is a restriction in RFC 2821 on the length of an address in MAIL and RCPT commands of 254 characters.  Since\r\n            //   addresses that do not fit in those fields are not normally useful, the upper limit on address lengths should normally be considered\r\n            //   to be 254.\r\n            updateResult(internals.diagnoses.rfc5322TooLong);\r\n        }\r\n        else if (elementLength > 63) {\r\n            // http://tools.ietf.org/html/rfc1035#section-2.3.4\r\n            // labels   63 octets or less\r\n            updateResult(internals.diagnoses.rfc5322LabelTooLong);\r\n        }\r\n        else if (options.minDomainAtoms && atomData.domains.length < options.minDomainAtoms) {\r\n            updateResult(internals.diagnoses.errDomainTooShort);\r\n        }\r\n        else if (options.tldWhitelist) {\r\n            var tldAtom = atomData.domains[elementCount];\r\n            if (Array.isArray(options.tldWhitelist)) {\r\n                var tldValid = false;\r\n                for (i = 0, il = options.tldWhitelist.length; i < il; ++i) {\r\n                    if (tldAtom === options.tldWhitelist[i]) {\r\n                        tldValid = true;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (!tldValid) {\r\n                    updateResult(internals.diagnoses.errUnknownTLD);\r\n                }\r\n            }\r\n            else if (!hasOwn.call(options.tldWhitelist, tldAtom)) {\r\n                updateResult(internals.diagnoses.errUnknownTLD);\r\n            }\r\n        }\r\n    } // Check for errors\r\n\r\n    var dnsPositive = false;\r\n    var finishImmediately = false;\r\n\r\n    var finish = function finish () {\r\n\r\n        if (!dnsPositive && maxResult < internals.categories.dnsWarn) {\r\n            // Per RFC 5321, domain atoms are limited to letter-digit-hyphen, so we only need to check code <= 57 to check for a digit\r\n            var code = atomData.domains[elementCount].charCodeAt(0);\r\n            if (code <= 57) {\r\n                updateResult(internals.diagnoses.rfc5321TLDNumeric);\r\n            }\r\n            else if (elementCount === 0) {\r\n                updateResult(internals.diagnoses.rfc5321TLD);\r\n            }\r\n        }\r\n\r\n        if (maxResult < threshold) {\r\n            maxResult = internals.diagnoses.valid;\r\n        }\r\n\r\n        var finishResult = diagnose ? maxResult : maxResult < internals.defaultThreshold;\r\n\r\n        if (callback) {\r\n            if (finishImmediately) {\r\n                callback(finishResult);\r\n            } else {\r\n                internals.defer(callback.bind(null, finishResult));\r\n            }\r\n        }\r\n\r\n        return finishResult;\r\n    }; // Finish\r\n\r\n    if (options.checkDNS && maxResult < internals.categories.dnsWarn) {\r\n        // http://tools.ietf.org/html/rfc5321#section-2.3.5\r\n        //   Names that can be resolved to MX RRs or address (i.e., A or AAAA) RRs (as discussed in Section 5) are permitted, as are CNAME RRs whose\r\n        //   targets can be resolved, in turn, to MX or address RRs.\r\n        //\r\n        // http://tools.ietf.org/html/rfc5321#section-5.1\r\n        //   The lookup first attempts to locate an MX record associated with the name.  If a CNAME record is found, the resulting name is processed\r\n        //   as if it were the initial name. ... If an empty list of MXs is returned, the address is treated as if it was associated with an implicit\r\n        //   MX RR, with a preference of 0, pointing to that host.\r\n        //\r\n        // isEmail() author's note: We will regard the existence of a CNAME to be sufficient evidence of the domain's existence. For performance\r\n        // reasons we will not repeat the DNS lookup for the CNAME's target, but we will raise a warning because we didn't immediately find an MX\r\n        // record.\r\n        if (elementCount === 0) {\r\n            // Checking TLD DNS only works if you explicitly check from the root\r\n            parseData.domain += '.';\r\n        }\r\n\r\n        var dnsDomain = parseData.domain;\r\n        Dns.resolveMx(dnsDomain, function resolveDNS (err, mxRecords) {\r\n\r\n            // If we have a fatal error, then we must assume that there are no records\r\n            if (err && err.code !== Dns.NODATA) {\r\n                updateResult(internals.diagnoses.dnsWarnNoRecord);\r\n                return finish();\r\n            }\r\n\r\n            if (mxRecords && mxRecords.length) {\r\n                dnsPositive = true;\r\n                return finish();\r\n            }\r\n\r\n            var count = 3;\r\n            var done = false;\r\n            updateResult(internals.diagnoses.dnsWarnNoMXRecord);\r\n\r\n            var handleRecords = function handleRecords (err, records) {\r\n\r\n                if (done) {\r\n                    return;\r\n                }\r\n\r\n                --count;\r\n\r\n                if (records && records.length) {\r\n                    done = true;\r\n                    return finish();\r\n                }\r\n\r\n                if (count === 0) {\r\n                    // No usable records for the domain can be found\r\n                    updateResult(internals.diagnoses.dnsWarnNoRecord);\r\n                    done = true;\r\n                    finish();\r\n                }\r\n            };\r\n\r\n            Dns.resolveCname(dnsDomain, handleRecords);\r\n            Dns.resolve4(dnsDomain, handleRecords);\r\n            Dns.resolve6(dnsDomain, handleRecords);\r\n        });\r\n\r\n        finishImmediately = true;\r\n    }\r\n    else {\r\n        var result = finish();\r\n        finishImmediately = true;\r\n        return result;\r\n    } // CheckDNS\r\n};\r\n\r\n\r\nisEmail.diagnoses = (function exportDiagnoses () {\r\n\r\n    var diag = {};\r\n    for (var key in internals.diagnoses) {\r\n        diag[key] = internals.diagnoses[key];\r\n    }\r\n    return diag;\r\n})();\r\n\r\nmodule.exports = isEmail;\r\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/string/uri.js":"var RFC3986 = require('./rfc3986');\n\nvar internals = {\n    Uri: {\n        createUriRegex: function (optionalScheme) {\n\n            var scheme = RFC3986.scheme;\n\n            // If we were passed a scheme, use it instead of the generic one\n            if (optionalScheme) {\n\n                // Have to put this in a non-capturing group to handle the OR statements\n                scheme = '(?:' + optionalScheme + ')';\n            }\n\n            /**\n             * URI = scheme \":\" hier-part [ \"?\" query ] [ \"#\" fragment ]\n             */\n            return new RegExp('^' + scheme + ':' + RFC3986.hierPart + '(?:\\\\?' + RFC3986.query + ')?' + '(?:#' + RFC3986.fragment + ')?$');\n        }\n    }\n};\n\nmodule.exports = internals.Uri;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/string/rfc3986.js":"var internals = {\n    rfc3986: {}\n};\n\n/**\n * elements separated by forward slash (\"/\") are alternatives.\n */\nvar or = '|';\n\n/**\n * DIGIT = %x30-39 ; 0-9\n */\nvar digit = '0-9';\nvar digitOnly = '[' + digit + ']';\n\n/**\n * ALPHA = %x41-5A / %x61-7A   ; A-Z / a-z\n */\nvar alpha = 'a-zA-Z';\nvar alphaOnly = '[' + alpha + ']';\n\n/**\n * cidr       = DIGIT                ; 0-9\n *            / %x31-32 DIGIT         ; 10-29\n *            / \"3\" %x30-32           ; 30-32\n */\ninternals.rfc3986.cidr = digitOnly + or + '[1-2]' + digitOnly + or + '3' + '[0-2]';\n\n/**\n * HEXDIG = DIGIT / \"A\" / \"B\" / \"C\" / \"D\" / \"E\" / \"F\"\n */\nvar hexDigit = digit + 'A-Fa-f',\n    hexDigitOnly = '[' + hexDigit + ']';\n\n/**\n * unreserved = ALPHA / DIGIT / \"-\" / \".\" / \"_\" / \"~\"\n */\nvar unreserved = alpha + digit + '-\\\\._~';\n\n/**\n * sub-delims = \"!\" / \"$\" / \"&\" / \"'\" / \"(\" / \")\" / \"*\" / \"+\" / \",\" / \";\" / \"=\"\n */\nvar subDelims = '!\\\\$&\\'\\\\(\\\\)\\\\*\\\\+,;=';\n\n/**\n * pct-encoded = \"%\" HEXDIG HEXDIG\n */\nvar pctEncoded = '%' + hexDigit;\n\n/**\n * pchar = unreserved / pct-encoded / sub-delims / \":\" / \"@\"\n */\nvar pchar = unreserved + pctEncoded + subDelims + ':@';\nvar pcharOnly = '[' + pchar + ']';\n\n/**\n * Rule to support zero-padded addresses.\n */\nvar zeroPad = '0?';\n\n/**\n * dec-octet   = DIGIT                 ; 0-9\n *            / %x31-39 DIGIT         ; 10-99\n *            / \"1\" 2DIGIT            ; 100-199\n *            / \"2\" %x30-34 DIGIT     ; 200-249\n *            / \"25\" %x30-35          ; 250-255\n */\nvar decOctect = '(?:' + zeroPad + zeroPad + digitOnly + or + zeroPad + '[1-9]' + digitOnly + or + '1' + digitOnly + digitOnly + or + '2' + '[0-4]' + digitOnly + or + '25' + '[0-5])';\n\n/**\n * IPv4address = dec-octet \".\" dec-octet \".\" dec-octet \".\" dec-octet\n */\ninternals.rfc3986.IPv4address = '(?:' + decOctect + '\\\\.){3}' + decOctect;\n\n/**\n * h16 = 1*4HEXDIG ; 16 bits of address represented in hexadecimal\n * ls32 = ( h16 \":\" h16 ) / IPv4address ; least-significant 32 bits of address\n * IPv6address =                            6( h16 \":\" ) ls32\n *             /                       \"::\" 5( h16 \":\" ) ls32\n *             / [               h16 ] \"::\" 4( h16 \":\" ) ls32\n *             / [ *1( h16 \":\" ) h16 ] \"::\" 3( h16 \":\" ) ls32\n *             / [ *2( h16 \":\" ) h16 ] \"::\" 2( h16 \":\" ) ls32\n *             / [ *3( h16 \":\" ) h16 ] \"::\"    h16 \":\"   ls32\n *             / [ *4( h16 \":\" ) h16 ] \"::\"              ls32\n *             / [ *5( h16 \":\" ) h16 ] \"::\"              h16\n *             / [ *6( h16 \":\" ) h16 ] \"::\"\n */\nvar h16 = hexDigitOnly + '{1,4}';\nvar ls32 = '(?:' + h16 + ':' + h16 + '|' + internals.rfc3986.IPv4address + ')';\nvar IPv6SixHex = '(?:' + h16 + ':){6}' + ls32;\nvar IPv6FiveHex = '::(?:' + h16 + ':){5}' + ls32;\nvar IPv6FourHex = h16 + '::(?:' + h16 + ':){4}' + ls32;\nvar IPv6ThreeHex = '(?:' + h16 + ':){0,1}' + h16 + '::(?:' + h16 + ':){3}' + ls32;\nvar IPv6TwoHex = '(?:' + h16 + ':){0,2}' + h16 + '::(?:' + h16 + ':){2}' + ls32;\nvar IPv6OneHex = '(?:' + h16 + ':){0,3}' + h16 + '::' + h16 + ':' + ls32;\nvar IPv6NoneHex = '(?:' + h16 + ':){0,4}' + h16 + '::' + ls32;\nvar IPv6NoneHex2 = '(?:' + h16 + ':){0,5}' + h16 + '::' + h16;\nvar IPv6NoneHex3 = '(?:' + h16 + ':){0,6}' + h16 + '::';\ninternals.rfc3986.IPv6address = '(?:' + IPv6SixHex + or + IPv6FiveHex + or + IPv6FourHex + or + IPv6ThreeHex + or + IPv6TwoHex + or + IPv6OneHex + or + IPv6NoneHex + or + IPv6NoneHex2 + or + IPv6NoneHex3 + ')';\n\n/**\n * IPvFuture = \"v\" 1*HEXDIG \".\" 1*( unreserved / sub-delims / \":\" )\n */\ninternals.rfc3986.IPvFuture = 'v' + hexDigitOnly + '+\\\\.[' + unreserved + subDelims + ':]+';\n\n/**\n * scheme = ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\n */\ninternals.rfc3986.scheme = alphaOnly + '[' + alpha + digit + '+-\\\\.]*';\n\n/**\n * userinfo = *( unreserved / pct-encoded / sub-delims / \":\" )\n */\nvar userinfo = '[' + unreserved + pctEncoded + subDelims + ':]*';\n\n/**\n * IP-literal = \"[\" ( IPv6address / IPvFuture  ) \"]\"\n */\nvar IPLiteral = '\\\\[(?:' + internals.rfc3986.IPv6address + or + internals.rfc3986.IPvFuture + ')\\\\]';\n\n/**\n * reg-name = *( unreserved / pct-encoded / sub-delims )\n */\nvar regName = '[' + unreserved + pctEncoded + subDelims + ']{0,255}';\n\n/**\n * host = IP-literal / IPv4address / reg-name\n */\nvar host = '(?:' + IPLiteral + or + internals.rfc3986.IPv4address + or + regName + ')';\n\n/**\n * port = *DIGIT\n */\nvar port = digitOnly + '*';\n\n/**\n * authority   = [ userinfo \"@\" ] host [ \":\" port ]\n */\nvar authority = '(?:' + userinfo + '@)?' + host + '(?::' + port + ')?';\n\n/**\n * segment       = *pchar\n * segment-nz    = 1*pchar\n * path          = path-abempty    ; begins with \"/\" or is empty\n *               / path-absolute   ; begins with \"/\" but not \"//\"\n *               / path-noscheme   ; begins with a non-colon segment\n *               / path-rootless   ; begins with a segment\n *               / path-empty      ; zero characters\n * path-abempty  = *( \"/\" segment )\n * path-absolute = \"/\" [ segment-nz *( \"/\" segment ) ]\n * path-rootless = segment-nz *( \"/\" segment )\n */\nvar segment = pcharOnly + '*';\nvar segmentNz = pcharOnly + '+';\nvar pathAbEmpty = '(?:\\\\/' + segment + ')*';\nvar pathAbsolute = '\\\\/(?:' + segmentNz + pathAbEmpty + ')?';\nvar pathRootless = segmentNz + pathAbEmpty;\n\n/**\n * hier-part = \"//\" authority path\n */\ninternals.rfc3986.hierPart = '(?:\\\\/\\\\/' + authority + pathAbEmpty + or + pathAbsolute + or + pathRootless + ')';\n\n/**\n * query = *( pchar / \"/\" / \"?\" )\n */\ninternals.rfc3986.query = '[' + pchar + '\\\\/\\\\?]*(?=#|$)'; //Finish matching either at the fragment part or end of the line.\n\n/**\n * fragment = *( pchar / \"/\" / \"?\" )\n */\ninternals.rfc3986.fragment = '[' + pchar + '\\\\/\\\\?]*';\n\nmodule.exports = internals.rfc3986;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/string/ip.js":"var RFC3986 = require('./rfc3986');\n\nvar internals = {\n    Ip: {\n        cidrs: {\n            required: '\\\\/(?:' + RFC3986.cidr + ')',\n            optional: '(?:\\\\/(?:' + RFC3986.cidr + '))?',\n            forbidden: ''\n        },\n        versions: {\n            ipv4: RFC3986.IPv4address,\n            ipv6: RFC3986.IPv6address,\n            ipvfuture: RFC3986.IPvFuture\n        }\n    }\n};\n\ninternals.Ip.createIpRegex = function (versions, cidr) {\n\n    var regex;\n    for (var i = 0, il = versions.length; i < il; ++i) {\n        var version = versions[i];\n        if (!regex) {\n            regex = '^(?:' + internals.Ip.versions[version];\n        }\n        regex += '|' + internals.Ip.versions[version];\n    }\n\n    return new RegExp(regex + ')' + internals.Ip.cidrs[cidr] + '$');\n};\n\nmodule.exports = internals.Ip;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/number.js":"// Load modules\n\nvar Any = require('./any');\nvar Ref = require('./ref');\nvar Errors = require('./errors');\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.Number = function () {\n\n    Any.call(this);\n    this._type = 'number';\n    this._invalids.add(Infinity);\n    this._invalids.add(-Infinity);\n};\n\nHoek.inherits(internals.Number, Any);\n\ninternals.compare = function (type, compare) {\n\n    return function (limit) {\n\n        var isRef = Ref.isRef(limit);\n        var isNumber = typeof limit === 'number' && !isNaN(limit);\n\n        Hoek.assert(isNumber || isRef, 'limit must be a number or reference');\n\n        return this._test(type, limit, function (value, state, options) {\n\n            var compareTo;\n            if (isRef) {\n                compareTo = limit(state.parent, options);\n\n                if (!(typeof compareTo === 'number' && !isNaN(compareTo))) {\n                    return Errors.create('number.ref', { ref: limit.key }, state, options);\n                }\n            }\n            else {\n                compareTo = limit;\n            }\n\n            if (compare(value, compareTo)) {\n                return null;\n            }\n\n            return Errors.create('number.' + type, { limit: compareTo, value: value }, state, options);\n        });\n    };\n};\n\n\ninternals.Number.prototype._base = function (value, state, options) {\n\n    var result = {\n        errors: null,\n        value: value\n    };\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        var number = parseFloat(value);\n        result.value = (isNaN(number) || !isFinite(value)) ? NaN : number;\n    }\n\n    var isNumber = typeof result.value === 'number' && !isNaN(result.value);\n\n    if (options.convert && 'precision' in this._flags && isNumber) {\n\n        // This is conceptually equivalent to using toFixed but it should be much faster\n        var precision = Math.pow(10, this._flags.precision);\n        result.value = Math.round(result.value * precision) / precision;\n    }\n\n    result.errors = isNumber ? null : Errors.create('number.base', null, state, options);\n    return result;\n};\n\n\ninternals.Number.prototype.min = internals.compare('min', function (value, limit) {\n\n    return value >= limit;\n});\n\n\ninternals.Number.prototype.max = internals.compare('max', function (value, limit) {\n\n    return value <= limit;\n});\n\n\ninternals.Number.prototype.greater = internals.compare('greater', function (value, limit) {\n\n    return value > limit;\n});\n\n\ninternals.Number.prototype.less = internals.compare('less', function (value, limit) {\n\n    return value < limit;\n});\n\n\ninternals.Number.prototype.multiple = function (base) {\n\n    Hoek.assert(Hoek.isInteger(base), 'multiple must be an integer');\n    Hoek.assert(base > 0, 'multiple must be greater than 0');\n\n    return this._test('multiple', base, function (value, state, options) {\n\n        if (value % base === 0) {\n            return null;\n        }\n\n        return Errors.create('number.multiple', { multiple: base, value: value }, state, options);\n    });\n};\n\n\ninternals.Number.prototype.integer = function () {\n\n    return this._test('integer', undefined, function (value, state, options) {\n\n        return Hoek.isInteger(value) ? null : Errors.create('number.integer', { value: value }, state, options);\n    });\n};\n\n\ninternals.Number.prototype.negative = function () {\n\n    return this._test('negative', undefined, function (value, state, options) {\n\n        if (value < 0) {\n            return null;\n        }\n\n        return Errors.create('number.negative', { value: value }, state, options);\n    });\n};\n\n\ninternals.Number.prototype.positive = function () {\n\n    return this._test('positive', undefined, function (value, state, options) {\n\n        if (value > 0) {\n            return null;\n        }\n\n        return Errors.create('number.positive', { value: value }, state, options);\n    });\n};\n\n\ninternals.precisionRx = /(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/;\n\n\ninternals.Number.prototype.precision = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit), 'limit must be an integer');\n    Hoek.assert(!('precision' in this._flags), 'precision already set');\n\n    var obj = this._test('precision', limit, function (value, state, options){\n\n        var places = value.toString().match(internals.precisionRx);\n        var decimals = Math.max((places[1] ? places[1].length : 0) - (places[2] ? parseInt(places[2], 10) : 0), 0);\n        if (decimals <= limit) {\n            return null;\n        }\n\n        return Errors.create('number.precision', { limit: limit, value: value }, state, options);\n    });\n\n    obj._flags.precision = limit;\n    return obj;\n};\n\n\nmodule.exports = new internals.Number();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/boolean.js":"// Load modules\n\nvar Any = require('./any');\nvar Errors = require('./errors');\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.Boolean = function () {\n\n    Any.call(this);\n    this._type = 'boolean';\n};\n\nHoek.inherits(internals.Boolean, Any);\n\n\ninternals.Boolean.prototype._base = function (value, state, options) {\n\n    var result = {\n        value: value\n    };\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        var lower = value.toLowerCase();\n        result.value = (lower === 'true' || lower === 'yes' || lower === 'on' ? true\n                                                                              : (lower === 'false' || lower === 'no' || lower === 'off' ? false : value));\n    }\n\n    result.errors = (typeof result.value === 'boolean') ? null : Errors.create('boolean.base', null, state, options);\n    return result;\n};\n\n\nmodule.exports = new internals.Boolean();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/alternatives.js":"// Load modules\n\nvar Hoek = require('hoek');\nvar Any = require('./any');\nvar Cast = require('./cast');\nvar Ref = require('./ref');\nvar Errors = require('./errors');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.Alternatives = function () {\n\n    Any.call(this);\n    this._type = 'alternatives';\n    this._invalids.remove(null);\n\n    this._inner.matches = [];\n};\n\nHoek.inherits(internals.Alternatives, Any);\n\n\ninternals.Alternatives.prototype._base = function (value, state, options) {\n\n    var errors = [];\n    for (var i = 0, il = this._inner.matches.length; i < il; ++i) {\n        var item = this._inner.matches[i];\n        var schema = item.schema;\n        if (!schema) {\n            var failed = item.is._validate(item.ref(state.parent, options), null, options, state.parent).errors;\n            schema = failed ? item.otherwise : item.then;\n            if (!schema) {\n                continue;\n            }\n        }\n\n        var result = schema._validate(value, state, options);\n        if (!result.errors) {     // Found a valid match\n            return result;\n        }\n\n        errors = errors.concat(result.errors);\n    }\n\n    return { errors: errors.length ? errors : Errors.create('alternatives.base', null, state, options) };\n};\n\n\ninternals.Alternatives.prototype.try = function (/* schemas */) {\n\n\n    var schemas = Hoek.flatten(Array.prototype.slice.call(arguments));\n    Hoek.assert(schemas.length, 'Cannot add other alternatives without at least one schema');\n\n    var obj = this.clone();\n\n    for (var i = 0, il = schemas.length; i < il; ++i) {\n        var cast = Cast.schema(schemas[i]);\n        if (cast._refs.length) {\n            obj._refs = obj._refs.concat(cast._refs);\n        }\n        obj._inner.matches.push({ schema: cast });\n    }\n\n    return obj;\n};\n\n\ninternals.Alternatives.prototype.when = function (ref, options) {\n\n    Hoek.assert(Ref.isRef(ref) || typeof ref === 'string', 'Invalid reference:', ref);\n    Hoek.assert(options, 'Missing options');\n    Hoek.assert(typeof options === 'object', 'Invalid options');\n    Hoek.assert(options.hasOwnProperty('is'), 'Missing \"is\" directive');\n    Hoek.assert(options.then !== undefined || options.otherwise !== undefined, 'options must have at least one of \"then\" or \"otherwise\"');\n\n    var obj = this.clone();\n    var is = Cast.schema(options.is);\n\n    if (options.is === null || !options.is.isJoi) {\n\n        // Only apply required if this wasn't already a schema, we'll suppose people know what they're doing\n        is = is.required();\n    }\n\n    var item = {\n        ref: Cast.ref(ref),\n        is: is,\n        then: options.then !== undefined ? Cast.schema(options.then) : undefined,\n        otherwise: options.otherwise !== undefined ? Cast.schema(options.otherwise) : undefined\n    };\n\n    Ref.push(obj._refs, item.ref);\n    obj._refs = obj._refs.concat(item.is._refs);\n\n    if (item.then && item.then._refs) {\n        obj._refs = obj._refs.concat(item.then._refs);\n    }\n\n    if (item.otherwise && item.otherwise._refs) {\n        obj._refs = obj._refs.concat(item.otherwise._refs);\n    }\n\n    obj._inner.matches.push(item);\n\n    return obj;\n};\n\n\ninternals.Alternatives.prototype.describe = function () {\n\n    var description = Any.prototype.describe.call(this);\n    var alternatives = [];\n    for (var i = 0, il = this._inner.matches.length; i < il; ++i) {\n        var item = this._inner.matches[i];\n        if (item.schema) {\n\n            // try()\n\n            alternatives.push(item.schema.describe());\n        }\n        else {\n\n            // when()\n\n            var when = {\n                ref: item.ref.toString(),\n                is: item.is.describe()\n            };\n\n            if (item.then) {\n                when.then = item.then.describe();\n            }\n\n            if (item.otherwise) {\n                when.otherwise = item.otherwise.describe();\n            }\n\n            alternatives.push(when);\n        }\n    }\n\n    description.alternatives = alternatives;\n    return description;\n};\n\n\nmodule.exports = new internals.Alternatives();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/array.js":"// Load modules\n\nvar Any = require('./any');\nvar Cast = require('./cast');\nvar Errors = require('./errors');\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.fastSplice = function (arr, i) {\n\n    var il = arr.length;\n    var pos = i;\n\n    while (pos < il) {\n        arr[pos++] = arr[pos];\n    }\n\n    --arr.length;\n};\n\n\ninternals.Array = function () {\n\n    Any.call(this);\n    this._type = 'array';\n    this._inner.items = [];\n    this._inner.ordereds = [];\n    this._inner.inclusions = [];\n    this._inner.exclusions = [];\n    this._inner.requireds = [];\n    this._flags.sparse = false;\n};\n\nHoek.inherits(internals.Array, Any);\n\n\ninternals.Array.prototype._base = function (value, state, options) {\n\n    var result = {\n        value: value\n    };\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        try {\n            var converted = JSON.parse(value);\n            if (Array.isArray(converted)) {\n                result.value = converted;\n            }\n        }\n        catch (e) { }\n    }\n\n    var isArray = Array.isArray(result.value);\n    var wasArray = isArray;\n    if (options.convert && this._flags.single && !isArray) {\n        result.value = [result.value];\n        isArray = true;\n    }\n\n    if (!isArray) {\n        result.errors = Errors.create('array.base', null, state, options);\n        return result;\n    }\n\n    if (this._inner.inclusions.length ||\n        this._inner.exclusions.length ||\n        !this._flags.sparse) {\n\n        // Clone the array so that we don't modify the original\n        if (wasArray) {\n            result.value = result.value.slice(0);\n        }\n\n        result.errors = internals.checkItems.call(this, result.value, wasArray, state, options);\n\n        if (result.errors && wasArray && options.convert && this._flags.single) {\n\n            // Attempt a 2nd pass by putting the array inside one.\n            var previousErrors = result.errors;\n\n            result.value = [result.value];\n            result.errors = internals.checkItems.call(this, result.value, wasArray, state, options);\n\n            if (result.errors) {\n\n                // Restore previous errors and value since this didn't validate either.\n                result.errors = previousErrors;\n                result.value = result.value[0];\n            }\n        }\n    }\n\n    return result;\n};\n\n\ninternals.checkItems = function (items, wasArray, state, options) {\n\n    var errors = [];\n    var errored;\n\n    var requireds = this._inner.requireds.slice();\n    var ordereds = this._inner.ordereds.slice();\n    var inclusions = this._inner.inclusions.concat(requireds);\n\n    for (var v = 0, vl = items.length; v < vl; ++v) {\n        errored = false;\n        var item = items[v];\n        var isValid = false;\n        var localState = { key: v, path: (state.path ? state.path + '.' : '') + v, parent: items, reference: state.reference };\n        var res;\n\n        // Sparse\n\n        if (!this._flags.sparse && item === undefined) {\n            errors.push(Errors.create('array.sparse', null, { key: state.key, path: localState.path }, options));\n\n            if (options.abortEarly) {\n                return errors;\n            }\n\n            continue;\n        }\n\n        // Exclusions\n\n        for (var i = 0, il = this._inner.exclusions.length; i < il; ++i) {\n            res = this._inner.exclusions[i]._validate(item, localState, {});                // Not passing options to use defaults\n\n            if (!res.errors) {\n                errors.push(Errors.create(wasArray ? 'array.excludes' : 'array.excludesSingle', { pos: v, value: item }, { key: state.key, path: localState.path }, options));\n                errored = true;\n\n                if (options.abortEarly) {\n                    return errors;\n                }\n\n                break;\n            }\n        }\n\n        if (errored) {\n            continue;\n        }\n\n        // Ordered\n        if (this._inner.ordereds.length) {\n            if (ordereds.length > 0) {\n                var ordered = ordereds.shift();\n                res = ordered._validate(item, localState, options);\n                if (!res.errors) {\n                    if (ordered._flags.strip) {\n                        internals.fastSplice(items, v);\n                        --v;\n                        --vl;\n                    }\n                    else {\n                        items[v] = res.value;\n                    }\n                }\n                else {\n                    errors.push(Errors.create('array.ordered', { pos: v, reason: res.errors, value: item }, { key: state.key, path: localState.path }, options));\n                    if (options.abortEarly) {\n                        return errors;\n                    }\n                }\n                continue;\n            }\n            else if (!this._inner.items.length) {\n                errors.push(Errors.create('array.orderedLength', { pos: v, limit: this._inner.ordereds.length }, { key: state.key, path: localState.path }, options));\n                if (options.abortEarly) {\n                    return errors;\n                }\n                continue;\n            }\n        }\n\n        // Requireds\n\n        var requiredChecks = [];\n        for (i = 0, il = requireds.length; i < il; ++i) {\n            res = requiredChecks[i] = requireds[i]._validate(item, localState, options);\n            if (!res.errors) {\n                items[v] = res.value;\n                isValid = true;\n                internals.fastSplice(requireds, i);\n                --i;\n                --il;\n                break;\n            }\n        }\n\n        if (isValid) {\n            continue;\n        }\n\n        // Inclusions\n\n        for (i = 0, il = inclusions.length; i < il; ++i) {\n            var inclusion = inclusions[i];\n\n            // Avoid re-running requireds that already didn't match in the previous loop\n            var previousCheck = requireds.indexOf(inclusion);\n            if (previousCheck !== -1) {\n                res = requiredChecks[previousCheck];\n            }\n            else {\n                res = inclusion._validate(item, localState, options);\n\n                if (!res.errors) {\n                    if (inclusion._flags.strip) {\n                        internals.fastSplice(items, v);\n                        --v;\n                        --vl;\n                    }\n                    else {\n                        items[v] = res.value;\n                    }\n                    isValid = true;\n                    break;\n                }\n            }\n\n            // Return the actual error if only one inclusion defined\n            if (il === 1) {\n                if (options.stripUnknown) {\n                    internals.fastSplice(items, v);\n                    --v;\n                    --vl;\n                    isValid = true;\n                    break;\n                }\n\n                errors.push(Errors.create(wasArray ? 'array.includesOne' : 'array.includesOneSingle', { pos: v, reason: res.errors, value: item }, { key: state.key, path: localState.path }, options));\n                errored = true;\n\n                if (options.abortEarly) {\n                    return errors;\n                }\n\n                break;\n            }\n        }\n\n        if (errored) {\n            continue;\n        }\n\n        if (this._inner.inclusions.length && !isValid) {\n            if (options.stripUnknown) {\n                internals.fastSplice(items, v);\n                --v;\n                --vl;\n                continue;\n            }\n\n            errors.push(Errors.create(wasArray ? 'array.includes' : 'array.includesSingle', { pos: v, value: item }, { key: state.key, path: localState.path }, options));\n\n            if (options.abortEarly) {\n                return errors;\n            }\n        }\n    }\n\n    if (requireds.length) {\n        internals.fillMissedErrors(errors, requireds, state, options);\n    }\n\n    if (ordereds.length) {\n        internals.fillOrderedErrors(errors, ordereds, state, options);\n    }\n\n    return errors.length ? errors : null;\n};\n\ninternals.fillMissedErrors = function (errors, requireds, state, options) {\n\n    var knownMisses = [];\n    var unknownMisses = 0;\n    for (var i = 0, il = requireds.length; i < il; ++i) {\n        var label = Hoek.reach(requireds[i], '_settings.language.label');\n        if (label) {\n            knownMisses.push(label);\n        }\n        else {\n            ++unknownMisses;\n        }\n    }\n\n    if (knownMisses.length) {\n        if (unknownMisses) {\n            errors.push(Errors.create('array.includesRequiredBoth', { knownMisses: knownMisses, unknownMisses: unknownMisses }, { key: state.key, path: state.patk }, options));\n        }\n        else {\n            errors.push(Errors.create('array.includesRequiredKnowns', { knownMisses: knownMisses }, { key: state.key, path: state.path }, options));\n        }\n    }\n    else {\n        errors.push(Errors.create('array.includesRequiredUnknowns', { unknownMisses: unknownMisses }, { key: state.key, path: state.path }, options));\n    }\n};\n\ninternals.fillOrderedErrors = function (errors, ordereds, state, options) {\n\n    var requiredOrdereds = [];\n\n    for (var i = 0, il = ordereds.length; i < il; ++i) {\n        var presence = Hoek.reach(ordereds[i], '_flags.presence');\n        if (presence === 'required') {\n            requiredOrdereds.push(ordereds[i]);\n        }\n    }\n\n    if (requiredOrdereds.length) {\n        internals.fillMissedErrors(errors, requiredOrdereds, state, options);\n    }\n};\n\ninternals.Array.prototype.describe = function () {\n\n    var description = Any.prototype.describe.call(this);\n\n    if (this._inner.ordereds.length) {\n        description.orderedItems = [];\n\n        for (var o = 0, ol = this._inner.ordereds.length; o < ol; ++o) {\n            description.orderedItems.push(this._inner.ordereds[o].describe());\n        }\n    }\n\n    if (this._inner.items.length) {\n        description.items = [];\n\n        for (var i = 0, il = this._inner.items.length; i < il; ++i) {\n            description.items.push(this._inner.items[i].describe());\n        }\n    }\n\n    return description;\n};\n\n\ninternals.Array.prototype.items = function () {\n\n    var obj = this.clone();\n\n    Hoek.flatten(Array.prototype.slice.call(arguments)).forEach(function (type, index) {\n\n        try {\n            type = Cast.schema(type);\n        }\n        catch (castErr) {\n            if (castErr.hasOwnProperty('path')) {\n                castErr.path = index + '.' + castErr.path;\n            }\n            else {\n                castErr.path = index;\n            }\n            castErr.message += '(' + castErr.path + ')';\n            throw castErr;\n        }\n\n        obj._inner.items.push(type);\n\n        if (type._flags.presence === 'required') {\n            obj._inner.requireds.push(type);\n        }\n        else if (type._flags.presence === 'forbidden') {\n            obj._inner.exclusions.push(type.optional());\n        }\n        else {\n            obj._inner.inclusions.push(type);\n        }\n    });\n\n    return obj;\n};\n\n\ninternals.Array.prototype.ordered = function () {\n\n    var obj = this.clone();\n\n    Hoek.flatten(Array.prototype.slice.call(arguments)).forEach(function (type, index) {\n\n        try {\n            type = Cast.schema(type);\n        }\n        catch (castErr) {\n            if (castErr.hasOwnProperty('path')) {\n                castErr.path = index + '.' + castErr.path;\n            }\n            else {\n                castErr.path = index;\n            }\n            castErr.message += '(' + castErr.path + ')';\n            throw castErr;\n        }\n        obj._inner.ordereds.push(type);\n    });\n\n    return obj;\n};\n\n\ninternals.Array.prototype.min = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('min', limit, function (value, state, options) {\n\n        if (value.length >= limit) {\n            return null;\n        }\n\n        return Errors.create('array.min', { limit: limit, value: value }, state, options);\n    });\n};\n\n\ninternals.Array.prototype.max = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('max', limit, function (value, state, options) {\n\n        if (value.length <= limit) {\n            return null;\n        }\n\n        return Errors.create('array.max', { limit: limit, value: value }, state, options);\n    });\n};\n\n\ninternals.Array.prototype.length = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('length', limit, function (value, state, options) {\n\n        if (value.length === limit) {\n            return null;\n        }\n\n        return Errors.create('array.length', { limit: limit, value: value }, state, options);\n    });\n};\n\n\ninternals.Array.prototype.unique = function () {\n\n    return this._test('unique', undefined, function (value, state, options) {\n\n        var found = {\n            string: {},\n            number: {},\n            undefined: {},\n            boolean: {},\n            object: [],\n            function: []\n        };\n\n        for (var i = 0, il = value.length; i < il; ++i) {\n            var item = value[i];\n            var type = typeof item;\n            var records = found[type];\n\n            // All available types are supported, so it's not possible to reach 100% coverage without ignoring this line.\n            // I still want to keep the test for future js versions with new types (eg. Symbol).\n            if (/* $lab:coverage:off$ */ records /* $lab:coverage:on$ */) {\n                if (Array.isArray(records)) {\n                    for (var r = 0, rl = records.length; r < rl; ++r) {\n                        if (Hoek.deepEqual(records[r], item)) {\n                            return Errors.create('array.unique', { pos: i, value: item }, state, options);\n                        }\n                    }\n\n                    records.push(item);\n                }\n                else {\n                    if (records[item]) {\n                        return Errors.create('array.unique', { pos: i, value: item }, state, options);\n                    }\n\n                    records[item] = true;\n                }\n            }\n        }\n    });\n};\n\n\ninternals.Array.prototype.sparse = function (enabled) {\n\n    var obj = this.clone();\n    obj._flags.sparse = enabled === undefined ? true : !!enabled;\n    return obj;\n};\n\n\ninternals.Array.prototype.single = function (enabled) {\n\n    var obj = this.clone();\n    obj._flags.single = enabled === undefined ? true : !!enabled;\n    return obj;\n};\n\n\nmodule.exports = new internals.Array();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/binary.js":"// Load modules\n\nvar Any = require('./any');\nvar Errors = require('./errors');\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.Binary = function () {\n\n    Any.call(this);\n    this._type = 'binary';\n};\n\nHoek.inherits(internals.Binary, Any);\n\n\ninternals.Binary.prototype._base = function (value, state, options) {\n\n    var result = {\n        value: value\n    };\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        try {\n            var converted = new Buffer(value, this._flags.encoding);\n            result.value = converted;\n        }\n        catch (e) { }\n    }\n\n    result.errors = Buffer.isBuffer(result.value) ? null : Errors.create('binary.base', null, state, options);\n    return result;\n};\n\n\ninternals.Binary.prototype.encoding = function (encoding) {\n\n    Hoek.assert(Buffer.isEncoding(encoding), 'Invalid encoding:', encoding);\n\n    var obj = this.clone();\n    obj._flags.encoding = encoding;\n    return obj;\n};\n\n\ninternals.Binary.prototype.min = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('min', limit, function (value, state, options) {\n\n        if (value.length >= limit) {\n            return null;\n        }\n\n        return Errors.create('binary.min', { limit: limit, value: value }, state, options);\n    });\n};\n\n\ninternals.Binary.prototype.max = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('max', limit, function (value, state, options) {\n\n        if (value.length <= limit) {\n            return null;\n        }\n\n        return Errors.create('binary.max', { limit: limit, value: value }, state, options);\n    });\n};\n\n\ninternals.Binary.prototype.length = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('length', limit, function (value, state, options) {\n\n        if (value.length === limit) {\n            return null;\n        }\n\n        return Errors.create('binary.length', { limit: limit, value: value }, state, options);\n    });\n};\n\n\nmodule.exports = new internals.Binary();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/joi/lib/object.js":"// Load modules\n\nvar Hoek = require('hoek');\nvar Topo = require('topo');\nvar Any = require('./any');\nvar Cast = require('./cast');\nvar Errors = require('./errors');\n\n\n// Declare internals\n\nvar internals = {};\n\n\ninternals.Object = function () {\n\n    Any.call(this);\n    this._type = 'object';\n    this._inner.children = null;\n    this._inner.renames = [];\n    this._inner.dependencies = [];\n    this._inner.patterns = [];\n};\n\nHoek.inherits(internals.Object, Any);\n\n\ninternals.Object.prototype._base = function (value, state, options) {\n\n    var item, key, localState, result;\n    var target = value;\n    var errors = [];\n    var finish = function () {\n\n        return {\n            value: target,\n            errors: errors.length ? errors : null\n        };\n    };\n\n    if (typeof value === 'string' &&\n        options.convert) {\n\n        try {\n            value = JSON.parse(value);\n        }\n        catch (parseErr) { }\n    }\n\n    var type = this._flags.func ? 'function' : 'object';\n    if (!value ||\n        typeof value !== type ||\n        Array.isArray(value)) {\n\n        errors.push(Errors.create(type + '.base', null, state, options));\n        return finish();\n    }\n\n    // Skip if there are no other rules to test\n\n    if (!this._inner.renames.length &&\n        !this._inner.dependencies.length &&\n        !this._inner.children &&                    // null allows any keys\n        !this._inner.patterns.length) {\n\n        target = value;\n        return finish();\n    }\n\n    // Ensure target is a local copy (parsed) or shallow copy\n\n    if (target === value) {\n        if (type === 'object') {\n            target = Object.create(Object.getPrototypeOf(value));\n        }\n        else {\n            target = function () {\n\n                return value.apply(this, arguments);\n            };\n\n            target.prototype = Hoek.clone(value.prototype);\n        }\n\n        var valueKeys = Object.keys(value);\n        for (var t = 0, tl = valueKeys.length; t < tl; ++t) {\n            target[valueKeys[t]] = value[valueKeys[t]];\n        }\n    }\n    else {\n        target = value;\n    }\n\n    // Rename keys\n\n    var renamed = {};\n    for (var r = 0, rl = this._inner.renames.length; r < rl; ++r) {\n        item = this._inner.renames[r];\n\n        if (item.options.ignoreUndefined && target[item.from] === undefined) {\n            continue;\n        }\n\n        if (!item.options.multiple &&\n            renamed[item.to]) {\n\n            errors.push(Errors.create('object.rename.multiple', { from: item.from, to: item.to }, state, options));\n            if (options.abortEarly) {\n                return finish();\n            }\n        }\n\n        if (Object.prototype.hasOwnProperty.call(target, item.to) &&\n            !item.options.override &&\n            !renamed[item.to]) {\n\n            errors.push(Errors.create('object.rename.override', { from: item.from, to: item.to }, state, options));\n            if (options.abortEarly) {\n                return finish();\n            }\n        }\n\n        if (target[item.from] === undefined) {\n            delete target[item.to];\n        }\n        else {\n            target[item.to] = target[item.from];\n        }\n\n        renamed[item.to] = true;\n\n        if (!item.options.alias) {\n            delete target[item.from];\n        }\n    }\n\n    // Validate schema\n\n    if (!this._inner.children &&            // null allows any keys\n        !this._inner.patterns.length &&\n        !this._inner.dependencies.length) {\n\n        return finish();\n    }\n\n    var unprocessed = Hoek.mapToObject(Object.keys(target));\n\n    if (this._inner.children) {\n        for (var i = 0, il = this._inner.children.length; i < il; ++i) {\n            var child = this._inner.children[i];\n            key = child.key;\n            item = target[key];\n\n            delete unprocessed[key];\n\n            localState = { key: key, path: (state.path || '') + (state.path && key ? '.' : '') + key, parent: target, reference: state.reference };\n            result = child.schema._validate(item, localState, options);\n            if (result.errors) {\n                errors.push(Errors.create('object.child', { key: key, reason: result.errors }, localState, options));\n\n                if (options.abortEarly) {\n                    return finish();\n                }\n            }\n\n            if (child.schema._flags.strip || (result.value === undefined && result.value !== item)) {\n                delete target[key];\n            }\n            else if (result.value !== undefined) {\n                target[key] = result.value;\n            }\n        }\n    }\n\n    // Unknown keys\n\n    var unprocessedKeys = Object.keys(unprocessed);\n    if (unprocessedKeys.length &&\n        this._inner.patterns.length) {\n\n        for (i = 0, il = unprocessedKeys.length; i < il; ++i) {\n            key = unprocessedKeys[i];\n\n            for (var p = 0, pl = this._inner.patterns.length; p < pl; ++p) {\n                var pattern = this._inner.patterns[p];\n\n                if (pattern.regex.test(key)) {\n                    delete unprocessed[key];\n\n                    item = target[key];\n                    localState = { key: key, path: (state.path ? state.path + '.' : '') + key, parent: target, reference: state.reference };\n                    result = pattern.rule._validate(item, localState, options);\n                    if (result.errors) {\n                        errors.push(Errors.create('object.child', { key: key, reason: result.errors }, localState, options));\n\n                        if (options.abortEarly) {\n                            return finish();\n                        }\n                    }\n\n                    if (result.value !== undefined) {\n                        target[key] = result.value;\n                    }\n                }\n            }\n        }\n\n        unprocessedKeys = Object.keys(unprocessed);\n    }\n\n    if ((this._inner.children || this._inner.patterns.length) && unprocessedKeys.length) {\n        if (options.stripUnknown ||\n            options.skipFunctions) {\n\n            for (var k = 0, kl = unprocessedKeys.length; k < kl; ++k) {\n                key = unprocessedKeys[k];\n\n                if (options.stripUnknown) {\n                    delete target[key];\n                    delete unprocessed[key];\n                }\n                else if (typeof target[key] === 'function') {\n                    delete unprocessed[key];\n                }\n            }\n\n            unprocessedKeys = Object.keys(unprocessed);\n        }\n\n        if (unprocessedKeys.length &&\n            (this._flags.allowUnknown !== undefined ? !this._flags.allowUnknown : !options.allowUnknown)) {\n\n            for (var e = 0, el = unprocessedKeys.length; e < el; ++e) {\n                errors.push(Errors.create('object.allowUnknown', null, { key: unprocessedKeys[e], path: state.path + (state.path ? '.' : '') + unprocessedKeys[e] }, options));\n            }\n        }\n    }\n\n    // Validate dependencies\n\n    for (var d = 0, dl = this._inner.dependencies.length; d < dl; ++d) {\n        var dep = this._inner.dependencies[d];\n        var err = internals[dep.type](dep.key !== null && value[dep.key], dep.peers, target, { key: dep.key, path: (state.path || '') + (dep.key ? '.' + dep.key : '') }, options);\n        if (err) {\n            errors.push(err);\n            if (options.abortEarly) {\n                return finish();\n            }\n        }\n    }\n\n    return finish();\n};\n\n\ninternals.Object.prototype._func = function () {\n\n    var obj = this.clone();\n    obj._flags.func = true;\n    return obj;\n};\n\n\ninternals.Object.prototype.keys = function (schema) {\n\n    Hoek.assert(schema === null || schema === undefined || typeof schema === 'object', 'Object schema must be a valid object');\n    Hoek.assert(!schema || !schema.isJoi, 'Object schema cannot be a joi schema');\n\n    var obj = this.clone();\n\n    if (!schema) {\n        obj._inner.children = null;\n        return obj;\n    }\n\n    var children = Object.keys(schema);\n\n    if (!children.length) {\n        obj._inner.children = [];\n        return obj;\n    }\n\n    var topo = new Topo();\n    var child;\n    if (obj._inner.children) {\n        for (var i = 0, il = obj._inner.children.length; i < il; ++i) {\n            child = obj._inner.children[i];\n\n            // Only add the key if we are not going to replace it later\n            if (children.indexOf(child.key) === -1) {\n                topo.add(child, { after: child._refs, group: child.key });\n            }\n        }\n    }\n\n    for (var c = 0, cl = children.length; c < cl; ++c) {\n        var key = children[c];\n        child = schema[key];\n        try {\n            var cast = Cast.schema(child);\n            topo.add({ key: key, schema: cast }, { after: cast._refs, group: key });\n        }\n        catch (castErr) {\n            if (castErr.hasOwnProperty('path')) {\n                castErr.path = key + '.' + castErr.path;\n            }\n            else {\n                castErr.path = key;\n            }\n            throw castErr;\n        }\n    }\n\n    obj._inner.children = topo.nodes;\n\n    return obj;\n};\n\n\ninternals.Object.prototype.unknown = function (allow) {\n\n    var obj = this.clone();\n    obj._flags.allowUnknown = (allow !== false);\n    return obj;\n};\n\n\ninternals.Object.prototype.length = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('length', limit, function (value, state, options) {\n\n        if (Object.keys(value).length === limit) {\n            return null;\n        }\n\n        return Errors.create('object.length', { limit: limit }, state, options);\n    });\n};\n\n\ninternals.Object.prototype.min = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('min', limit, function (value, state, options) {\n\n        if (Object.keys(value).length >= limit) {\n            return null;\n        }\n\n        return Errors.create('object.min', { limit: limit }, state, options);\n    });\n};\n\n\ninternals.Object.prototype.max = function (limit) {\n\n    Hoek.assert(Hoek.isInteger(limit) && limit >= 0, 'limit must be a positive integer');\n\n    return this._test('max', limit, function (value, state, options) {\n\n        if (Object.keys(value).length <= limit) {\n            return null;\n        }\n\n        return Errors.create('object.max', { limit: limit }, state, options);\n    });\n};\n\n\ninternals.Object.prototype.pattern = function (pattern, schema) {\n\n    Hoek.assert(pattern instanceof RegExp, 'Invalid regular expression');\n    Hoek.assert(schema !== undefined, 'Invalid rule');\n\n    pattern = new RegExp(pattern.source, pattern.ignoreCase ? 'i' : undefined);         // Future version should break this and forbid unsupported regex flags\n\n    try {\n        schema = Cast.schema(schema);\n    }\n    catch (castErr) {\n        if (castErr.hasOwnProperty('path')) {\n            castErr.message += '(' + castErr.path + ')';\n        }\n\n        throw castErr;\n    }\n\n\n    var obj = this.clone();\n    obj._inner.patterns.push({ regex: pattern, rule: schema });\n    return obj;\n};\n\n\ninternals.Object.prototype.with = function (key, peers) {\n\n    return this._dependency('with', key, peers);\n};\n\n\ninternals.Object.prototype.without = function (key, peers) {\n\n    return this._dependency('without', key, peers);\n};\n\n\ninternals.Object.prototype.xor = function () {\n\n    var peers = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this._dependency('xor', null, peers);\n};\n\n\ninternals.Object.prototype.or = function () {\n\n    var peers = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this._dependency('or', null, peers);\n};\n\n\ninternals.Object.prototype.and = function () {\n\n    var peers = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this._dependency('and', null, peers);\n};\n\n\ninternals.Object.prototype.nand = function () {\n\n    var peers = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this._dependency('nand', null, peers);\n};\n\n\ninternals.Object.prototype.requiredKeys = function (children) {\n\n    children = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this.applyFunctionToChildren(children, 'required');\n};\n\n\ninternals.Object.prototype.optionalKeys = function (children) {\n\n    children = Hoek.flatten(Array.prototype.slice.call(arguments));\n    return this.applyFunctionToChildren(children, 'optional');\n};\n\n\ninternals.renameDefaults = {\n    alias: false,                   // Keep old value in place\n    multiple: false,                // Allow renaming multiple keys into the same target\n    override: false                 // Overrides an existing key\n};\n\n\ninternals.Object.prototype.rename = function (from, to, options) {\n\n    Hoek.assert(typeof from === 'string', 'Rename missing the from argument');\n    Hoek.assert(typeof to === 'string', 'Rename missing the to argument');\n    Hoek.assert(to !== from, 'Cannot rename key to same name:', from);\n\n    for (var i = 0, il = this._inner.renames.length; i < il; ++i) {\n        Hoek.assert(this._inner.renames[i].from !== from, 'Cannot rename the same key multiple times');\n    }\n\n    var obj = this.clone();\n\n    obj._inner.renames.push({\n        from: from,\n        to: to,\n        options: Hoek.applyToDefaults(internals.renameDefaults, options || {})\n    });\n\n    return obj;\n};\n\n\ninternals.groupChildren = function (children) {\n\n    children.sort();\n\n    var grouped = {};\n\n    for (var c = 0, lc = children.length; c < lc; c++) {\n        var child = children[c];\n        Hoek.assert(typeof child === 'string', 'children must be strings');\n        var group = child.split('.')[0];\n        var childGroup = grouped[group] = (grouped[group] || []);\n        childGroup.push(child.substring(group.length + 1));\n    }\n\n    return grouped;\n};\n\n\ninternals.Object.prototype.applyFunctionToChildren = function (children, fn, args, root) {\n\n    children = [].concat(children);\n    Hoek.assert(children.length > 0, 'expected at least one children');\n\n    var groupedChildren = internals.groupChildren(children);\n    var obj;\n\n    if ('' in groupedChildren) {\n        obj = this[fn].apply(this, args);\n        delete groupedChildren[''];\n    }\n    else {\n        obj = this.clone();\n    }\n\n    if (obj._inner.children) {\n        root = root ? (root + '.') : '';\n\n        for (var i = 0, il = obj._inner.children.length; i < il; ++i) {\n            var child = obj._inner.children[i];\n            var group = groupedChildren[child.key];\n\n            if (group) {\n                obj._inner.children[i] = {\n                    key: child.key,\n                    _refs: child._refs,\n                    schema: child.schema.applyFunctionToChildren(group, fn, args, root + child.key)\n                };\n\n                delete groupedChildren[child.key];\n            }\n        }\n    }\n\n    var remaining = Object.keys(groupedChildren);\n    Hoek.assert(remaining.length === 0, 'unknown key(s)', remaining.join(', '));\n\n    return obj;\n};\n\n\ninternals.Object.prototype._dependency = function (type, key, peers) {\n\n    peers = [].concat(peers);\n    for (var i = 0, li = peers.length; i < li; i++) {\n        Hoek.assert(typeof peers[i] === 'string', type, 'peers must be a string or array of strings');\n    }\n\n    var obj = this.clone();\n    obj._inner.dependencies.push({ type: type, key: key, peers: peers });\n    return obj;\n};\n\n\ninternals.with = function (value, peers, parent, state, options) {\n\n    if (value === undefined) {\n        return null;\n    }\n\n    for (var i = 0, il = peers.length; i < il; ++i) {\n        var peer = peers[i];\n        if (!Object.prototype.hasOwnProperty.call(parent, peer) ||\n            parent[peer] === undefined) {\n\n            return Errors.create('object.with', { peer: peer }, state, options);\n        }\n    }\n\n    return null;\n};\n\n\ninternals.without = function (value, peers, parent, state, options) {\n\n    if (value === undefined) {\n        return null;\n    }\n\n    for (var i = 0, il = peers.length; i < il; ++i) {\n        var peer = peers[i];\n        if (Object.prototype.hasOwnProperty.call(parent, peer) &&\n            parent[peer] !== undefined) {\n\n            return Errors.create('object.without', { peer: peer }, state, options);\n        }\n    }\n\n    return null;\n};\n\n\ninternals.xor = function (value, peers, parent, state, options) {\n\n    var present = [];\n    for (var i = 0, il = peers.length; i < il; ++i) {\n        var peer = peers[i];\n        if (Object.prototype.hasOwnProperty.call(parent, peer) &&\n            parent[peer] !== undefined) {\n\n            present.push(peer);\n        }\n    }\n\n    if (present.length === 1) {\n        return null;\n    }\n\n    if (present.length === 0) {\n        return Errors.create('object.missing', { peers: peers }, state, options);\n    }\n\n    return Errors.create('object.xor', { peers: peers }, state, options);\n};\n\n\ninternals.or = function (value, peers, parent, state, options) {\n\n    for (var i = 0, il = peers.length; i < il; ++i) {\n        var peer = peers[i];\n        if (Object.prototype.hasOwnProperty.call(parent, peer) &&\n            parent[peer] !== undefined) {\n            return null;\n        }\n    }\n\n    return Errors.create('object.missing', { peers: peers }, state, options);\n};\n\n\ninternals.and = function (value, peers, parent, state, options) {\n\n    var missing = [];\n    var present = [];\n    var count = peers.length;\n    for (var i = 0; i < count; ++i) {\n        var peer = peers[i];\n        if (!Object.prototype.hasOwnProperty.call(parent, peer) ||\n            parent[peer] === undefined) {\n\n            missing.push(peer);\n        }\n        else {\n            present.push(peer);\n        }\n    }\n\n    var aon = (missing.length === count || present.length === count);\n    return !aon ? Errors.create('object.and', { present: present, missing: missing }, state, options) : null;\n};\n\n\ninternals.nand = function (value, peers, parent, state, options) {\n\n    var present = [];\n    for (var i = 0, il = peers.length; i < il; ++i) {\n        var peer = peers[i];\n        if (Object.prototype.hasOwnProperty.call(parent, peer) &&\n            parent[peer] !== undefined) {\n\n            present.push(peer);\n        }\n    }\n\n    var values = Hoek.clone(peers);\n    var main = values.splice(0, 1)[0];\n    var allPresent = (present.length === peers.length);\n    return allPresent ? Errors.create('object.nand', { main: main, peers: values }, state, options) : null;\n};\n\n\ninternals.Object.prototype.describe = function (shallow) {\n\n    var description = Any.prototype.describe.call(this);\n\n    if (this._inner.children &&\n        !shallow) {\n\n        description.children = {};\n        for (var i = 0, il = this._inner.children.length; i < il; ++i) {\n            var child = this._inner.children[i];\n            description.children[child.key] = child.schema.describe();\n        }\n    }\n\n    if (this._inner.dependencies.length) {\n        description.dependencies = Hoek.clone(this._inner.dependencies);\n    }\n\n    if (this._inner.patterns.length) {\n        description.patterns = [];\n\n        for (var p = 0, pl = this._inner.patterns.length; p < pl; ++p) {\n            var pattern = this._inner.patterns[p];\n            description.patterns.push({ regex: pattern.regex.toString(), rule: pattern.rule.describe() });\n        }\n    }\n\n    return description;\n};\n\n\ninternals.Object.prototype.assert = function (ref, schema, message) {\n\n    ref = Cast.ref(ref);\n    Hoek.assert(ref.isContext || ref.depth > 1, 'Cannot use assertions for root level references - use direct key rules instead');\n    message = message || 'pass the assertion test';\n\n    var cast;\n    try {\n        cast = Cast.schema(schema);\n    }\n    catch (castErr) {\n        if (castErr.hasOwnProperty('path')) {\n            castErr.message += '(' + castErr.path + ')';\n        }\n\n        throw castErr;\n    }\n\n    var key = ref.path[ref.path.length - 1];\n    var path = ref.path.join('.');\n\n    return this._test('assert', { cast: cast, ref: ref }, function (value, state, options) {\n\n        var result = cast._validate(ref(value), null, options, value);\n        if (!result.errors) {\n            return null;\n        }\n\n        var localState = Hoek.merge({}, state);\n        localState.key = key;\n        localState.path = path;\n        return Errors.create('object.assert', { ref: localState.path, message: message }, localState, options);\n    });\n};\n\n\ninternals.Object.prototype.type = function (constructor, name) {\n\n    Hoek.assert(typeof constructor === 'function', 'type must be a constructor function');\n    name = name || constructor.name;\n\n    return this._test('type', name, function (value, state, options) {\n\n        if (value instanceof constructor) {\n            return null;\n        }\n\n        return Errors.create('object.type', { type: name }, state, options);\n    });\n};\n\n\nmodule.exports = new internals.Object();\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/topo/lib/index.js":"// Load modules\n\nvar Hoek = require('hoek');\n\n\n// Declare internals\n\nvar internals = {};\n\n\nexports = module.exports = internals.Topo = function () {\n\n    this._items = [];\n    this.nodes = [];\n};\n\n\ninternals.Topo.prototype.add = function (nodes, options) {\n\n    var self = this;\n\n    options = options || {};\n\n    // Validate rules\n\n    var before = [].concat(options.before || []);\n    var after = [].concat(options.after || []);\n    var group = options.group || '?';\n    var sort = options.sort || 0;                   // Used for merging only\n\n    Hoek.assert(before.indexOf(group) === -1, 'Item cannot come before itself:', group);\n    Hoek.assert(before.indexOf('?') === -1, 'Item cannot come before unassociated items');\n    Hoek.assert(after.indexOf(group) === -1, 'Item cannot come after itself:', group);\n    Hoek.assert(after.indexOf('?') === -1, 'Item cannot come after unassociated items');\n\n    ([].concat(nodes)).forEach(function (node, i) {\n\n        var item = {\n            seq: self._items.length,\n            sort: sort,\n            before: before,\n            after: after,\n            group: group,\n            node: node\n        };\n\n        self._items.push(item);\n    });\n\n    // Insert event\n\n    var error = this._sort();\n    Hoek.assert(!error, 'item', (group !== '?' ? 'added into group ' + group : ''), 'created a dependencies error');\n\n    return this.nodes;\n};\n\n\ninternals.Topo.prototype.merge = function (others) {\n\n    others = [].concat(others);\n    for (var o = 0, ol = others.length; o < ol; ++o) {\n        var other = others[o];\n        if (other) {\n            for (var i = 0, il = other._items.length; i < il; ++i) {\n                var item = Hoek.shallow(other._items[i]);\n                this._items.push(item);\n            }\n        }\n    }\n\n    // Sort items\n\n    this._items.sort(internals.mergeSort);\n    for (i = 0, il = this._items.length; i < il; ++i) {\n        this._items[i].seq = i;\n    }\n\n    var error = this._sort();\n    Hoek.assert(!error, 'merge created a dependencies error');\n\n    return this.nodes;\n};\n\n\ninternals.mergeSort = function (a, b) {\n\n    return a.sort === b.sort ? 0 : (a.sort < b.sort ? -1 : 1);\n};\n\n\ninternals.Topo.prototype._sort = function () {\n\n    // Construct graph\n\n    var groups = {};\n    var graph = {};\n    var graphAfters = {};\n\n    for (var i = 0, il = this._items.length; i < il; ++i) {\n        var item = this._items[i];\n        var seq = item.seq;                         // Unique across all items\n        var group = item.group;\n\n        // Determine Groups\n\n        groups[group] = groups[group] || [];\n        groups[group].push(seq);\n\n        // Build intermediary graph using 'before'\n\n        graph[seq] = item.before;\n\n        // Build second intermediary graph with 'after'\n\n        var after = item.after;\n        for (var j = 0, jl = after.length; j < jl; ++j) {\n            graphAfters[after[j]] = (graphAfters[after[j]] || []).concat(seq);\n        }\n    }\n\n    // Expand intermediary graph\n\n    var graphNodes = Object.keys(graph);\n    for (i = 0, il = graphNodes.length; i < il; ++i) {\n        var node = graphNodes[i];\n        var expandedGroups = [];\n\n        var graphNodeItems = Object.keys(graph[node]);\n        for (j = 0, jl = graphNodeItems.length; j < jl; ++j) {\n            group = graph[node][graphNodeItems[j]];\n            groups[group] = groups[group] || [];\n\n            for (var k = 0, kl = groups[group].length; k < kl; ++k) {\n\n                expandedGroups.push(groups[group][k]);\n            }\n        }\n        graph[node] = expandedGroups;\n    }\n\n    // Merge intermediary graph using graphAfters into final graph\n\n    var afterNodes = Object.keys(graphAfters);\n    for (i = 0, il = afterNodes.length; i < il; ++i) {\n        group = afterNodes[i];\n\n        if (groups[group]) {\n            for (j = 0, jl = groups[group].length; j < jl; ++j) {\n                node = groups[group][j];\n                graph[node] = graph[node].concat(graphAfters[group]);\n            }\n        }\n    }\n\n    // Compile ancestors\n\n    var children;\n    var ancestors = {};\n    graphNodes = Object.keys(graph);\n    for (i = 0, il = graphNodes.length; i < il; ++i) {\n        node = graphNodes[i];\n        children = graph[node];\n\n        for (j = 0, jl = children.length; j < jl; ++j) {\n            ancestors[children[j]] = (ancestors[children[j]] || []).concat(node);\n        }\n    }\n\n    // Topo sort\n\n    var visited = {};\n    var sorted = [];\n\n    for (i = 0, il = this._items.length; i < il; ++i) {\n        var next = i;\n\n        if (ancestors[i]) {\n            next = null;\n            for (j = 0, jl = this._items.length; j < jl; ++j) {\n                if (visited[j] === true) {\n                    continue;\n                }\n\n                if (!ancestors[j]) {\n                    ancestors[j] = [];\n                }\n\n                var shouldSeeCount = ancestors[j].length;\n                var seenCount = 0;\n                for (var l = 0, ll = shouldSeeCount; l < ll; ++l) {\n                    if (sorted.indexOf(ancestors[j][l]) >= 0) {\n                        ++seenCount;\n                    }\n                }\n\n                if (seenCount === shouldSeeCount) {\n                    next = j;\n                    break;\n                }\n            }\n        }\n\n        if (next !== null) {\n            next = next.toString();         // Normalize to string TODO: replace with seq\n            visited[next] = true;\n            sorted.push(next);\n        }\n    }\n\n    if (sorted.length !== this._items.length) {\n        return new Error('Invalid dependencies');\n    }\n\n    var seqIndex = {};\n    for (i = 0, il = this._items.length; i < il; ++i) {\n\n        item = this._items[i];\n        seqIndex[item.seq] = item;\n    }\n\n    var sortedNodes = [];\n    this._items = sorted.map(function (value) {\n\n        var sortedItem = seqIndex[value];\n        sortedNodes.push(sortedItem.node);\n        return sortedItem;\n    });\n\n    this.nodes = sortedNodes;\n};\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/jsonwebtoken/lib/timespan.js":"var ms = require('ms');\n\nmodule.exports = function (time, iat) {\n  var timestamp = iat || Math.floor(Date.now() / 1000);\n\n  if (typeof time === 'string') {\n    var milliseconds = ms(time);\n    if (typeof milliseconds === 'undefined') {\n      return;\n    }\n    return Math.floor(timestamp + milliseconds / 1000);\n  } else if (typeof time === 'number') {\n    return timestamp + time;\n  } else {\n    return;\n  }\n\n};","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/lodash.once/index.js":"/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Creates a function that invokes `func`, with the `this` binding and arguments\n * of the created function, while it's called less than `n` times. Subsequent\n * calls to the created function return the result of the last `func` invocation.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {number} n The number of calls at which `func` is no longer invoked.\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * jQuery(element).on('click', _.before(5, addContactToList));\n * // => Allows adding up to 4 contacts to the list.\n */\nfunction before(n, func) {\n  var result;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  n = toInteger(n);\n  return function() {\n    if (--n > 0) {\n      result = func.apply(this, arguments);\n    }\n    if (n <= 1) {\n      func = undefined;\n    }\n    return result;\n  };\n}\n\n/**\n * Creates a function that is restricted to invoking `func` once. Repeat calls\n * to the function return the value of the first invocation. The `func` is\n * invoked with the `this` binding and arguments of the created function.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * var initialize = _.once(createApplication);\n * initialize();\n * initialize();\n * // => `createApplication` is invoked once\n */\nfunction once(func) {\n  return before(2, func);\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = once;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/server-auth-node/credential.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/ */\n\n'use strict';\n\nvar https = require('https');\nvar jwt = require('jsonwebtoken');\nvar firebase = require('../app-node');\n\nvar GOOGLE_TOKEN_AUDIENCE = 'https://accounts.google.com/o/oauth2/token';\nvar GOOGLE_AUTH_TOKEN_HOST = 'accounts.google.com';\nvar GOOGLE_AUTH_TOKEN_PATH = '/o/oauth2/token';\nvar GOOGLE_AUTH_TOKEN_PORT = 443;\n\nvar ONE_HOUR_IN_SECONDS = 60 * 60;\nvar JWT_ALGORITHM = 'RS256';\n\nvar Credential = function() {};\n\nvar AccessToken = function() {};\n\nvar ServiceAccount = function() {};\n\nCredential.prototype.getAccessToken = function() {};\n\nvar CertCredential = function(serviceAccount) {\n  this.serviceAccount_ = serviceAccount;\n};\n\nCertCredential.prototype.getAccessToken = function() {\n  var token = this.authJwt();\n  return new firebase.Promise(function(resolve, reject) {\n    var postData = 'grant_type=urn%3Aietf%3Aparams%3Aoauth%3A' +\n        'grant-type%3Ajwt-bearer&assertion=' +\n        token;\n    var options = {\n      method: 'POST',\n      host: GOOGLE_AUTH_TOKEN_HOST,\n      port: GOOGLE_AUTH_TOKEN_PORT,\n      path: GOOGLE_AUTH_TOKEN_PATH,\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n        'Content-Length': postData.length\n      }\n    };\n    var req = https.request(options, function(res) {\n      var buffers = [];\n      res.on('data', function(buffer) {\n        buffers.push(buffer);\n      });\n      res.on('end', function() {\n        try {\n          var json = JSON.parse(Buffer.concat(buffers));\n          if (json.error) {\n            var msg = 'Error refreshing access token: ' + json.error;\n            if (json.error_description) {\n              msg += ' (' + json.error_description + ')';\n            }\n            reject(new Error(msg));\n          } else if (!json.access_token || !json.expires_in) {\n            reject(new Error('Unexpected response from OAuth server'));\n          } else {\n            resolve(json);\n          }\n        } catch (err) {\n          reject(err);\n        }\n      });\n    });\n    req.on('error', reject);\n    req.write(postData);\n    req.end();\n  });\n};\n\nCertCredential.prototype.authJwt = function() {\n  var claims = {\n    scope: [\n      'https://www.googleapis.com/auth/userinfo.email',\n      'https://www.googleapis.com/auth/firebase.database',\n    ].join(' ')\n  };\n  return jwt.sign(claims, this.serviceAccount_.private_key, {\n    audience: GOOGLE_TOKEN_AUDIENCE,\n    expiresIn: ONE_HOUR_IN_SECONDS,\n    issuer: this.serviceAccount_.client_email,\n    algorithm: JWT_ALGORITHM\n  });\n};\n\nvar UnauthenticatedCredential = function() {};\n\nUnauthenticatedCredential.prototype.getAccessToken = function() {\n  return firebase.Promise.resolve(null);\n};\n\nmodule.exports.Credential = Credential;\nmodule.exports.CertCredential = CertCredential;\nmodule.exports.UnauthenticatedCredential = UnauthenticatedCredential;\n\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/database-node.js":"/*! @license Firebase v3.7.8\nBuild: rev-44ec95c\nTerms: https://firebase.google.com/terms/\n\n---\n\ntypedarray.js\nCopyright (c) 2010, Linden Research, Inc.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\n(function() {\n  var firebase = require('./app-node');\n  var h,aa=this;function n(a){return void 0!==a}function ba(){}function ca(a){a.Tb=function(){return a.Ve?a.Ve:a.Ve=new a}}\nfunction da(a){var b=typeof a;if(\"object\"==b)if(a){if(a instanceof Array)return\"array\";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(\"[object Window]\"==c)return\"object\";if(\"[object Array]\"==c||\"number\"==typeof a.length&&\"undefined\"!=typeof a.splice&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"splice\"))return\"array\";if(\"[object Function]\"==c||\"undefined\"!=typeof a.call&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"call\"))return\"function\"}else return\"null\";\nelse if(\"function\"==b&&\"undefined\"==typeof a.call)return\"object\";return b}function ea(a){return\"array\"==da(a)}function fa(a){var b=da(a);return\"array\"==b||\"object\"==b&&\"number\"==typeof a.length}function p(a){return\"string\"==typeof a}function ga(a){return\"number\"==typeof a}function ha(a){return\"function\"==da(a)}function ia(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b}function ja(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ka(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function q(a,b,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?ja:ka;return q.apply(null,arguments)}\nfunction la(a,b){function c(){}c.prototype=b.prototype;a.Bg=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.vg=function(a,c,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[c].apply(a,g)}};function ma(a){a=String(a);if(/^\\s*$/.test(a)?0:/^[\\],:{}\\s\\u2028\\u2029]*$/.test(a.replace(/\\\\[\"\\\\\\/bfnrtu]/g,\"@\").replace(/\"[^\"\\\\\\n\\r\\u2028\\u2029\\x00-\\x08\\x0a-\\x1f]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\"]\").replace(/(?:^|:|,)(?:[\\s\\u2028\\u2029]*\\[)+/g,\"\")))try{return eval(\"(\"+a+\")\")}catch(b){}throw Error(\"Invalid JSON string: \"+a);}function na(){this.Dd=void 0}\nfunction oa(a,b,c){switch(typeof b){case \"string\":pa(b,c);break;case \"number\":c.push(isFinite(b)&&!isNaN(b)?b:\"null\");break;case \"boolean\":c.push(b);break;case \"undefined\":c.push(\"null\");break;case \"object\":if(null==b){c.push(\"null\");break}if(ea(b)){var d=b.length;c.push(\"[\");for(var e=\"\",f=0;f<d;f++)c.push(e),e=b[f],oa(a,a.Dd?a.Dd.call(b,String(f),e):e,c),e=\",\";c.push(\"]\");break}c.push(\"{\");d=\"\";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],\"function\"!=typeof e&&(c.push(d),pa(f,c),\nc.push(\":\"),oa(a,a.Dd?a.Dd.call(b,f,e):e,c),d=\",\"));c.push(\"}\");break;case \"function\":break;default:throw Error(\"Unknown type: \"+typeof b);}}var qa={'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\",\"/\":\"\\\\/\",\"\\b\":\"\\\\b\",\"\\f\":\"\\\\f\",\"\\n\":\"\\\\n\",\"\\r\":\"\\\\r\",\"\\t\":\"\\\\t\",\"\\x0B\":\"\\\\u000b\"},ra=/\\uffff/.test(\"\\uffff\")?/[\\\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g:/[\\\\\\\"\\x00-\\x1f\\x7f-\\xff]/g;\nfunction pa(a,b){b.push('\"',a.replace(ra,function(a){if(a in qa)return qa[a];var b=a.charCodeAt(0),e=\"\\\\u\";16>b?e+=\"000\":256>b?e+=\"00\":4096>b&&(e+=\"0\");return qa[a]=e+b.toString(16)}),'\"')};function sa(){this.Va=-1};function ta(){this.Va=-1;this.Va=64;this.M=[];this.Sd=[];this.zf=[];this.xd=[];this.xd[0]=128;for(var a=1;a<this.Va;++a)this.xd[a]=0;this.Md=this.Yb=0;this.reset()}la(ta,sa);ta.prototype.reset=function(){this.M[0]=1732584193;this.M[1]=4023233417;this.M[2]=2562383102;this.M[3]=271733878;this.M[4]=3285377520;this.Md=this.Yb=0};\nfunction ua(a,b,c){c||(c=0);var d=a.zf;if(p(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.M[0];c=a.M[1];for(var g=a.M[2],k=a.M[3],m=a.M[4],l,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),l=1518500249):(f=c^g^k,l=1859775393):60>e?(f=c&g|k&(c|g),l=2400959708):(f=c^g^k,l=3395469782),f=(b<<\n5|b>>>27)+f+m+l+d[e]&4294967295,m=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.M[0]=a.M[0]+b&4294967295;a.M[1]=a.M[1]+c&4294967295;a.M[2]=a.M[2]+g&4294967295;a.M[3]=a.M[3]+k&4294967295;a.M[4]=a.M[4]+m&4294967295}\nta.prototype.update=function(a,b){if(null!=a){n(b)||(b=a.length);for(var c=b-this.Va,d=0,e=this.Sd,f=this.Yb;d<b;){if(0==f)for(;d<=c;)ua(this,a,d),d+=this.Va;if(p(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.Va){ua(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.Va){ua(this,e);f=0;break}}this.Yb=f;this.Md+=b}};var t;a:{var va=aa.navigator;if(va){var wa=va.userAgent;if(wa){t=wa;break a}}t=\"\"};var u=Array.prototype,xa=u.indexOf?function(a,b,c){return u.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ya=u.forEach?function(a,b,c){u.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},za=u.filter?function(a,b,c){return u.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=p(a)?\na.split(\"\"):a,k=0;k<d;k++)if(k in g){var m=g[k];b.call(c,m,k,a)&&(e[f++]=m)}return e},Aa=u.map?function(a,b,c){return u.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=p(a)?a.split(\"\"):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ba=u.reduce?function(a,b,c,d){for(var e=[],f=1,g=arguments.length;f<g;f++)e.push(arguments[f]);d&&(e[0]=q(b,d));return u.reduce.apply(a,e)}:function(a,b,c,d){var e=c;ya(a,function(c,g){e=b.call(d,e,c,g,a)});return e},Ca=u.every?function(a,b,\nc){return u.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(\"\"):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Da(a,b){var c=Ea(a,b,void 0);return 0>c?null:p(a)?a.charAt(c):a[c]}function Ea(a,b,c){for(var d=a.length,e=p(a)?a.split(\"\"):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Fa(a,b){var c=xa(a,b);0<=c&&u.splice.call(a,c,1)}function Ga(a,b){a.sort(b||Ha)}function Ha(a,b){return a>b?1:a<b?-1:0};function v(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Ia(a,b){var c={},d;for(d in a)c[d]=b.call(void 0,a[d],d,a);return c}function Ja(a,b){for(var c in a)if(!b.call(void 0,a[c],c,a))return!1;return!0}function Ka(a){var b=0,c;for(c in a)b++;return b}function La(a){for(var b in a)return b}function Ma(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Na(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Oa(a,b){for(var c in a)if(a[c]==b)return!0;return!1}\nfunction Pa(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d}function Qa(a,b){var c=Pa(a,b,void 0);return c&&a[c]}function Ra(a){for(var b in a)return!1;return!0}function Sa(a){var b={},c;for(c in a)b[c]=a[c];return b};var Ta=-1!=t.indexOf(\"Opera\")||-1!=t.indexOf(\"OPR\"),Ua=-1!=t.indexOf(\"Trident\")||-1!=t.indexOf(\"MSIE\"),Va=-1!=t.indexOf(\"Gecko\")&&-1==t.toLowerCase().indexOf(\"webkit\")&&!(-1!=t.indexOf(\"Trident\")||-1!=t.indexOf(\"MSIE\")),Wa=-1!=t.toLowerCase().indexOf(\"webkit\");\n(function(){var a=\"\",b;if(Ta&&aa.opera)return a=aa.opera.version,ha(a)?a():a;Va?b=/rv\\:([^\\);]+)(\\)|;)/:Ua?b=/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/:Wa&&(b=/WebKit\\/(\\S+)/);b&&(a=(a=b.exec(t))?a[1]:\"\");return Ua&&(b=(b=aa.document)?b.documentMode:void 0,b>parseFloat(a))?String(b):a})();var Xa=null,Ya=null;\nfunction Za(a,b){if(!fa(a))throw Error(\"encodeByteArray takes an array as a parameter\");if(!Xa){Xa={};Ya={};for(var c=0;65>c;c++)Xa[c]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".charAt(c),Ya[c]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.\".charAt(c)}for(var c=b?Ya:Xa,d=[],e=0;e<a.length;e+=3){var f=a[e],g=e+1<a.length,k=g?a[e+1]:0,m=e+2<a.length,l=m?a[e+2]:0,r=f>>2,f=(f&3)<<4|k>>4,k=(k&15)<<2|l>>6,l=l&63;m||(l=64,g||(k=64));d.push(c[r],c[f],c[k],c[l])}return d.join(\"\")}\n;function $a(a,b){if(!a)throw ab(b);}function ab(a){return Error(\"Firebase Database (\"+firebase.SDK_VERSION+\") INTERNAL ASSERT FAILED: \"+a)};function bb(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function w(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}function cb(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])};function db(a){var b=[];cb(a,function(a,d){ea(d)?ya(d,function(d){b.push(encodeURIComponent(a)+\"=\"+encodeURIComponent(d))}):b.push(encodeURIComponent(a)+\"=\"+encodeURIComponent(d))});return b.length?\"&\"+b.join(\"&\"):\"\"};var eb=firebase.Promise;function fb(){var a=this;this.reject=this.resolve=null;this.ra=new eb(function(b,c){a.resolve=b;a.reject=c})}function gb(a,b){return function(c,d){c?a.reject(c):a.resolve(d);ha(b)&&(hb(a.ra),1===b.length?b(c):b(c,d))}}function hb(a){a.then(void 0,ba)};function ib(a){return\"undefined\"!==typeof JSON&&n(JSON.parse)?JSON.parse(a):ma(a)}function x(a){if(\"undefined\"!==typeof JSON&&n(JSON.stringify))a=JSON.stringify(a);else{var b=[];oa(new na,a,b);a=b.join(\"\")}return a};function jb(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,$a(d<a.length,\"Surrogate pair missing trail surrogate.\"),e=65536+(e<<10)+(a.charCodeAt(d)-56320));128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function kb(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b++:2048>d?b+=2:55296<=d&&56319>=d?(b+=4,c++):b+=3}return b};function z(a,b,c,d){var e;d<b?e=\"at least \"+b:d>c&&(e=0===c?\"none\":\"no more than \"+c);if(e)throw Error(a+\" failed: Was called with \"+d+(1===d?\" argument.\":\" arguments.\")+\" Expects \"+e+\".\");}function A(a,b,c){var d=\"\";switch(b){case 1:d=c?\"first\":\"First\";break;case 2:d=c?\"second\":\"Second\";break;case 3:d=c?\"third\":\"Third\";break;case 4:d=c?\"fourth\":\"Fourth\";break;default:throw Error(\"errorPrefix called with argumentNumber > 4.  Need to update it?\");}return a=a+\" failed: \"+(d+\" argument \")}\nfunction B(a,b,c,d){if((!d||n(c))&&!ha(c))throw Error(A(a,b,d)+\"must be a valid function.\");}function lb(a,b,c){if(n(c)&&(!ia(c)||null===c))throw Error(A(a,b,!0)+\"must be a valid context object.\");};function mb(){return\"undefined\"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(\"undefined\"!==typeof navigator&&\"string\"===typeof navigator.userAgent?navigator.userAgent:\"\")};function C(a,b){this.name=a;this.R=b}function nb(a,b){return new C(a,b)};function ob(a,b){return pb(a.name,b.name)}function qb(a,b){return pb(a,b)};function rb(a){this.rc=a;this.Ad=\"firebase:\"}h=rb.prototype;h.set=function(a,b){null==b?this.rc.removeItem(this.Ad+a):this.rc.setItem(this.Ad+a,x(b))};h.get=function(a){a=this.rc.getItem(this.Ad+a);return null==a?null:ib(a)};h.remove=function(a){this.rc.removeItem(this.Ad+a)};h.We=!1;h.toString=function(){return this.rc.toString()};function sb(){this.mc={}}sb.prototype.set=function(a,b){null==b?delete this.mc[a]:this.mc[a]=b};sb.prototype.get=function(a){return bb(this.mc,a)?this.mc[a]:null};sb.prototype.remove=function(a){delete this.mc[a]};sb.prototype.We=!0;function tb(a){try{if(\"undefined\"!==typeof window&&\"undefined\"!==typeof window[a]){var b=window[a];b.setItem(\"firebase:sentinel\",\"cache\");b.removeItem(\"firebase:sentinel\");return new rb(b)}}catch(c){}return new sb}var ub=tb(\"localStorage\"),vb=tb(\"sessionStorage\");function wb(a,b,c,d,e){this.host=a.toLowerCase();this.domain=this.host.substr(this.host.indexOf(\".\")+1);this.Pc=b;this.ne=c;this.tg=d;this.ef=e||\"\";this.Za=ub.get(\"host:\"+a)||this.host}function xb(a,b){b!==a.Za&&(a.Za=b,\"s-\"===a.Za.substr(0,2)&&ub.set(\"host:\"+a.host,a.Za))}\nfunction yb(a,b,c){D(\"string\"===typeof b,\"typeof type must == string\");D(\"object\"===typeof c,\"typeof params must == object\");if(b===zb)b=(a.Pc?\"wss://\":\"ws://\")+a.Za+\"/.ws?\";else if(b===Ab)b=(a.Pc?\"https://\":\"http://\")+a.Za+\"/.lp?\";else throw Error(\"Unknown connection type: \"+b);a.host!==a.Za&&(c.ns=a.ne);var d=[];v(c,function(a,b){d.push(b+\"=\"+a)});return b+d.join(\"&\")}wb.prototype.toString=function(){var a=(this.Pc?\"https://\":\"http://\")+this.host;this.ef&&(a+=\"<\"+this.ef+\">\");return a};function Bb(a,b){return a&&\"object\"===typeof a?(D(\".sv\"in a,\"Unexpected leaf node or priority contents\"),b[a[\".sv\"]]):a}function Cb(a,b){var c=new Db;Eb(a,new E(\"\"),function(a,e){Fb(c,a,Gb(e,b))});return c}function Gb(a,b){var c=a.C().H(),c=Bb(c,b),d;if(a.J()){var e=Bb(a.Ca(),b);return e!==a.Ca()||c!==a.C().H()?new Hb(e,G(c)):a}d=a;c!==a.C().H()&&(d=d.fa(new Hb(c)));a.O(H,function(a,c){var e=Gb(c,b);e!==c&&(d=d.T(a,e))});return d};var Ib=function(){var a=1;return function(){return a++}}(),D=$a,Jb=ab;function Kb(a){try{return(new Buffer(a,\"base64\")).toString(\"utf8\")}catch(b){I(\"base64Decode failed: \",b)}return null}function Lb(a){var b=jb(a);a=new ta;a.update(b);var b=[],c=8*a.Md;56>a.Yb?a.update(a.xd,56-a.Yb):a.update(a.xd,a.Va-(a.Yb-56));for(var d=a.Va-1;56<=d;d--)a.Sd[d]=c&255,c/=256;ua(a,a.Sd);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.M[d]>>e&255,++c;return Za(b)}\nfunction Mb(a){for(var b=\"\",c=0;c<arguments.length;c++)b=fa(arguments[c])?b+Mb.apply(null,arguments[c]):\"object\"===typeof arguments[c]?b+x(arguments[c]):b+arguments[c],b+=\" \";return b}var Nb=null,Ob=!0;\nfunction Pb(a,b){$a(!b||!0===a||!1===a,\"Can't turn on custom loggers persistently.\");!0===a?(\"undefined\"!==typeof console&&(\"function\"===typeof console.log?Nb=q(console.log,console):\"object\"===typeof console.log&&(Nb=function(a){console.log(a)})),b&&vb.set(\"logging_enabled\",!0)):ha(a)?Nb=a:(Nb=null,vb.remove(\"logging_enabled\"))}function I(a){!0===Ob&&(Ob=!1,null===Nb&&!0===vb.get(\"logging_enabled\")&&Pb(!0));if(Nb){var b=Mb.apply(null,arguments);Nb(b)}}\nfunction Qb(a){return function(){I(a,arguments)}}function Rb(a){if(\"undefined\"!==typeof console){var b=\"FIREBASE INTERNAL ERROR: \"+Mb.apply(null,arguments);\"undefined\"!==typeof console.error?console.error(b):console.log(b)}}function Sb(a){var b=Mb.apply(null,arguments);throw Error(\"FIREBASE FATAL ERROR: \"+b);}function J(a){if(\"undefined\"!==typeof console){var b=\"FIREBASE WARNING: \"+Mb.apply(null,arguments);\"undefined\"!==typeof console.warn?console.warn(b):console.log(b)}}\nfunction Tb(a){var b,c,d,e,f,g=a;f=c=a=b=\"\";d=!0;e=\"https\";if(p(g)){var k=g.indexOf(\"//\");0<=k&&(e=g.substring(0,k-1),g=g.substring(k+2));k=g.indexOf(\"/\");-1===k&&(k=g.length);b=g.substring(0,k);f=\"\";g=g.substring(k).split(\"/\");for(k=0;k<g.length;k++)if(0<g[k].length){var m=g[k];try{m=decodeURIComponent(m.replace(/\\+/g,\" \"))}catch(l){}f+=\"/\"+m}g=b.split(\".\");3===g.length?(a=g[1],c=g[0].toLowerCase()):2===g.length&&(a=g[0]);k=b.indexOf(\":\");0<=k&&(d=\"https\"===e||\"wss\"===e)}\"firebase\"===a&&Sb(b+\" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead\");\nc&&\"undefined\"!=c||Sb(\"Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com\");d||\"undefined\"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf(\"https:\")&&J(\"Insecure Firebase access from a secure page. Please use https in calls to new Firebase().\");return{gc:new wb(b,d,c,\"ws\"===e||\"wss\"===e),path:new E(f)}}function Ub(a){return ga(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function Vb(a){a()}\nfunction pb(a,b){if(a===b)return 0;if(\"[MIN_NAME]\"===a||\"[MAX_NAME]\"===b)return-1;if(\"[MIN_NAME]\"===b||\"[MAX_NAME]\"===a)return 1;var c=Wb(a),d=Wb(b);return null!==c?null!==d?0==c-d?a.length-b.length:c-d:-1:null!==d?1:a<b?-1:1}function Xb(a,b){if(b&&a in b)return b[a];throw Error(\"Missing required key (\"+a+\") in object: \"+x(b));}\nfunction Yb(a){if(\"object\"!==typeof a||null===a)return x(a);var b=[],c;for(c in a)b.push(c);b.sort();c=\"{\";for(var d=0;d<b.length;d++)0!==d&&(c+=\",\"),c+=x(b[d]),c+=\":\",c+=Yb(a[b[d]]);return c+\"}\"}function Zb(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function $b(a,b){if(ea(a))for(var c=0;c<a.length;++c)b(c,a[c]);else v(a,b)}\nfunction ac(a){D(!Ub(a),\"Invalid JSON number\");var b,c,d,e;0===a?(d=c=0,b=-Infinity===1/a?1:0):(b=0>a,a=Math.abs(a),a>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,52))):(c=0,d=Math.round(a/Math.pow(2,-1074))));e=[];for(a=52;a;--a)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;--a)e.push(c%2?1:0),c=Math.floor(c/2);e.push(b?1:0);e.reverse();b=e.join(\"\");c=\"\";for(a=0;64>a;a+=8)d=parseInt(b.substr(a,8),2).toString(16),1===d.length&&\n(d=\"0\"+d),c+=d;return c.toLowerCase()}var bc=/^-?\\d{1,10}$/;function Wb(a){return bc.test(a)&&(a=Number(a),-2147483648<=a&&2147483647>=a)?a:null}function cc(a){try{a()}catch(b){setTimeout(function(){J(\"Exception was thrown by user callback.\",b.stack||\"\");throw b;},Math.floor(0))}}function dc(a,b,c){Object.defineProperty(a,b,{get:c})}function ec(a,b){var c=setTimeout(a,b);\"object\"===typeof c&&c.unref&&c.unref();return c};function fc(a){var b={},c={},d={},e=\"\";try{var f=a.split(\".\"),b=ib(Kb(f[0])||\"\"),c=ib(Kb(f[1])||\"\"),e=f[2],d=c.d||{};delete c.d}catch(g){}return{yg:b,He:c,data:d,og:e}}function gc(a){a=fc(a);var b=a.He;return!!a.og&&!!b&&\"object\"===typeof b&&b.hasOwnProperty(\"iat\")}function hc(a){a=fc(a).He;return\"object\"===typeof a&&!0===w(a,\"admin\")};function ic(){}var jc={};function kc(a){return q(a.compare,a)}ic.prototype.kd=function(a,b){return 0!==this.compare(new C(\"[MIN_NAME]\",a),new C(\"[MIN_NAME]\",b))};ic.prototype.Ec=function(){return lc};function mc(a){D(!a.e()&&\".priority\"!==K(a),\"Can't create PathIndex with empty path or .priority key\");this.$b=a}la(mc,ic);h=mc.prototype;h.uc=function(a){return!a.P(this.$b).e()};h.compare=function(a,b){var c=a.R.P(this.$b),d=b.R.P(this.$b),c=c.pc(d);return 0===c?pb(a.name,b.name):c};\nh.Bc=function(a,b){var c=G(a),c=L.F(this.$b,c);return new C(b,c)};h.Cc=function(){var a=L.F(this.$b,nc);return new C(\"[MAX_NAME]\",a)};h.toString=function(){return this.$b.slice().join(\"/\")};function oc(){}la(oc,ic);h=oc.prototype;h.compare=function(a,b){var c=a.R.C(),d=b.R.C(),c=c.pc(d);return 0===c?pb(a.name,b.name):c};h.uc=function(a){return!a.C().e()};h.kd=function(a,b){return!a.C().Z(b.C())};h.Ec=function(){return lc};h.Cc=function(){return new C(\"[MAX_NAME]\",new Hb(\"[PRIORITY-POST]\",nc))};\nh.Bc=function(a,b){var c=G(a);return new C(b,new Hb(\"[PRIORITY-POST]\",c))};h.toString=function(){return\".priority\"};var H=new oc;function pc(){}la(pc,ic);h=pc.prototype;h.compare=function(a,b){return pb(a.name,b.name)};h.uc=function(){throw Jb(\"KeyIndex.isDefinedOn not expected to be called.\");};h.kd=function(){return!1};h.Ec=function(){return lc};h.Cc=function(){return new C(\"[MAX_NAME]\",L)};h.Bc=function(a){D(p(a),\"KeyIndex indexValue must always be a string.\");return new C(a,L)};h.toString=function(){return\".key\"};\nvar qc=new pc;function rc(){}la(rc,ic);h=rc.prototype;h.compare=function(a,b){var c=a.R.pc(b.R);return 0===c?pb(a.name,b.name):c};h.uc=function(){return!0};h.kd=function(a,b){return!a.Z(b)};h.Ec=function(){return lc};h.Cc=function(){return sc};h.Bc=function(a,b){var c=G(a);return new C(b,c)};h.toString=function(){return\".value\"};var tc=new rc;function uc(a,b){this.ld=a;this.ac=b}uc.prototype.get=function(a){var b=w(this.ld,a);if(!b)throw Error(\"No index defined for \"+a);return b===jc?null:b};function vc(a,b,c){var d=Ia(a.ld,function(d,f){var g=w(a.ac,f);D(g,\"Missing index implementation for \"+f);if(d===jc){if(g.uc(b.R)){for(var k=[],m=c.Ub(nb),l=M(m);l;)l.name!=b.name&&k.push(l),l=M(m);k.push(b);return wc(k,kc(g))}return jc}g=c.get(b.name);k=d;g&&(k=k.remove(new C(b.name,g)));return k.Na(b,b.R)});return new uc(d,a.ac)}\nfunction xc(a,b,c){var d=Ia(a.ld,function(a){if(a===jc)return a;var d=c.get(b.name);return d?a.remove(new C(b.name,d)):a});return new uc(d,a.ac)}var yc=new uc({\".priority\":jc},{\".priority\":H});function Hb(a,b){this.B=a;D(n(this.B)&&null!==this.B,\"LeafNode shouldn't be created with null/undefined value.\");this.aa=b||L;zc(this.aa);this.Bb=null}var Ac=[\"object\",\"boolean\",\"number\",\"string\"];h=Hb.prototype;h.J=function(){return!0};h.C=function(){return this.aa};h.fa=function(a){return new Hb(this.B,a)};h.Q=function(a){return\".priority\"===a?this.aa:L};h.P=function(a){return a.e()?this:\".priority\"===K(a)?this.aa:L};h.Da=function(){return!1};h.Se=function(){return null};\nh.T=function(a,b){return\".priority\"===a?this.fa(b):b.e()&&\".priority\"!==a?this:L.T(a,b).fa(this.aa)};h.F=function(a,b){var c=K(a);if(null===c)return b;if(b.e()&&\".priority\"!==c)return this;D(\".priority\"!==c||1===Bc(a),\".priority must be the last token in a path\");return this.T(c,L.F(N(a),b))};h.e=function(){return!1};h.Cb=function(){return 0};h.O=function(){return!1};h.H=function(a){return a&&!this.C().e()?{\".value\":this.Ca(),\".priority\":this.C().H()}:this.Ca()};\nh.hash=function(){if(null===this.Bb){var a=\"\";this.aa.e()||(a+=\"priority:\"+Cc(this.aa.H())+\":\");var b=typeof this.B,a=a+(b+\":\"),a=\"number\"===b?a+ac(this.B):a+this.B;this.Bb=Lb(a)}return this.Bb};h.Ca=function(){return this.B};h.pc=function(a){if(a===L)return 1;if(a instanceof O)return-1;D(a.J(),\"Unknown node type\");var b=typeof a.B,c=typeof this.B,d=xa(Ac,b),e=xa(Ac,c);D(0<=d,\"Unknown leaf type: \"+b);D(0<=e,\"Unknown leaf type: \"+c);return d===e?\"object\"===c?0:this.B<a.B?-1:this.B===a.B?0:1:e-d};\nh.lb=function(){return this};h.vc=function(){return!0};h.Z=function(a){return a===this?!0:a.J()?this.B===a.B&&this.aa.Z(a.aa):!1};h.toString=function(){return x(this.H(!0))};function Dc(){this.set={}}h=Dc.prototype;h.add=function(a,b){this.set[a]=null!==b?b:!0};h.contains=function(a){return bb(this.set,a)};h.get=function(a){return this.contains(a)?this.set[a]:void 0};h.remove=function(a){delete this.set[a]};h.clear=function(){this.set={}};h.e=function(){return Ra(this.set)};h.count=function(){return Ka(this.set)};function Ec(a,b){v(a.set,function(a,d){b(d,a)})}h.keys=function(){var a=[];v(this.set,function(b,c){a.push(c)});return a};function Fc(a){D(ea(a)&&0<a.length,\"Requires a non-empty array\");this.Af=a;this.Ac={}}Fc.prototype.Ee=function(a,b){var c;c=this.Ac[a]||[];var d=c.length;if(0<d){for(var e=Array(d),f=0;f<d;f++)e[f]=c[f];c=e}else c=[];for(d=0;d<c.length;d++)c[d].Ge.apply(c[d].La,Array.prototype.slice.call(arguments,1))};Fc.prototype.dc=function(a,b,c){Gc(this,a);this.Ac[a]=this.Ac[a]||[];this.Ac[a].push({Ge:b,La:c});(a=this.Re(a))&&b.apply(c,a)};\nFc.prototype.Fc=function(a,b,c){Gc(this,a);a=this.Ac[a]||[];for(var d=0;d<a.length;d++)if(a[d].Ge===b&&(!c||c===a[d].La)){a.splice(d,1);break}};function Gc(a,b){D(Da(a.Af,function(a){return a===b}),\"Unknown event: \"+b)};var Hc=function(){var a=0,b=[];return function(c){var d=c===a;a=c;for(var e=Array(8),f=7;0<=f;f--)e[f]=\"-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz\".charAt(c%64),c=Math.floor(c/64);D(0===c,\"Cannot push at time == 0\");c=e.join(\"\");if(d){for(f=11;0<=f&&63===b[f];f--)b[f]=0;b[f]++}else for(f=0;12>f;f++)b[f]=Math.floor(64*Math.random());for(f=0;12>f;f++)c+=\"-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz\".charAt(b[f]);D(20===c.length,\"nextPushId: Length should be 20.\");\nreturn c}}();function Ic(){Fc.call(this,[\"online\"]);this.ec=!0;if(\"undefined\"!==typeof window&&\"undefined\"!==typeof window.addEventListener&&!mb()){var a=this;window.addEventListener(\"online\",function(){a.ec||(a.ec=!0,a.Ee(\"online\",!0))},!1);window.addEventListener(\"offline\",function(){a.ec&&(a.ec=!1,a.Ee(\"online\",!1))},!1)}}la(Ic,Fc);Ic.prototype.Re=function(a){D(\"online\"===a,\"Unknown event type: \"+a);return[this.ec]};ca(Ic);function Jc(){Fc.call(this,[\"visible\"]);var a,b;\"undefined\"!==typeof document&&\"undefined\"!==typeof document.addEventListener&&(\"undefined\"!==typeof document.hidden?(b=\"visibilitychange\",a=\"hidden\"):\"undefined\"!==typeof document.mozHidden?(b=\"mozvisibilitychange\",a=\"mozHidden\"):\"undefined\"!==typeof document.msHidden?(b=\"msvisibilitychange\",a=\"msHidden\"):\"undefined\"!==typeof document.webkitHidden&&(b=\"webkitvisibilitychange\",a=\"webkitHidden\"));this.Kb=!0;if(b){var c=this;document.addEventListener(b,\nfunction(){var b=!document[a];b!==c.Kb&&(c.Kb=b,c.Ee(\"visible\",b))},!1)}}la(Jc,Fc);Jc.prototype.Re=function(a){D(\"visible\"===a,\"Unknown event type: \"+a);return[this.Kb]};ca(Jc);(function(){var a=process.version;if(\"v0.10.22\"===a||\"v0.10.23\"===a||\"v0.10.24\"===a){var b=function(a,b,c){this.chunk=a;this.encoding=b;this.callback=c},c=function(a,c,d,e,l){c.objectMode||!1===c.decodeStrings||\"string\"!==typeof d||(d=new Buffer(d,e));Buffer.isBuffer(d)&&(e=\"buffer\");var r=c.objectMode?1:d.length;c.length+=r;var y=c.length<c.highWaterMark;y||(c.needDrain=!0);c.writing?c.buffer.push(new b(d,e,l)):(c.writelen=r,c.writecb=l,c.writing=!0,c.sync=!0,a._write(d,e,c.onwrite),c.sync=!1);return y},\nd=function(a,b,c,d){var e=!0;if(!Buffer.isBuffer(c)&&\"string\"!==typeof c&&null!==c&&void 0!==c&&!b.objectMode){var r=new TypeError(\"Invalid non-string/buffer chunk\");a.emit(\"error\",r);process.nextTick(function(){d(r)});e=!1}return e},e=function(a,b){var c=Error(\"write after end\");a.emit(\"error\",c);process.nextTick(function(){b(c)})},a=require(\"_stream_writable\");a.prototype.write=function(a,b,k){var m=this._writableState,l=!1;\"function\"===typeof b&&(k=b,b=null);Buffer.isBuffer(a)?b=\"buffer\":b||(b=\nm.defaultEncoding);\"function\"!==typeof k&&(k=function(){});m.ended?e(this,k):d(this,m,a,k)&&(l=c(this,m,a,b,k));return l};require(\"_stream_duplex\").prototype.write=a.prototype.write}})();function E(a,b){if(1==arguments.length){this.o=a.split(\"/\");for(var c=0,d=0;d<this.o.length;d++)0<this.o[d].length&&(this.o[c]=this.o[d],c++);this.o.length=c;this.Y=0}else this.o=a,this.Y=b}function P(a,b){var c=K(a);if(null===c)return b;if(c===K(b))return P(N(a),N(b));throw Error(\"INTERNAL ERROR: innerPath (\"+b+\") is not within outerPath (\"+a+\")\");}\nfunction Kc(a,b){for(var c=a.slice(),d=b.slice(),e=0;e<c.length&&e<d.length;e++){var f=pb(c[e],d[e]);if(0!==f)return f}return c.length===d.length?0:c.length<d.length?-1:1}function K(a){return a.Y>=a.o.length?null:a.o[a.Y]}function Bc(a){return a.o.length-a.Y}function N(a){var b=a.Y;b<a.o.length&&b++;return new E(a.o,b)}function Lc(a){return a.Y<a.o.length?a.o[a.o.length-1]:null}h=E.prototype;\nh.toString=function(){for(var a=\"\",b=this.Y;b<this.o.length;b++)\"\"!==this.o[b]&&(a+=\"/\"+this.o[b]);return a||\"/\"};h.slice=function(a){return this.o.slice(this.Y+(a||0))};h.parent=function(){if(this.Y>=this.o.length)return null;for(var a=[],b=this.Y;b<this.o.length-1;b++)a.push(this.o[b]);return new E(a,0)};\nh.n=function(a){for(var b=[],c=this.Y;c<this.o.length;c++)b.push(this.o[c]);if(a instanceof E)for(c=a.Y;c<a.o.length;c++)b.push(a.o[c]);else for(a=a.split(\"/\"),c=0;c<a.length;c++)0<a[c].length&&b.push(a[c]);return new E(b,0)};h.e=function(){return this.Y>=this.o.length};h.Z=function(a){if(Bc(this)!==Bc(a))return!1;for(var b=this.Y,c=a.Y;b<=this.o.length;b++,c++)if(this.o[b]!==a.o[c])return!1;return!0};\nh.contains=function(a){var b=this.Y,c=a.Y;if(Bc(this)>Bc(a))return!1;for(;b<this.o.length;){if(this.o[b]!==a.o[c])return!1;++b;++c}return!0};var Q=new E(\"\");function Mc(a,b){this.Pa=a.slice();this.Ga=Math.max(1,this.Pa.length);this.Ne=b;for(var c=0;c<this.Pa.length;c++)this.Ga+=kb(this.Pa[c]);Nc(this)}Mc.prototype.push=function(a){0<this.Pa.length&&(this.Ga+=1);this.Pa.push(a);this.Ga+=kb(a);Nc(this)};Mc.prototype.pop=function(){var a=this.Pa.pop();this.Ga-=kb(a);0<this.Pa.length&&--this.Ga};\nfunction Nc(a){if(768<a.Ga)throw Error(a.Ne+\"has a key path longer than 768 bytes (\"+a.Ga+\").\");if(32<a.Pa.length)throw Error(a.Ne+\"path specified exceeds the maximum depth that can be written (32) or object contains a cycle \"+Oc(a));}function Oc(a){return 0==a.Pa.length?\"\":\"in property '\"+a.Pa.join(\".\")+\"'\"};function Pc(){this.children={};this.Zc=0;this.value=null}function Qc(a,b,c){this.sd=a?a:\"\";this.Mc=b?b:null;this.A=c?c:new Pc}function Rc(a,b){for(var c=b instanceof E?b:new E(b),d=a,e;null!==(e=K(c));)d=new Qc(e,d,w(d.A.children,e)||new Pc),c=N(c);return d}h=Qc.prototype;h.Ca=function(){return this.A.value};function Sc(a,b){D(\"undefined\"!==typeof b,\"Cannot set value to undefined\");a.A.value=b;Tc(a)}h.clear=function(){this.A.value=null;this.A.children={};this.A.Zc=0;Tc(this)};\nh.gd=function(){return 0<this.A.Zc};h.e=function(){return null===this.Ca()&&!this.gd()};h.O=function(a){var b=this;v(this.A.children,function(c,d){a(new Qc(d,b,c))})};function Uc(a,b,c,d){c&&!d&&b(a);a.O(function(a){Uc(a,b,!0,d)});c&&d&&b(a)}function Vc(a,b){for(var c=a.parent();null!==c&&!b(c);)c=c.parent()}h.path=function(){return new E(null===this.Mc?this.sd:this.Mc.path()+\"/\"+this.sd)};h.name=function(){return this.sd};h.parent=function(){return this.Mc};\nfunction Tc(a){if(null!==a.Mc){var b=a.Mc,c=a.sd,d=a.e(),e=bb(b.A.children,c);d&&e?(delete b.A.children[c],b.A.Zc--,Tc(b)):d||e||(b.A.children[c]=a.A,b.A.Zc++,Tc(b))}};function Wc(a,b){this.Ka=a;this.ba=b?b:Xc}h=Wc.prototype;h.Na=function(a,b){return new Wc(this.Ka,this.ba.Na(a,b,this.Ka).X(null,null,!1,null,null))};h.remove=function(a){return new Wc(this.Ka,this.ba.remove(a,this.Ka).X(null,null,!1,null,null))};h.get=function(a){for(var b,c=this.ba;!c.e();){b=this.Ka(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return null};\nfunction Yc(a,b){for(var c,d=a.ba,e=null;!d.e();){c=a.Ka(b,d.key);if(0===c){if(d.left.e())return e?e.key:null;for(d=d.left;!d.right.e();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}throw Error(\"Attempted to find predecessor key for a nonexistent key.  What gives?\");}h.e=function(){return this.ba.e()};h.count=function(){return this.ba.count()};h.Dc=function(){return this.ba.Dc()};h.cc=function(){return this.ba.cc()};h.ha=function(a){return this.ba.ha(a)};\nh.Ub=function(a){return new Zc(this.ba,null,this.Ka,!1,a)};h.Vb=function(a,b){return new Zc(this.ba,a,this.Ka,!1,b)};h.Xb=function(a,b){return new Zc(this.ba,a,this.Ka,!0,b)};h.Te=function(a){return new Zc(this.ba,null,this.Ka,!0,a)};function Zc(a,b,c,d,e){this.Fd=e||null;this.ie=d;this.Oa=[];for(e=1;!a.e();)if(e=b?c(a.key,b):1,d&&(e*=-1),0>e)a=this.ie?a.left:a.right;else if(0===e){this.Oa.push(a);break}else this.Oa.push(a),a=this.ie?a.right:a.left}\nfunction M(a){if(0===a.Oa.length)return null;var b=a.Oa.pop(),c;c=a.Fd?a.Fd(b.key,b.value):{key:b.key,value:b.value};if(a.ie)for(b=b.left;!b.e();)a.Oa.push(b),b=b.right;else for(b=b.right;!b.e();)a.Oa.push(b),b=b.left;return c}function $c(a){if(0===a.Oa.length)return null;var b;b=a.Oa;b=b[b.length-1];return a.Fd?a.Fd(b.key,b.value):{key:b.key,value:b.value}}function ad(a,b,c,d,e){this.key=a;this.value=b;this.color=null!=c?c:!0;this.left=null!=d?d:Xc;this.right=null!=e?e:Xc}h=ad.prototype;\nh.X=function(a,b,c,d,e){return new ad(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)};h.count=function(){return this.left.count()+1+this.right.count()};h.e=function(){return!1};h.ha=function(a){return this.left.ha(a)||a(this.key,this.value)||this.right.ha(a)};function bd(a){return a.left.e()?a:bd(a.left)}h.Dc=function(){return bd(this).key};h.cc=function(){return this.right.e()?this.key:this.right.cc()};\nh.Na=function(a,b,c){var d,e;e=this;d=c(a,e.key);e=0>d?e.X(null,null,null,e.left.Na(a,b,c),null):0===d?e.X(null,b,null,null,null):e.X(null,null,null,null,e.right.Na(a,b,c));return cd(e)};function dd(a){if(a.left.e())return Xc;a.left.ea()||a.left.left.ea()||(a=fd(a));a=a.X(null,null,null,dd(a.left),null);return cd(a)}\nh.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))c.left.e()||c.left.ea()||c.left.left.ea()||(c=fd(c)),c=c.X(null,null,null,c.left.remove(a,b),null);else{c.left.ea()&&(c=gd(c));c.right.e()||c.right.ea()||c.right.left.ea()||(c=hd(c),c.left.left.ea()&&(c=gd(c),c=hd(c)));if(0===b(a,c.key)){if(c.right.e())return Xc;d=bd(c.right);c=c.X(d.key,d.value,null,null,dd(c.right))}c=c.X(null,null,null,null,c.right.remove(a,b))}return cd(c)};h.ea=function(){return this.color};\nfunction cd(a){a.right.ea()&&!a.left.ea()&&(a=id(a));a.left.ea()&&a.left.left.ea()&&(a=gd(a));a.left.ea()&&a.right.ea()&&(a=hd(a));return a}function fd(a){a=hd(a);a.right.left.ea()&&(a=a.X(null,null,null,null,gd(a.right)),a=id(a),a=hd(a));return a}function id(a){return a.right.X(null,null,a.color,a.X(null,null,!0,null,a.right.left),null)}function gd(a){return a.left.X(null,null,a.color,null,a.X(null,null,!0,a.left.right,null))}\nfunction hd(a){return a.X(null,null,!a.color,a.left.X(null,null,!a.left.color,null,null),a.right.X(null,null,!a.right.color,null,null))}function jd(){}h=jd.prototype;h.X=function(){return this};h.Na=function(a,b){return new ad(a,b,null)};h.remove=function(){return this};h.count=function(){return 0};h.e=function(){return!0};h.ha=function(){return!1};h.Dc=function(){return null};h.cc=function(){return null};h.ea=function(){return!1};var Xc=new jd;function O(a,b,c){this.k=a;(this.aa=b)&&zc(this.aa);a.e()&&D(!this.aa||this.aa.e(),\"An empty node cannot have a priority\");this.wb=c;this.Bb=null}h=O.prototype;h.J=function(){return!1};h.C=function(){return this.aa||L};h.fa=function(a){return this.k.e()?this:new O(this.k,a,this.wb)};h.Q=function(a){if(\".priority\"===a)return this.C();a=this.k.get(a);return null===a?L:a};h.P=function(a){var b=K(a);return null===b?this:this.Q(b).P(N(a))};h.Da=function(a){return null!==this.k.get(a)};\nh.T=function(a,b){D(b,\"We should always be passing snapshot nodes\");if(\".priority\"===a)return this.fa(b);var c=new C(a,b),d,e;b.e()?(d=this.k.remove(a),c=xc(this.wb,c,this.k)):(d=this.k.Na(a,b),c=vc(this.wb,c,this.k));e=d.e()?L:this.aa;return new O(d,e,c)};h.F=function(a,b){var c=K(a);if(null===c)return b;D(\".priority\"!==K(a)||1===Bc(a),\".priority must be the last token in a path\");var d=this.Q(c).F(N(a),b);return this.T(c,d)};h.e=function(){return this.k.e()};h.Cb=function(){return this.k.count()};\nvar kd=/^(0|[1-9]\\d*)$/;h=O.prototype;h.H=function(a){if(this.e())return null;var b={},c=0,d=0,e=!0;this.O(H,function(f,g){b[f]=g.H(a);c++;e&&kd.test(f)?d=Math.max(d,Number(f)):e=!1});if(!a&&e&&d<2*c){var f=[],g;for(g in b)f[g]=b[g];return f}a&&!this.C().e()&&(b[\".priority\"]=this.C().H());return b};h.hash=function(){if(null===this.Bb){var a=\"\";this.C().e()||(a+=\"priority:\"+Cc(this.C().H())+\":\");this.O(H,function(b,c){var d=c.hash();\"\"!==d&&(a+=\":\"+b+\":\"+d)});this.Bb=\"\"===a?\"\":Lb(a)}return this.Bb};\nh.Se=function(a,b,c){return(c=ld(this,c))?(a=Yc(c,new C(a,b)))?a.name:null:Yc(this.k,a)};function md(a,b){var c;c=(c=ld(a,b))?(c=c.Dc())&&c.name:a.k.Dc();return c?new C(c,a.k.get(c)):null}function nd(a,b){var c;c=(c=ld(a,b))?(c=c.cc())&&c.name:a.k.cc();return c?new C(c,a.k.get(c)):null}h.O=function(a,b){var c=ld(this,a);return c?c.ha(function(a){return b(a.name,a.R)}):this.k.ha(b)};h.Ub=function(a){return this.Vb(a.Ec(),a)};\nh.Vb=function(a,b){var c=ld(this,b);if(c)return c.Vb(a,function(a){return a});for(var c=this.k.Vb(a.name,nb),d=$c(c);null!=d&&0>b.compare(d,a);)M(c),d=$c(c);return c};h.Te=function(a){return this.Xb(a.Cc(),a)};h.Xb=function(a,b){var c=ld(this,b);if(c)return c.Xb(a,function(a){return a});for(var c=this.k.Xb(a.name,nb),d=$c(c);null!=d&&0<b.compare(d,a);)M(c),d=$c(c);return c};h.pc=function(a){return this.e()?a.e()?0:-1:a.J()||a.e()?1:a===nc?-1:0};\nh.lb=function(a){if(a===qc||Oa(this.wb.ac,a.toString()))return this;var b=this.wb,c=this.k;D(a!==qc,\"KeyIndex always exists and isn't meant to be added to the IndexMap.\");for(var d=[],e=!1,c=c.Ub(nb),f=M(c);f;)e=e||a.uc(f.R),d.push(f),f=M(c);d=e?wc(d,kc(a)):jc;e=a.toString();c=Sa(b.ac);c[e]=a;a=Sa(b.ld);a[e]=d;return new O(this.k,this.aa,new uc(a,c))};h.vc=function(a){return a===qc||Oa(this.wb.ac,a.toString())};\nh.Z=function(a){if(a===this)return!0;if(a.J())return!1;if(this.C().Z(a.C())&&this.k.count()===a.k.count()){var b=this.Ub(H);a=a.Ub(H);for(var c=M(b),d=M(a);c&&d;){if(c.name!==d.name||!c.R.Z(d.R))return!1;c=M(b);d=M(a)}return null===c&&null===d}return!1};function ld(a,b){return b===qc?null:a.wb.get(b.toString())}h.toString=function(){return x(this.H(!0))};function G(a,b){if(null===a)return L;var c=null;\"object\"===typeof a&&\".priority\"in a?c=a[\".priority\"]:\"undefined\"!==typeof b&&(c=b);D(null===c||\"string\"===typeof c||\"number\"===typeof c||\"object\"===typeof c&&\".sv\"in c,\"Invalid priority type found: \"+typeof c);\"object\"===typeof a&&\".value\"in a&&null!==a[\".value\"]&&(a=a[\".value\"]);if(\"object\"!==typeof a||\".sv\"in a)return new Hb(a,G(c));if(a instanceof Array){var d=L,e=a;v(e,function(a,b){if(bb(e,b)&&\".\"!==b.substring(0,1)){var c=G(a);if(c.J()||!c.e())d=\nd.T(b,c)}});return d.fa(G(c))}var f=[],g=!1,k=a;cb(k,function(a){if(\"string\"!==typeof a||\".\"!==a.substring(0,1)){var b=G(k[a]);b.e()||(g=g||!b.C().e(),f.push(new C(a,b)))}});if(0==f.length)return L;var m=wc(f,ob,function(a){return a.name},qb);if(g){var l=wc(f,kc(H));return new O(m,G(c),new uc({\".priority\":l},{\".priority\":H}))}return new O(m,G(c),yc)}var od=Math.log(2);\nfunction pd(a){this.count=parseInt(Math.log(a+1)/od,10);this.Le=this.count-1;this.Bf=a+1&parseInt(Array(this.count+1).join(\"1\"),2)}function qd(a){var b=!(a.Bf&1<<a.Le);a.Le--;return b}\nfunction wc(a,b,c,d){function e(b,d){var f=d-b;if(0==f)return null;if(1==f){var l=a[b],r=c?c(l):l;return new ad(r,l.R,!1,null,null)}var l=parseInt(f/2,10)+b,f=e(b,l),y=e(l+1,d),l=a[l],r=c?c(l):l;return new ad(r,l.R,!1,f,y)}a.sort(b);var f=function(b){function d(b,g){var k=r-b,y=r;r-=b;var y=e(k+1,y),k=a[k],F=c?c(k):k,y=new ad(F,k.R,g,null,y);f?f.left=y:l=y;f=y}for(var f=null,l=null,r=a.length,y=0;y<b.count;++y){var F=qd(b),ed=Math.pow(2,b.count-(y+1));F?d(ed,!1):(d(ed,!1),d(ed,!0))}return l}(new pd(a.length));\nreturn null!==f?new Wc(d||b,f):new Wc(d||b)}function Cc(a){return\"number\"===typeof a?\"number:\"+ac(a):\"string:\"+a}function zc(a){if(a.J()){var b=a.H();D(\"string\"===typeof b||\"number\"===typeof b||\"object\"===typeof b&&bb(b,\".sv\"),\"Priority must be a string or number.\")}else D(a===nc||a.e(),\"priority of unexpected type.\");D(a===nc||a.C().e(),\"Priority nodes can't have a priority of their own.\")}var L=new O(new Wc(qb),null,yc);function rd(){O.call(this,new Wc(qb),L,yc)}la(rd,O);h=rd.prototype;\nh.pc=function(a){return a===this?0:1};h.Z=function(a){return a===this};h.C=function(){return this};h.Q=function(){return L};h.e=function(){return!1};var nc=new rd,lc=new C(\"[MIN_NAME]\",L),sc=new C(\"[MAX_NAME]\",nc);function sd(a,b){this.value=a;this.children=b||td}var td=new Wc(function(a,b){return a===b?0:a<b?-1:1});function ud(a){var b=R;v(a,function(a,d){b=b.set(new E(d),a)});return b}h=sd.prototype;h.e=function(){return null===this.value&&this.children.e()};function vd(a,b,c){if(null!=a.value&&c(a.value))return{path:Q,value:a.value};if(b.e())return null;var d=K(b);a=a.children.get(d);return null!==a?(b=vd(a,N(b),c),null!=b?{path:(new E(d)).n(b.path),value:b.value}:null):null}\nfunction wd(a,b){return vd(a,b,function(){return!0})}h.subtree=function(a){if(a.e())return this;var b=this.children.get(K(a));return null!==b?b.subtree(N(a)):R};h.set=function(a,b){if(a.e())return new sd(b,this.children);var c=K(a),d=(this.children.get(c)||R).set(N(a),b),c=this.children.Na(c,d);return new sd(this.value,c)};\nh.remove=function(a){if(a.e())return this.children.e()?R:new sd(null,this.children);var b=K(a),c=this.children.get(b);return c?(a=c.remove(N(a)),b=a.e()?this.children.remove(b):this.children.Na(b,a),null===this.value&&b.e()?R:new sd(this.value,b)):this};h.get=function(a){if(a.e())return this.value;var b=this.children.get(K(a));return b?b.get(N(a)):null};\nfunction xd(a,b,c){if(b.e())return c;var d=K(b);b=xd(a.children.get(d)||R,N(b),c);d=b.e()?a.children.remove(d):a.children.Na(d,b);return new sd(a.value,d)}function yd(a,b){return zd(a,Q,b)}function zd(a,b,c){var d={};a.children.ha(function(a,f){d[a]=zd(f,b.n(a),c)});return c(b,a.value,d)}function Ad(a,b,c){return Bd(a,b,Q,c)}function Bd(a,b,c,d){var e=a.value?d(c,a.value):!1;if(e)return e;if(b.e())return null;e=K(b);return(a=a.children.get(e))?Bd(a,N(b),c.n(e),d):null}\nfunction Cd(a,b,c){Dd(a,b,Q,c)}function Dd(a,b,c,d){if(b.e())return a;a.value&&d(c,a.value);var e=K(b);return(a=a.children.get(e))?Dd(a,N(b),c.n(e),d):R}function Ed(a,b){Fd(a,Q,b)}function Fd(a,b,c){a.children.ha(function(a,e){Fd(e,b.n(a),c)});a.value&&c(b,a.value)}function Gd(a,b){a.children.ha(function(a,d){d.value&&b(a,d.value)})}var R=new sd(null);sd.prototype.toString=function(){var a={};Ed(this,function(b,c){a[b.toString()]=c.toString()});return x(a)};var Hd=/[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/,Id=/[\\[\\].#$\\u0000-\\u001F\\u007F]/;function Jd(a){return p(a)&&0!==a.length&&!Hd.test(a)}function Kd(a){return null===a||p(a)||ga(a)&&!Ub(a)||ia(a)&&bb(a,\".sv\")}function Ld(a,b,c,d){d&&!n(b)||Md(A(a,1,d),b,c)}\nfunction Md(a,b,c){c instanceof E&&(c=new Mc(c,a));if(!n(b))throw Error(a+\"contains undefined \"+Oc(c));if(ha(b))throw Error(a+\"contains a function \"+Oc(c)+\" with contents: \"+b.toString());if(Ub(b))throw Error(a+\"contains \"+b.toString()+\" \"+Oc(c));if(p(b)&&b.length>10485760/3&&10485760<kb(b))throw Error(a+\"contains a string greater than 10485760 utf8 bytes \"+Oc(c)+\" ('\"+b.substring(0,50)+\"...')\");if(ia(b)){var d=!1,e=!1;cb(b,function(b,g){if(\".value\"===b)d=!0;else if(\".priority\"!==b&&\".sv\"!==b&&(e=\n!0,!Jd(b)))throw Error(a+\" contains an invalid key (\"+b+\") \"+Oc(c)+'.  Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');c.push(b);Md(a,g,c);c.pop()});if(d&&e)throw Error(a+' contains \".value\" child '+Oc(c)+\" in addition to actual children.\");}}\nfunction Nd(a,b){var c,d;for(c=0;c<b.length;c++){d=b[c];for(var e=d.slice(),f=0;f<e.length;f++)if((\".priority\"!==e[f]||f!==e.length-1)&&!Jd(e[f]))throw Error(a+\"contains an invalid key (\"+e[f]+\") in path \"+d.toString()+'. Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');}b.sort(Kc);e=null;for(c=0;c<b.length;c++){d=b[c];if(null!==e&&e.contains(d))throw Error(a+\"contains a path \"+e.toString()+\" that is ancestor of another path \"+d.toString());e=d}}\nfunction Od(a,b,c){var d=A(a,1,!1);if(!ia(b)||ea(b))throw Error(d+\" must be an object containing the children to replace.\");var e=[];cb(b,function(a,b){var k=new E(a);Md(d,b,c.n(k));if(\".priority\"===Lc(k)&&!Kd(b))throw Error(d+\"contains an invalid value for '\"+k.toString()+\"', which must be a valid Firebase priority (a string, finite number, server value, or null).\");e.push(k)});Nd(d,e)}\nfunction Pd(a,b,c){if(Ub(c))throw Error(A(a,b,!1)+\"is \"+c.toString()+\", but must be a valid Firebase priority (a string, finite number, server value, or null).\");if(!Kd(c))throw Error(A(a,b,!1)+\"must be a valid Firebase priority (a string, finite number, server value, or null).\");}\nfunction Qd(a,b,c){if(!c||n(b))switch(b){case \"value\":case \"child_added\":case \"child_removed\":case \"child_changed\":case \"child_moved\":break;default:throw Error(A(a,1,c)+'must be a valid event type: \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".');}}function Rd(a,b){if(n(b)&&!Jd(b))throw Error(A(a,2,!0)+'was an invalid key: \"'+b+'\".  Firebase keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").');}\nfunction Sd(a,b){if(!p(b)||0===b.length||Id.test(b))throw Error(A(a,1,!1)+'was an invalid path: \"'+b+'\". Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"');}function Td(a,b){if(\".info\"===K(b))throw Error(a+\" failed: Can't modify data under /.info/\");}\nfunction Ud(a,b){var c=b.path.toString(),d;!(d=!p(b.gc.host)||0===b.gc.host.length||!Jd(b.gc.ne))&&(d=0!==c.length)&&(c&&(c=c.replace(/^\\/*\\.info(\\/|$)/,\"/\")),d=!(p(c)&&0!==c.length&&!Id.test(c)));if(d)throw Error(A(a,1,!1)+'must be a valid firebase URL and the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".');};function Db(){this.k=this.B=null}Db.prototype.find=function(a){if(null!=this.B)return this.B.P(a);if(a.e()||null==this.k)return null;var b=K(a);a=N(a);return this.k.contains(b)?this.k.get(b).find(a):null};function Fb(a,b,c){if(b.e())a.B=c,a.k=null;else if(null!==a.B)a.B=a.B.F(b,c);else{null==a.k&&(a.k=new Dc);var d=K(b);a.k.contains(d)||a.k.add(d,new Db);a=a.k.get(d);b=N(b);Fb(a,b,c)}}\nfunction Vd(a,b){if(b.e())return a.B=null,a.k=null,!0;if(null!==a.B){if(a.B.J())return!1;var c=a.B;a.B=null;c.O(H,function(b,c){Fb(a,new E(b),c)});return Vd(a,b)}return null!==a.k?(c=K(b),b=N(b),a.k.contains(c)&&Vd(a.k.get(c),b)&&a.k.remove(c),a.k.e()?(a.k=null,!0):!1):!0}function Eb(a,b,c){null!==a.B?c(b,a.B):a.O(function(a,e){var f=new E(b.toString()+\"/\"+a);Eb(e,f,c)})}Db.prototype.O=function(a){null!==this.k&&Ec(this.k,function(b,c){a(b,c)})};function Wd(a,b){this.type=Xd;this.source=a;this.path=b}Wd.prototype.Jc=function(){return this.path.e()?new Wd(this.source,Q):new Wd(this.source,N(this.path))};Wd.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" listen_complete)\"};function Yd(a,b,c){this.type=Zd;this.source=a;this.path=b;this.children=c}Yd.prototype.Jc=function(a){if(this.path.e())return a=this.children.subtree(new E(a)),a.e()?null:a.value?new $d(this.source,Q,a.value):new Yd(this.source,Q,a);D(K(this.path)===a,\"Can't get a merge for a child not on the path of the operation\");return new Yd(this.source,N(this.path),this.children)};Yd.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" merge: \"+this.children.toString()+\")\"};function ae(a,b,c){this.type=be;this.source=ce;this.path=a;this.Mb=b;this.Gd=c}ae.prototype.Jc=function(a){if(this.path.e()){if(null!=this.Mb.value)return D(this.Mb.children.e(),\"affectedTree should not have overlapping affected paths.\"),this;a=this.Mb.subtree(new E(a));return new ae(Q,a,this.Gd)}D(K(this.path)===a,\"operationForChild called for unrelated child.\");return new ae(N(this.path),this.Mb,this.Gd)};\nae.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" ack write revert=\"+this.Gd+\" affectedTree=\"+this.Mb+\")\"};function $d(a,b,c){this.type=de;this.source=a;this.path=b;this.Fa=c}$d.prototype.Jc=function(a){return this.path.e()?new $d(this.source,Q,this.Fa.Q(a)):new $d(this.source,N(this.path),this.Fa)};$d.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" overwrite: \"+this.Fa.toString()+\")\"};var de=0,Zd=1,be=2,Xd=3;function ee(a,b,c,d){this.be=a;this.Pe=b;this.Fb=c;this.Ce=d;D(!d||b,\"Tagged queries must be from server.\")}var ce=new ee(!0,!1,null,!1),fe=new ee(!1,!0,null,!1);ee.prototype.toString=function(){return this.be?\"user\":this.Ce?\"server(queryID=\"+this.Fb+\")\":\"server\"};function ge(a,b,c){this.A=a;this.da=b;this.Qb=c}function he(a){return a.da}function ie(a){return a.Qb}function je(a,b){return b.e()?a.da&&!a.Qb:ke(a,K(b))}function ke(a,b){return a.da&&!a.Qb||a.A.Da(b)}ge.prototype.j=function(){return this.A};function le(a,b){this.N=a;this.Id=b}function me(a,b,c,d){return new le(new ge(b,c,d),a.Id)}function ne(a){return a.N.da?a.N.j():null}le.prototype.w=function(){return this.Id};function oe(a){return a.Id.da?a.Id.j():null};function pe(){}pe.prototype.Qe=function(){return null};pe.prototype.ce=function(){return null};var qe=new pe;function re(a,b,c){this.wf=a;this.Ja=b;this.wd=c}re.prototype.Qe=function(a){var b=this.Ja.N;if(ke(b,a))return b.j().Q(a);b=null!=this.wd?new ge(this.wd,!0,!1):this.Ja.w();return this.wf.nc(a,b)};re.prototype.ce=function(a,b,c){var d=null!=this.wd?this.wd:oe(this.Ja);a=this.wf.Td(d,b,1,c,a);return 0===a.length?null:a[0]};function se(a,b){this.Od=a;this.Cf=b}function te(a){this.U=a}\nte.prototype.bb=function(a,b,c,d){var e=new ue,f;if(b.type===de)b.source.be?c=ve(this,a,b.path,b.Fa,c,d,e):(D(b.source.Pe,\"Unknown source.\"),f=b.source.Ce||ie(a.w())&&!b.path.e(),c=we(this,a,b.path,b.Fa,c,d,f,e));else if(b.type===Zd)b.source.be?c=xe(this,a,b.path,b.children,c,d,e):(D(b.source.Pe,\"Unknown source.\"),f=b.source.Ce||ie(a.w()),c=ye(this,a,b.path,b.children,c,d,f,e));else if(b.type===be)if(b.Gd)if(b=b.path,null!=c.ic(b))c=a;else{f=new re(c,a,d);d=a.N.j();if(b.e()||\".priority\"===K(b))he(a.w())?\nb=c.Aa(oe(a)):(b=a.w().j(),D(b instanceof O,\"serverChildren would be complete if leaf node\"),b=c.oc(b)),b=this.U.ya(d,b,e);else{var g=K(b),k=c.nc(g,a.w());null==k&&ke(a.w(),g)&&(k=d.Q(g));b=null!=k?this.U.F(d,g,k,N(b),f,e):a.N.j().Da(g)?this.U.F(d,g,L,N(b),f,e):d;b.e()&&he(a.w())&&(d=c.Aa(oe(a)),d.J()&&(b=this.U.ya(b,d,e)))}d=he(a.w())||null!=c.ic(Q);c=me(a,b,d,this.U.Ma())}else c=ze(this,a,b.path,b.Mb,c,d,e);else if(b.type===Xd)d=b.path,b=a.w(),f=b.j(),g=b.da||d.e(),c=Ae(this,new le(a.N,new ge(f,\ng,b.Qb)),d,c,qe,e);else throw Jb(\"Unknown operation type: \"+b.type);e=Ma(e.eb);d=c;b=d.N;b.da&&(f=b.j().J()||b.j().e(),g=ne(a),(0<e.length||!a.N.da||f&&!b.j().Z(g)||!b.j().C().Z(g.C()))&&e.push(Be(ne(d))));return new se(c,e)};\nfunction Ae(a,b,c,d,e,f){var g=b.N;if(null!=d.ic(c))return b;var k;if(c.e())D(he(b.w()),\"If change path is empty, we must have complete server data\"),ie(b.w())?(e=oe(b),d=d.oc(e instanceof O?e:L)):d=d.Aa(oe(b)),f=a.U.ya(b.N.j(),d,f);else{var m=K(c);if(\".priority\"==m)D(1==Bc(c),\"Can't have a priority with additional path components\"),f=g.j(),k=b.w().j(),d=d.Yc(c,f,k),f=null!=d?a.U.fa(f,d):g.j();else{var l=N(c);ke(g,m)?(k=b.w().j(),d=d.Yc(c,g.j(),k),d=null!=d?g.j().Q(m).F(l,d):g.j().Q(m)):d=d.nc(m,\nb.w());f=null!=d?a.U.F(g.j(),m,d,l,e,f):g.j()}}return me(b,f,g.da||c.e(),a.U.Ma())}function we(a,b,c,d,e,f,g,k){var m=b.w();g=g?a.U:a.U.Sb();if(c.e())d=g.ya(m.j(),d,null);else if(g.Ma()&&!m.Qb)d=m.j().F(c,d),d=g.ya(m.j(),d,null);else{var l=K(c);if(!je(m,c)&&1<Bc(c))return b;var r=N(c);d=m.j().Q(l).F(r,d);d=\".priority\"==l?g.fa(m.j(),d):g.F(m.j(),l,d,r,qe,null)}m=m.da||c.e();b=new le(b.N,new ge(d,m,g.Ma()));return Ae(a,b,c,e,new re(e,b,f),k)}\nfunction ve(a,b,c,d,e,f,g){var k=b.N;e=new re(e,b,f);if(c.e())g=a.U.ya(b.N.j(),d,g),a=me(b,g,!0,a.U.Ma());else if(f=K(c),\".priority\"===f)g=a.U.fa(b.N.j(),d),a=me(b,g,k.da,k.Qb);else{c=N(c);var m=k.j().Q(f);if(!c.e()){var l=e.Qe(f);d=null!=l?\".priority\"===Lc(c)&&l.P(c.parent()).e()?l:l.F(c,d):L}m.Z(d)?a=b:(g=a.U.F(k.j(),f,d,c,e,g),a=me(b,g,k.da,a.U.Ma()))}return a}\nfunction xe(a,b,c,d,e,f,g){var k=b;Ed(d,function(d,l){var r=c.n(d);ke(b.N,K(r))&&(k=ve(a,k,r,l,e,f,g))});Ed(d,function(d,l){var r=c.n(d);ke(b.N,K(r))||(k=ve(a,k,r,l,e,f,g))});return k}function Ce(a,b){Ed(b,function(b,d){a=a.F(b,d)});return a}\nfunction ye(a,b,c,d,e,f,g,k){if(b.w().j().e()&&!he(b.w()))return b;var m=b;c=c.e()?d:xd(R,c,d);var l=b.w().j();c.children.ha(function(c,d){if(l.Da(c)){var F=b.w().j().Q(c),F=Ce(F,d);m=we(a,m,new E(c),F,e,f,g,k)}});c.children.ha(function(c,d){var F=!ke(b.w(),c)&&null==d.value;l.Da(c)||F||(F=b.w().j().Q(c),F=Ce(F,d),m=we(a,m,new E(c),F,e,f,g,k))});return m}\nfunction ze(a,b,c,d,e,f,g){if(null!=e.ic(c))return b;var k=ie(b.w()),m=b.w();if(null!=d.value){if(c.e()&&m.da||je(m,c))return we(a,b,c,m.j().P(c),e,f,k,g);if(c.e()){var l=R;m.j().O(qc,function(a,b){l=l.set(new E(a),b)});return ye(a,b,c,l,e,f,k,g)}return b}l=R;Ed(d,function(a){var b=c.n(a);je(m,b)&&(l=l.set(a,m.j().P(b)))});return ye(a,b,c,l,e,f,k,g)};function De(a){this.V=a;this.g=a.m.g}function Ee(a,b,c,d){var e=[],f=[];ya(b,function(b){b.type===Fe&&a.g.kd(b.oe,b.Ia)&&f.push(new S(Ge,b.Ia,b.Wa))});He(a,e,Ie,b,d,c);He(a,e,Je,b,d,c);He(a,e,Ge,f,d,c);He(a,e,Fe,b,d,c);He(a,e,Ke,b,d,c);return e}function He(a,b,c,d,e,f){d=za(d,function(a){return a.type===c});Ga(d,q(a.Ff,a));ya(d,function(c){var d=Le(a,c,f);ya(e,function(e){e.lf(c.type)&&b.push(e.createEvent(d,a.V))})})}\nfunction Le(a,b,c){\"value\"!==b.type&&\"child_removed\"!==b.type&&(b.Bd=c.Se(b.Wa,b.Ia,a.g));return b}De.prototype.Ff=function(a,b){if(null==a.Wa||null==b.Wa)throw Jb(\"Should only compare child_ events.\");return this.g.compare(new C(a.Wa,a.Ia),new C(b.Wa,b.Ia))};function Me(a,b){this.V=a;var c=a.m,d=new Ne(c.g),c=T(c)?new Ne(c.g):c.xa?new Oe(c):new Pe(c);this.ff=new te(c);var e=b.w(),f=b.N,g=d.ya(L,e.j(),null),k=c.ya(L,f.j(),null);this.Ja=new le(new ge(k,f.da,c.Ma()),new ge(g,e.da,d.Ma()));this.Ya=[];this.Lf=new De(a)}function Qe(a){return a.V}h=Me.prototype;h.w=function(){return this.Ja.w().j()};h.fb=function(a){var b=oe(this.Ja);return b&&(T(this.V.m)||!a.e()&&!b.Q(K(a)).e())?b.P(a):null};h.e=function(){return 0===this.Ya.length};h.Lb=function(a){this.Ya.push(a)};\nh.ib=function(a,b){var c=[];if(b){D(null==a,\"A cancel should cancel all event registrations.\");var d=this.V.path;ya(this.Ya,function(a){(a=a.Je(b,d))&&c.push(a)})}if(a){for(var e=[],f=0;f<this.Ya.length;++f){var g=this.Ya[f];if(!g.matches(a))e.push(g);else if(a.Ue()){e=e.concat(this.Ya.slice(f+1));break}}this.Ya=e}else this.Ya=[];return c};\nh.bb=function(a,b,c){a.type===Zd&&null!==a.source.Fb&&(D(oe(this.Ja),\"We should always have a full cache before handling merges\"),D(ne(this.Ja),\"Missing event cache, even though we have a server cache\"));var d=this.Ja;a=this.ff.bb(d,a,b,c);b=this.ff;c=a.Od;D(c.N.j().vc(b.U.g),\"Event snap not indexed\");D(c.w().j().vc(b.U.g),\"Server snap not indexed\");D(he(a.Od.w())||!he(d.w()),\"Once a server snap is complete, it should never go back\");this.Ja=a.Od;return Re(this,a.Cf,a.Od.N.j(),null)};\nfunction Se(a,b){var c=a.Ja.N,d=[];c.j().J()||c.j().O(H,function(a,b){d.push(new S(Je,b,a))});c.da&&d.push(Be(c.j()));return Re(a,d,c.j(),b)}function Re(a,b,c,d){return Ee(a.Lf,b,c,d?[d]:a.Ya)};function Te(a,b,c,d){this.Yd=b;this.Jd=c;this.Bd=d;this.ed=a}Te.prototype.Wb=function(){var a=this.Jd.ub();return\"value\"===this.ed?a.path:a.getParent().path};Te.prototype.de=function(){return this.ed};Te.prototype.Rb=function(){return this.Yd.Rb(this)};Te.prototype.toString=function(){return this.Wb().toString()+\":\"+this.ed+\":\"+x(this.Jd.Zd())};function Ue(a,b,c){this.Yd=a;this.error=b;this.path=c}Ue.prototype.Wb=function(){return this.path};Ue.prototype.de=function(){return\"cancel\"};\nUe.prototype.Rb=function(){return this.Yd.Rb(this)};Ue.prototype.toString=function(){return this.path.toString()+\":cancel\"};function Ve(){this.tb=[]}function We(a,b){for(var c=null,d=0;d<b.length;d++){var e=b[d],f=e.Wb();null===c||f.Z(c.Wb())||(a.tb.push(c),c=null);null===c&&(c=new Xe(f));c.add(e)}c&&a.tb.push(c)}function Ye(a,b,c){We(a,c);Ze(a,function(a){return a.Z(b)})}function $e(a,b,c){We(a,c);Ze(a,function(a){return a.contains(b)||b.contains(a)})}\nfunction Ze(a,b){for(var c=!0,d=0;d<a.tb.length;d++){var e=a.tb[d];if(e)if(e=e.Wb(),b(e)){for(var e=a.tb[d],f=0;f<e.fd.length;f++){var g=e.fd[f];if(null!==g){e.fd[f]=null;var k=g.Rb();Nb&&I(\"event: \"+g.toString());cc(k)}}a.tb[d]=null}else c=!1}c&&(a.tb=[])}function Xe(a){this.qa=a;this.fd=[]}Xe.prototype.add=function(a){this.fd.push(a)};Xe.prototype.Wb=function(){return this.qa};function Ne(a){this.g=a}h=Ne.prototype;h.F=function(a,b,c,d,e,f){D(a.vc(this.g),\"A node must be indexed if only a child is updated\");e=a.Q(b);if(e.P(d).Z(c.P(d))&&e.e()==c.e())return a;null!=f&&(c.e()?a.Da(b)?af(f,new S(Ie,e,b)):D(a.J(),\"A child remove without an old child only makes sense on a leaf node\"):e.e()?af(f,new S(Je,c,b)):af(f,new S(Fe,c,b,e)));return a.J()&&c.e()?a:a.T(b,c).lb(this.g)};\nh.ya=function(a,b,c){null!=c&&(a.J()||a.O(H,function(a,e){b.Da(a)||af(c,new S(Ie,e,a))}),b.J()||b.O(H,function(b,e){if(a.Da(b)){var f=a.Q(b);f.Z(e)||af(c,new S(Fe,e,b,f))}else af(c,new S(Je,e,b))}));return b.lb(this.g)};h.fa=function(a,b){return a.e()?L:a.fa(b)};h.Ma=function(){return!1};h.Sb=function(){return this};function Pe(a){this.ee=new Ne(a.g);this.g=a.g;var b;a.ka?(b=bf(a),b=a.g.Bc(cf(a),b)):b=a.g.Ec();this.Rc=b;a.na?(b=df(a),a=a.g.Bc(ef(a),b)):a=a.g.Cc();this.sc=a}h=Pe.prototype;h.matches=function(a){return 0>=this.g.compare(this.Rc,a)&&0>=this.g.compare(a,this.sc)};h.F=function(a,b,c,d,e,f){this.matches(new C(b,c))||(c=L);return this.ee.F(a,b,c,d,e,f)};\nh.ya=function(a,b,c){b.J()&&(b=L);var d=b.lb(this.g),d=d.fa(L),e=this;b.O(H,function(a,b){e.matches(new C(a,b))||(d=d.T(a,L))});return this.ee.ya(a,d,c)};h.fa=function(a){return a};h.Ma=function(){return!0};h.Sb=function(){return this.ee};function Oe(a){this.sa=new Pe(a);this.g=a.g;D(a.xa,\"Only valid if limit has been set\");this.oa=a.oa;this.Gb=!ff(a)}h=Oe.prototype;h.F=function(a,b,c,d,e,f){this.sa.matches(new C(b,c))||(c=L);return a.Q(b).Z(c)?a:a.Cb()<this.oa?this.sa.Sb().F(a,b,c,d,e,f):gf(this,a,b,c,e,f)};\nh.ya=function(a,b,c){var d;if(b.J()||b.e())d=L.lb(this.g);else if(2*this.oa<b.Cb()&&b.vc(this.g)){d=L.lb(this.g);b=this.Gb?b.Xb(this.sa.sc,this.g):b.Vb(this.sa.Rc,this.g);for(var e=0;0<b.Oa.length&&e<this.oa;){var f=M(b),g;if(g=this.Gb?0>=this.g.compare(this.sa.Rc,f):0>=this.g.compare(f,this.sa.sc))d=d.T(f.name,f.R),e++;else break}}else{d=b.lb(this.g);d=d.fa(L);var k,m,l;if(this.Gb){b=d.Te(this.g);k=this.sa.sc;m=this.sa.Rc;var r=kc(this.g);l=function(a,b){return r(b,a)}}else b=d.Ub(this.g),k=this.sa.Rc,\nm=this.sa.sc,l=kc(this.g);for(var e=0,y=!1;0<b.Oa.length;)f=M(b),!y&&0>=l(k,f)&&(y=!0),(g=y&&e<this.oa&&0>=l(f,m))?e++:d=d.T(f.name,L)}return this.sa.Sb().ya(a,d,c)};h.fa=function(a){return a};h.Ma=function(){return!0};h.Sb=function(){return this.sa.Sb()};\nfunction gf(a,b,c,d,e,f){var g;if(a.Gb){var k=kc(a.g);g=function(a,b){return k(b,a)}}else g=kc(a.g);D(b.Cb()==a.oa,\"\");var m=new C(c,d),l=a.Gb?md(b,a.g):nd(b,a.g),r=a.sa.matches(m);if(b.Da(c)){for(var y=b.Q(c),l=e.ce(a.g,l,a.Gb);null!=l&&(l.name==c||b.Da(l.name));)l=e.ce(a.g,l,a.Gb);e=null==l?1:g(l,m);if(r&&!d.e()&&0<=e)return null!=f&&af(f,new S(Fe,d,c,y)),b.T(c,d);null!=f&&af(f,new S(Ie,y,c));b=b.T(c,L);return null!=l&&a.sa.matches(l)?(null!=f&&af(f,new S(Je,l.R,l.name)),b.T(l.name,l.R)):b}return d.e()?\nb:r&&0<=g(l,m)?(null!=f&&(af(f,new S(Ie,l.R,l.name)),af(f,new S(Je,d,c))),b.T(c,d).T(l.name,L)):b};function S(a,b,c,d){this.type=a;this.Ia=b;this.Wa=c;this.oe=d;this.Bd=void 0}function Be(a){return new S(Ke,a)}var Je=\"child_added\",Ie=\"child_removed\",Fe=\"child_changed\",Ge=\"child_moved\",Ke=\"value\";function ue(){this.eb={}}\nfunction af(a,b){var c=b.type,d=b.Wa;D(c==Je||c==Fe||c==Ie,\"Only child changes supported for tracking\");D(\".priority\"!==d,\"Only non-priority child changes can be tracked.\");var e=w(a.eb,d);if(e){var f=e.type;if(c==Je&&f==Ie)a.eb[d]=new S(Fe,b.Ia,d,e.Ia);else if(c==Ie&&f==Je)delete a.eb[d];else if(c==Ie&&f==Fe)a.eb[d]=new S(Ie,e.oe,d);else if(c==Fe&&f==Je)a.eb[d]=new S(Je,b.Ia,d);else if(c==Fe&&f==Fe)a.eb[d]=new S(Fe,b.Ia,d,e.oe);else throw Jb(\"Illegal combination of changes: \"+b+\" occurred after \"+\ne);}else a.eb[d]=b};function hf(){this.Pb=this.na=this.Ib=this.ka=this.xa=!1;this.oa=0;this.kb=\"\";this.bc=null;this.xb=\"\";this.Zb=null;this.vb=\"\";this.g=H}var jf=new hf;function ff(a){return\"\"===a.kb?a.ka:\"l\"===a.kb}function cf(a){D(a.ka,\"Only valid if start has been set\");return a.bc}function bf(a){D(a.ka,\"Only valid if start has been set\");return a.Ib?a.xb:\"[MIN_NAME]\"}function ef(a){D(a.na,\"Only valid if end has been set\");return a.Zb}\nfunction df(a){D(a.na,\"Only valid if end has been set\");return a.Pb?a.vb:\"[MAX_NAME]\"}function kf(a){var b=new hf;b.xa=a.xa;b.oa=a.oa;b.ka=a.ka;b.bc=a.bc;b.Ib=a.Ib;b.xb=a.xb;b.na=a.na;b.Zb=a.Zb;b.Pb=a.Pb;b.vb=a.vb;b.g=a.g;b.kb=a.kb;return b}h=hf.prototype;h.ke=function(a){var b=kf(this);b.xa=!0;b.oa=a;b.kb=\"l\";return b};h.le=function(a){var b=kf(this);b.xa=!0;b.oa=a;b.kb=\"r\";return b};h.Kd=function(a,b){var c=kf(this);c.ka=!0;n(a)||(a=null);c.bc=a;null!=b?(c.Ib=!0,c.xb=b):(c.Ib=!1,c.xb=\"\");return c};\nh.dd=function(a,b){var c=kf(this);c.na=!0;n(a)||(a=null);c.Zb=a;n(b)?(c.Pb=!0,c.vb=b):(c.Ag=!1,c.vb=\"\");return c};function lf(a,b){var c=kf(a);c.g=b;return c}function mf(a){var b={};a.ka&&(b.sp=a.bc,a.Ib&&(b.sn=a.xb));a.na&&(b.ep=a.Zb,a.Pb&&(b.en=a.vb));if(a.xa){b.l=a.oa;var c=a.kb;\"\"===c&&(c=ff(a)?\"l\":\"r\");b.vf=c}a.g!==H&&(b.i=a.g.toString());return b}function T(a){return!(a.ka||a.na||a.xa)}function nf(a){return T(a)&&a.g==H}\nfunction of(a){var b={};if(nf(a))return b;var c;a.g===H?c=\"$priority\":a.g===tc?c=\"$value\":a.g===qc?c=\"$key\":(D(a.g instanceof mc,\"Unrecognized index type!\"),c=a.g.toString());b.orderBy=x(c);a.ka&&(b.startAt=x(a.bc),a.Ib&&(b.startAt+=\",\"+x(a.xb)));a.na&&(b.endAt=x(a.Zb),a.Pb&&(b.endAt+=\",\"+x(a.vb)));a.xa&&(ff(a)?b.limitToFirst=a.oa:b.limitToLast=a.oa);return b}h.toString=function(){return x(mf(this))};function pf(a){this.W=a}var qf=new pf(new sd(null));function rf(a,b,c){if(b.e())return new pf(new sd(c));var d=wd(a.W,b);if(null!=d){var e=d.path,d=d.value;b=P(e,b);d=d.F(b,c);return new pf(a.W.set(e,d))}a=xd(a.W,b,new sd(c));return new pf(a)}function sf(a,b,c){var d=a;cb(c,function(a,c){d=rf(d,b.n(a),c)});return d}pf.prototype.Cd=function(a){if(a.e())return qf;a=xd(this.W,a,R);return new pf(a)};function tf(a,b){var c=wd(a.W,b);return null!=c?a.W.get(c.path).P(P(c.path,b)):null}\nfunction uf(a){var b=[],c=a.W.value;null!=c?c.J()||c.O(H,function(a,c){b.push(new C(a,c))}):a.W.children.ha(function(a,c){null!=c.value&&b.push(new C(a,c.value))});return b}function vf(a,b){if(b.e())return a;var c=tf(a,b);return null!=c?new pf(new sd(c)):new pf(a.W.subtree(b))}pf.prototype.e=function(){return this.W.e()};pf.prototype.apply=function(a){return wf(Q,this.W,a)};\nfunction wf(a,b,c){if(null!=b.value)return c.F(a,b.value);var d=null;b.children.ha(function(b,f){\".priority\"===b?(D(null!==f.value,\"Priority writes must always be leaf nodes\"),d=f.value):c=wf(a.n(b),f,c)});c.P(a).e()||null===d||(c=c.F(a.n(\".priority\"),d));return c};function xf(){this.Hd=L}xf.prototype.j=function(a){return this.Hd.P(a)};xf.prototype.toString=function(){return this.Hd.toString()};function yf(a){this.lc=a}yf.prototype.getToken=function(a){return this.lc.INTERNAL.getToken(a).then(null,function(a){return a&&\"auth/token-not-initialized\"===a.code?(I(\"Got auth/token-not-initialized error.  Treating as null token.\"),null):Promise.reject(a)})};function zf(a,b){a.lc.INTERNAL.addAuthTokenListener(b)};function Af(){this.S=qf;this.la=[];this.yc=-1}function Bf(a,b){for(var c=0;c<a.la.length;c++){var d=a.la[c];if(d.Wc===b)return d}return null}h=Af.prototype;\nh.Cd=function(a){var b=Ea(this.la,function(b){return b.Wc===a});D(0<=b,\"removeWrite called with nonexistent writeId.\");var c=this.la[b];this.la.splice(b,1);for(var d=c.visible,e=!1,f=this.la.length-1;d&&0<=f;){var g=this.la[f];g.visible&&(f>=b&&Cf(g,c.path)?d=!1:c.path.contains(g.path)&&(e=!0));f--}if(d){if(e)this.S=Df(this.la,Ef,Q),this.yc=0<this.la.length?this.la[this.la.length-1].Wc:-1;else if(c.Fa)this.S=this.S.Cd(c.path);else{var k=this;v(c.children,function(a,b){k.S=k.S.Cd(c.path.n(b))})}return!0}return!1};\nh.Aa=function(a,b,c,d){if(c||d){var e=vf(this.S,a);return!d&&e.e()?b:d||null!=b||null!=tf(e,Q)?(e=Df(this.la,function(b){return(b.visible||d)&&(!c||!(0<=xa(c,b.Wc)))&&(b.path.contains(a)||a.contains(b.path))},a),b=b||L,e.apply(b)):null}e=tf(this.S,a);if(null!=e)return e;e=vf(this.S,a);return e.e()?b:null!=b||null!=tf(e,Q)?(b=b||L,e.apply(b)):null};\nh.oc=function(a,b){var c=L,d=tf(this.S,a);if(d)d.J()||d.O(H,function(a,b){c=c.T(a,b)});else if(b){var e=vf(this.S,a);b.O(H,function(a,b){var d=vf(e,new E(a)).apply(b);c=c.T(a,d)});ya(uf(e),function(a){c=c.T(a.name,a.R)})}else e=vf(this.S,a),ya(uf(e),function(a){c=c.T(a.name,a.R)});return c};h.Yc=function(a,b,c,d){D(c||d,\"Either existingEventSnap or existingServerSnap must exist\");a=a.n(b);if(null!=tf(this.S,a))return null;a=vf(this.S,a);return a.e()?d.P(b):a.apply(d.P(b))};\nh.nc=function(a,b,c){a=a.n(b);var d=tf(this.S,a);return null!=d?d:ke(c,b)?vf(this.S,a).apply(c.j().Q(b)):null};h.ic=function(a){return tf(this.S,a)};h.Td=function(a,b,c,d,e,f){var g;a=vf(this.S,a);g=tf(a,Q);if(null==g)if(null!=b)g=a.apply(b);else return[];g=g.lb(f);if(g.e()||g.J())return[];b=[];a=kc(f);e=e?g.Xb(c,f):g.Vb(c,f);for(f=M(e);f&&b.length<d;)0!==a(f,c)&&b.push(f),f=M(e);return b};\nfunction Cf(a,b){return a.Fa?a.path.contains(b):!!Pa(a.children,function(c,d){return a.path.n(d).contains(b)})}function Ef(a){return a.visible}\nfunction Df(a,b,c){for(var d=qf,e=0;e<a.length;++e){var f=a[e];if(b(f)){var g=f.path;if(f.Fa)c.contains(g)?(g=P(c,g),d=rf(d,g,f.Fa)):g.contains(c)&&(g=P(g,c),d=rf(d,Q,f.Fa.P(g)));else if(f.children)if(c.contains(g))g=P(c,g),d=sf(d,g,f.children);else{if(g.contains(c))if(g=P(g,c),g.e())d=sf(d,Q,f.children);else if(f=w(f.children,K(g)))f=f.P(N(g)),d=rf(d,Q,f)}else throw Jb(\"WriteRecord should have .snap or .children\");}}return d}function Ff(a,b){this.Jb=a;this.W=b}h=Ff.prototype;\nh.Aa=function(a,b,c){return this.W.Aa(this.Jb,a,b,c)};h.oc=function(a){return this.W.oc(this.Jb,a)};h.Yc=function(a,b,c){return this.W.Yc(this.Jb,a,b,c)};h.ic=function(a){return this.W.ic(this.Jb.n(a))};h.Td=function(a,b,c,d,e){return this.W.Td(this.Jb,a,b,c,d,e)};h.nc=function(a,b){return this.W.nc(this.Jb,a,b)};h.n=function(a){return new Ff(this.Jb.n(a),this.W)};function Gf(a,b){this.qf={};this.Sc=new Hf(a);this.va=b;var c=1E4+2E4*Math.random();ec(q(this.jf,this),Math.floor(c))}Gf.prototype.jf=function(){var a=this.Sc.get(),b={},c=!1,d;for(d in a)0<a[d]&&bb(this.qf,d)&&(b[d]=a[d],c=!0);c&&this.va.we(b);ec(q(this.jf,this),Math.floor(6E5*Math.random()))};function If(){this.qc={}}function Jf(a,b,c){n(c)||(c=1);bb(a.qc,b)||(a.qc[b]=0);a.qc[b]+=c}If.prototype.get=function(){return Sa(this.qc)};function Hf(a){this.Df=a;this.od=null}Hf.prototype.get=function(){var a=this.Df.get(),b=Sa(a);if(this.od)for(var c in this.od)b[c]-=this.od[c];this.od=a;return b};var Kf={},Lf={};function Mf(a){a=a.toString();Kf[a]||(Kf[a]=new If);return Kf[a]}function Nf(a,b){var c=a.toString();Lf[c]||(Lf[c]=b());return Lf[c]};function Of(a,b,c){this.f=Qb(\"p:rest:\");this.L=a;this.Eb=b;this.Xc=c;this.$={}}function Pf(a,b){if(n(b))return\"tag$\"+b;D(nf(a.m),\"should have a tag if it's not a default query.\");return a.path.toString()}h=Of.prototype;\nh.Xe=function(a,b,c,d){var e=a.path.toString();this.f(\"Listen called for \"+e+\" \"+a.ja());var f=Pf(a,c),g={};this.$[f]=g;a=of(a.m);var k=this;Qf(this,e+\".json\",a,function(a,b){var r=b;404===a&&(a=r=null);null===a&&k.Eb(e,r,!1,c);w(k.$,f)===g&&d(a?401==a?\"permission_denied\":\"rest_error:\"+a:\"ok\",null)})};h.tf=function(a,b){var c=Pf(a,b);delete this.$[c]};h.hf=function(){};h.pe=function(){};h.bf=function(){};h.vd=function(){};h.put=function(){};h.Ye=function(){};h.we=function(){};\nfunction Qf(a,b,c,d){c=c||{};c.format=\"export\";a.Xc.getToken(!1).then(function(e){(e=e&&e.accessToken)&&(c.auth=e);var f=(a.L.Pc?\"https://\":\"http://\")+a.L.host+b+\"?\"+db(c);a.f(\"Sending REST request for \"+f);var g=new XMLHttpRequest;g.onreadystatechange=function(){if(d&&4===g.readyState){a.f(\"REST Response for \"+f+\" received. status:\",g.status,\"response:\",g.responseText);var b=null;if(200<=g.status&&300>g.status){try{b=ib(g.responseText)}catch(c){J(\"Failed to parse JSON response for \"+f+\": \"+g.responseText)}d(null,\nb)}else 401!==g.status&&404!==g.status&&J(\"Got unsuccessful REST response for \"+f+\" Status: \"+g.status),d(g.status);d=null}};g.open(\"GET\",f,!0);g.send()})};function Rf(a){this.re=a;this.zd=[];this.Ob=0;this.Ud=-1;this.Db=null}function Sf(a,b,c){a.Ud=b;a.Db=c;a.Ud<a.Ob&&(a.Db(),a.Db=null)}function Tf(a,b,c){for(a.zd[b]=c;a.zd[a.Ob];){var d=a.zd[a.Ob];delete a.zd[a.Ob];for(var e=0;e<d.length;++e)if(d[e]){var f=a;cc(function(){f.re(d[e])})}if(a.Ob===a.Ud){a.Db&&(clearTimeout(a.Db),a.Db(),a.Db=null);break}a.Ob++}};var zb=\"websocket\",Ab=\"long_polling\";var Uf=null,Uf=require(\"faye-websocket\").Client;function Vf(a,b,c,d){this.Vd=a;this.f=Qb(this.Vd);this.frames=this.wc=null;this.nb=this.ob=this.De=0;this.Ua=Mf(b);a={v:\"5\"};c&&(a.s=c);d&&(a.ls=d);this.Wd=yb(b,zb,a)}var Wf;\nVf.prototype.open=function(a,b){this.gb=b;this.Xf=a;this.f(\"Websocket connecting to \"+this.Wd);this.tc=!1;ub.set(\"previous_websocket_failure\",!0);try{var c={headers:{\"User-Agent\":\"Firebase/5/\"+firebase.SDK_VERSION+\"/\"+process.platform+\"/Node\"}},d=process.env,e=0==this.Wd.indexOf(\"wss://\")?d.HTTPS_PROXY||d.https_proxy:d.HTTP_PROXY||d.http_proxy;e&&(c.proxy={origin:e});this.Ha=new Uf(this.Wd,[],c)}catch(f){this.f(\"Error instantiating WebSocket.\");(c=f.message||f.data)&&this.f(c);this.ab();return}var g=\nthis;this.Ha.onopen=function(){g.f(\"Websocket connected.\");g.tc=!0};this.Ha.onclose=function(){g.f(\"Websocket connection was disconnected.\");g.Ha=null;g.ab()};this.Ha.onmessage=function(a){if(null!==g.Ha)if(a=a.data,g.nb+=a.length,Jf(g.Ua,\"bytes_received\",a.length),Xf(g),null!==g.frames)Yf(g,a);else{a:{D(null===g.frames,\"We already have a frame buffer\");if(6>=a.length){var b=Number(a);if(!isNaN(b)){g.De=b;g.frames=[];a=null;break a}}g.De=1;g.frames=[]}null!==a&&Yf(g,a)}};this.Ha.onerror=function(a){g.f(\"WebSocket error.  Closing connection.\");\n(a=a.message||a.data)&&g.f(a);g.ab()}};Vf.prototype.start=function(){};Vf.isAvailable=function(){var a=!1;if(\"undefined\"!==typeof navigator&&navigator.userAgent){var b=navigator.userAgent.match(/Android ([0-9]{0,}\\.[0-9]{0,})/);b&&1<b.length&&4.4>parseFloat(b[1])&&(a=!0)}return!a&&null!==Uf&&!Wf};Vf.responsesRequiredToBeHealthy=2;Vf.healthyTimeout=3E4;h=Vf.prototype;h.pd=function(){ub.remove(\"previous_websocket_failure\")};\nfunction Yf(a,b){a.frames.push(b);if(a.frames.length==a.De){var c=a.frames.join(\"\");a.frames=null;c=ib(c);a.Xf(c)}}h.send=function(a){Xf(this);a=x(a);this.ob+=a.length;Jf(this.Ua,\"bytes_sent\",a.length);a=Zb(a,16384);1<a.length&&Zf(this,String(a.length));for(var b=0;b<a.length;b++)Zf(this,a[b])};h.Qc=function(){this.yb=!0;this.wc&&(clearInterval(this.wc),this.wc=null);this.Ha&&(this.Ha.close(),this.Ha=null)};\nh.ab=function(){this.yb||(this.f(\"WebSocket is closing itself\"),this.Qc(),this.gb&&(this.gb(this.tc),this.gb=null))};h.close=function(){this.yb||(this.f(\"WebSocket is being closed\"),this.Qc())};function Xf(a){clearInterval(a.wc);a.wc=setInterval(function(){a.Ha&&Zf(a,\"0\");Xf(a)},Math.floor(45E3))}function Zf(a,b){try{a.Ha.send(b)}catch(c){a.f(\"Exception thrown from WebSocket.send():\",c.message||c.data,\"Closing connection.\"),setTimeout(q(a.ab,a),0)}};function $f(a,b,c,d){this.Vd=a;this.f=Qb(a);this.gc=b;this.nb=this.ob=0;this.Ua=Mf(b);this.sf=c;this.tc=!1;this.Ab=d;this.Vc=function(a){return yb(b,Ab,a)}}var ag,bg;\n$f.prototype.open=function(a,b){this.Ke=0;this.ia=b;this.af=new Rf(a);this.yb=!1;var c=this;this.qb=setTimeout(function(){c.f(\"Timed out trying to connect.\");c.ab();c.qb=null},Math.floor(3E4));Vb(function(){if(!c.yb){c.Sa=new cg(function(a,b,d,k,m){dg(c,arguments);if(c.Sa)if(c.qb&&(clearTimeout(c.qb),c.qb=null),c.tc=!0,\"start\"==a)c.id=b,c.fg=d;else if(\"close\"===a)b?(c.Sa.of=!1,Sf(c.af,b,function(){c.ab()})):c.ab();else throw Error(\"Unrecognized command received: \"+a);},function(a,b){dg(c,arguments);\nTf(c.af,a,b)},function(){c.ab()},c.Vc);var a={start:\"t\"};a.ser=Math.floor(1E8*Math.random());c.Sa.sg&&(a.cb=c.Sa.sg);a.v=\"5\";c.sf&&(a.s=c.sf);c.Ab&&(a.ls=c.Ab);a=c.Vc(a);c.f(\"Connecting via long-poll to \"+a);eg(c.Sa,a,function(){})}})};$f.prototype.start=function(){var a=this.Sa,b=this.fg;a.me=this.id;a.$e=b;for(a.Qd=!0;fg(a););};\n$f.isAvailable=function(){return ag||!bg&&\"undefined\"!==typeof document&&null!=document.createElement&&!(\"object\"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!(\"object\"===typeof Windows&&\"object\"===typeof Windows.ug)&&!1};h=$f.prototype;h.pd=function(){};h.Qc=function(){this.yb=!0;this.Sa&&(this.Sa.close(),this.Sa=null);this.Ze&&(document.body.removeChild(this.Ze),this.Ze=null);this.qb&&(clearTimeout(this.qb),this.qb=null)};\nh.ab=function(){this.yb||(this.f(\"Longpoll is closing itself\"),this.Qc(),this.ia&&(this.ia(this.tc),this.ia=null))};h.close=function(){this.yb||(this.f(\"Longpoll is being closed.\"),this.Qc())};h.send=function(a){a=x(a);this.ob+=a.length;Jf(this.Ua,\"bytes_sent\",a.length);a=jb(a);a=Za(a,!0);a=Zb(a,1840);for(var b=0;b<a.length;b++){var c=this.Sa;c.Nc.push({lg:this.Ke,rg:a.length,Me:a[b]});c.Qd&&fg(c);this.Ke++}};function dg(a,b){var c=x(b).length;a.nb+=c;Jf(a.Ua,\"bytes_received\",c)}\nfunction cg(a,b,c,d){this.Vc=d;this.gb=c;this.te=new Dc;this.Nc=[];this.Xd=Math.floor(1E8*Math.random());this.of=!0;this.Ef=a;this.Yf=b}cg.prototype.close=function(){this.Qd=!1;if(this.rd){this.rd.wg.body.innerHTML=\"\";var a=this;setTimeout(function(){null!==a.rd&&(document.body.removeChild(a.rd),a.rd=null)},Math.floor(0))}if(this.me){var b={disconn:\"t\"};b.id=this.me;b.pw=this.$e;b=this.Vc(b);gg(b)}if(b=this.gb)this.gb=null,b()};\nfunction fg(a){if(a.Qd&&a.of&&a.te.count()<(0<a.Nc.length?2:1)){a.Xd++;var b={};b.id=a.me;b.pw=a.$e;b.ser=a.Xd;for(var b=a.Vc(b),c=\"\",d=0;0<a.Nc.length;)if(1870>=a.Nc[0].Me.length+30+c.length){var e=a.Nc.shift(),c=c+\"&seg\"+d+\"=\"+e.lg+\"&ts\"+d+\"=\"+e.rg+\"&d\"+d+\"=\"+e.Me;d++}else break;hg(a,b+c,a.Xd);return!0}return!1}function hg(a,b,c){function d(){a.te.remove(c);fg(a)}a.te.add(c,1);var e=setTimeout(d,Math.floor(25E3));eg(a,b,function(){clearTimeout(e);d()})}function eg(a,b,c){a.Hf(b,c)}var ig=null;\nfunction gg(a,b){ig||(ig=require(\"request\"));ig(a,function(c,d,e){if(c)throw\"Rest request for \"+a.url+\" failed.\";b&&b(e)})}cg.prototype.Hf=function(a,b){var c=this;gg({url:a,xg:!0},function(a){c.Kf(a);b()})};cg.prototype.Kf=function(a){eval(\"var jsonpCB = function(pLPCommand, pRTLPCB) {\"+a+\"}\");jsonpCB(this.Ef,this.Yf)};function jg(a){kg(this,a)}var lg=[$f,Vf];function kg(a,b){var c=Vf&&Vf.isAvailable(),d=c&&!(ub.We||!0===ub.get(\"previous_websocket_failure\"));b.tg&&(c||J(\"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\"),d=!0);if(d)a.Tc=[Vf];else{var e=a.Tc=[];$b(lg,function(a,b){b&&b.isAvailable()&&e.push(b)})}}function mg(a){if(0<a.Tc.length)return a.Tc[0];throw Error(\"No transports available\");};function ng(a,b,c,d,e,f,g){this.id=a;this.f=Qb(\"c:\"+this.id+\":\");this.re=c;this.Ic=d;this.ia=e;this.qe=f;this.L=b;this.yd=[];this.Ie=0;this.rf=new jg(b);this.Ta=0;this.Ab=g;this.f(\"Connection created\");og(this)}\nfunction og(a){var b=mg(a.rf);a.I=new b(\"c:\"+a.id+\":\"+a.Ie++,a.L,void 0,a.Ab);a.ve=b.responsesRequiredToBeHealthy||0;var c=pg(a,a.I),d=qg(a,a.I);a.Uc=a.I;a.Oc=a.I;a.D=null;a.zb=!1;setTimeout(function(){a.I&&a.I.open(c,d)},Math.floor(0));b=b.healthyTimeout||0;0<b&&(a.jd=ec(function(){a.jd=null;a.zb||(a.I&&102400<a.I.nb?(a.f(\"Connection exceeded healthy timeout but has received \"+a.I.nb+\" bytes.  Marking connection healthy.\"),a.zb=!0,a.I.pd()):a.I&&10240<a.I.ob?a.f(\"Connection exceeded healthy timeout but has sent \"+\na.I.ob+\" bytes.  Leaving connection alive.\"):(a.f(\"Closing unhealthy connection after timeout.\"),a.close()))},Math.floor(b)))}function qg(a,b){return function(c){b===a.I?(a.I=null,c||0!==a.Ta?1===a.Ta&&a.f(\"Realtime connection lost.\"):(a.f(\"Realtime connection failed.\"),\"s-\"===a.L.Za.substr(0,2)&&(ub.remove(\"host:\"+a.L.host),a.L.Za=a.L.host)),a.close()):b===a.D?(a.f(\"Secondary connection lost.\"),c=a.D,a.D=null,a.Uc!==c&&a.Oc!==c||a.close()):a.f(\"closing an old connection\")}}\nfunction pg(a,b){return function(c){if(2!=a.Ta)if(b===a.Oc){var d=Xb(\"t\",c);c=Xb(\"d\",c);if(\"c\"==d){if(d=Xb(\"t\",c),\"d\"in c)if(c=c.d,\"h\"===d){var d=c.ts,e=c.v,f=c.h;a.pf=c.s;xb(a.L,f);0==a.Ta&&(a.I.start(),rg(a,a.I,d),\"5\"!==e&&J(\"Protocol version mismatch detected\"),c=a.rf,(c=1<c.Tc.length?c.Tc[1]:null)&&sg(a,c))}else if(\"n\"===d){a.f(\"recvd end transmission on primary\");a.Oc=a.D;for(c=0;c<a.yd.length;++c)a.ud(a.yd[c]);a.yd=[];tg(a)}else\"s\"===d?(a.f(\"Connection shutdown command received. Shutting down...\"),\na.qe&&(a.qe(c),a.qe=null),a.ia=null,a.close()):\"r\"===d?(a.f(\"Reset packet received.  New host: \"+c),xb(a.L,c),1===a.Ta?a.close():(ug(a),og(a))):\"e\"===d?Rb(\"Server Error: \"+c):\"o\"===d?(a.f(\"got pong on primary.\"),vg(a),wg(a)):Rb(\"Unknown control packet command: \"+d)}else\"d\"==d&&a.ud(c)}else if(b===a.D)if(d=Xb(\"t\",c),c=Xb(\"d\",c),\"c\"==d)\"t\"in c&&(c=c.t,\"a\"===c?xg(a):\"r\"===c?(a.f(\"Got a reset on secondary, closing it\"),a.D.close(),a.Uc!==a.D&&a.Oc!==a.D||a.close()):\"o\"===c&&(a.f(\"got pong on secondary.\"),\na.nf--,xg(a)));else if(\"d\"==d)a.yd.push(c);else throw Error(\"Unknown protocol layer: \"+d);else a.f(\"message on old connection\")}}ng.prototype.ua=function(a){yg(this,{t:\"d\",d:a})};function tg(a){a.Uc===a.D&&a.Oc===a.D&&(a.f(\"cleaning up and promoting a connection: \"+a.D.Vd),a.I=a.D,a.D=null)}\nfunction xg(a){0>=a.nf?(a.f(\"Secondary connection is healthy.\"),a.zb=!0,a.D.pd(),a.D.start(),a.f(\"sending client ack on secondary\"),a.D.send({t:\"c\",d:{t:\"a\",d:{}}}),a.f(\"Ending transmission on primary\"),a.I.send({t:\"c\",d:{t:\"n\",d:{}}}),a.Uc=a.D,tg(a)):(a.f(\"sending ping on secondary.\"),a.D.send({t:\"c\",d:{t:\"p\",d:{}}}))}ng.prototype.ud=function(a){vg(this);this.re(a)};function vg(a){a.zb||(a.ve--,0>=a.ve&&(a.f(\"Primary connection is healthy.\"),a.zb=!0,a.I.pd()))}\nfunction sg(a,b){a.D=new b(\"c:\"+a.id+\":\"+a.Ie++,a.L,a.pf);a.nf=b.responsesRequiredToBeHealthy||0;a.D.open(pg(a,a.D),qg(a,a.D));ec(function(){a.D&&(a.f(\"Timed out trying to upgrade.\"),a.D.close())},Math.floor(6E4))}function rg(a,b,c){a.f(\"Realtime connection established.\");a.I=b;a.Ta=1;a.Ic&&(a.Ic(c,a.pf),a.Ic=null);0===a.ve?(a.f(\"Primary connection is healthy.\"),a.zb=!0):ec(function(){wg(a)},Math.floor(5E3))}\nfunction wg(a){a.zb||1!==a.Ta||(a.f(\"sending ping on primary.\"),yg(a,{t:\"c\",d:{t:\"p\",d:{}}}))}function yg(a,b){if(1!==a.Ta)throw\"Connection is not connected\";a.Uc.send(b)}ng.prototype.close=function(){2!==this.Ta&&(this.f(\"Closing realtime connection.\"),this.Ta=2,ug(this),this.ia&&(this.ia(),this.ia=null))};function ug(a){a.f(\"Shutting down all connections\");a.I&&(a.I.close(),a.I=null);a.D&&(a.D.close(),a.D=null);a.jd&&(clearTimeout(a.jd),a.jd=null)};function zg(a,b,c,d,e,f){this.id=Ag++;this.f=Qb(\"p:\"+this.id+\":\");this.nd={};this.$={};this.pa=[];this.Lc=0;this.Hc=[];this.ma=!1;this.Ra=1E3;this.qd=3E5;this.Eb=b;this.Gc=c;this.se=d;this.L=a;this.mb=this.Ea=this.Ab=this.xe=null;this.Xc=e;this.ae=!1;this.he=0;this.Rd=f;this.sb=null;this.Kb=!1;this.Ed={};this.kg=0;this.Oe=!0;this.xc=this.je=null;Bg(this,0);Jc.Tb().dc(\"visible\",this.$f,this);-1===a.host.indexOf(\"fblocal\")&&Ic.Tb().dc(\"online\",this.Zf,this)}var Ag=0,Cg=0;h=zg.prototype;\nh.ua=function(a,b,c){var d=++this.kg;a={r:d,a:a,b:b};this.f(x(a));D(this.ma,\"sendRequest call when we're not connected not allowed.\");this.Ea.ua(a);c&&(this.Ed[d]=c)};h.Xe=function(a,b,c,d){var e=a.ja(),f=a.path.toString();this.f(\"Listen called for \"+f+\" \"+e);this.$[f]=this.$[f]||{};D(nf(a.m)||!T(a.m),\"listen() called for non-default but complete query\");D(!this.$[f][e],\"listen() called twice for same path/queryId.\");a={G:d,hd:b,gg:a,tag:c};this.$[f][e]=a;this.ma&&Dg(this,a)};\nfunction Dg(a,b){var c=b.gg,d=c.path.toString(),e=c.ja();a.f(\"Listen on \"+d+\" for \"+e);var f={p:d};b.tag&&(f.q=mf(c.m),f.t=b.tag);f.h=b.hd();a.ua(\"q\",f,function(f){var k=f.d,m=f.s;if(k&&\"object\"===typeof k&&bb(k,\"w\")){var l=w(k,\"w\");ea(l)&&0<=xa(l,\"no_index\")&&J(\"Using an unspecified index. Consider adding \"+('\".indexOn\": \"'+c.m.g.toString()+'\"')+\" at \"+c.path.toString()+\" to your security rules for better performance\")}(a.$[d]&&a.$[d][e])===b&&(a.f(\"listen response\",f),\"ok\"!==m&&Eg(a,d,e),b.G&&b.G(m,\nk))})}h.hf=function(a){this.mb=a;this.f(\"Auth token refreshed\");this.mb?Fg(this):this.ma&&this.ua(\"unauth\",{},function(){});if(a&&40===a.length||hc(a))this.f(\"Admin auth credential detected.  Reducing max reconnect time.\"),this.qd=3E4};function Fg(a){if(a.ma&&a.mb){var b=a.mb,c=gc(b)?\"auth\":\"gauth\",d={cred:b};null===a.Rd?d.noauth=!0:\"object\"===typeof a.Rd&&(d.authvar=a.Rd);a.ua(c,d,function(c){var d=c.s;c=c.d||\"error\";a.mb===b&&(\"ok\"===d?a.he=0:Gg(a,d,c))})}}\nh.tf=function(a,b){var c=a.path.toString(),d=a.ja();this.f(\"Unlisten called for \"+c+\" \"+d);D(nf(a.m)||!T(a.m),\"unlisten() called for non-default but complete query\");if(Eg(this,c,d)&&this.ma){var e=mf(a.m);this.f(\"Unlisten on \"+c+\" for \"+d);c={p:c};b&&(c.q=e,c.t=b);this.ua(\"n\",c)}};h.pe=function(a,b,c){this.ma?Hg(this,\"o\",a,b,c):this.Hc.push({ue:a,action:\"o\",data:b,G:c})};h.bf=function(a,b,c){this.ma?Hg(this,\"om\",a,b,c):this.Hc.push({ue:a,action:\"om\",data:b,G:c})};\nh.vd=function(a,b){this.ma?Hg(this,\"oc\",a,null,b):this.Hc.push({ue:a,action:\"oc\",data:null,G:b})};function Hg(a,b,c,d,e){c={p:c,d:d};a.f(\"onDisconnect \"+b,c);a.ua(b,c,function(a){e&&setTimeout(function(){e(a.s,a.d)},Math.floor(0))})}h.put=function(a,b,c,d){Ig(this,\"p\",a,b,c,d)};h.Ye=function(a,b,c,d){Ig(this,\"m\",a,b,c,d)};function Ig(a,b,c,d,e,f){d={p:c,d:d};n(f)&&(d.h=f);a.pa.push({action:b,kf:d,G:e});a.Lc++;b=a.pa.length-1;a.ma?Jg(a,b):a.f(\"Buffering put: \"+c)}\nfunction Jg(a,b){var c=a.pa[b].action,d=a.pa[b].kf,e=a.pa[b].G;a.pa[b].hg=a.ma;a.ua(c,d,function(d){a.f(c+\" response\",d);delete a.pa[b];a.Lc--;0===a.Lc&&(a.pa=[]);e&&e(d.s,d.d)})}h.we=function(a){this.ma&&(a={c:a},this.f(\"reportStats\",a),this.ua(\"s\",a,function(a){\"ok\"!==a.s&&this.f(\"reportStats\",\"Error sending stats: \"+a.d)}))};\nh.ud=function(a){if(\"r\"in a){this.f(\"from server: \"+x(a));var b=a.r,c=this.Ed[b];c&&(delete this.Ed[b],c(a.b))}else{if(\"error\"in a)throw\"A server-side error has occurred: \"+a.error;\"a\"in a&&(b=a.a,a=a.b,this.f(\"handleServerMessage\",b,a),\"d\"===b?this.Eb(a.p,a.d,!1,a.t):\"m\"===b?this.Eb(a.p,a.d,!0,a.t):\"c\"===b?Kg(this,a.p,a.q):\"ac\"===b?Gg(this,a.s,a.d):\"sd\"===b?this.xe?this.xe(a):\"msg\"in a&&\"undefined\"!==typeof console&&console.log(\"FIREBASE: \"+a.msg.replace(\"\\n\",\"\\nFIREBASE: \")):Rb(\"Unrecognized action received from server: \"+\nx(b)+\"\\nAre you using the latest client?\"))}};h.Ic=function(a,b){this.f(\"connection ready\");this.ma=!0;this.xc=(new Date).getTime();this.se({serverTimeOffset:a-(new Date).getTime()});this.Ab=b;if(this.Oe){var c={};c[\"sdk.node.\"+firebase.SDK_VERSION.replace(/\\./g,\"-\")]=1;mb()?c[\"framework.cordova\"]=1:\"object\"===typeof navigator&&\"ReactNative\"===navigator.product&&(c[\"framework.reactnative\"]=1);this.we(c)}Lg(this);this.Oe=!1;this.Gc(!0)};\nfunction Bg(a,b){D(!a.Ea,\"Scheduling a connect when we're already connected/ing?\");a.sb&&clearTimeout(a.sb);a.sb=setTimeout(function(){a.sb=null;Mg(a)},Math.floor(b))}h.$f=function(a){a&&!this.Kb&&this.Ra===this.qd&&(this.f(\"Window became visible.  Reducing delay.\"),this.Ra=1E3,this.Ea||Bg(this,0));this.Kb=a};h.Zf=function(a){a?(this.f(\"Browser went online.\"),this.Ra=1E3,this.Ea||Bg(this,0)):(this.f(\"Browser went offline.  Killing connection.\"),this.Ea&&this.Ea.close())};\nh.cf=function(){this.f(\"data client disconnected\");this.ma=!1;this.Ea=null;for(var a=0;a<this.pa.length;a++){var b=this.pa[a];b&&\"h\"in b.kf&&b.hg&&(b.G&&b.G(\"disconnect\"),delete this.pa[a],this.Lc--)}0===this.Lc&&(this.pa=[]);this.Ed={};Ng(this)&&(this.Kb?this.xc&&(3E4<(new Date).getTime()-this.xc&&(this.Ra=1E3),this.xc=null):(this.f(\"Window isn't visible.  Delaying reconnect.\"),this.Ra=this.qd,this.je=(new Date).getTime()),a=Math.max(0,this.Ra-((new Date).getTime()-this.je)),a*=Math.random(),this.f(\"Trying to reconnect in \"+\na+\"ms\"),Bg(this,a),this.Ra=Math.min(this.qd,1.3*this.Ra));this.Gc(!1)};\nfunction Mg(a){if(Ng(a)){a.f(\"Making a connection attempt\");a.je=(new Date).getTime();a.xc=null;var b=q(a.ud,a),c=q(a.Ic,a),d=q(a.cf,a),e=a.id+\":\"+Cg++,f=a.Ab,g=!1,k=null,m=function(){k?k.close():(g=!0,d())};a.Ea={close:m,ua:function(a){D(k,\"sendRequest call when we're not connected not allowed.\");k.ua(a)}};var l=a.ae;a.ae=!1;a.Xc.getToken(l).then(function(l){g?I(\"getToken() completed but was canceled\"):(I(\"getToken() completed. Creating connection.\"),a.mb=l&&l.accessToken,k=new ng(e,a.L,b,c,d,function(b){J(b+\n\" (\"+a.L.toString()+\")\");a.$a(\"server_kill\")},f))}).then(null,function(b){a.f(\"Failed to get token: \"+b);g||m()})}}h.$a=function(a){I(\"Interrupting connection for reason: \"+a);this.nd[a]=!0;this.Ea?this.Ea.close():(this.sb&&(clearTimeout(this.sb),this.sb=null),this.ma&&this.cf())};h.hc=function(a){I(\"Resuming connection for reason: \"+a);delete this.nd[a];Ra(this.nd)&&(this.Ra=1E3,this.Ea||Bg(this,0))};\nfunction Kg(a,b,c){c=c?Aa(c,function(a){return Yb(a)}).join(\"$\"):\"default\";(a=Eg(a,b,c))&&a.G&&a.G(\"permission_denied\")}function Eg(a,b,c){b=(new E(b)).toString();var d;n(a.$[b])?(d=a.$[b][c],delete a.$[b][c],0===Ka(a.$[b])&&delete a.$[b]):d=void 0;return d}\nfunction Gg(a,b,c){I(\"Auth token revoked: \"+b+\"/\"+c);a.mb=null;a.ae=!0;a.Ea.close();if(\"invalid_token\"===b||\"permission_denied\"===b)a.he++,3<=a.he&&(a.Ra=3E4,a=a.Xc,b='Provided authentication credentials for the app named \"'+a.lc.name+'\" are invalid. This usually indicates your app was not initialized correctly. ',b=\"credential\"in a.lc.options?b+'Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':\"serviceAccount\"in\na.lc.options?b+'Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':b+'Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',J(b))}\nfunction Lg(a){Fg(a);v(a.$,function(b){v(b,function(b){Dg(a,b)})});for(var b=0;b<a.pa.length;b++)a.pa[b]&&Jg(a,b);for(;a.Hc.length;)b=a.Hc.shift(),Hg(a,b.action,b.ue,b.data,b.G)}function Ng(a){var b;b=Ic.Tb().ec;return Ra(a.nd)&&b};function Og(a){a instanceof Pg||Sb(\"Don't call new Database() directly - please use firebase.database().\");this.ta=a;this.ba=new U(a,Q);this.INTERNAL=new Qg(this)}var Rg={TIMESTAMP:{\".sv\":\"timestamp\"}};h=Og.prototype;h.app=null;h.gf=function(a){Sg(this,\"ref\");z(\"database.ref\",0,1,arguments.length);return n(a)?this.ba.n(a):this.ba};\nh.ig=function(a){Sg(this,\"database.refFromURL\");z(\"database.refFromURL\",1,1,arguments.length);var b=Tb(a);Ud(\"database.refFromURL\",b);var c=b.gc;c.host!==this.ta.L.host&&Sb(\"database.refFromURL: Host name does not match the current database: (found \"+c.host+\" but expected \"+this.ta.L.host+\")\");return this.gf(b.path.toString())};function Sg(a,b){null===a.ta&&Sb(\"Cannot call \"+b+\" on a deleted database.\")}h.Rf=function(){z(\"database.goOffline\",0,0,arguments.length);Sg(this,\"goOffline\");this.ta.$a()};\nh.Sf=function(){z(\"database.goOnline\",0,0,arguments.length);Sg(this,\"goOnline\");this.ta.hc()};Object.defineProperty(Og.prototype,\"app\",{get:function(){return this.ta.app}});function Qg(a){this.Xa=a}Qg.prototype.delete=function(){Sg(this.Xa,\"delete\");var a=Tg.Tb(),b=this.Xa.ta;w(a.jb,b.app.name)!==b&&Sb(\"Database \"+b.app.name+\" has already been deleted.\");b.$a();delete a.jb[b.app.name];this.Xa.ta=null;this.Xa.ba=null;this.Xa=this.Xa.INTERNAL=null;return firebase.Promise.resolve()};\nOg.prototype.ref=Og.prototype.gf;Og.prototype.refFromURL=Og.prototype.ig;Og.prototype.goOnline=Og.prototype.Sf;Og.prototype.goOffline=Og.prototype.Rf;Qg.prototype[\"delete\"]=Qg.prototype.delete;function V(a,b,c){this.A=a;this.V=b;this.g=c}V.prototype.H=function(){z(\"Firebase.DataSnapshot.val\",0,0,arguments.length);return this.A.H()};V.prototype.val=V.prototype.H;V.prototype.Zd=function(){z(\"Firebase.DataSnapshot.exportVal\",0,0,arguments.length);return this.A.H(!0)};V.prototype.exportVal=V.prototype.Zd;V.prototype.toJSON=function(){z(\"Firebase.DataSnapshot.toJSON\",0,1,arguments.length);return this.Zd()};V.prototype.toJSON=V.prototype.toJSON;\nV.prototype.Nf=function(){z(\"Firebase.DataSnapshot.exists\",0,0,arguments.length);return!this.A.e()};V.prototype.exists=V.prototype.Nf;V.prototype.n=function(a){z(\"Firebase.DataSnapshot.child\",0,1,arguments.length);ga(a)&&(a=String(a));Sd(\"Firebase.DataSnapshot.child\",a);var b=new E(a),c=this.V.n(b);return new V(this.A.P(b),c,H)};V.prototype.child=V.prototype.n;\nV.prototype.Da=function(a){z(\"Firebase.DataSnapshot.hasChild\",1,1,arguments.length);Sd(\"Firebase.DataSnapshot.hasChild\",a);var b=new E(a);return!this.A.P(b).e()};V.prototype.hasChild=V.prototype.Da;V.prototype.C=function(){z(\"Firebase.DataSnapshot.getPriority\",0,0,arguments.length);return this.A.C().H()};V.prototype.getPriority=V.prototype.C;\nV.prototype.forEach=function(a){z(\"Firebase.DataSnapshot.forEach\",1,1,arguments.length);B(\"Firebase.DataSnapshot.forEach\",1,a,!1);if(this.A.J())return!1;var b=this;return!!this.A.O(this.g,function(c,d){return a(new V(d,b.V.n(c),H))})};V.prototype.forEach=V.prototype.forEach;V.prototype.gd=function(){z(\"Firebase.DataSnapshot.hasChildren\",0,0,arguments.length);return this.A.J()?!1:!this.A.e()};V.prototype.hasChildren=V.prototype.gd;\nV.prototype.getKey=function(){z(\"Firebase.DataSnapshot.key\",0,0,arguments.length);return this.V.getKey()};dc(V.prototype,\"key\",V.prototype.getKey);V.prototype.Cb=function(){z(\"Firebase.DataSnapshot.numChildren\",0,0,arguments.length);return this.A.Cb()};V.prototype.numChildren=V.prototype.Cb;V.prototype.ub=function(){z(\"Firebase.DataSnapshot.ref\",0,0,arguments.length);return this.V};dc(V.prototype,\"ref\",V.prototype.ub);function Ug(a,b,c){this.Nb=a;this.pb=b;this.rb=c||null}h=Ug.prototype;h.lf=function(a){return\"value\"===a};h.createEvent=function(a,b){var c=b.m.g;return new Te(\"value\",this,new V(a.Ia,b.ub(),c))};h.Rb=function(a){var b=this.rb;if(\"cancel\"===a.de()){D(this.pb,\"Raising a cancel event on a listener with no cancel callback\");var c=this.pb;return function(){c.call(b,a.error)}}var d=this.Nb;return function(){d.call(b,a.Jd)}};h.Je=function(a,b){return this.pb?new Ue(this,a,b):null};\nh.matches=function(a){return a instanceof Ug?a.Nb&&this.Nb?a.Nb===this.Nb&&a.rb===this.rb:!0:!1};h.Ue=function(){return null!==this.Nb};function Vg(a,b,c){this.ga=a;this.pb=b;this.rb=c}h=Vg.prototype;h.lf=function(a){a=\"children_added\"===a?\"child_added\":a;return(\"children_removed\"===a?\"child_removed\":a)in this.ga};h.Je=function(a,b){return this.pb?new Ue(this,a,b):null};\nh.createEvent=function(a,b){D(null!=a.Wa,\"Child events should have a childName.\");var c=b.ub().n(a.Wa);return new Te(a.type,this,new V(a.Ia,c,b.m.g),a.Bd)};h.Rb=function(a){var b=this.rb;if(\"cancel\"===a.de()){D(this.pb,\"Raising a cancel event on a listener with no cancel callback\");var c=this.pb;return function(){c.call(b,a.error)}}var d=this.ga[a.ed];return function(){d.call(b,a.Jd,a.Bd)}};\nh.matches=function(a){if(a instanceof Vg){if(!this.ga||!a.ga)return!0;if(this.rb===a.rb){var b=Ka(a.ga);if(b===Ka(this.ga)){if(1===b){var b=La(a.ga),c=La(this.ga);return c===b&&(!a.ga[b]||!this.ga[c]||a.ga[b]===this.ga[c])}return Ja(this.ga,function(b,c){return a.ga[c]===b})}}}return!1};h.Ue=function(){return null!==this.ga};function Wg(){this.za={}}h=Wg.prototype;h.e=function(){return Ra(this.za)};h.bb=function(a,b,c){var d=a.source.Fb;if(null!==d)return d=w(this.za,d),D(null!=d,\"SyncTree gave us an op for an invalid query.\"),d.bb(a,b,c);var e=[];v(this.za,function(d){e=e.concat(d.bb(a,b,c))});return e};h.Lb=function(a,b,c,d,e){var f=a.ja(),g=w(this.za,f);if(!g){var g=c.Aa(e?d:null),k=!1;g?k=!0:(g=d instanceof O?c.oc(d):L,k=!1);g=new Me(a,new le(new ge(g,k,!1),new ge(d,e,!1)));this.za[f]=g}g.Lb(b);return Se(g,b)};\nh.ib=function(a,b,c){var d=a.ja(),e=[],f=[],g=null!=Xg(this);if(\"default\"===d){var k=this;v(this.za,function(a,d){f=f.concat(a.ib(b,c));a.e()&&(delete k.za[d],T(a.V.m)||e.push(a.V))})}else{var m=w(this.za,d);m&&(f=f.concat(m.ib(b,c)),m.e()&&(delete this.za[d],T(m.V.m)||e.push(m.V)))}g&&null==Xg(this)&&e.push(new U(a.u,a.path));return{jg:e,Mf:f}};function Yg(a){return za(Ma(a.za),function(a){return!T(a.V.m)})}h.fb=function(a){var b=null;v(this.za,function(c){b=b||c.fb(a)});return b};\nfunction Zg(a,b){if(T(b.m))return Xg(a);var c=b.ja();return w(a.za,c)}function Xg(a){return Qa(a.za,function(a){return T(a.V.m)})||null};function $g(a){this.wa=R;this.hb=new Af;this.Be={};this.fc={};this.zc=a}function ah(a,b,c,d,e){var f=a.hb,g=e;D(d>f.yc,\"Stacking an older write on top of newer ones\");n(g)||(g=!0);f.la.push({path:b,Fa:c,Wc:d,visible:g});g&&(f.S=rf(f.S,b,c));f.yc=d;return e?bh(a,new $d(ce,b,c)):[]}function ch(a,b,c,d){var e=a.hb;D(d>e.yc,\"Stacking an older merge on top of newer ones\");e.la.push({path:b,children:c,Wc:d,visible:!0});e.S=sf(e.S,b,c);e.yc=d;c=ud(c);return bh(a,new Yd(ce,b,c))}\nfunction dh(a,b,c){c=c||!1;var d=Bf(a.hb,b);if(a.hb.Cd(b)){var e=R;null!=d.Fa?e=e.set(Q,!0):cb(d.children,function(a,b){e=e.set(new E(a),b)});return bh(a,new ae(d.path,e,c))}return[]}function eh(a,b,c){c=ud(c);return bh(a,new Yd(fe,b,c))}function fh(a,b,c,d){d=gh(a,d);if(null!=d){var e=hh(d);d=e.path;e=e.Fb;b=P(d,b);c=new $d(new ee(!1,!0,e,!0),b,c);return ih(a,d,c)}return[]}\nfunction jh(a,b,c,d){if(d=gh(a,d)){var e=hh(d);d=e.path;e=e.Fb;b=P(d,b);c=ud(c);c=new Yd(new ee(!1,!0,e,!0),b,c);return ih(a,d,c)}return[]}\n$g.prototype.Lb=function(a,b){var c=a.path,d=null,e=!1;Cd(this.wa,c,function(a,b){var f=P(a,c);d=d||b.fb(f);e=e||null!=Xg(b)});var f=this.wa.get(c);f?(e=e||null!=Xg(f),d=d||f.fb(Q)):(f=new Wg,this.wa=this.wa.set(c,f));var g;null!=d?g=!0:(g=!1,d=L,Gd(this.wa.subtree(c),function(a,b){var c=b.fb(Q);c&&(d=d.T(a,c))}));var k=null!=Zg(f,a);if(!k&&!T(a.m)){var m=kh(a);D(!(m in this.fc),\"View does not exist, but we have a tag\");var l=lh++;this.fc[m]=l;this.Be[\"_\"+l]=m}g=f.Lb(a,b,new Ff(c,this.hb),d,g);k||\ne||(f=Zg(f,a),g=g.concat(mh(this,a,f)));return g};\n$g.prototype.ib=function(a,b,c){var d=a.path,e=this.wa.get(d),f=[];if(e&&(\"default\"===a.ja()||null!=Zg(e,a))){f=e.ib(a,b,c);e.e()&&(this.wa=this.wa.remove(d));e=f.jg;f=f.Mf;b=-1!==Ea(e,function(a){return T(a.m)});var g=Ad(this.wa,d,function(a,b){return null!=Xg(b)});if(b&&!g&&(d=this.wa.subtree(d),!d.e()))for(var d=nh(d),k=0;k<d.length;++k){var m=d[k],l=m.V,m=oh(this,m);this.zc.ye(ph(l),qh(this,l),m.hd,m.G)}if(!g&&0<e.length&&!c)if(b)this.zc.Ld(ph(a),null);else{var r=this;ya(e,function(a){a.ja();\nvar b=r.fc[kh(a)];r.zc.Ld(ph(a),b)})}rh(this,e)}return f};$g.prototype.Aa=function(a,b){var c=this.hb,d=Ad(this.wa,a,function(b,c){var d=P(b,a);if(d=c.fb(d))return d});return c.Aa(a,d,b,!0)};function nh(a){return yd(a,function(a,c,d){if(c&&null!=Xg(c))return[Xg(c)];var e=[];c&&(e=Yg(c));v(d,function(a){e=e.concat(a)});return e})}function rh(a,b){for(var c=0;c<b.length;++c){var d=b[c];if(!T(d.m)){var d=kh(d),e=a.fc[d];delete a.fc[d];delete a.Be[\"_\"+e]}}}\nfunction ph(a){return T(a.m)&&!nf(a.m)?a.ub():a}function mh(a,b,c){var d=b.path,e=qh(a,b);c=oh(a,c);b=a.zc.ye(ph(b),e,c.hd,c.G);d=a.wa.subtree(d);if(e)D(null==Xg(d.value),\"If we're adding a query, it shouldn't be shadowed\");else for(e=yd(d,function(a,b,c){if(!a.e()&&b&&null!=Xg(b))return[Qe(Xg(b))];var d=[];b&&(d=d.concat(Aa(Yg(b),function(a){return a.V})));v(c,function(a){d=d.concat(a)});return d}),d=0;d<e.length;++d)c=e[d],a.zc.Ld(ph(c),qh(a,c));return b}\nfunction oh(a,b){var c=b.V,d=qh(a,c);return{hd:function(){return(b.w()||L).hash()},G:function(b){if(\"ok\"===b){if(d){var f=c.path;if(b=gh(a,d)){var g=hh(b);b=g.path;g=g.Fb;f=P(b,f);f=new Wd(new ee(!1,!0,g,!0),f);b=ih(a,b,f)}else b=[]}else b=bh(a,new Wd(fe,c.path));return b}f=\"Unknown Error\";\"too_big\"===b?f=\"The data requested exceeds the maximum size that can be accessed with a single request.\":\"permission_denied\"==b?f=\"Client doesn't have permission to access the desired data.\":\"unavailable\"==b&&\n(f=\"The service is unavailable\");f=Error(b+\" at \"+c.path.toString()+\": \"+f);f.code=b.toUpperCase();return a.ib(c,null,f)}}}function kh(a){return a.path.toString()+\"$\"+a.ja()}function hh(a){var b=a.indexOf(\"$\");D(-1!==b&&b<a.length-1,\"Bad queryKey.\");return{Fb:a.substr(b+1),path:new E(a.substr(0,b))}}function gh(a,b){var c=a.Be,d=\"_\"+b;return d in c?c[d]:void 0}function qh(a,b){var c=kh(b);return w(a.fc,c)}var lh=1;\nfunction ih(a,b,c){var d=a.wa.get(b);D(d,\"Missing sync point for query tag that we're tracking\");return d.bb(c,new Ff(b,a.hb),null)}function bh(a,b){return sh(a,b,a.wa,null,new Ff(Q,a.hb))}function sh(a,b,c,d,e){if(b.path.e())return th(a,b,c,d,e);var f=c.get(Q);null==d&&null!=f&&(d=f.fb(Q));var g=[],k=K(b.path),m=b.Jc(k);if((c=c.children.get(k))&&m)var l=d?d.Q(k):null,k=e.n(k),g=g.concat(sh(a,m,c,l,k));f&&(g=g.concat(f.bb(b,e,d)));return g}\nfunction th(a,b,c,d,e){var f=c.get(Q);null==d&&null!=f&&(d=f.fb(Q));var g=[];c.children.ha(function(c,f){var l=d?d.Q(c):null,r=e.n(c),y=b.Jc(c);y&&(g=g.concat(th(a,y,f,l,r)))});f&&(g=g.concat(f.bb(b,e,d)));return g};function Pg(a,b,c){this.app=c;var d=new yf(c);this.L=a;this.Ua=Mf(a);this.Sc=null;this.ca=new Ve;this.td=1;this.Qa=null;if(b||0<=(\"object\"===typeof window&&window.navigator&&window.navigator.userAgent||\"\").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.va=new Of(this.L,q(this.Eb,this),d),setTimeout(q(this.Gc,this,!0),0);else{b=c.options.databaseAuthVariableOverride;if(\"undefined\"!==da(b)&&null!==b){if(\"object\"!==da(b))throw Error(\"Only objects are supported for option databaseAuthVariableOverride\");\ntry{x(b)}catch(e){throw Error(\"Invalid authOverride provided: \"+e);}}this.va=this.Qa=new zg(this.L,q(this.Eb,this),q(this.Gc,this),q(this.se,this),d,b)}var f=this;zf(d,function(a){f.va.hf(a)});this.qg=Nf(a,q(function(){return new Gf(this.Ua,this.va)},this));this.jc=new Qc;this.fe=new xf;this.md=new $g({ye:function(a,b,c,d){b=[];c=f.fe.j(a.path);c.e()||(b=bh(f.md,new $d(fe,a.path,c)),setTimeout(function(){d(\"ok\")},0));return b},Ld:ba});uh(this,\"connected\",!1);this.ia=new Db;this.Xa=new Og(this);this.cd=\n0;this.ge=null;this.K=new $g({ye:function(a,b,c,d){f.va.Xe(a,c,b,function(b,c){var e=d(b,c);$e(f.ca,a.path,e)});return[]},Ld:function(a,b){f.va.tf(a,b)}})}h=Pg.prototype;h.toString=function(){return(this.L.Pc?\"https://\":\"http://\")+this.L.host};h.name=function(){return this.L.ne};function vh(a){a=a.fe.j(new E(\".info/serverTimeOffset\")).H()||0;return(new Date).getTime()+a}function wh(a){a=a={timestamp:vh(a)};a.timestamp=a.timestamp||(new Date).getTime();return a}\nh.Eb=function(a,b,c,d){this.cd++;var e=new E(a);b=this.ge?this.ge(a,b):b;a=[];d?c?(b=Ia(b,function(a){return G(a)}),a=jh(this.K,e,b,d)):(b=G(b),a=fh(this.K,e,b,d)):c?(d=Ia(b,function(a){return G(a)}),a=eh(this.K,e,d)):(d=G(b),a=bh(this.K,new $d(fe,e,d)));d=e;0<a.length&&(d=xh(this,e));$e(this.ca,d,a)};h.Gc=function(a){uh(this,\"connected\",a);!1===a&&yh(this)};h.se=function(a){var b=this;$b(a,function(a,d){uh(b,d,a)})};\nfunction uh(a,b,c){b=new E(\"/.info/\"+b);c=G(c);var d=a.fe;d.Hd=d.Hd.F(b,c);c=bh(a.md,new $d(fe,b,c));$e(a.ca,b,c)}h.Hb=function(a,b,c,d){this.f(\"set\",{path:a.toString(),value:b,zg:c});var e=wh(this);b=G(b,c);var e=Gb(b,e),f=this.td++,e=ah(this.K,a,e,f,!0);We(this.ca,e);var g=this;this.va.put(a.toString(),b.H(!0),function(b,c){var e=\"ok\"===b;e||J(\"set at \"+a+\" failed: \"+b);e=dh(g.K,f,!e);$e(g.ca,a,e);zh(d,b,c)});e=Ah(this,a);xh(this,e);$e(this.ca,e,[])};\nh.update=function(a,b,c){this.f(\"update\",{path:a.toString(),value:b});var d=!0,e=wh(this),f={};v(b,function(a,b){d=!1;var c=G(a);f[b]=Gb(c,e)});if(d)I(\"update() called with empty data.  Don't do anything.\"),zh(c,\"ok\");else{var g=this.td++,k=ch(this.K,a,f,g);We(this.ca,k);var m=this;this.va.Ye(a.toString(),b,function(b,d){var e=\"ok\"===b;e||J(\"update at \"+a+\" failed: \"+b);var e=dh(m.K,g,!e),f=a;0<e.length&&(f=xh(m,a));$e(m.ca,f,e);zh(c,b,d)});v(b,function(b,c){var d=Ah(m,a.n(c));xh(m,d)});$e(this.ca,\na,[])}};function yh(a){a.f(\"onDisconnectEvents\");var b=wh(a),c=[];Eb(Cb(a.ia,b),Q,function(b,e){c=c.concat(bh(a.K,new $d(fe,b,e)));var f=Ah(a,b);xh(a,f)});a.ia=new Db;$e(a.ca,Q,c)}h.vd=function(a,b){var c=this;this.va.vd(a.toString(),function(d,e){\"ok\"===d&&Vd(c.ia,a);zh(b,d,e)})};function Bh(a,b,c,d){var e=G(c);a.va.pe(b.toString(),e.H(!0),function(c,g){\"ok\"===c&&Fb(a.ia,b,e);zh(d,c,g)})}\nfunction Ch(a,b,c,d,e){var f=G(c,d);a.va.pe(b.toString(),f.H(!0),function(c,d){\"ok\"===c&&Fb(a.ia,b,f);zh(e,c,d)})}function Dh(a,b,c,d){var e=!0,f;for(f in c)e=!1;e?(I(\"onDisconnect().update() called with empty data.  Don't do anything.\"),zh(d,\"ok\")):a.va.bf(b.toString(),c,function(e,f){if(\"ok\"===e)for(var m in c){var l=G(c[m]);Fb(a.ia,b.n(m),l)}zh(d,e,f)})}function Eh(a,b,c){c=\".info\"===K(b.path)?a.md.Lb(b,c):a.K.Lb(b,c);Ye(a.ca,b.path,c)}h.$a=function(){this.Qa&&this.Qa.$a(\"repo_interrupt\")};\nh.hc=function(){this.Qa&&this.Qa.hc(\"repo_interrupt\")};h.ze=function(a){if(\"undefined\"!==typeof console){a?(this.Sc||(this.Sc=new Hf(this.Ua)),a=this.Sc.get()):a=this.Ua.get();var b=Ba(Na(a),function(a,b){return Math.max(b.length,a)},0),c;for(c in a){for(var d=a[c],e=c.length;e<b+2;e++)c+=\" \";console.log(c+d)}}};h.Ae=function(a){Jf(this.Ua,a);this.qg.qf[a]=!0};h.f=function(a){var b=\"\";this.Qa&&(b=this.Qa.id+\":\");I(b,arguments)};\nfunction zh(a,b,c){a&&cc(function(){if(\"ok\"==b)a(null);else{var d=(b||\"error\").toUpperCase(),e=d;c&&(e+=\": \"+c);e=Error(e);e.code=d;a(e)}})};function Fh(a,b,c,d,e){function f(){}a.f(\"transaction on \"+b);var g=new U(a,b);g.dc(\"value\",f);c={path:b,update:c,G:d,status:null,df:Ib(),Fe:e,mf:0,Nd:function(){g.Fc(\"value\",f)},Pd:null,Ba:null,$c:null,ad:null,bd:null};d=a.K.Aa(b,void 0)||L;c.$c=d;d=c.update(d.H());if(n(d)){Md(\"transaction failed: Data returned \",d,c.path);c.status=1;e=Rc(a.jc,b);var k=e.Ca()||[];k.push(c);Sc(e,k);\"object\"===typeof d&&null!==d&&bb(d,\".priority\")?(k=w(d,\".priority\"),D(Kd(k),\"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.\")):\nk=(a.K.Aa(b)||L).C().H();e=wh(a);d=G(d,k);e=Gb(d,e);c.ad=d;c.bd=e;c.Ba=a.td++;c=ah(a.K,b,e,c.Ba,c.Fe);$e(a.ca,b,c);Gh(a)}else c.Nd(),c.ad=null,c.bd=null,c.G&&(a=new V(c.$c,new U(a,c.path),H),c.G(null,!1,a))}function Gh(a,b){var c=b||a.jc;b||Hh(a,c);if(null!==c.Ca()){var d=Ih(a,c);D(0<d.length,\"Sending zero length transaction queue\");Ca(d,function(a){return 1===a.status})&&Jh(a,c.path(),d)}else c.gd()&&c.O(function(b){Gh(a,b)})}\nfunction Jh(a,b,c){for(var d=Aa(c,function(a){return a.Ba}),e=a.K.Aa(b,d)||L,d=e,e=e.hash(),f=0;f<c.length;f++){var g=c[f];D(1===g.status,\"tryToSendTransactionQueue_: items in queue should all be run.\");g.status=2;g.mf++;var k=P(b,g.path),d=d.F(k,g.ad)}d=d.H(!0);a.va.put(b.toString(),d,function(d){a.f(\"transaction put response\",{path:b.toString(),status:d});var e=[];if(\"ok\"===d){d=[];for(f=0;f<c.length;f++){c[f].status=3;e=e.concat(dh(a.K,c[f].Ba));if(c[f].G){var g=c[f].bd,k=new U(a,c[f].path);d.push(q(c[f].G,\nnull,null,!0,new V(g,k,H)))}c[f].Nd()}Hh(a,Rc(a.jc,b));Gh(a);$e(a.ca,b,e);for(f=0;f<d.length;f++)cc(d[f])}else{if(\"datastale\"===d)for(f=0;f<c.length;f++)c[f].status=4===c[f].status?5:1;else for(J(\"transaction at \"+b.toString()+\" failed: \"+d),f=0;f<c.length;f++)c[f].status=5,c[f].Pd=d;xh(a,b)}},e)}function xh(a,b){var c=Kh(a,b),d=c.path(),c=Ih(a,c);Lh(a,c,d);return d}\nfunction Lh(a,b,c){if(0!==b.length){for(var d=[],e=[],f=za(b,function(a){return 1===a.status}),f=Aa(f,function(a){return a.Ba}),g=0;g<b.length;g++){var k=b[g],m=P(c,k.path),l=!1,r;D(null!==m,\"rerunTransactionsUnderNode_: relativePath should not be null.\");if(5===k.status)l=!0,r=k.Pd,e=e.concat(dh(a.K,k.Ba,!0));else if(1===k.status)if(25<=k.mf)l=!0,r=\"maxretry\",e=e.concat(dh(a.K,k.Ba,!0));else{var y=a.K.Aa(k.path,f)||L;k.$c=y;var F=b[g].update(y.H());n(F)?(Md(\"transaction failed: Data returned \",F,\nk.path),m=G(F),\"object\"===typeof F&&null!=F&&bb(F,\".priority\")||(m=m.fa(y.C())),y=k.Ba,F=wh(a),F=Gb(m,F),k.ad=m,k.bd=F,k.Ba=a.td++,Fa(f,y),e=e.concat(ah(a.K,k.path,F,k.Ba,k.Fe)),e=e.concat(dh(a.K,y,!0))):(l=!0,r=\"nodata\",e=e.concat(dh(a.K,k.Ba,!0)))}$e(a.ca,c,e);e=[];l&&(b[g].status=3,setTimeout(b[g].Nd,Math.floor(0)),b[g].G&&(\"nodata\"===r?(k=new U(a,b[g].path),d.push(q(b[g].G,null,null,!1,new V(b[g].$c,k,H)))):d.push(q(b[g].G,null,Error(r),!1,null))))}Hh(a,a.jc);for(g=0;g<d.length;g++)cc(d[g]);Gh(a)}}\nfunction Kh(a,b){for(var c,d=a.jc;null!==(c=K(b))&&null===d.Ca();)d=Rc(d,c),b=N(b);return d}function Ih(a,b){var c=[];Mh(a,b,c);c.sort(function(a,b){return a.df-b.df});return c}function Mh(a,b,c){var d=b.Ca();if(null!==d)for(var e=0;e<d.length;e++)c.push(d[e]);b.O(function(b){Mh(a,b,c)})}function Hh(a,b){var c=b.Ca();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d;Sc(b,0<c.length?c:null)}b.O(function(b){Hh(a,b)})}\nfunction Ah(a,b){var c=Kh(a,b).path(),d=Rc(a.jc,b);Vc(d,function(b){Nh(a,b)});Nh(a,d);Uc(d,function(b){Nh(a,b)});return c}\nfunction Nh(a,b){var c=b.Ca();if(null!==c){for(var d=[],e=[],f=-1,g=0;g<c.length;g++)4!==c[g].status&&(2===c[g].status?(D(f===g-1,\"All SENT items should be at beginning of queue.\"),f=g,c[g].status=4,c[g].Pd=\"set\"):(D(1===c[g].status,\"Unexpected transaction status in abort\"),c[g].Nd(),e=e.concat(dh(a.K,c[g].Ba,!0)),c[g].G&&d.push(q(c[g].G,null,Error(\"set\"),!1,null))));-1===f?Sc(b,null):c.length=f+1;$e(a.ca,b.path(),e);for(g=0;g<d.length;g++)cc(d[g])}};function Tg(){this.jb={};this.uf=!1}Tg.prototype.$a=function(){for(var a in this.jb)this.jb[a].$a()};Tg.prototype.hc=function(){for(var a in this.jb)this.jb[a].hc()};Tg.prototype.$d=function(a){this.uf=a};ca(Tg);Tg.prototype.interrupt=Tg.prototype.$a;Tg.prototype.resume=Tg.prototype.hc;var W={};W.kc=zg;W.DataConnection=W.kc;zg.prototype.pg=function(a,b){this.ua(\"q\",{p:a},b)};W.kc.prototype.simpleListen=W.kc.prototype.pg;zg.prototype.If=function(a,b){this.ua(\"echo\",{d:a},b)};W.kc.prototype.echo=W.kc.prototype.If;zg.prototype.interrupt=zg.prototype.$a;W.yf=ng;W.RealTimeConnection=W.yf;ng.prototype.sendRequest=ng.prototype.ua;ng.prototype.close=ng.prototype.close;\nW.Tf=function(a){var b=zg.prototype.put;zg.prototype.put=function(c,d,e,f){n(f)&&(f=a());b.call(this,c,d,e,f)};return function(){zg.prototype.put=b}};W.hijackHash=W.Tf;W.xf=wb;W.ConnectionTarget=W.xf;W.ja=function(a){return a.ja()};W.queryIdentifier=W.ja;W.Wf=function(a){return a.u.Qa.$};W.listens=W.Wf;W.$d=function(a){Tg.Tb().$d(a)};W.forceRestClient=W.$d;W.Context=Tg;function Oh(a,b){this.committed=a;this.snapshot=b};function X(a,b,c,d){this.u=a;this.path=b;this.m=c;this.Kc=d}\nfunction Ph(a){var b=null,c=null;a.ka&&(b=cf(a));a.na&&(c=ef(a));if(a.g===qc){if(a.ka){if(\"[MIN_NAME]\"!=bf(a))throw Error(\"Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().\");if(\"string\"!==typeof b)throw Error(\"Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.\");}if(a.na){if(\"[MAX_NAME]\"!=df(a))throw Error(\"Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().\");if(\"string\"!==\ntypeof c)throw Error(\"Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.\");}}else if(a.g===H){if(null!=b&&!Kd(b)||null!=c&&!Kd(c))throw Error(\"Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).\");}else if(D(a.g instanceof mc||a.g===tc,\"unknown index type.\"),null!=b&&\"object\"===typeof b||null!=c&&\"object\"===typeof c)throw Error(\"Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.\");\n}function Qh(a){if(a.ka&&a.na&&a.xa&&(!a.xa||\"\"===a.kb))throw Error(\"Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.\");}function Rh(a,b){if(!0===a.Kc)throw Error(b+\": You can't combine multiple orderBy calls.\");}h=X.prototype;h.ub=function(){z(\"Query.ref\",0,0,arguments.length);return new U(this.u,this.path)};\nh.dc=function(a,b,c,d){z(\"Query.on\",2,4,arguments.length);Qd(\"Query.on\",a,!1);B(\"Query.on\",2,b,!1);var e=Sh(\"Query.on\",c,d);if(\"value\"===a)Eh(this.u,this,new Ug(b,e.cancel||null,e.La||null));else{var f={};f[a]=b;Eh(this.u,this,new Vg(f,e.cancel,e.La))}return b};\nh.Fc=function(a,b,c){z(\"Query.off\",0,3,arguments.length);Qd(\"Query.off\",a,!0);B(\"Query.off\",2,b,!0);lb(\"Query.off\",3,c);var d=null,e=null;\"value\"===a?d=new Ug(b||null,null,c||null):a&&(b&&(e={},e[a]=b),d=new Vg(e,null,c||null));e=this.u;d=\".info\"===K(this.path)?e.md.ib(this,d):e.K.ib(this,d);Ye(e.ca,this.path,d)};\nh.ag=function(a,b){function c(k){f&&(f=!1,e.Fc(a,c),b&&b.call(d.La,k),g.resolve(k))}z(\"Query.once\",1,4,arguments.length);Qd(\"Query.once\",a,!1);B(\"Query.once\",2,b,!0);var d=Sh(\"Query.once\",arguments[2],arguments[3]),e=this,f=!0,g=new fb;hb(g.ra);this.dc(a,c,function(b){e.Fc(a,c);d.cancel&&d.cancel.call(d.La,b);g.reject(b)});return g.ra};\nh.ke=function(a){z(\"Query.limitToFirst\",1,1,arguments.length);if(!ga(a)||Math.floor(a)!==a||0>=a)throw Error(\"Query.limitToFirst: First argument must be a positive integer.\");if(this.m.xa)throw Error(\"Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).\");return new X(this.u,this.path,this.m.ke(a),this.Kc)};\nh.le=function(a){z(\"Query.limitToLast\",1,1,arguments.length);if(!ga(a)||Math.floor(a)!==a||0>=a)throw Error(\"Query.limitToLast: First argument must be a positive integer.\");if(this.m.xa)throw Error(\"Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).\");return new X(this.u,this.path,this.m.le(a),this.Kc)};\nh.bg=function(a){z(\"Query.orderByChild\",1,1,arguments.length);if(\"$key\"===a)throw Error('Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.');if(\"$priority\"===a)throw Error('Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.');if(\"$value\"===a)throw Error('Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.');Sd(\"Query.orderByChild\",a);Rh(this,\"Query.orderByChild\");var b=new E(a);if(b.e())throw Error(\"Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.\");\nb=new mc(b);b=lf(this.m,b);Ph(b);return new X(this.u,this.path,b,!0)};h.cg=function(){z(\"Query.orderByKey\",0,0,arguments.length);Rh(this,\"Query.orderByKey\");var a=lf(this.m,qc);Ph(a);return new X(this.u,this.path,a,!0)};h.dg=function(){z(\"Query.orderByPriority\",0,0,arguments.length);Rh(this,\"Query.orderByPriority\");var a=lf(this.m,H);Ph(a);return new X(this.u,this.path,a,!0)};\nh.eg=function(){z(\"Query.orderByValue\",0,0,arguments.length);Rh(this,\"Query.orderByValue\");var a=lf(this.m,tc);Ph(a);return new X(this.u,this.path,a,!0)};h.Kd=function(a,b){z(\"Query.startAt\",0,2,arguments.length);Ld(\"Query.startAt\",a,this.path,!0);Rd(\"Query.startAt\",b);var c=this.m.Kd(a,b);Qh(c);Ph(c);if(this.m.ka)throw Error(\"Query.startAt: Starting point was already set (by another call to startAt or equalTo).\");n(a)||(b=a=null);return new X(this.u,this.path,c,this.Kc)};\nh.dd=function(a,b){z(\"Query.endAt\",0,2,arguments.length);Ld(\"Query.endAt\",a,this.path,!0);Rd(\"Query.endAt\",b);var c=this.m.dd(a,b);Qh(c);Ph(c);if(this.m.na)throw Error(\"Query.endAt: Ending point was already set (by another call to endAt or equalTo).\");return new X(this.u,this.path,c,this.Kc)};\nh.Jf=function(a,b){z(\"Query.equalTo\",1,2,arguments.length);Ld(\"Query.equalTo\",a,this.path,!1);Rd(\"Query.equalTo\",b);if(this.m.ka)throw Error(\"Query.equalTo: Starting point was already set (by another call to startAt or equalTo).\");if(this.m.na)throw Error(\"Query.equalTo: Ending point was already set (by another call to endAt or equalTo).\");return this.Kd(a,b).dd(a,b)};\nh.toString=function(){z(\"Query.toString\",0,0,arguments.length);for(var a=this.path,b=\"\",c=a.Y;c<a.o.length;c++)\"\"!==a.o[c]&&(b+=\"/\"+encodeURIComponent(String(a.o[c])));return this.u.toString()+(b||\"/\")};h.toJSON=function(){z(\"Query.toJSON\",0,1,arguments.length);return this.toString()};h.ja=function(){var a=Yb(mf(this.m));return\"{}\"===a?\"default\":a};\nh.isEqual=function(a){z(\"Query.isEqual\",1,1,arguments.length);if(!(a instanceof X))throw Error(\"Query.isEqual failed: First argument must be an instance of firebase.database.Query.\");var b=this.u===a.u,c=this.path.Z(a.path),d=this.ja()===a.ja();return b&&c&&d};\nfunction Sh(a,b,c){var d={cancel:null,La:null};if(b&&c)d.cancel=b,B(a,3,d.cancel,!0),d.La=c,lb(a,4,d.La);else if(b)if(\"object\"===typeof b&&null!==b)d.La=b;else if(\"function\"===typeof b)d.cancel=b;else throw Error(A(a,3,!0)+\" must either be a cancel callback or a context object.\");return d}X.prototype.on=X.prototype.dc;X.prototype.off=X.prototype.Fc;X.prototype.once=X.prototype.ag;X.prototype.limitToFirst=X.prototype.ke;X.prototype.limitToLast=X.prototype.le;X.prototype.orderByChild=X.prototype.bg;\nX.prototype.orderByKey=X.prototype.cg;X.prototype.orderByPriority=X.prototype.dg;X.prototype.orderByValue=X.prototype.eg;X.prototype.startAt=X.prototype.Kd;X.prototype.endAt=X.prototype.dd;X.prototype.equalTo=X.prototype.Jf;X.prototype.toString=X.prototype.toString;X.prototype.isEqual=X.prototype.isEqual;dc(X.prototype,\"ref\",X.prototype.ub);function Y(a,b){this.ta=a;this.qa=b}Y.prototype.cancel=function(a){z(\"Firebase.onDisconnect().cancel\",0,1,arguments.length);B(\"Firebase.onDisconnect().cancel\",1,a,!0);var b=new fb;this.ta.vd(this.qa,gb(b,a));return b.ra};Y.prototype.cancel=Y.prototype.cancel;Y.prototype.remove=function(a){z(\"Firebase.onDisconnect().remove\",0,1,arguments.length);Td(\"Firebase.onDisconnect().remove\",this.qa);B(\"Firebase.onDisconnect().remove\",1,a,!0);var b=new fb;Bh(this.ta,this.qa,null,gb(b,a));return b.ra};\nY.prototype.remove=Y.prototype.remove;Y.prototype.set=function(a,b){z(\"Firebase.onDisconnect().set\",1,2,arguments.length);Td(\"Firebase.onDisconnect().set\",this.qa);Ld(\"Firebase.onDisconnect().set\",a,this.qa,!1);B(\"Firebase.onDisconnect().set\",2,b,!0);var c=new fb;Bh(this.ta,this.qa,a,gb(c,b));return c.ra};Y.prototype.set=Y.prototype.set;\nY.prototype.Hb=function(a,b,c){z(\"Firebase.onDisconnect().setWithPriority\",2,3,arguments.length);Td(\"Firebase.onDisconnect().setWithPriority\",this.qa);Ld(\"Firebase.onDisconnect().setWithPriority\",a,this.qa,!1);Pd(\"Firebase.onDisconnect().setWithPriority\",2,b);B(\"Firebase.onDisconnect().setWithPriority\",3,c,!0);var d=new fb;Ch(this.ta,this.qa,a,b,gb(d,c));return d.ra};Y.prototype.setWithPriority=Y.prototype.Hb;\nY.prototype.update=function(a,b){z(\"Firebase.onDisconnect().update\",1,2,arguments.length);Td(\"Firebase.onDisconnect().update\",this.qa);if(ea(a)){for(var c={},d=0;d<a.length;++d)c[\"\"+d]=a[d];a=c;J(\"Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}Od(\"Firebase.onDisconnect().update\",a,this.qa);B(\"Firebase.onDisconnect().update\",2,b,!0);\nc=new fb;Dh(this.ta,this.qa,a,gb(c,b));return c.ra};Y.prototype.update=Y.prototype.update;var Z={Of:function(){ag=Wf=!0}};Z.forceLongPolling=Z.Of;Z.Pf=function(){bg=!0};Z.forceWebSockets=Z.Pf;Z.Vf=function(){return Vf.isAvailable()};Z.isWebSocketsAvailable=Z.Vf;Z.ng=function(a,b){a.u.Qa.xe=b};Z.setSecurityDebugCallback=Z.ng;Z.ze=function(a,b){a.u.ze(b)};Z.stats=Z.ze;Z.Ae=function(a,b){a.u.Ae(b)};Z.statsIncrementCounter=Z.Ae;Z.cd=function(a){return a.u.cd};Z.dataUpdateCount=Z.cd;Z.Uf=function(a,b){a.u.ge=b};Z.interceptServerData=Z.Uf;function U(a,b){if(!(a instanceof Pg))throw Error(\"new Firebase() no longer supported - use app.database().\");X.call(this,a,b,jf,!1);this.then=void 0;this[\"catch\"]=void 0}la(U,X);h=U.prototype;h.getKey=function(){z(\"Firebase.key\",0,0,arguments.length);return this.path.e()?null:Lc(this.path)};\nh.n=function(a){z(\"Firebase.child\",1,1,arguments.length);if(ga(a))a=String(a);else if(!(a instanceof E))if(null===K(this.path)){var b=a;b&&(b=b.replace(/^\\/*\\.info(\\/|$)/,\"/\"));Sd(\"Firebase.child\",b)}else Sd(\"Firebase.child\",a);return new U(this.u,this.path.n(a))};h.getParent=function(){z(\"Firebase.parent\",0,0,arguments.length);var a=this.path.parent();return null===a?null:new U(this.u,a)};\nh.Qf=function(){z(\"Firebase.ref\",0,0,arguments.length);for(var a=this;null!==a.getParent();)a=a.getParent();return a};h.Gf=function(){return this.u.Xa};h.set=function(a,b){z(\"Firebase.set\",1,2,arguments.length);Td(\"Firebase.set\",this.path);Ld(\"Firebase.set\",a,this.path,!1);B(\"Firebase.set\",2,b,!0);var c=new fb;this.u.Hb(this.path,a,null,gb(c,b));return c.ra};\nh.update=function(a,b){z(\"Firebase.update\",1,2,arguments.length);Td(\"Firebase.update\",this.path);if(ea(a)){for(var c={},d=0;d<a.length;++d)c[\"\"+d]=a[d];a=c;J(\"Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}Od(\"Firebase.update\",a,this.path);B(\"Firebase.update\",2,b,!0);c=new fb;this.u.update(this.path,a,gb(c,b));return c.ra};\nh.Hb=function(a,b,c){z(\"Firebase.setWithPriority\",2,3,arguments.length);Td(\"Firebase.setWithPriority\",this.path);Ld(\"Firebase.setWithPriority\",a,this.path,!1);Pd(\"Firebase.setWithPriority\",2,b);B(\"Firebase.setWithPriority\",3,c,!0);if(\".length\"===this.getKey()||\".keys\"===this.getKey())throw\"Firebase.setWithPriority failed: \"+this.getKey()+\" is a read-only object.\";var d=new fb;this.u.Hb(this.path,a,b,gb(d,c));return d.ra};\nh.remove=function(a){z(\"Firebase.remove\",0,1,arguments.length);Td(\"Firebase.remove\",this.path);B(\"Firebase.remove\",1,a,!0);return this.set(null,a)};\nh.transaction=function(a,b,c){z(\"Firebase.transaction\",1,3,arguments.length);Td(\"Firebase.transaction\",this.path);B(\"Firebase.transaction\",1,a,!1);B(\"Firebase.transaction\",2,b,!0);if(n(c)&&\"boolean\"!=typeof c)throw Error(A(\"Firebase.transaction\",3,!0)+\"must be a boolean.\");if(\".length\"===this.getKey()||\".keys\"===this.getKey())throw\"Firebase.transaction failed: \"+this.getKey()+\" is a read-only object.\";\"undefined\"===typeof c&&(c=!0);var d=new fb;ha(b)&&hb(d.ra);Fh(this.u,this.path,a,function(a,c,g){a?\nd.reject(a):d.resolve(new Oh(c,g));ha(b)&&b(a,c,g)},c);return d.ra};h.mg=function(a,b){z(\"Firebase.setPriority\",1,2,arguments.length);Td(\"Firebase.setPriority\",this.path);Pd(\"Firebase.setPriority\",1,a);B(\"Firebase.setPriority\",2,b,!0);var c=new fb;this.u.Hb(this.path.n(\".priority\"),a,null,gb(c,b));return c.ra};\nh.push=function(a,b){z(\"Firebase.push\",0,2,arguments.length);Td(\"Firebase.push\",this.path);Ld(\"Firebase.push\",a,this.path,!0);B(\"Firebase.push\",2,b,!0);var c=vh(this.u),d=Hc(c),c=this.n(d),e=this.n(d),d=null!=a?c.set(a,b).then(function(){return e}):eb.resolve(e);c.then=q(d.then,d);c[\"catch\"]=q(d.then,d,void 0);ha(b)&&hb(d);return c};h.gb=function(){Td(\"Firebase.onDisconnect\",this.path);return new Y(this.u,this.path)};U.prototype.child=U.prototype.n;U.prototype.set=U.prototype.set;\nU.prototype.update=U.prototype.update;U.prototype.setWithPriority=U.prototype.Hb;U.prototype.remove=U.prototype.remove;U.prototype.transaction=U.prototype.transaction;U.prototype.setPriority=U.prototype.mg;U.prototype.push=U.prototype.push;U.prototype.onDisconnect=U.prototype.gb;dc(U.prototype,\"database\",U.prototype.Gf);dc(U.prototype,\"key\",U.prototype.getKey);dc(U.prototype,\"parent\",U.prototype.getParent);dc(U.prototype,\"root\",U.prototype.Qf);if(\"undefined\"===typeof firebase)throw Error(\"Cannot install Firebase Database - be sure to load firebase-app.js first.\");\ntry{var Th=firebase.INTERNAL.registerService(\"database\",function(a){var b=Tg.Tb(),c=a.options.databaseURL;n(c)||Sb(\"Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().\");var d=Tb(c),c=d.gc;Ud(\"Invalid Firebase Database URL\",d);d.path.e()||Sb(\"Database URL must point to the root of a Firebase Database (not including a child path).\");(d=w(b.jb,a.name))&&Sb(\"FIREBASE INTERNAL ERROR: Database initialized multiple times.\");d=new Pg(c,b.uf,\na);b.jb[a.name]=d;return d.Xa},{Reference:U,Query:X,Database:Og,enableLogging:Pb,INTERNAL:Z,TEST_ACCESS:W,ServerValue:Rg});module.exports=Th}catch(Uh){Sb(\"Failed to register the Firebase Database Service (\"+Uh+\")\")};\n})();\n\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/websocket.js":"// API references:\n//\n// * http://dev.w3.org/html5/websockets/\n// * http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#interface-eventtarget\n// * http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#interface-event\n\nvar util   = require('util'),\n    driver = require('websocket-driver'),\n    API    = require('./websocket/api');\n\nvar WebSocket = function(request, socket, body, protocols, options) {\n  options = options || {};\n\n  this._stream = socket;\n  this._driver = driver.http(request, {maxLength: options.maxLength, protocols: protocols});\n\n  var self = this;\n  if (!this._stream || !this._stream.writable) return;\n  if (!this._stream.readable) return this._stream.end();\n\n  var catchup = function() { self._stream.removeListener('data', catchup) };\n  this._stream.on('data', catchup);\n\n  this._driver.io.write(body);\n  API.call(this, options);\n\n  process.nextTick(function() {\n    self._driver.start();\n  });\n};\nutil.inherits(WebSocket, API);\n\nWebSocket.isWebSocket = function(request) {\n  return driver.isWebSocket(request);\n};\n\nWebSocket.validateOptions = function(options, validKeys) {\n  driver.validateOptions(options, validKeys);\n};\n\nWebSocket.WebSocket   = WebSocket;\nWebSocket.Client      = require('./websocket/client');\nWebSocket.EventSource = require('./eventsource');\n\nmodule.exports        = WebSocket;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver.js":"'use strict';\n\n// Protocol references:\n// \n// * http://tools.ietf.org/html/draft-hixie-thewebsocketprotocol-75\n// * http://tools.ietf.org/html/draft-hixie-thewebsocketprotocol-76\n// * http://tools.ietf.org/html/draft-ietf-hybi-thewebsocketprotocol-17\n\nvar Base   = require('./driver/base'),\n    Client = require('./driver/client'),\n    Server = require('./driver/server');\n\nvar Driver = {\n  client: function(url, options) {\n    options = options || {};\n    if (options.masking === undefined) options.masking = true;\n    return new Client(url, options);\n  },\n\n  server: function(options) {\n    options = options || {};\n    if (options.requireMasking === undefined) options.requireMasking = true;\n    return new Server(options);\n  },\n\n  http: function() {\n    return Server.http.apply(Server, arguments);\n  },\n\n  isSecureRequest: function(request) {\n    return Server.isSecureRequest(request);\n  },\n\n  isWebSocket: function(request) {\n    if (request.method !== 'GET') return false;\n\n    var connection = request.headers.connection || '',\n        upgrade    = request.headers.upgrade || '';\n\n    return request.method === 'GET' &&\n           connection.toLowerCase().split(/ *, */).indexOf('upgrade') >= 0 &&\n           upgrade.toLowerCase() === 'websocket';\n  },\n\n  validateOptions: function(options, validKeys) {\n    Base.validateOptions(options, validKeys);\n  }\n};\n\nmodule.exports = Driver;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/base.js":"'use strict';\n\nvar Emitter = require('events').EventEmitter,\n    util    = require('util'),\n    streams = require('../streams'),\n    Headers = require('./headers'),\n    Reader  = require('./stream_reader');\n\nvar Base = function(request, url, options) {\n  Emitter.call(this);\n  Base.validateOptions(options || {}, ['maxLength', 'masking', 'requireMasking', 'protocols']);\n\n  this._request   = request;\n  this._reader    = new Reader();\n  this._options   = options || {};\n  this._maxLength = this._options.maxLength || this.MAX_LENGTH;\n  this._headers   = new Headers();\n  this.__queue    = [];\n  this.readyState = 0;\n  this.url        = url;\n\n  this.io = new streams.IO(this);\n  this.messages = new streams.Messages(this);\n  this._bindEventListeners();\n};\nutil.inherits(Base, Emitter);\n\nBase.validateOptions = function(options, validKeys) {\n  for (var key in options) {\n    if (validKeys.indexOf(key) < 0)\n      throw new Error('Unrecognized option: ' + key);\n  }\n};\n\nvar instance = {\n  // This is 64MB, small enough for an average VPS to handle without\n  // crashing from process out of memory\n  MAX_LENGTH: 0x3ffffff,\n\n  STATES: ['connecting', 'open', 'closing', 'closed'],\n\n  _bindEventListeners: function() {\n    var self = this;\n\n    // Protocol errors are informational and do not have to be handled\n    this.messages.on('error', function() {});\n\n    this.on('message', function(event) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('data', event.data);\n    });\n\n    this.on('error', function(error) {\n      var messages = self.messages;\n      if (messages.readable) messages.emit('error', error);\n    });\n\n    this.on('close', function() {\n      var messages = self.messages;\n      if (!messages.readable) return;\n      messages.readable = messages.writable = false;\n      messages.emit('end');\n    });\n  },\n\n  getState: function() {\n    return this.STATES[this.readyState] || null;\n  },\n\n  addExtension: function(extension) {\n    return false;\n  },\n\n  setHeader: function(name, value) {\n    if (this.readyState > 0) return false;\n    this._headers.set(name, value);\n    return true;\n  },\n\n  start: function() {\n    if (this.readyState !== 0) return false;\n    var response = this._handshakeResponse();\n    if (!response) return false;\n    this._write(response);\n    if (this._stage !== -1) this._open();\n    return true;\n  },\n\n  text: function(message) {\n    return this.frame(message);\n  },\n\n  binary: function(message) {\n    return false;\n  },\n\n  ping: function() {\n    return false;\n  },\n\n  pong: function() {\n      return false;\n  },\n\n  close: function(reason, code) {\n    if (this.readyState !== 1) return false;\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n\n  _open: function() {\n    this.readyState = 1;\n    this.__queue.forEach(function(args) { this.frame.apply(this, args) }, this);\n    this.__queue = [];\n    this.emit('open', new Base.OpenEvent());\n  },\n\n  _queue: function(message) {\n    this.__queue.push(message);\n    return true;\n  },\n\n  _write: function(chunk) {\n    var io = this.io;\n    if (io.readable) io.emit('data', chunk);\n  }\n};\n\nfor (var key in instance)\n  Base.prototype[key] = instance[key];\n\n\nBase.ConnectEvent = function() {};\n\nBase.OpenEvent = function() {};\n\nBase.CloseEvent = function(code, reason) {\n  this.code   = code;\n  this.reason = reason;\n};\n\nBase.MessageEvent = function(data) {\n  this.data = data;\n};\n\nmodule.exports = Base;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/streams.js":"'use strict';\n\n/**\n\nStreams in a WebSocket connection\n---------------------------------\n\nWe model a WebSocket as two duplex streams: one stream is for the wire protocol\nover an I/O socket, and the other is for incoming/outgoing messages.\n\n\n                        +----------+      +---------+      +----------+\n    [1] write(chunk) -->| ~~~~~~~~ +----->| parse() +----->| ~~~~~~~~ +--> emit('data') [2]\n                        |          |      +----+----+      |          |\n                        |          |           |           |          |\n                        |    IO    |           | [5]       | Messages |\n                        |          |           V           |          |\n                        |          |      +---------+      |          |\n    [4] emit('data') <--+ ~~~~~~~~ |<-----+ frame() |<-----+ ~~~~~~~~ |<-- write(chunk) [3]\n                        +----------+      +---------+      +----------+\n\n\nMessage transfer in each direction is simple: IO receives a byte stream [1] and\nsends this stream for parsing. The parser will periodically emit a complete\nmessage text on the Messages stream [2]. Similarly, when messages are written\nto the Messages stream [3], they are framed using the WebSocket wire format and\nemitted via IO [4].\n\nThere is a feedback loop via [5] since some input from [1] will be things like\nping, pong and close frames. In these cases the protocol responds by emitting\nresponses directly back to [4] rather than emitting messages via [2].\n\nFor the purposes of flow control, we consider the sources of each Readable\nstream to be as follows:\n\n* [2] receives input from [1]\n* [4] receives input from [1] and [3]\n\nThe classes below express the relationships described above without prescribing\nanything about how parse() and frame() work, other than assuming they emit\n'data' events to the IO and Messages streams. They will work with any protocol\ndriver having these two methods.\n**/\n\n\nvar Stream = require('stream').Stream,\n    util   = require('util');\n\n\nvar IO = function(driver) {\n  this.readable = this.writable = true;\n  this._paused  = false;\n  this._driver  = driver;\n};\nutil.inherits(IO, Stream);\n\n// The IO pause() and resume() methods will be called when the socket we are\n// piping to gets backed up and drains. Since IO output [4] comes from IO input\n// [1] and Messages input [3], we need to tell both of those to return false\n// from write() when this stream is paused.\n\nIO.prototype.pause = function() {\n  this._paused = true;\n  this._driver.messages._paused = true;\n};\n\nIO.prototype.resume = function() {\n  this._paused = false;\n  this.emit('drain');\n\n  var messages = this._driver.messages;\n  messages._paused = false;\n  messages.emit('drain');\n};\n\n// When we receive input from a socket, send it to the parser and tell the\n// source whether to back off.\nIO.prototype.write = function(chunk) {\n  if (!this.writable) return false;\n  this._driver.parse(chunk);\n  return !this._paused;\n};\n\n// The IO end() method will be called when the socket piping into it emits\n// 'close' or 'end', i.e. the socket is closed. In this situation the Messages\n// stream will not emit any more data so we emit 'end'.\nIO.prototype.end = function(chunk) {\n  if (!this.writable) return;\n  if (chunk !== undefined) this.write(chunk);\n  this.writable = false;\n\n  var messages = this._driver.messages;\n  if (messages.readable) {\n    messages.readable = messages.writable = false;\n    messages.emit('end');\n  }\n};\n\nIO.prototype.destroy = function() {\n  this.end();\n};\n\n\nvar Messages = function(driver) {\n  this.readable = this.writable = true;\n  this._paused  = false;\n  this._driver  = driver;\n};\nutil.inherits(Messages, Stream);\n\n// The Messages pause() and resume() methods will be called when the app that's\n// processing the messages gets backed up and drains. If we're emitting\n// messages too fast we should tell the source to slow down. Message output [2]\n// comes from IO input [1].\n\nMessages.prototype.pause = function() {\n  this._driver.io._paused = true;\n};\n\nMessages.prototype.resume = function() {\n  this._driver.io._paused = false;\n  this._driver.io.emit('drain');\n};\n\n// When we receive messages from the user, send them to the formatter and tell\n// the source whether to back off.\nMessages.prototype.write = function(message) {\n  if (!this.writable) return false;\n  if (typeof message === 'string') this._driver.text(message);\n  else this._driver.binary(message);\n  return !this._paused;\n};\n\n// The Messages end() method will be called when a stream piping into it emits\n// 'end'. Many streams may be piped into the WebSocket and one of them ending\n// does not mean the whole socket is done, so just process the input and move\n// on leaving the socket open.\nMessages.prototype.end = function(message) {\n  if (message !== undefined) this.write(message);\n};\n\nMessages.prototype.destroy = function() {};\n\n\nexports.IO = IO;\nexports.Messages = Messages;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/headers.js":"'use strict';\n\nvar Headers = function() {\n  this.clear();\n};\n\nHeaders.prototype.ALLOWED_DUPLICATES = ['set-cookie', 'set-cookie2', 'warning', 'www-authenticate'];\n\nHeaders.prototype.clear = function() {\n  this._sent  = {};\n  this._lines = [];\n};\n\nHeaders.prototype.set = function(name, value) {\n  if (value === undefined) return;\n\n  name = this._strip(name);\n  value = this._strip(value);\n\n  var key = name.toLowerCase();\n  if (!this._sent.hasOwnProperty(key) || this.ALLOWED_DUPLICATES.indexOf(key) >= 0) {\n    this._sent[key] = true;\n    this._lines.push(name + ': ' + value + '\\r\\n');\n  }\n};\n\nHeaders.prototype.toString = function() {\n  return this._lines.join('');\n};\n\nHeaders.prototype._strip = function(string) {\n  return string.toString().replace(/^ */, '').replace(/ *$/, '');\n};\n\nmodule.exports = Headers;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/stream_reader.js":"'use strict';\n\nvar StreamReader = function() {\n  this._queue     = [];\n  this._queueSize = 0;\n  this._offset    = 0;\n};\n\nStreamReader.prototype.put = function(buffer) {\n  if (!buffer || buffer.length === 0) return;\n  if (!buffer.copy) buffer = new Buffer(buffer);\n  this._queue.push(buffer);\n  this._queueSize += buffer.length;\n};\n\nStreamReader.prototype.read = function(length) {\n  if (length > this._queueSize) return null;\n  if (length === 0) return new Buffer(0);\n\n  this._queueSize -= length;\n\n  var queue  = this._queue,\n      remain = length,\n      first  = queue[0],\n      buffers, buffer;\n\n  if (first.length >= length) {\n    if (first.length === length) {\n      return queue.shift();\n    } else {\n      buffer = first.slice(0, length);\n      queue[0] = first.slice(length);\n      return buffer;\n    }\n  }\n\n  for (var i = 0, n = queue.length; i < n; i++) {\n    if (remain < queue[i].length) break;\n    remain -= queue[i].length;\n  }\n  buffers = queue.splice(0, i);\n\n  if (remain > 0 && queue.length > 0) {\n    buffers.push(queue[0].slice(0, remain));\n    queue[0] = queue[0].slice(remain);\n  }\n  return this._concat(buffers, length);\n};\n\nStreamReader.prototype.eachByte = function(callback, context) {\n  var buffer, n, index;\n\n  while (this._queue.length > 0) {\n    buffer = this._queue[0];\n    n = buffer.length;\n\n    while (this._offset < n) {\n      index = this._offset;\n      this._offset += 1;\n      callback.call(context, buffer[index]);\n    }\n    this._offset = 0;\n    this._queue.shift();\n  }\n};\n\nStreamReader.prototype._concat = function(buffers, length) {\n  if (Buffer.concat) return Buffer.concat(buffers, length);\n\n  var buffer = new Buffer(length),\n      offset = 0;\n\n  for (var i = 0, n = buffers.length; i < n; i++) {\n    buffers[i].copy(buffer, offset);\n    offset += buffers[i].length;\n  }\n  return buffer;\n};\n\nmodule.exports = StreamReader;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/client.js":"'use strict';\n\nvar crypto     = require('crypto'),\n    url        = require('url'),\n    util       = require('util'),\n    HttpParser = require('../http_parser'),\n    Base       = require('./base'),\n    Hybi       = require('./hybi'),\n    Proxy      = require('./proxy');\n\nvar Client = function(_url, options) {\n  this.version = 'hybi-13';\n  Hybi.call(this, null, _url, options);\n\n  this.readyState = -1;\n  this._key       = Client.generateKey();\n  this._accept    = Hybi.generateAccept(this._key);\n  this._http      = new HttpParser('response');\n\n  var uri  = url.parse(this.url),\n      auth = uri.auth && new Buffer(uri.auth, 'utf8').toString('base64');\n\n  if (this.VALID_PROTOCOLS.indexOf(uri.protocol) < 0)\n    throw new Error(this.url + ' is not a valid WebSocket URL');\n\n  this._pathname = (uri.pathname || '/') + (uri.search || '');\n\n  this._headers.set('Host', uri.host);\n  this._headers.set('Upgrade', 'websocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Key', this._key);\n  this._headers.set('Sec-WebSocket-Version', '13');\n\n  if (this._protocols.length > 0)\n    this._headers.set('Sec-WebSocket-Protocol', this._protocols.join(', '));\n\n  if (auth)\n    this._headers.set('Authorization', 'Basic ' + auth);\n};\nutil.inherits(Client, Hybi);\n\nClient.generateKey = function() {\n  return crypto.randomBytes(16).toString('base64');\n};\n\nvar instance = {\n  VALID_PROTOCOLS: ['ws:', 'wss:'],\n\n  proxy: function(origin, options) {\n    return new Proxy(this, origin, options);\n  },\n\n  start: function() {\n    if (this.readyState !== -1) return false;\n    this._write(this._handshakeRequest());\n    this.readyState = 0;\n    return true;\n  },\n\n  parse: function(chunk) {\n    if (this.readyState === 3) return;\n    if (this.readyState > 0) return Hybi.prototype.parse.call(this, chunk);\n\n    this._http.parse(chunk);\n    if (!this._http.isComplete()) return;\n\n    this._validateHandshake();\n    if (this.readyState === 3) return;\n\n    this._open();\n    this.parse(this._http.body);\n  },\n\n  _handshakeRequest: function() {\n    var extensions = this._extensions.generateOffer();\n    if (extensions)\n      this._headers.set('Sec-WebSocket-Extensions', extensions);\n\n    var start   = 'GET ' + this._pathname + ' HTTP/1.1',\n        headers = [start, this._headers.toString(), ''];\n\n    return new Buffer(headers.join('\\r\\n'), 'utf8');\n  },\n\n  _failHandshake: function(message) {\n    message = 'Error during WebSocket handshake: ' + message;\n    this.readyState = 3;\n    this.emit('error', new Error(message));\n    this.emit('close', new Base.CloseEvent(this.ERRORS.protocol_error, message));\n  },\n\n  _validateHandshake: function() {\n    this.statusCode = this._http.statusCode;\n    this.headers    = this._http.headers;\n\n    if (this._http.statusCode !== 101)\n      return this._failHandshake('Unexpected response code: ' + this._http.statusCode);\n\n    var headers    = this._http.headers,\n        upgrade    = headers['upgrade'] || '',\n        connection = headers['connection'] || '',\n        accept     = headers['sec-websocket-accept'] || '',\n        protocol   = headers['sec-websocket-protocol'] || '';\n\n    if (upgrade === '')\n      return this._failHandshake(\"'Upgrade' header is missing\");\n    if (upgrade.toLowerCase() !== 'websocket')\n      return this._failHandshake(\"'Upgrade' header value is not 'WebSocket'\");\n\n    if (connection === '')\n      return this._failHandshake(\"'Connection' header is missing\");\n    if (connection.toLowerCase() !== 'upgrade')\n      return this._failHandshake(\"'Connection' header value is not 'Upgrade'\");\n\n    if (accept !== this._accept)\n      return this._failHandshake('Sec-WebSocket-Accept mismatch');\n\n    this.protocol = null;\n\n    if (protocol !== '') {\n      if (this._protocols.indexOf(protocol) < 0)\n        return this._failHandshake('Sec-WebSocket-Protocol mismatch');\n      else\n        this.protocol = protocol;\n    }\n\n    try {\n      this._extensions.activate(this.headers['sec-websocket-extensions']);\n    } catch (e) {\n      return this._failHandshake(e.message);\n    }\n  }\n};\n\nfor (var key in instance)\n  Client.prototype[key] = instance[key];\n\nmodule.exports = Client;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/http_parser.js":"'use strict';\n\nvar NodeHTTPParser = process.binding('http_parser').HTTPParser,\n    version        = NodeHTTPParser.RESPONSE ? 6 : 4;\n\nvar HttpParser = function(type) {\n  if (type === 'request')\n    this._parser = new NodeHTTPParser(NodeHTTPParser.REQUEST || 'request');\n  else\n    this._parser = new NodeHTTPParser(NodeHTTPParser.RESPONSE || 'response');\n\n  this._type     = type;\n  this._complete = false;\n  this.headers   = {};\n\n  var current = null,\n      self    = this;\n\n  this._parser.onHeaderField = function(b, start, length) {\n    current = b.toString('utf8', start, start + length).toLowerCase();\n  };\n\n  this._parser.onHeaderValue = function(b, start, length) {\n    var value = b.toString('utf8', start, start + length);\n\n    if (self.headers.hasOwnProperty(current))\n      self.headers[current] += ', ' + value;\n    else\n      self.headers[current] = value;\n  };\n\n  this._parser.onHeadersComplete = this._parser[NodeHTTPParser.kOnHeadersComplete] =\n  function(majorVersion, minorVersion, headers, method, pathname, statusCode) {\n    var info = arguments[0];\n\n    if (typeof info === 'object') {\n      method     = info.method;\n      pathname   = info.url;\n      statusCode = info.statusCode;\n      headers    = info.headers;\n    }\n\n    self.method     = (typeof method === 'number') ? HttpParser.METHODS[method] : method;\n    self.statusCode = statusCode;\n    self.url        = pathname;\n\n    if (!headers) return;\n\n    for (var i = 0, n = headers.length, key, value; i < n; i += 2) {\n      key   = headers[i].toLowerCase();\n      value = headers[i+1];\n      if (self.headers.hasOwnProperty(key))\n        self.headers[key] += ', ' + value;\n      else\n        self.headers[key] = value;\n    }\n\n    self._complete = true;\n  };\n};\n\nHttpParser.METHODS = {\n  0:  'DELETE',\n  1:  'GET',\n  2:  'HEAD',\n  3:  'POST',\n  4:  'PUT',\n  5:  'CONNECT',\n  6:  'OPTIONS',\n  7:  'TRACE',\n  8:  'COPY',\n  9:  'LOCK',\n  10: 'MKCOL',\n  11: 'MOVE',\n  12: 'PROPFIND',\n  13: 'PROPPATCH',\n  14: 'SEARCH',\n  15: 'UNLOCK',\n  16: 'REPORT',\n  17: 'MKACTIVITY',\n  18: 'CHECKOUT',\n  19: 'MERGE',\n  24: 'PATCH'\n};\n\nHttpParser.prototype.isComplete = function() {\n  return this._complete;\n};\n\nHttpParser.prototype.parse = function(chunk) {\n  var offset   = (version < 6) ? 1 : 0,\n      consumed = this._parser.execute(chunk, 0, chunk.length) + offset;\n\n  if (this._complete)\n    this.body = (consumed < chunk.length)\n              ? chunk.slice(consumed)\n              : new Buffer(0);\n};\n\nmodule.exports = HttpParser;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/hybi.js":"'use strict';\n\nvar crypto     = require('crypto'),\n    util       = require('util'),\n    Extensions = require('websocket-extensions'),\n    Base       = require('./base'),\n    Frame      = require('./hybi/frame'),\n    Message    = require('./hybi/message');\n\nvar Hybi = function(request, url, options) {\n  Base.apply(this, arguments);\n\n  this._extensions     = new Extensions();\n  this._stage          = 0;\n  this._masking        = this._options.masking;\n  this._protocols      = this._options.protocols || [];\n  this._requireMasking = this._options.requireMasking;\n  this._pingCallbacks  = {};\n\n  if (typeof this._protocols === 'string')\n    this._protocols = this._protocols.split(/ *, */);\n\n  if (!this._request) return;\n\n  var secKey    = this._request.headers['sec-websocket-key'],\n      protos    = this._request.headers['sec-websocket-protocol'],\n      version   = this._request.headers['sec-websocket-version'],\n      supported = this._protocols;\n\n  this._headers.set('Upgrade', 'websocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Accept', Hybi.generateAccept(secKey));\n\n  if (protos !== undefined) {\n    if (typeof protos === 'string') protos = protos.split(/ *, */);\n    this.protocol = protos.filter(function(p) { return supported.indexOf(p) >= 0 })[0];\n    if (this.protocol) this._headers.set('Sec-WebSocket-Protocol', this.protocol);\n  }\n\n  this.version = 'hybi-' + version;\n};\nutil.inherits(Hybi, Base);\n\nHybi.mask = function(payload, mask, offset) {\n  if (!mask || mask.length === 0) return payload;\n  offset = offset || 0;\n\n  for (var i = 0, n = payload.length - offset; i < n; i++) {\n    payload[offset + i] = payload[offset + i] ^ mask[i % 4];\n  }\n  return payload;\n};\n\nHybi.generateAccept = function(key) {\n  var sha1 = crypto.createHash('sha1');\n  sha1.update(key + Hybi.GUID);\n  return sha1.digest('base64');\n};\n\nHybi.GUID = '258EAFA5-E914-47DA-95CA-C5AB0DC85B11';\n\nvar instance = {\n  FIN:    0x80,\n  MASK:   0x80,\n  RSV1:   0x40,\n  RSV2:   0x20,\n  RSV3:   0x10,\n  OPCODE: 0x0F,\n  LENGTH: 0x7F,\n\n  OPCODES: {\n    continuation: 0,\n    text:         1,\n    binary:       2,\n    close:        8,\n    ping:         9,\n    pong:         10\n  },\n\n  OPCODE_CODES:    [0, 1, 2, 8, 9, 10],\n  MESSAGE_OPCODES: [0, 1, 2],\n  OPENING_OPCODES: [1, 2],\n\n  ERRORS: {\n    normal_closure:       1000,\n    going_away:           1001,\n    protocol_error:       1002,\n    unacceptable:         1003,\n    encoding_error:       1007,\n    policy_violation:     1008,\n    too_large:            1009,\n    extension_error:      1010,\n    unexpected_condition: 1011\n  },\n\n  ERROR_CODES:        [1000, 1001, 1002, 1003, 1007, 1008, 1009, 1010, 1011],\n  DEFAULT_ERROR_CODE: 1000,\n  MIN_RESERVED_ERROR: 3000,\n  MAX_RESERVED_ERROR: 4999,\n\n  // http://www.w3.org/International/questions/qa-forms-utf-8.en.php\n  UTF8_MATCH: /^([\\x00-\\x7F]|[\\xC2-\\xDF][\\x80-\\xBF]|\\xE0[\\xA0-\\xBF][\\x80-\\xBF]|[\\xE1-\\xEC\\xEE\\xEF][\\x80-\\xBF]{2}|\\xED[\\x80-\\x9F][\\x80-\\xBF]|\\xF0[\\x90-\\xBF][\\x80-\\xBF]{2}|[\\xF1-\\xF3][\\x80-\\xBF]{3}|\\xF4[\\x80-\\x8F][\\x80-\\xBF]{2})*$/,\n\n  addExtension: function(extension) {\n    this._extensions.add(extension);\n    return true;\n  },\n\n  parse: function(chunk) {\n    this._reader.put(chunk);\n    var buffer = true;\n    while (buffer) {\n      switch (this._stage) {\n        case 0:\n          buffer = this._reader.read(1);\n          if (buffer) this._parseOpcode(buffer[0]);\n          break;\n\n        case 1:\n          buffer = this._reader.read(1);\n          if (buffer) this._parseLength(buffer[0]);\n          break;\n\n        case 2:\n          buffer = this._reader.read(this._frame.lengthBytes);\n          if (buffer) this._parseExtendedLength(buffer);\n          break;\n\n        case 3:\n          buffer = this._reader.read(4);\n          if (buffer) {\n            this._stage = 4;\n            this._frame.maskingKey = buffer;\n          }\n          break;\n\n        case 4:\n          buffer = this._reader.read(this._frame.length);\n          if (buffer) {\n            this._stage = 0;\n            this._emitFrame(buffer);\n          }\n          break;\n\n        default:\n          buffer = null;\n      }\n    }\n  },\n\n  text: function(message) {\n    if (this.readyState > 1) return false;\n    return this.frame(message, 'text');\n  },\n\n  binary: function(message) {\n    if (this.readyState > 1) return false;\n    return this.frame(message, 'binary');\n  },\n\n  ping: function(message, callback) {\n    if (this.readyState > 1) return false;\n    message = message || '';\n    if (callback) this._pingCallbacks[message] = callback;\n    return this.frame(message, 'ping');\n  },\n\n  pong: function(message) {\n      if (this.readyState > 1) return false;\n      message = message ||'';\n      return this.frame(message, 'pong');\n  },\n\n  close: function(reason, code) {\n    reason = reason || '';\n    code   = code   || this.ERRORS.normal_closure;\n\n    if (this.readyState <= 0) {\n      this.readyState = 3;\n      this.emit('close', new Base.CloseEvent(code, reason));\n      return true;\n    } else if (this.readyState === 1) {\n      this.readyState = 2;\n      this._extensions.close(function() { this.frame(reason, 'close', code) }, this);\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  frame: function(buffer, type, code) {\n    if (this.readyState <= 0) return this._queue([buffer, type, code]);\n    if (this.readyState > 2) return false;\n\n    if (buffer instanceof Array)    buffer = new Buffer(buffer);\n    if (typeof buffer === 'number') buffer = buffer.toString();\n\n    var message = new Message(),\n        isText  = (typeof buffer === 'string'),\n        payload, copy;\n\n    message.rsv1   = message.rsv2 = message.rsv3 = false;\n    message.opcode = this.OPCODES[type || (isText ? 'text' : 'binary')];\n\n    payload = isText ? new Buffer(buffer, 'utf8') : buffer;\n\n    if (code) {\n      copy = payload;\n      payload = new Buffer(2 + copy.length);\n      payload.writeUInt16BE(code, 0);\n      copy.copy(payload, 2);\n    }\n    message.data = payload;\n\n    var onMessageReady = function(message) {\n      var frame = new Frame();\n\n      frame.final   = true;\n      frame.rsv1    = message.rsv1;\n      frame.rsv2    = message.rsv2;\n      frame.rsv3    = message.rsv3;\n      frame.opcode  = message.opcode;\n      frame.masked  = !!this._masking;\n      frame.length  = message.data.length;\n      frame.payload = message.data;\n\n      if (frame.masked) frame.maskingKey = crypto.randomBytes(4);\n\n      this._sendFrame(frame);\n    };\n\n    if (this.MESSAGE_OPCODES.indexOf(message.opcode) >= 0)\n      this._extensions.processOutgoingMessage(message, function(error, message) {\n        if (error) return this._fail('extension_error', error.message);\n        onMessageReady.call(this, message);\n      }, this);\n    else\n      onMessageReady.call(this, message);\n\n    return true;\n  },\n\n  _sendFrame: function(frame) {\n    var length = frame.length,\n        header = (length <= 125) ? 2 : (length <= 65535 ? 4 : 10),\n        offset = header + (frame.masked ? 4 : 0),\n        buffer = new Buffer(offset + length),\n        masked = frame.masked ? this.MASK : 0;\n\n    buffer[0] = (frame.final ? this.FIN : 0) |\n                (frame.rsv1 ? this.RSV1 : 0) |\n                (frame.rsv2 ? this.RSV2 : 0) |\n                (frame.rsv3 ? this.RSV3 : 0) |\n                frame.opcode;\n\n    if (length <= 125) {\n      buffer[1] = masked | length;\n    } else if (length <= 65535) {\n      buffer[1] = masked | 126;\n      buffer.writeUInt16BE(length, 2);\n    } else {\n      buffer[1] = masked | 127;\n      buffer.writeUInt32BE(Math.floor(length / 0x100000000), 2);\n      buffer.writeUInt32BE(length % 0x100000000, 6);\n    }\n\n    frame.payload.copy(buffer, offset);\n\n    if (frame.masked) {\n      frame.maskingKey.copy(buffer, header);\n      Hybi.mask(buffer, frame.maskingKey, offset);\n    }\n\n    this._write(buffer);\n  },\n\n  _handshakeResponse: function() {\n    try {\n      var extensions = this._extensions.generateResponse(this._request.headers['sec-websocket-extensions']);\n    } catch (e) {\n      return this._fail('protocol_error', e.message);\n    }\n\n    if (extensions) this._headers.set('Sec-WebSocket-Extensions', extensions);\n\n    var start   = 'HTTP/1.1 101 Switching Protocols',\n        headers = [start, this._headers.toString(), ''];\n\n    return new Buffer(headers.join('\\r\\n'), 'utf8');\n  },\n\n  _shutdown: function(code, reason, error) {\n    delete this._frame;\n    delete this._message;\n    this._stage = 5;\n\n    var sendCloseFrame = (this.readyState === 1);\n    this.readyState = 2;\n\n    this._extensions.close(function() {\n      if (sendCloseFrame) this.frame(reason, 'close', code);\n      this.readyState = 3;\n      if (error) this.emit('error', new Error(reason));\n      this.emit('close', new Base.CloseEvent(code, reason));\n    }, this);\n  },\n\n  _fail: function(type, message) {\n    if (this.readyState > 1) return;\n    this._shutdown(this.ERRORS[type], message, true);\n  },\n\n  _parseOpcode: function(octet) {\n    var rsvs = [this.RSV1, this.RSV2, this.RSV3].map(function(rsv) {\n      return (octet & rsv) === rsv;\n    });\n\n    var frame = this._frame = new Frame();\n\n    frame.final  = (octet & this.FIN) === this.FIN;\n    frame.rsv1   = rsvs[0];\n    frame.rsv2   = rsvs[1];\n    frame.rsv3   = rsvs[2];\n    frame.opcode = (octet & this.OPCODE);\n\n    this._stage = 1;\n\n    if (!this._extensions.validFrameRsv(frame))\n      return this._fail('protocol_error',\n          'One or more reserved bits are on: reserved1 = ' + (frame.rsv1 ? 1 : 0) +\n          ', reserved2 = ' + (frame.rsv2 ? 1 : 0) +\n          ', reserved3 = ' + (frame.rsv3 ? 1 : 0));\n\n    if (this.OPCODE_CODES.indexOf(frame.opcode) < 0)\n      return this._fail('protocol_error', 'Unrecognized frame opcode: ' + frame.opcode);\n\n    if (this.MESSAGE_OPCODES.indexOf(frame.opcode) < 0 && !frame.final)\n      return this._fail('protocol_error', 'Received fragmented control frame: opcode = ' + frame.opcode);\n\n    if (this._message && this.OPENING_OPCODES.indexOf(frame.opcode) >= 0)\n      return this._fail('protocol_error', 'Received new data frame but previous continuous frame is unfinished');\n  },\n\n  _parseLength: function(octet) {\n    var frame = this._frame;\n    frame.masked = (octet & this.MASK) === this.MASK;\n    frame.length = (octet & this.LENGTH);\n\n    if (frame.length >= 0 && frame.length <= 125) {\n      this._stage = frame.masked ? 3 : 4;\n      if (!this._checkFrameLength()) return;\n    } else {\n      this._stage = 2;\n      frame.lengthBytes = (frame.length === 126 ? 2 : 8);\n    }\n\n    if (this._requireMasking && !frame.masked)\n      return this._fail('unacceptable', 'Received unmasked frame but masking is required');\n  },\n\n  _parseExtendedLength: function(buffer) {\n    var frame = this._frame;\n    frame.length = this._readUInt(buffer);\n\n    this._stage = frame.masked ? 3 : 4;\n\n    if (this.MESSAGE_OPCODES.indexOf(frame.opcode) < 0 && frame.length > 125)\n      return this._fail('protocol_error', 'Received control frame having too long payload: ' + frame.length);\n\n    if (!this._checkFrameLength()) return;\n  },\n\n  _checkFrameLength: function() {\n    var length = this._message ? this._message.length : 0;\n\n    if (length + this._frame.length > this._maxLength) {\n      this._fail('too_large', 'WebSocket frame length too large');\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  _emitFrame: function(buffer) {\n    var frame   = this._frame,\n        payload = frame.payload = Hybi.mask(buffer, frame.maskingKey),\n        opcode  = frame.opcode,\n        message,\n        code, reason,\n        callbacks, callback;\n\n    delete this._frame;\n\n    if (opcode === this.OPCODES.continuation) {\n      if (!this._message) return this._fail('protocol_error', 'Received unexpected continuation frame');\n      this._message.pushFrame(frame);\n    }\n\n    if (opcode === this.OPCODES.text || opcode === this.OPCODES.binary) {\n      this._message = new Message();\n      this._message.pushFrame(frame);\n    }\n\n    if (frame.final && this.MESSAGE_OPCODES.indexOf(opcode) >= 0)\n      return this._emitMessage(this._message);\n\n    if (opcode === this.OPCODES.close) {\n      code   = (payload.length >= 2) ? payload.readUInt16BE(0) : null;\n      reason = (payload.length > 2) ? this._encode(payload.slice(2)) : null;\n\n      if (!(payload.length === 0) &&\n          !(code !== null && code >= this.MIN_RESERVED_ERROR && code <= this.MAX_RESERVED_ERROR) &&\n          this.ERROR_CODES.indexOf(code) < 0)\n        code = this.ERRORS.protocol_error;\n\n      if (payload.length > 125 || (payload.length > 2 && !reason))\n        code = this.ERRORS.protocol_error;\n\n      this._shutdown(code || this.DEFAULT_ERROR_CODE, reason || '');\n    }\n\n    if (opcode === this.OPCODES.ping) {\n      this.frame(payload, 'pong');\n    }\n\n    if (opcode === this.OPCODES.pong) {\n      callbacks = this._pingCallbacks;\n      message   = this._encode(payload);\n      callback  = callbacks[message];\n\n      delete callbacks[message];\n      if (callback) callback()\n    }\n  },\n\n  _emitMessage: function(message) {\n    var message = this._message;\n    message.read();\n\n    delete this._message;\n\n    this._extensions.processIncomingMessage(message, function(error, message) {\n      if (error) return this._fail('extension_error', error.message);\n\n      var payload = message.data;\n      if (message.opcode === this.OPCODES.text) payload = this._encode(payload);\n\n      if (payload === null)\n        return this._fail('encoding_error', 'Could not decode a text frame as UTF-8');\n      else\n        this.emit('message', new Base.MessageEvent(payload));\n    }, this);\n  },\n\n  _encode: function(buffer) {\n    try {\n      var string = buffer.toString('binary', 0, buffer.length);\n      if (!this.UTF8_MATCH.test(string)) return null;\n    } catch (e) {}\n    return buffer.toString('utf8', 0, buffer.length);\n  },\n\n  _readUInt: function(buffer) {\n    if (buffer.length === 2) return buffer.readUInt16BE(0);\n\n    return buffer.readUInt32BE(0) * 0x100000000 +\n           buffer.readUInt32BE(4);\n  }\n};\n\nfor (var key in instance)\n  Hybi.prototype[key] = instance[key];\n\nmodule.exports = Hybi;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/websocket_extensions.js":"'use strict';\n\nvar Parser   = require('./parser'),\n    Pipeline = require('./pipeline');\n\nvar Extensions = function() {\n  this._rsv1 = this._rsv2 = this._rsv3 = null;\n\n  this._byName   = {};\n  this._inOrder  = [];\n  this._sessions = [];\n  this._index    = {}\n};\n\nExtensions.MESSAGE_OPCODES = [1, 2];\n\nvar instance = {\n  add: function(ext) {\n    if (typeof ext.name !== 'string') throw new TypeError('extension.name must be a string');\n    if (ext.type !== 'permessage') throw new TypeError('extension.type must be \"permessage\"');\n\n    if (typeof ext.rsv1 !== 'boolean') throw new TypeError('extension.rsv1 must be true or false');\n    if (typeof ext.rsv2 !== 'boolean') throw new TypeError('extension.rsv2 must be true or false');\n    if (typeof ext.rsv3 !== 'boolean') throw new TypeError('extension.rsv3 must be true or false');\n\n    if (this._byName.hasOwnProperty(ext.name))\n      throw new TypeError('An extension with name \"' + ext.name + '\" is already registered');\n\n    this._byName[ext.name] = ext;\n    this._inOrder.push(ext);\n  },\n\n  generateOffer: function() {\n    var sessions = [],\n        offer    = [],\n        index    = {};\n\n    this._inOrder.forEach(function(ext) {\n      var session = ext.createClientSession();\n      if (!session) return;\n\n      var record = [ext, session];\n      sessions.push(record);\n      index[ext.name] = record;\n\n      var offers = session.generateOffer();\n      offers = offers ? [].concat(offers) : [];\n\n      offers.forEach(function(off) {\n        offer.push(Parser.serializeParams(ext.name, off));\n      }, this);\n    }, this);\n\n    this._sessions = sessions;\n    this._index    = index;\n\n    return offer.length > 0 ? offer.join(', ') : null;\n  },\n\n  activate: function(header) {\n    var responses = Parser.parseHeader(header),\n        sessions  = [];\n\n    responses.eachOffer(function(name, params) {\n      var record = this._index[name];\n\n      if (!record)\n        throw new Error('Server sent an extension response for unknown extension \"' + name + '\"');\n\n      var ext      = record[0],\n          session  = record[1],\n          reserved = this._reserved(ext);\n\n      if (reserved)\n        throw new Error('Server sent two extension responses that use the RSV' +\n                        reserved[0] + ' bit: \"' +\n                        reserved[1] + '\" and \"' + ext.name + '\"');\n\n      if (session.activate(params) !== true)\n        throw new Error('Server sent unacceptable extension parameters: ' +\n                        Parser.serializeParams(name, params));\n\n      this._reserve(ext);\n      sessions.push(record);\n    }, this);\n\n    this._sessions = sessions;\n    this._pipeline = new Pipeline(sessions);\n  },\n\n  generateResponse: function(header) {\n    var offers   = Parser.parseHeader(header),\n        sessions = [],\n        response = [];\n\n    this._inOrder.forEach(function(ext) {\n      var offer = offers.byName(ext.name);\n      if (offer.length === 0 || this._reserved(ext)) return;\n\n      var session = ext.createServerSession(offer);\n      if (!session) return;\n\n      this._reserve(ext);\n      sessions.push([ext, session]);\n      response.push(Parser.serializeParams(ext.name, session.generateResponse()));\n    }, this);\n\n    this._sessions = sessions;\n    this._pipeline = new Pipeline(sessions);\n\n    return response.length > 0 ? response.join(', ') : null;\n  },\n\n  validFrameRsv: function(frame) {\n    var allowed = {rsv1: false, rsv2: false, rsv3: false},\n        ext;\n\n    if (Extensions.MESSAGE_OPCODES.indexOf(frame.opcode) >= 0) {\n      for (var i = 0, n = this._sessions.length; i < n; i++) {\n        ext = this._sessions[i][0];\n        allowed.rsv1 = allowed.rsv1 || ext.rsv1;\n        allowed.rsv2 = allowed.rsv2 || ext.rsv2;\n        allowed.rsv3 = allowed.rsv3 || ext.rsv3;\n      }\n    }\n\n    return (allowed.rsv1 || !frame.rsv1) &&\n           (allowed.rsv2 || !frame.rsv2) &&\n           (allowed.rsv3 || !frame.rsv3);\n  },\n\n  processIncomingMessage: function(message, callback, context) {\n    this._pipeline.processIncomingMessage(message, callback, context);\n  },\n\n  processOutgoingMessage: function(message, callback, context) {\n    this._pipeline.processOutgoingMessage(message, callback, context);\n  },\n\n  close: function(callback, context) {\n    if (!this._pipeline) return callback.call(context);\n    this._pipeline.close(callback, context);\n  },\n\n  _reserve: function(ext) {\n    this._rsv1 = this._rsv1 || (ext.rsv1 && ext.name);\n    this._rsv2 = this._rsv2 || (ext.rsv2 && ext.name);\n    this._rsv3 = this._rsv3 || (ext.rsv3 && ext.name);\n  },\n\n  _reserved: function(ext) {\n    if (this._rsv1 && ext.rsv1) return [1, this._rsv1];\n    if (this._rsv2 && ext.rsv2) return [2, this._rsv2];\n    if (this._rsv3 && ext.rsv3) return [3, this._rsv3];\n    return false;\n  }\n};\n\nfor (var key in instance)\n  Extensions.prototype[key] = instance[key];\n\nmodule.exports = Extensions;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/parser.js":"'use strict';\n\nvar TOKEN    = /([!#\\$%&'\\*\\+\\-\\.\\^_`\\|~0-9a-z]+)/,\n    NOTOKEN  = /([^!#\\$%&'\\*\\+\\-\\.\\^_`\\|~0-9a-z])/g,\n    QUOTED   = /\"((?:\\\\[\\x00-\\x7f]|[^\\x00-\\x08\\x0a-\\x1f\\x7f\"])*)\"/,\n    PARAM    = new RegExp(TOKEN.source + '(?:=(?:' + TOKEN.source + '|' + QUOTED.source + '))?'),\n    EXT      = new RegExp(TOKEN.source + '(?: *; *' + PARAM.source + ')*', 'g'),\n    EXT_LIST = new RegExp('^' + EXT.source + '(?: *, *' + EXT.source + ')*$'),\n    NUMBER   = /^-?(0|[1-9][0-9]*)(\\.[0-9]+)?$/;\n\nvar Parser = {\n  parseHeader: function(header) {\n    var offers = new Offers();\n    if (header === '' || header === undefined) return offers;\n\n    if (!EXT_LIST.test(header))\n      throw new SyntaxError('Invalid Sec-WebSocket-Extensions header: ' + header);\n\n    var values = header.match(EXT);\n\n    values.forEach(function(value) {\n      var params = value.match(new RegExp(PARAM.source, 'g')),\n          name   = params.shift(),\n          offer  = {};\n\n      params.forEach(function(param) {\n        var args = param.match(PARAM), key = args[1], data;\n\n        if (args[2] !== undefined) {\n          data = args[2];\n        } else if (args[3] !== undefined) {\n          data = args[3].replace(/\\\\/g, '');\n        } else {\n          data = true;\n        }\n        if (NUMBER.test(data)) data = parseFloat(data);\n\n        if (offer.hasOwnProperty(key)) {\n          offer[key] = [].concat(offer[key]);\n          offer[key].push(data);\n        } else {\n          offer[key] = data;\n        }\n      }, this);\n      offers.push(name, offer);\n    }, this);\n\n    return offers;\n  },\n\n  serializeParams: function(name, params) {\n    var values = [];\n\n    var print = function(key, value) {\n      if (value instanceof Array) {\n        value.forEach(function(v) { print(key, v) });\n      } else if (value === true) {\n        values.push(key);\n      } else if (typeof value === 'number') {\n        values.push(key + '=' + value);\n      } else if (NOTOKEN.test(value)) {\n        values.push(key + '=\"' + value.replace(/\"/g, '\\\\\"') + '\"');\n      } else {\n        values.push(key + '=' + value);\n      }\n    };\n\n    for (var key in params) print(key, params[key]);\n\n    return [name].concat(values).join('; ');\n  }\n};\n\nvar Offers = function() {\n  this._byName  = {};\n  this._inOrder = [];\n};\n\nOffers.prototype.push = function(name, params) {\n  this._byName[name] = this._byName[name] || [];\n  this._byName[name].push(params);\n  this._inOrder.push({name: name, params: params});\n};\n\nOffers.prototype.eachOffer = function(callback, context) {\n  var list = this._inOrder;\n  for (var i = 0, n = list.length; i < n; i++)\n    callback.call(context, list[i].name, list[i].params);\n};\n\nOffers.prototype.byName = function(name) {\n  return this._byName[name] || [];\n};\n\nOffers.prototype.toArray = function() {\n  return this._inOrder.slice();\n};\n\nmodule.exports = Parser;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/pipeline/index.js":"'use strict';\n\nvar Cell   = require('./cell'),\n    Pledge = require('./pledge');\n\nvar Pipeline = function(sessions) {\n  this._cells   = sessions.map(function(session) { return new Cell(session) });\n  this._stopped = {incoming: false, outgoing: false};\n};\n\nPipeline.prototype.processIncomingMessage = function(message, callback, context) {\n  if (this._stopped.incoming) return;\n  this._loop('incoming', this._cells.length - 1, -1, -1, message, callback, context);\n};\n\nPipeline.prototype.processOutgoingMessage = function(message, callback, context) {\n  if (this._stopped.outgoing) return;\n  this._loop('outgoing', 0, this._cells.length, 1, message, callback, context);\n};\n\nPipeline.prototype.close = function(callback, context) {\n  this._stopped = {incoming: true, outgoing: true};\n\n  var closed = this._cells.map(function(a) { return a.close() });\n  if (callback)\n    Pledge.all(closed).then(function() { callback.call(context) });\n};\n\nPipeline.prototype._loop = function(direction, start, end, step, message, callback, context) {\n  var cells = this._cells,\n      n     = cells.length,\n      self  = this;\n\n  while (n--) cells[n].pending(direction);\n\n  var pipe = function(index, error, msg) {\n    if (index === end) return callback.call(context, error, msg);\n\n    cells[index][direction](error, msg, function(err, m) {\n      if (err) self._stopped[direction] = true;\n      pipe(index + step, err, m);\n    });\n  };\n  pipe(start, null, message);\n};\n\nmodule.exports = Pipeline;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/pipeline/cell.js":"'use strict';\n\nvar Functor = require('./functor'),\n    Pledge  = require('./pledge');\n\nvar Cell = function(tuple) {\n  this._ext     = tuple[0];\n  this._session = tuple[1];\n\n  this._functors = {\n    incoming: new Functor(this._session, 'processIncomingMessage'),\n    outgoing: new Functor(this._session, 'processOutgoingMessage')\n  };\n};\n\nCell.prototype.pending = function(direction) {\n  this._functors[direction].pending += 1;\n};\n\nCell.prototype.incoming = function(error, message, callback, context) {\n  this._exec('incoming', error, message, callback, context);\n};\n\nCell.prototype.outgoing = function(error, message, callback, context) {\n  this._exec('outgoing', error, message, callback, context);\n};\n\nCell.prototype.close = function() {\n  this._closed = this._closed || new Pledge();\n  this._doClose();\n  return this._closed;\n};\n\nCell.prototype._exec = function(direction, error, message, callback, context) {\n  this._functors[direction].call(error, message, function(err, msg) {\n    if (err) err.message = this._ext.name + ': ' + err.message;\n    callback.call(context, err, msg);\n    this._doClose();\n  }, this);\n};\n\nCell.prototype._doClose = function() {\n  var fin  = this._functors.incoming,\n      fout = this._functors.outgoing;\n\n  if (!this._closed || fin.pending + fout.pending !== 0) return;\n  if (this._session) this._session.close();\n  this._session = null;\n  this._closed.done();\n};\n\nmodule.exports = Cell;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/pipeline/functor.js":"'use strict';\n\nvar RingBuffer = require('./ring_buffer');\n\nvar Functor = function(session, method) {\n  this._session = session;\n  this._method  = method;\n  this._queue   = new RingBuffer(Functor.QUEUE_SIZE);\n  this._stopped = false;\n  this.pending  = 0;\n};\n\nFunctor.QUEUE_SIZE = 8;\n\nFunctor.prototype.call = function(error, message, callback, context) {\n  if (this._stopped) return;\n\n  var record = {error: error, message: message, callback: callback, context: context, done: false},\n      called = false,\n      self   = this;\n\n  this._queue.push(record);\n\n  if (record.error) {\n    record.done = true;\n    this._stop();\n    return this._flushQueue();\n  }\n\n  this._session[this._method](message, function(err, msg) {\n    if (!(called ^ (called = true))) return;\n\n    if (err) {\n      self._stop();\n      record.error   = err;\n      record.message = null;\n    } else {\n      record.message = msg;\n    }\n\n    record.done = true;\n    self._flushQueue();\n  });\n};\n\nFunctor.prototype._stop = function() {\n  this.pending  = this._queue.length;\n  this._stopped = true;\n};\n\nFunctor.prototype._flushQueue = function() {\n  var queue = this._queue, record;\n\n  while (queue.length > 0 && queue.peek().done) {\n    this.pending -= 1;\n    record = queue.shift();\n    record.callback.call(record.context, record.error, record.message);\n  }\n};\n\nmodule.exports = Functor;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/pipeline/ring_buffer.js":"'use strict';\n\nvar RingBuffer = function(bufferSize) {\n  this._buffer     = new Array(bufferSize);\n  this._bufferSize = bufferSize;\n  this._ringOffset = 0;\n  this._ringSize   = bufferSize;\n  this._head       = 0;\n  this._tail       = 0;\n  this.length      = 0;\n};\n\nRingBuffer.prototype.push = function(value) {\n  var expandBuffer = false,\n      expandRing   = false;\n\n  if (this._ringSize < this._bufferSize) {\n    expandBuffer = (this._tail === 0);\n  } else if (this._ringOffset === this._ringSize) {\n    expandBuffer = true;\n    expandRing   = (this._tail === 0);\n  }\n\n  if (expandBuffer) {\n    this._tail       = this._bufferSize;\n    this._buffer     = this._buffer.concat(new Array(this._bufferSize));\n    this._bufferSize = this._buffer.length;\n\n    if (expandRing)\n      this._ringSize = this._bufferSize;\n  }\n\n  this._buffer[this._tail] = value;\n  this.length += 1;\n  if (this._tail < this._ringSize) this._ringOffset += 1;\n  this._tail = (this._tail + 1) % this._bufferSize;\n};\n\nRingBuffer.prototype.peek = function() {\n  if (this.length === 0) return void 0;\n  return this._buffer[this._head];\n};\n\nRingBuffer.prototype.shift = function() {\n  if (this.length === 0) return void 0;\n\n  var value = this._buffer[this._head];\n  this._buffer[this._head] = void 0;\n  this.length -= 1;\n  this._ringOffset -= 1;\n\n  if (this._ringOffset === 0 && this.length > 0) {\n    this._head       = this._ringSize;\n    this._ringOffset = this.length;\n    this._ringSize   = this._bufferSize;\n  } else {\n    this._head = (this._head + 1) % this._ringSize;\n  }\n  return value;\n};\n\nmodule.exports = RingBuffer;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-extensions/lib/pipeline/pledge.js":"'use strict';\n\nvar RingBuffer = require('./ring_buffer');\n\nvar Pledge = function() {\n  this._complete  = false;\n  this._callbacks = new RingBuffer(Pledge.QUEUE_SIZE);\n};\n\nPledge.QUEUE_SIZE = 4;\n\nPledge.all = function(list) {\n  var pledge  = new Pledge(),\n      pending = list.length,\n      n       = pending;\n\n  if (pending === 0) pledge.done();\n\n  while (n--) list[n].then(function() {\n    pending -= 1;\n    if (pending === 0) pledge.done();\n  });\n  return pledge;\n};\n\nPledge.prototype.then = function(callback) {\n  if (this._complete) callback();\n  else this._callbacks.push(callback);\n};\n\nPledge.prototype.done = function() {\n  this._complete = true;\n  var callbacks = this._callbacks, callback;\n  while (callback = callbacks.shift()) callback();\n};\n\nmodule.exports = Pledge;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/hybi/frame.js":"'use strict';\n\nvar Frame = function() {};\n\nvar instance = {\n  final:        false,\n  rsv1:         false,\n  rsv2:         false,\n  rsv3:         false,\n  opcode:       null,\n  masked:       false,\n  maskingKey:   null,\n  lengthBytes:  1,\n  length:       0,\n  payload:      null\n};\n\nfor (var key in instance)\n  Frame.prototype[key] = instance[key];\n\nmodule.exports = Frame;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/hybi/message.js":"'use strict';\n\nvar Message = function() {\n  this.rsv1    = false;\n  this.rsv2    = false;\n  this.rsv3    = false;\n  this.opcode  = null\n  this.length  = 0;\n  this._chunks = [];\n};\n\nvar instance = {\n  read: function() {\n    if (this.data) return this.data;\n\n    this.data  = new Buffer(this.length);\n    var offset = 0;\n\n    for (var i = 0, n = this._chunks.length; i < n; i++) {\n      this._chunks[i].copy(this.data, offset);\n      offset += this._chunks[i].length;\n    }\n    return this.data;\n  },\n\n  pushFrame: function(frame) {\n    this.rsv1 = this.rsv1 || frame.rsv1;\n    this.rsv2 = this.rsv2 || frame.rsv2;\n    this.rsv3 = this.rsv3 || frame.rsv3;\n\n    if (this.opcode === null) this.opcode = frame.opcode;\n\n    this._chunks.push(frame.payload);\n    this.length += frame.length;\n  }\n};\n\nfor (var key in instance)\n  Message.prototype[key] = instance[key];\n\nmodule.exports = Message;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/proxy.js":"'use strict';\n\nvar Stream     = require('stream').Stream,\n    url        = require('url'),\n    util       = require('util'),\n    Base       = require('./base'),\n    Headers    = require('./headers'),\n    HttpParser = require('../http_parser');\n\nvar PORTS = {'ws:': 80, 'wss:': 443};\n\nvar Proxy = function(client, origin, options) {\n  this._client  = client;\n  this._http    = new HttpParser('response');\n  this._origin  = (typeof client.url === 'object') ? client.url : url.parse(client.url);\n  this._url     = (typeof origin === 'object') ? origin : url.parse(origin);\n  this._options = options || {};\n  this._state   = 0;\n\n  this.readable = this.writable = true;\n  this._paused  = false;\n\n  this._headers = new Headers();\n  this._headers.set('Host', this._origin.host);\n  this._headers.set('Connection', 'keep-alive');\n  this._headers.set('Proxy-Connection', 'keep-alive');\n\n  var auth = this._url.auth && new Buffer(this._url.auth, 'utf8').toString('base64');\n  if (auth) this._headers.set('Proxy-Authorization', 'Basic ' + auth);\n};\nutil.inherits(Proxy, Stream);\n\nvar instance = {\n  setHeader: function(name, value) {\n    if (this._state !== 0) return false;\n    this._headers.set(name, value);\n    return true;\n  },\n\n  start: function() {\n    if (this._state !== 0) return false;\n    this._state = 1;\n\n    var origin = this._origin,\n        port   = origin.port || PORTS[origin.protocol],\n        start  = 'CONNECT ' + origin.hostname + ':' + port + ' HTTP/1.1';\n\n    var headers = [start, this._headers.toString(), ''];\n\n    this.emit('data', new Buffer(headers.join('\\r\\n'), 'utf8'));\n    return true;\n  },\n\n  pause: function() {\n    this._paused = true;\n  },\n\n  resume: function() {\n    this._paused = false;\n    this.emit('drain');\n  },\n\n  write: function(chunk) {\n    if (!this.writable) return false;\n\n    this._http.parse(chunk);\n    if (!this._http.isComplete()) return !this._paused;\n\n    this.statusCode = this._http.statusCode;\n    this.headers    = this._http.headers;\n\n    if (this.statusCode === 200) {\n      this.emit('connect', new Base.ConnectEvent());\n    } else {\n      var message = \"Can't establish a connection to the server at \" + this._origin.href;\n      this.emit('error', new Error(message));\n    }\n    this.end();\n    return !this._paused;\n  },\n\n  end: function(chunk) {\n    if (!this.writable) return;\n    if (chunk !== undefined) this.write(chunk);\n    this.readable = this.writable = false;\n    this.emit('close');\n    this.emit('end');\n  },\n\n  destroy: function() {\n    this.end();\n  }\n};\n\nfor (var key in instance)\n  Proxy.prototype[key] = instance[key];\n\nmodule.exports = Proxy;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/server.js":"'use strict';\n\nvar util       = require('util'),\n    HttpParser = require('../http_parser'),\n    Base       = require('./base'),\n    Draft75    = require('./draft75'),\n    Draft76    = require('./draft76'),\n    Hybi       = require('./hybi');\n\nvar Server = function(options) {\n  Base.call(this, null, null, options);\n  this._http = new HttpParser('request');\n};\nutil.inherits(Server, Base);\n\nvar instance = {\n  EVENTS: ['open', 'message', 'error', 'close'],\n\n  _bindEventListeners: function() {\n    this.messages.on('error', function() {});\n    this.on('error', function() {});\n  },\n\n  parse: function(chunk) {\n    if (this._delegate) return this._delegate.parse(chunk);\n\n    this._http.parse(chunk);\n    if (!this._http.isComplete()) return;\n\n    this.method  = this._http.method;\n    this.url     = this._http.url;\n    this.headers = this._http.headers;\n    this.body    = this._http.body;\n\n    var self = this;\n    this._delegate = Server.http(this, this._options);\n    this._delegate.messages = this.messages;\n    this._delegate.io = this.io;\n    this._open();\n\n    this.EVENTS.forEach(function(event) {\n      this._delegate.on(event, function(e) { self.emit(event, e) });\n    }, this);\n\n    this.protocol = this._delegate.protocol;\n    this.version  = this._delegate.version;\n\n    this.parse(this._http.body);\n    this.emit('connect', new Base.ConnectEvent());\n  },\n\n  _open: function() {\n    this.__queue.forEach(function(msg) {\n      this._delegate[msg[0]].apply(this._delegate, msg[1]);\n    }, this);\n    this.__queue = [];\n  }\n};\n\n['addExtension', 'setHeader', 'start', 'frame', 'text', 'binary', 'ping', 'close'].forEach(function(method) {\n  instance[method] = function() {\n    if (this._delegate) {\n      return this._delegate[method].apply(this._delegate, arguments);\n    } else {\n      this.__queue.push([method, arguments]);\n      return true;\n    }\n  };\n});\n\nfor (var key in instance)\n  Server.prototype[key] = instance[key];\n\nServer.isSecureRequest = function(request) {\n  if (request.connection && request.connection.authorized !== undefined) return true;\n  if (request.socket && request.socket.secure) return true;\n\n  var headers = request.headers;\n  if (!headers) return false;\n  if (headers['https'] === 'on') return true;\n  if (headers['x-forwarded-ssl'] === 'on') return true;\n  if (headers['x-forwarded-scheme'] === 'https') return true;\n  if (headers['x-forwarded-proto'] === 'https') return true;\n\n  return false;\n};\n\nServer.determineUrl = function(request) {\n  var scheme = this.isSecureRequest(request) ? 'wss:' : 'ws:';\n  return scheme + '//' + request.headers.host + request.url;\n};\n\nServer.http = function(request, options) {\n  options = options || {};\n  if (options.requireMasking === undefined) options.requireMasking = true;\n\n  var headers = request.headers,\n      url     = this.determineUrl(request);\n\n  if (headers['sec-websocket-version'])\n    return new Hybi(request, url, options);\n  else if (headers['sec-websocket-key1'])\n    return new Draft76(request, url, options);\n  else\n    return new Draft75(request, url, options);\n};\n\nmodule.exports = Server;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/draft75.js":"'use strict';\n\nvar Base = require('./base'),\n    util = require('util');\n\nvar Draft75 = function(request, url, options) {\n  Base.apply(this, arguments);\n  this._stage  = 0;\n  this.version = 'hixie-75';\n\n  this._headers.set('Upgrade', 'WebSocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('WebSocket-Origin', this._request.headers.origin);\n  this._headers.set('WebSocket-Location', this.url);\n};\nutil.inherits(Draft75, Base);\n\nvar instance = {\n  close: function() {\n    if (this.readyState === 3) return false;\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n\n  parse: function(chunk) {\n    if (this.readyState > 1) return;\n\n    this._reader.put(chunk);\n\n    this._reader.eachByte(function(octet) {\n      var message;\n\n      switch (this._stage) {\n        case -1:\n          this._body.push(octet);\n          this._sendHandshakeBody();\n          break;\n\n        case 0:\n          this._parseLeadingByte(octet);\n          break;\n\n        case 1:\n          this._length = (octet & 0x7F) + 128 * this._length;\n\n          if (this._closing && this._length === 0) {\n            return this.close();\n          }\n          else if ((octet & 0x80) !== 0x80) {\n            if (this._length === 0) {\n              this._stage = 0;\n            }\n            else {\n              this._skipped = 0;\n              this._stage   = 2;\n            }\n          }\n          break;\n\n        case 2:\n          if (octet === 0xFF) {\n            this._stage = 0;\n            message = new Buffer(this._buffer).toString('utf8', 0, this._buffer.length);\n            this.emit('message', new Base.MessageEvent(message));\n          }\n          else {\n            if (this._length) {\n              this._skipped += 1;\n              if (this._skipped === this._length)\n                this._stage = 0;\n            } else {\n              this._buffer.push(octet);\n              if (this._buffer.length > this._maxLength) return this.close();\n            }\n          }\n          break;\n      }\n    }, this);\n  },\n\n  frame: function(buffer) {\n    if (this.readyState === 0) return this._queue([buffer]);\n    if (this.readyState > 1) return false;\n\n    if (typeof buffer !== 'string') buffer = buffer.toString();\n\n    var payload = new Buffer(buffer, 'utf8'),\n        frame   = new Buffer(payload.length + 2);\n\n    frame[0] = 0x00;\n    frame[payload.length + 1] = 0xFF;\n    payload.copy(frame, 1);\n\n    this._write(frame);\n    return true;\n  },\n\n  _handshakeResponse: function() {\n    var start   = 'HTTP/1.1 101 Web Socket Protocol Handshake',\n        headers = [start, this._headers.toString(), ''];\n\n    return new Buffer(headers.join('\\r\\n'), 'utf8');\n  },\n\n  _parseLeadingByte: function(octet) {\n    if ((octet & 0x80) === 0x80) {\n      this._length = 0;\n      this._stage  = 1;\n    } else {\n      delete this._length;\n      delete this._skipped;\n      this._buffer = [];\n      this._stage  = 2;\n    }\n  }\n};\n\nfor (var key in instance)\n  Draft75.prototype[key] = instance[key];\n\nmodule.exports = Draft75;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/websocket-driver/lib/websocket/driver/draft76.js":"'use strict';\n\nvar Base    = require('./base'),\n    Draft75 = require('./draft75'),\n    crypto  = require('crypto'),\n    util    = require('util');\n\n\nvar numberFromKey = function(key) {\n  return parseInt(key.match(/[0-9]/g).join(''), 10);\n};\n\nvar spacesInKey = function(key) {\n  return key.match(/ /g).length;\n};\n\n\nvar Draft76 = function(request, url, options) {\n  Draft75.apply(this, arguments);\n  this._stage  = -1;\n  this._body   = [];\n  this.version = 'hixie-76';\n\n  this._headers.clear();\n\n  this._headers.set('Upgrade', 'WebSocket');\n  this._headers.set('Connection', 'Upgrade');\n  this._headers.set('Sec-WebSocket-Origin', this._request.headers.origin);\n  this._headers.set('Sec-WebSocket-Location', this.url);\n};\nutil.inherits(Draft76, Draft75);\n\nvar instance = {\n  BODY_SIZE: 8,\n\n  start: function() {\n    if (!Draft75.prototype.start.call(this)) return false;\n    this._started = true;\n    this._sendHandshakeBody();\n    return true;\n  },\n\n  close: function() {\n    if (this.readyState === 3) return false;\n    this._write(new Buffer([0xFF, 0x00]));\n    this.readyState = 3;\n    this.emit('close', new Base.CloseEvent(null, null));\n    return true;\n  },\n\n  _handshakeResponse: function() {\n    var headers = this._request.headers,\n\n        key1    = headers['sec-websocket-key1'],\n        number1 = numberFromKey(key1),\n        spaces1 = spacesInKey(key1),\n\n        key2    = headers['sec-websocket-key2'],\n        number2 = numberFromKey(key2),\n        spaces2 = spacesInKey(key2);\n\n    if (number1 % spaces1 !== 0 || number2 % spaces2 !== 0) {\n      this.emit('error', new Error('Client sent invalid Sec-WebSocket-Key headers'));\n      this.close();\n      return null;\n    }\n\n    this._keyValues = [number1 / spaces1, number2 / spaces2];\n\n    var start   = 'HTTP/1.1 101 WebSocket Protocol Handshake',\n        headers = [start, this._headers.toString(), ''];\n\n    return new Buffer(headers.join('\\r\\n'), 'binary');\n  },\n\n  _handshakeSignature: function() {\n    if (this._body.length < this.BODY_SIZE) return null;\n\n    var md5    = crypto.createHash('md5'),\n        buffer = new Buffer(8 + this.BODY_SIZE);\n\n    buffer.writeUInt32BE(this._keyValues[0], 0);\n    buffer.writeUInt32BE(this._keyValues[1], 4);\n    new Buffer(this._body).copy(buffer, 8, 0, this.BODY_SIZE);\n\n    md5.update(buffer);\n    return new Buffer(md5.digest('binary'), 'binary');\n  },\n\n  _sendHandshakeBody: function() {\n    if (!this._started) return;\n    var signature = this._handshakeSignature();\n    if (!signature) return;\n\n    this._write(signature);\n    this._stage = 0;\n    this._open();\n\n    if (this._body.length > this.BODY_SIZE)\n      this.parse(this._body.slice(this.BODY_SIZE));\n  },\n\n  _parseLeadingByte: function(octet) {\n    if (octet !== 0xFF)\n      return Draft75.prototype._parseLeadingByte.call(this, octet);\n\n    this._closing = true;\n    this._length  = 0;\n    this._stage   = 1;\n  }\n};\n\nfor (var key in instance)\n  Draft76.prototype[key] = instance[key];\n\nmodule.exports = Draft76;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/websocket/api.js":"var Stream      = require('stream').Stream,\n    util        = require('util'),\n    driver      = require('websocket-driver'),\n    EventTarget = require('./api/event_target'),\n    Event       = require('./api/event');\n\nvar API = function(options) {\n  options = options || {};\n  driver.validateOptions(options, ['headers', 'extensions', 'maxLength', 'ping', 'proxy', 'tls', 'ca']);\n\n  this.readable = this.writable = true;\n\n  var headers = options.headers;\n  if (headers) {\n    for (var name in headers) this._driver.setHeader(name, headers[name]);\n  }\n\n  var extensions = options.extensions;\n  if (extensions) {\n    [].concat(extensions).forEach(this._driver.addExtension, this._driver);\n  }\n\n  this._ping          = options.ping;\n  this._pingId        = 0;\n  this.readyState     = API.CONNECTING;\n  this.bufferedAmount = 0;\n  this.protocol       = '';\n  this.url            = this._driver.url;\n  this.version        = this._driver.version;\n\n  var self = this;\n\n  this._driver.on('open',    function(e) { self._open() });\n  this._driver.on('message', function(e) { self._receiveMessage(e.data) });\n  this._driver.on('close',   function(e) { self._beginClose(e.reason, e.code) });\n\n  this._driver.on('error', function(error) {\n    self._emitError(error.message);\n  });\n  this.on('error', function() {});\n\n  this._driver.messages.on('drain', function() {\n    self.emit('drain');\n  });\n\n  if (this._ping)\n    this._pingTimer = setInterval(function() {\n      self._pingId += 1;\n      self.ping(self._pingId.toString());\n    }, this._ping * 1000);\n\n  this._configureStream();\n\n  if (!this._proxy) {\n    this._stream.pipe(this._driver.io);\n    this._driver.io.pipe(this._stream);\n  }\n};\nutil.inherits(API, Stream);\n\nAPI.CONNECTING = 0;\nAPI.OPEN       = 1;\nAPI.CLOSING    = 2;\nAPI.CLOSED     = 3;\n\nvar instance = {\n  write: function(data) {\n    return this.send(data);\n  },\n\n  end: function(data) {\n    if (data !== undefined) this.send(data);\n    this.close();\n  },\n\n  pause: function() {\n    return this._driver.messages.pause();\n  },\n\n  resume: function() {\n    return this._driver.messages.resume();\n  },\n\n  send: function(data) {\n    if (this.readyState > API.OPEN) return false;\n    if (!(data instanceof Buffer)) data = String(data);\n    return this._driver.messages.write(data);\n  },\n\n  ping: function(message, callback) {\n    if (this.readyState > API.OPEN) return false;\n    return this._driver.ping(message, callback);\n  },\n\n  close: function() {\n    if (this.readyState !== API.CLOSED) this.readyState = API.CLOSING;\n    this._driver.close();\n  },\n\n  _configureStream: function() {\n    var self = this;\n\n    this._stream.setTimeout(0);\n    this._stream.setNoDelay(true);\n\n    ['close', 'end'].forEach(function(event) {\n      this._stream.on(event, function() { self._finalizeClose() });\n    }, this);\n\n    this._stream.on('error', function(error) {\n      self._emitError('Network error: ' + self.url + ': ' + error.message);\n      self._finalizeClose();\n    });\n  },\n\n _open: function() {\n    if (this.readyState !== API.CONNECTING) return;\n\n    this.readyState = API.OPEN;\n    this.protocol = this._driver.protocol || '';\n\n    var event = new Event('open');\n    event.initEvent('open', false, false);\n    this.dispatchEvent(event);\n  },\n\n  _receiveMessage: function(data) {\n    if (this.readyState > API.OPEN) return false;\n\n    if (this.readable) this.emit('data', data);\n\n    var event = new Event('message', {data: data});\n    event.initEvent('message', false, false);\n    this.dispatchEvent(event);\n  },\n\n  _emitError: function(message) {\n    if (this.readyState >= API.CLOSING) return;\n\n    var event = new Event('error', {message: message});\n    event.initEvent('error', false, false);\n    this.dispatchEvent(event);\n  },\n\n  _beginClose: function(reason, code) {\n    if (this.readyState === API.CLOSED) return;\n    this.readyState = API.CLOSING;\n\n    if (this._stream) {\n      this._stream.end();\n      if (!this._stream.readable) this._finalizeClose();\n    }\n    this._closeParams = [reason, code];\n  },\n\n  _finalizeClose: function() {\n    if (this.readyState === API.CLOSED) return;\n    this.readyState = API.CLOSED;\n\n    if (this._pingTimer) clearInterval(this._pingTimer);\n    if (this._stream) this._stream.end();\n\n    if (this.readable) this.emit('end');\n    this.readable = this.writable = false;\n\n    var reason = this._closeParams ? this._closeParams[0] : '',\n        code   = this._closeParams ? this._closeParams[1] : 1006;\n\n    var event = new Event('close', {code: code, reason: reason});\n    event.initEvent('close', false, false);\n    this.dispatchEvent(event);\n  }\n};\n\nfor (var method in instance) API.prototype[method] = instance[method];\nfor (var key in EventTarget) API.prototype[key] = EventTarget[key];\n\nmodule.exports = API;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/websocket/api/event_target.js":"var Event = require('./event');\n\nvar EventTarget = {\n  onopen:     null,\n  onmessage:  null,\n  onerror:    null,\n  onclose:    null,\n\n  addEventListener: function(eventType, listener, useCapture) {\n    this.on(eventType, listener);\n  },\n\n  removeEventListener: function(eventType, listener, useCapture) {\n    this.removeListener(eventType, listener);\n  },\n\n  dispatchEvent: function(event) {\n    event.target = event.currentTarget = this;\n    event.eventPhase = Event.AT_TARGET;\n\n    if (this['on' + event.type])\n      this['on' + event.type](event);\n\n    this.emit(event.type, event);\n  }\n};\n\nmodule.exports = EventTarget;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/websocket/api/event.js":"var Event = function(eventType, options) {\n  this.type = eventType;\n  for (var key in options)\n    this[key] = options[key];\n};\n\nEvent.prototype.initEvent = function(eventType, canBubble, cancelable) {\n  this.type       = eventType;\n  this.bubbles    = canBubble;\n  this.cancelable = cancelable;\n};\n\nEvent.prototype.stopPropagation = function() {};\nEvent.prototype.preventDefault  = function() {};\n\nEvent.CAPTURING_PHASE = 1;\nEvent.AT_TARGET       = 2;\nEvent.BUBBLING_PHASE  = 3;\n\nmodule.exports = Event;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/websocket/client.js":"var util   = require('util'),\n    net    = require('net'),\n    tls    = require('tls'),\n    crypto = require('crypto'),\n    url    = require('url'),\n    driver = require('websocket-driver'),\n    API    = require('./api'),\n    Event  = require('./api/event');\n\nvar DEFAULT_PORTS    = {'http:': 80, 'https:': 443, 'ws:':80, 'wss:': 443},\n    SECURE_PROTOCOLS = ['https:', 'wss:'];\n\nvar Client = function(_url, protocols, options) {\n  options = options || {};\n\n  this.url     = _url;\n  this._driver = driver.client(this.url, {maxLength: options.maxLength, protocols: protocols});\n\n  ['open', 'error'].forEach(function(event) {\n    this._driver.on(event, function() {\n      self.headers    = self._driver.headers;\n      self.statusCode = self._driver.statusCode;\n    });\n  }, this);\n\n  var proxy     = options.proxy || {},\n      endpoint  = url.parse(proxy.origin || this.url),\n      port      = endpoint.port || DEFAULT_PORTS[endpoint.protocol],\n      secure    = SECURE_PROTOCOLS.indexOf(endpoint.protocol) >= 0,\n      onConnect = function() { self._onConnect() },\n      originTLS = options.tls || {},\n      socketTLS = proxy.origin ? (proxy.tls || {}) : originTLS,\n      self      = this;\n\n  originTLS.ca = originTLS.ca || options.ca;\n\n  this._stream = secure\n               ? tls.connect(port, endpoint.hostname, socketTLS, onConnect)\n               : net.connect(port, endpoint.hostname, onConnect);\n\n  if (proxy.origin) this._configureProxy(proxy, originTLS);\n\n  API.call(this, options);\n};\nutil.inherits(Client, API);\n\nClient.prototype._onConnect = function() {\n  var worker = this._proxy || this._driver;\n  worker.start();\n};\n\nClient.prototype._configureProxy = function(proxy, originTLS) {\n  var uri    = url.parse(this.url),\n      secure = SECURE_PROTOCOLS.indexOf(uri.protocol) >= 0,\n      self   = this,\n      name;\n\n  this._proxy = this._driver.proxy(proxy.origin);\n\n  if (proxy.headers) {\n    for (name in proxy.headers) this._proxy.setHeader(name, proxy.headers[name]);\n  }\n\n  this._proxy.pipe(this._stream, {end: false});\n  this._stream.pipe(this._proxy);\n\n  this._proxy.on('connect', function() {\n    if (secure) {\n      var options = {socket: self._stream, servername: uri.hostname};\n      for (name in originTLS) options[name] = originTLS[name];\n      self._stream = tls.connect(options);\n      self._configureStream();\n    }\n    self._driver.io.pipe(self._stream);\n    self._stream.pipe(self._driver.io);\n    self._driver.start();\n  });\n\n  this._proxy.on('error', function(error) {\n    self._driver.emit('error', error);\n  });\n};\n\nmodule.exports = Client;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/faye-websocket/lib/faye/eventsource.js":"var Stream      = require('stream').Stream,\n    util        = require('util'),\n    driver      = require('websocket-driver'),\n    Headers     = require('websocket-driver/lib/websocket/driver/headers'),\n    API         = require('./websocket/api'),\n    EventTarget = require('./websocket/api/event_target'),\n    Event       = require('./websocket/api/event');\n\nvar EventSource = function(request, response, options) {\n  this.writable = true;\n  options = options || {};\n\n  this._stream = response.socket;\n  this._ping   = options.ping  || this.DEFAULT_PING;\n  this._retry  = options.retry || this.DEFAULT_RETRY;\n\n  var scheme       = driver.isSecureRequest(request) ? 'https:' : 'http:';\n  this.url         = scheme + '//' + request.headers.host + request.url;\n  this.lastEventId = request.headers['last-event-id'] || '';\n  this.readyState  = API.CONNECTING;\n\n  var headers = new Headers(),\n      self    = this;\n\n  if (options.headers) {\n    for (var key in options.headers) headers.set(key, options.headers[key]);\n  }\n\n  if (!this._stream || !this._stream.writable) return;\n  process.nextTick(function() { self._open() });\n\n  this._stream.setTimeout(0);\n  this._stream.setNoDelay(true);\n\n  var handshake = 'HTTP/1.1 200 OK\\r\\n' +\n                  'Content-Type: text/event-stream\\r\\n' +\n                  'Cache-Control: no-cache, no-store\\r\\n' +\n                  'Connection: close\\r\\n' +\n                  headers.toString() +\n                  '\\r\\n' +\n                  'retry: ' + Math.floor(this._retry * 1000) + '\\r\\n\\r\\n';\n\n  this._write(handshake);\n\n  this._stream.on('drain', function() { self.emit('drain') });\n\n  if (this._ping)\n    this._pingTimer = setInterval(function() { self.ping() }, this._ping * 1000);\n\n  ['error', 'end'].forEach(function(event) {\n    self._stream.on(event, function() { self.close() });\n  });\n};\nutil.inherits(EventSource, Stream);\n\nEventSource.isEventSource = function(request) {\n  if (request.method !== 'GET') return false;\n  var accept = (request.headers.accept || '').split(/\\s*,\\s*/);\n  return accept.indexOf('text/event-stream') >= 0;\n};\n\nvar instance = {\n  DEFAULT_PING:   10,\n  DEFAULT_RETRY:  5,\n\n  _write: function(chunk) {\n    if (!this.writable) return false;\n    try {\n      return this._stream.write(chunk, 'utf8');\n    } catch (e) {\n      return false;\n    }\n  },\n\n  _open: function() {\n    if (this.readyState !== API.CONNECTING) return;\n\n    this.readyState = API.OPEN;\n\n    var event = new Event('open');\n    event.initEvent('open', false, false);\n    this.dispatchEvent(event);\n  },\n\n  write: function(message) {\n    return this.send(message);\n  },\n\n  end: function(message) {\n    if (message !== undefined) this.write(message);\n    this.close();\n  },\n\n  send: function(message, options) {\n    if (this.readyState > API.OPEN) return false;\n\n    message = String(message).replace(/(\\r\\n|\\r|\\n)/g, '$1data: ');\n    options = options || {};\n\n    var frame = '';\n    if (options.event) frame += 'event: ' + options.event + '\\r\\n';\n    if (options.id)    frame += 'id: '    + options.id    + '\\r\\n';\n    frame += 'data: ' + message + '\\r\\n\\r\\n';\n\n    return this._write(frame);\n  },\n\n  ping: function() {\n    return this._write(':\\r\\n\\r\\n');\n  },\n\n  close: function() {\n    if (this.readyState > API.OPEN) return false;\n\n    this.readyState = API.CLOSED;\n    this.writable = false;\n    if (this._pingTimer) clearInterval(this._pingTimer);\n    if (this._stream) this._stream.end();\n\n    var event = new Event('close');\n    event.initEvent('close', false, false);\n    this.dispatchEvent(event);\n\n    return true;\n  }\n};\n\nfor (var method in instance) EventSource.prototype[method] = instance[method];\nfor (var key in EventTarget) EventSource.prototype[key] = EventTarget[key];\n\nmodule.exports = EventSource;\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/dom-storage/lib/index.js":"// http://www.rajdeepd.com/articles/chrome/localstrg/LocalStorageSample.htm\n\n// NOTE:\n// this varies from actual localStorage in some subtle ways\n\n// also, there is no persistence\n// TODO persist\n(function () {\n  \"use strict\";\n\n  var fs = require('fs')\n    ;\n\n  function Storage(path, opts) {\n    opts = opts || {};\n    var db\n      ;\n\n    Object.defineProperty(this, '___priv_bk___', {\n      value: {\n        path: path\n      }\n    , writable: false\n    , enumerable: false\n    });\n\n    Object.defineProperty(this, '___priv_strict___', {\n      value: !!opts.strict\n    , writable: false\n    , enumerable: false\n    });\n\n    Object.defineProperty(this, '___priv_ws___', {\n      value: opts.ws || '  '\n    , writable: false\n    , enumerable: false\n    });\n\n    try {\n      db = JSON.parse(fs.readFileSync(path));\n    } catch(e) {\n      db = {};\n    }\n\n    Object.keys(db).forEach(function (key) {\n      this[key] = db[key];\n    }, this);\n  }\n\n  Storage.prototype.getItem = function (key) {\n    if (this.hasOwnProperty(key)) {\n      if (this.___priv_strict___) {\n        return String(this[key]);\n      } else {\n        return this[key];\n      }\n    }\n    return null;\n  };\n\n  Storage.prototype.setItem = function (key, val) {\n    if (val === undefined) {\n      this[key] = null;\n    } else if (this.___priv_strict___) {\n      this[key] = String(val);\n    } else {\n      this[key] = val;\n    }\n    this.___save___();\n  };\n\n  Storage.prototype.removeItem = function (key) {\n    delete this[key];\n    this.___save___();\n  };\n\n  Storage.prototype.clear = function () {\n    var self = this;\n    // filters out prototype keys\n    Object.keys(self).forEach(function (key) {\n      self[key] = undefined;\n      delete self[key];\n    });\n  };\n\n  Storage.prototype.key = function (i) {\n    i = i || 0;\n    return Object.keys(this)[i];\n  };\n\n  Storage.prototype.__defineGetter__('length', function () {\n    return Object.keys(this).length;\n  });\n\n  Storage.prototype.___save___ = function () {\n    var self = this\n      ;\n\n    if (!this.___priv_bk___.path) {\n      return;\n    }\n\n    if (this.___priv_bk___.lock) {\n      this.___priv_bk___.wait = true;\n      return;\n    }\n\n    this.___priv_bk___.lock = true;\n    fs.writeFile(\n      this.___priv_bk___.path\n    , JSON.stringify(this, null, this.___priv_ws___)\n    , 'utf8'\n    , function (e) {\n      self.___priv_bk___.lock = false;\n      if (e) {\n        return;\n      }\n      if (self.___priv_bk___.wait) {\n        self.___priv_bk___.wait = false;\n        self.___save___();\n      }\n    });\n  };\n\n  Object.defineProperty(Storage, 'create', {\n    value: function (path, opts) {\n      return new Storage(path, opts);\n    }\n  , writable: false\n  , enumerable: false\n  });\n\n  module.exports = Storage;\n}());\n","/home/travis/build/npmtest/node-npmtest-firebase/node_modules/firebase/node_modules/xmlhttprequest/lib/XMLHttpRequest.js":"/**\n * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.\n *\n * This can be used with JS designed for browsers to improve reuse of code and\n * allow the use of existing libraries.\n *\n * Usage: include(\"XMLHttpRequest.js\") and use XMLHttpRequest per W3C specs.\n *\n * @author Dan DeFelippi <dan@driverdan.com>\n * @contributor David Ellis <d.f.ellis@ieee.org>\n * @license MIT\n */\n\nvar Url = require(\"url\");\nvar spawn = require(\"child_process\").spawn;\nvar fs = require(\"fs\");\n\nexports.XMLHttpRequest = function() {\n  \"use strict\";\n\n  /**\n   * Private variables\n   */\n  var self = this;\n  var http = require(\"http\");\n  var https = require(\"https\");\n\n  // Holds http.js objects\n  var request;\n  var response;\n\n  // Request settings\n  var settings = {};\n\n  // Disable header blacklist.\n  // Not part of XHR specs.\n  var disableHeaderCheck = false;\n\n  // Set some default headers\n  var defaultHeaders = {\n    \"User-Agent\": \"node-XMLHttpRequest\",\n    \"Accept\": \"*/*\",\n  };\n\n  var headers = {};\n  var headersCase = {};\n\n  // These headers are not user setable.\n  // The following are allowed but banned in the spec:\n  // * user-agent\n  var forbiddenRequestHeaders = [\n    \"accept-charset\",\n    \"accept-encoding\",\n    \"access-control-request-headers\",\n    \"access-control-request-method\",\n    \"connection\",\n    \"content-length\",\n    \"content-transfer-encoding\",\n    \"cookie\",\n    \"cookie2\",\n    \"date\",\n    \"expect\",\n    \"host\",\n    \"keep-alive\",\n    \"origin\",\n    \"referer\",\n    \"te\",\n    \"trailer\",\n    \"transfer-encoding\",\n    \"upgrade\",\n    \"via\"\n  ];\n\n  // These request methods are not allowed\n  var forbiddenRequestMethods = [\n    \"TRACE\",\n    \"TRACK\",\n    \"CONNECT\"\n  ];\n\n  // Send flag\n  var sendFlag = false;\n  // Error flag, used when errors occur or abort is called\n  var errorFlag = false;\n\n  // Event listeners\n  var listeners = {};\n\n  /**\n   * Constants\n   */\n\n  this.UNSENT = 0;\n  this.OPENED = 1;\n  this.HEADERS_RECEIVED = 2;\n  this.LOADING = 3;\n  this.DONE = 4;\n\n  /**\n   * Public vars\n   */\n\n  // Current state\n  this.readyState = this.UNSENT;\n\n  // default ready state change handler in case one is not set or is set late\n  this.onreadystatechange = null;\n\n  // Result & response\n  this.responseText = \"\";\n  this.responseXML = \"\";\n  this.status = null;\n  this.statusText = null;\n  \n  // Whether cross-site Access-Control requests should be made using\n  // credentials such as cookies or authorization headers\n  this.withCredentials = false;\n\n  /**\n   * Private methods\n   */\n\n  /**\n   * Check if the specified header is allowed.\n   *\n   * @param string header Header to validate\n   * @return boolean False if not allowed, otherwise true\n   */\n  var isAllowedHttpHeader = function(header) {\n    return disableHeaderCheck || (header && forbiddenRequestHeaders.indexOf(header.toLowerCase()) === -1);\n  };\n\n  /**\n   * Check if the specified method is allowed.\n   *\n   * @param string method Request method to validate\n   * @return boolean False if not allowed, otherwise true\n   */\n  var isAllowedHttpMethod = function(method) {\n    return (method && forbiddenRequestMethods.indexOf(method) === -1);\n  };\n\n  /**\n   * Public methods\n   */\n\n  /**\n   * Open the connection. Currently supports local server requests.\n   *\n   * @param string method Connection method (eg GET, POST)\n   * @param string url URL for the connection.\n   * @param boolean async Asynchronous connection. Default is true.\n   * @param string user Username for basic authentication (optional)\n   * @param string password Password for basic authentication (optional)\n   */\n  this.open = function(method, url, async, user, password) {\n    this.abort();\n    errorFlag = false;\n\n    // Check for valid request method\n    if (!isAllowedHttpMethod(method)) {\n      throw new Error(\"SecurityError: Request method not allowed\");\n    }\n\n    settings = {\n      \"method\": method,\n      \"url\": url.toString(),\n      \"async\": (typeof async !== \"boolean\" ? true : async),\n      \"user\": user || null,\n      \"password\": password || null\n    };\n\n    setState(this.OPENED);\n  };\n\n  /**\n   * Disables or enables isAllowedHttpHeader() check the request. Enabled by default.\n   * This does not conform to the W3C spec.\n   *\n   * @param boolean state Enable or disable header checking.\n   */\n  this.setDisableHeaderCheck = function(state) {\n    disableHeaderCheck = state;\n  };\n\n  /**\n   * Sets a header for the request or appends the value if one is already set.\n   *\n   * @param string header Header name\n   * @param string value Header value\n   */\n  this.setRequestHeader = function(header, value) {\n    if (this.readyState !== this.OPENED) {\n      throw new Error(\"INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN\");\n    }\n    if (!isAllowedHttpHeader(header)) {\n      console.warn(\"Refused to set unsafe header \\\"\" + header + \"\\\"\");\n      return;\n    }\n    if (sendFlag) {\n      throw new Error(\"INVALID_STATE_ERR: send flag is true\");\n    }\n    header = headersCase[header.toLowerCase()] || header;\n    headersCase[header.toLowerCase()] = header;\n    headers[header] = headers[header] ? headers[header] + ', ' + value : value;\n  };\n\n  /**\n   * Gets a header from the server response.\n   *\n   * @param string header Name of header to get.\n   * @return string Text of the header or null if it doesn't exist.\n   */\n  this.getResponseHeader = function(header) {\n    if (typeof header === \"string\"\n      && this.readyState > this.OPENED\n      && response\n      && response.headers\n      && response.headers[header.toLowerCase()]\n      && !errorFlag\n    ) {\n      return response.headers[header.toLowerCase()];\n    }\n\n    return null;\n  };\n\n  /**\n   * Gets all the response headers.\n   *\n   * @return string A string with all response headers separated by CR+LF\n   */\n  this.getAllResponseHeaders = function() {\n    if (this.readyState < this.HEADERS_RECEIVED || errorFlag) {\n      return \"\";\n    }\n    var result = \"\";\n\n    for (var i in response.headers) {\n      // Cookie headers are excluded\n      if (i !== \"set-cookie\" && i !== \"set-cookie2\") {\n        result += i + \": \" + response.headers[i] + \"\\r\\n\";\n      }\n    }\n    return result.substr(0, result.length - 2);\n  };\n\n  /**\n   * Gets a request header\n   *\n   * @param string name Name of header to get\n   * @return string Returns the request header or empty string if not set\n   */\n  this.getRequestHeader = function(name) {\n    if (typeof name === \"string\" && headersCase[name.toLowerCase()]) {\n      return headers[headersCase[name.toLowerCase()]];\n    }\n\n    return \"\";\n  };\n\n  /**\n   * Sends the request to the server.\n   *\n   * @param string data Optional data to send as request body.\n   */\n  this.send = function(data) {\n    if (this.readyState !== this.OPENED) {\n      throw new Error(\"INVALID_STATE_ERR: connection must be opened before send() is called\");\n    }\n\n    if (sendFlag) {\n      throw new Error(\"INVALID_STATE_ERR: send has already been called\");\n    }\n\n    var ssl = false, local = false;\n    var url = Url.parse(settings.url);\n    var host;\n    // Determine the server\n    switch (url.protocol) {\n      case \"https:\":\n        ssl = true;\n        // SSL & non-SSL both need host, no break here.\n      case \"http:\":\n        host = url.hostname;\n        break;\n\n      case \"file:\":\n        local = true;\n        break;\n\n      case undefined:\n      case null:\n      case \"\":\n        host = \"localhost\";\n        break;\n\n      default:\n        throw new Error(\"Protocol not supported.\");\n    }\n\n    // Load files off the local filesystem (file://)\n    if (local) {\n      if (settings.method !== \"GET\") {\n        throw new Error(\"XMLHttpRequest: Only GET method is supported\");\n      }\n\n      if (settings.async) {\n        fs.readFile(url.pathname, \"utf8\", function(error, data) {\n          if (error) {\n            self.handleError(error);\n          } else {\n            self.status = 200;\n            self.responseText = data;\n            setState(self.DONE);\n          }\n        });\n      } else {\n        try {\n          this.responseText = fs.readFileSync(url.pathname, \"utf8\");\n          this.status = 200;\n          setState(self.DONE);\n        } catch(e) {\n          this.handleError(e);\n        }\n      }\n\n      return;\n    }\n\n    // Default to port 80. If accessing localhost on another port be sure\n    // to use http://localhost:port/path\n    var port = url.port || (ssl ? 443 : 80);\n    // Add query string if one is used\n    var uri = url.pathname + (url.search ? url.search : \"\");\n\n    // Set the defaults if they haven't been set\n    for (var name in defaultHeaders) {\n      if (!headersCase[name.toLowerCase()]) {\n        headers[name] = defaultHeaders[name];\n      }\n    }\n\n    // Set the Host header or the server may reject the request\n    headers.Host = host;\n    if (!((ssl && port === 443) || port === 80)) {\n      headers.Host += \":\" + url.port;\n    }\n\n    // Set Basic Auth if necessary\n    if (settings.user) {\n      if (typeof settings.password === \"undefined\") {\n        settings.password = \"\";\n      }\n      var authBuf = new Buffer(settings.user + \":\" + settings.password);\n      headers.Authorization = \"Basic \" + authBuf.toString(\"base64\");\n    }\n\n    // Set content length header\n    if (settings.method === \"GET\" || settings.method === \"HEAD\") {\n      data = null;\n    } else if (data) {\n      headers[\"Content-Length\"] = Buffer.isBuffer(data) ? data.length : Buffer.byteLength(data);\n\n      if (!headers[\"Content-Type\"]) {\n        headers[\"Content-Type\"] = \"text/plain;charset=UTF-8\";\n      }\n    } else if (settings.method === \"POST\") {\n      // For a post with no data set Content-Length: 0.\n      // This is required by buggy servers that don't meet the specs.\n      headers[\"Content-Length\"] = 0;\n    }\n\n    var options = {\n      host: host,\n      port: port,\n      path: uri,\n      method: settings.method,\n      headers: headers,\n      agent: false,\n      withCredentials: self.withCredentials\n    };\n\n    // Reset error flag\n    errorFlag = false;\n\n    // Handle async requests\n    if (settings.async) {\n      // Use the proper protocol\n      var doRequest = ssl ? https.request : http.request;\n\n      // Request is being sent, set send flag\n      sendFlag = true;\n\n      // As per spec, this is called here for historical reasons.\n      self.dispatchEvent(\"readystatechange\");\n\n      // Handler for the response\n      var responseHandler = function responseHandler(resp) {\n        // Set response var to the response we got back\n        // This is so it remains accessable outside this scope\n        response = resp;\n        // Check for redirect\n        // @TODO Prevent looped redirects\n        if (response.statusCode === 301 || response.statusCode === 302 || response.statusCode === 303 || response.statusCode === 307) {\n          // Change URL to the redirect location\n          settings.url = response.headers.location;\n          var url = Url.parse(settings.url);\n          // Set host var in case it's used later\n          host = url.hostname;\n          // Options for the new request\n          var newOptions = {\n            hostname: url.hostname,\n            port: url.port,\n            path: url.path,\n            method: response.statusCode === 303 ? \"GET\" : settings.method,\n            headers: headers,\n            withCredentials: self.withCredentials\n          };\n\n          // Issue the new request\n          request = doRequest(newOptions, responseHandler).on(\"error\", errorHandler);\n          request.end();\n          // @TODO Check if an XHR event needs to be fired here\n          return;\n        }\n\n        response.setEncoding(\"utf8\");\n\n        setState(self.HEADERS_RECEIVED);\n        self.status = response.statusCode;\n\n        response.on(\"data\", function(chunk) {\n          // Make sure there's some data\n          if (chunk) {\n            self.responseText += chunk;\n          }\n          // Don't emit state changes if the connection has been aborted.\n          if (sendFlag) {\n            setState(self.LOADING);\n          }\n        });\n\n        response.on(\"end\", function() {\n          if (sendFlag) {\n            // Discard the end event if the connection has been aborted\n            setState(self.DONE);\n            sendFlag = false;\n          }\n        });\n\n        response.on(\"error\", function(error) {\n          self.handleError(error);\n        });\n      };\n\n      // Error handler for the request\n      var errorHandler = function errorHandler(error) {\n        self.handleError(error);\n      };\n\n      // Create the request\n      request = doRequest(options, responseHandler).on(\"error\", errorHandler);\n\n      // Node 0.4 and later won't accept empty data. Make sure it's needed.\n      if (data) {\n        request.write(data);\n      }\n\n      request.end();\n\n      self.dispatchEvent(\"loadstart\");\n    } else { // Synchronous\n      // Create a temporary file for communication with the other Node process\n      var contentFile = \".node-xmlhttprequest-content-\" + process.pid;\n      var syncFile = \".node-xmlhttprequest-sync-\" + process.pid;\n      fs.writeFileSync(syncFile, \"\", \"utf8\");\n      // The async request the other Node process executes\n      var execString = \"var http = require('http'), https = require('https'), fs = require('fs');\"\n        + \"var doRequest = http\" + (ssl ? \"s\" : \"\") + \".request;\"\n        + \"var options = \" + JSON.stringify(options) + \";\"\n        + \"var responseText = '';\"\n        + \"var req = doRequest(options, function(response) {\"\n        + \"response.setEncoding('utf8');\"\n        + \"response.on('data', function(chunk) {\"\n        + \"  responseText += chunk;\"\n        + \"});\"\n        + \"response.on('end', function() {\"\n        + \"fs.writeFileSync('\" + contentFile + \"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');\"\n        + \"fs.unlinkSync('\" + syncFile + \"');\"\n        + \"});\"\n        + \"response.on('error', function(error) {\"\n        + \"fs.writeFileSync('\" + contentFile + \"', JSON.stringify({err: error}), 'utf8');\"\n        + \"fs.unlinkSync('\" + syncFile + \"');\"\n        + \"});\"\n        + \"}).on('error', function(error) {\"\n        + \"fs.writeFileSync('\" + contentFile + \"', JSON.stringify({err: error}), 'utf8');\"\n        + \"fs.unlinkSync('\" + syncFile + \"');\"\n        + \"});\"\n        + (data ? \"req.write('\" + JSON.stringify(data).slice(1,-1).replace(/'/g, \"\\\\'\") + \"');\":\"\")\n        + \"req.end();\";\n      // Start the other Node Process, executing this string\n      var syncProc = spawn(process.argv[0], [\"-e\", execString]);\n      while(fs.existsSync(syncFile)) {\n        // Wait while the sync file is empty\n      }\n      var resp = JSON.parse(fs.readFileSync(contentFile, 'utf8'));\n      // Kill the child process once the file has data\n      syncProc.stdin.end();\n      // Remove the temporary file\n      fs.unlinkSync(contentFile);\n\n      if (resp.err) {\n        self.handleError(resp.err);\n      } else {\n        response = resp.data;\n        self.status = resp.data.statusCode;\n        self.responseText = resp.data.text;\n        setState(self.DONE);\n      }\n    }\n  };\n\n  /**\n   * Called when an error is encountered to deal with it.\n   */\n  this.handleError = function(error) {\n    this.status = 0;\n    this.statusText = error;\n    this.responseText = error.stack;\n    errorFlag = true;\n    setState(this.DONE);\n    this.dispatchEvent('error');\n  };\n\n  /**\n   * Aborts a request.\n   */\n  this.abort = function() {\n    if (request) {\n      request.abort();\n      request = null;\n    }\n\n    headers = defaultHeaders;\n    this.status = 0;\n    this.responseText = \"\";\n    this.responseXML = \"\";\n\n    errorFlag = true;\n\n    if (this.readyState !== this.UNSENT\n        && (this.readyState !== this.OPENED || sendFlag)\n        && this.readyState !== this.DONE) {\n      sendFlag = false;\n      setState(this.DONE);\n    }\n    this.readyState = this.UNSENT;\n    this.dispatchEvent('abort');\n  };\n\n  /**\n   * Adds an event listener. Preferred method of binding to events.\n   */\n  this.addEventListener = function(event, callback) {\n    if (!(event in listeners)) {\n      listeners[event] = [];\n    }\n    // Currently allows duplicate callbacks. Should it?\n    listeners[event].push(callback);\n  };\n\n  /**\n   * Remove an event callback that has already been bound.\n   * Only works on the matching funciton, cannot be a copy.\n   */\n  this.removeEventListener = function(event, callback) {\n    if (event in listeners) {\n      // Filter will return a new array with the callback removed\n      listeners[event] = listeners[event].filter(function(ev) {\n        return ev !== callback;\n      });\n    }\n  };\n\n  /**\n   * Dispatch any events, including both \"on\" methods and events attached using addEventListener.\n   */\n  this.dispatchEvent = function(event) {\n    if (typeof self[\"on\" + event] === \"function\") {\n      self[\"on\" + event]();\n    }\n    if (event in listeners) {\n      for (var i = 0, len = listeners[event].length; i < len; i++) {\n        listeners[event][i].call(self);\n      }\n    }\n  };\n\n  /**\n   * Changes readyState and calls onreadystatechange.\n   *\n   * @param int state New state\n   */\n  var setState = function(state) {\n    if (state == self.LOADING || self.readyState !== state) {\n      self.readyState = state;\n\n      if (settings.async || self.readyState < self.OPENED || self.readyState === self.DONE) {\n        self.dispatchEvent(\"readystatechange\");\n      }\n\n      if (self.readyState === self.DONE && !errorFlag) {\n        self.dispatchEvent(\"load\");\n        // @TODO figure out InspectorInstrumentation::didLoadXHR(cookie)\n        self.dispatchEvent(\"loadend\");\n      }\n    }\n  };\n};\n"}